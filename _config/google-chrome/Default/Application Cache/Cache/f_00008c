/*! Copyright (c) 2015 WhatsApp Inc.  All Rights Reserved. */
webpackJsonp([82],[,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){this.logs=[],this.localCursor=0,this.pending=void 0,this.timer=new l(this,this.persistIdb)}function o(e){return this.writeLine(e,!1),_.noop}function a(e){return this.writeLine(e,!0),_.noop}var s=n(3),u=r(s),c=n(8),l=n(83),d=250;i.prototype.writeLine=function(e,t){e=t?e:e?e.toString().substring(0,d):e;var n=moment().locale("en").format("YYYY-MM-DD HH:mm:ss: ")+e;this.persist(n)},i.prototype.logColor=function(e,t){return o.call(this,t)},i.prototype.log=o,i.prototype.logVerbose=a,i.prototype.info=o,i.prototype.infoVerbose=a,i.prototype.warn=o,i.prototype.warnVerbose=a,i.prototype.error=o,i.prototype.errorVerbose=a,i.prototype.trace=function(e){var t=new Error(e);this.log(t.stack,"red",t,!0)()},i.prototype.persist=function(e){this.logs.push(e),this.logs.length>c.LOG_SIZE&&(this.logs.shift(),this.localCursor--),this.timer.debounceAndCap(250,1e3)},i.prototype.persistIdb=function(){var e=this,t=n(23),r=this.logs.slice(Math.max(this.localCursor,0),this.logs.length);r.length&&(this.pending=t.idb().bind(this).then(function(t){return t.transaction("rw",t.logs,function(){var n=void 0,i=e.getCursor();return _.forEach(r,function(e,r){n=(i+r)%c.LOG_SIZE,t.logs.put({line:n,log:e})}),n})}).then(function(t){e.localCursor+=r.length,e.setCursor(t)})["catch"](function(e){})["finally"](function(){e.pending=void 0}))},i.prototype.clearLogs=function(){var e=n(23);e.idb().then(function(e){e.logs["delete"]()})["catch"](_.noop),this.setCursor(0),this.localCursor=0,this.logs=[]},i.prototype.getLogs=function(){var e=this,t=n(23),r=[this.pending];return 0!==this.timer.ts&&(this.timer.trigger(),r.push(this.pending)),u["default"].all(r).then(function(){return t.idb()}).then(function(e){return e.logs.orderBy("line").toArray()}).then(function(t){var n=e.getCursor(),r=n<t.length-1?t.slice(n,t.length):[],i=t.slice(0,n);return _.pluck(r.concat(i),"log")})["catch"](function(){return e.logs})},i.prototype.getCursor=function(){var e=n(23);try{return JSON.parse(e.permanentStorage.getItem(c.KEY_LOG_CURSOR))||Math.max(this.localCursor,0)}catch(t){return Math.max(this.localCursor,0)}},i.prototype.setCursor=function(e){var t=n(23);return t.permanentStorage.setItem(c.KEY_LOG_CURSOR,e)},e.exports=new i},,function(e,t,n){e.exports={"default":n(402),__esModule:!0}},,,,function(e,t,n){(function(e){/**
	 * @license ByteBuffer.js (c) 2013-2014 Daniel Wirtz <dcode@dcode.io>
	 * This version of ByteBuffer.js uses an ArrayBuffer (AB) as its backing buffer and is compatible with modern browsers.
	 * Released under the Apache License, Version 2.0
	 * see: https://github.com/dcodeIO/ByteBuffer.js for details
	 */
!function(t){"use strict";function r(e){var t=function(e,r,i){if("undefined"==typeof e&&(e=t.DEFAULT_CAPACITY),"undefined"==typeof r&&(r=t.DEFAULT_ENDIAN),"undefined"==typeof i&&(i=t.DEFAULT_NOASSERT),!i){if(e=0|e,0>e)throw new RangeError("Illegal capacity: 0 <= "+e);if("boolean"!=typeof r)throw new TypeError("Illegal littleEndian: Not a boolean");if("boolean"!=typeof i)throw new TypeError("Illegal noAssert: Not a boolean")}this.buffer=0===e?n:new ArrayBuffer(e),this.view=0===e?null:new DataView(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian="undefined"!=typeof r?!!r:!1,this.noAssert=!!i};t.VERSION="3.1.0",t.LITTLE_ENDIAN=!0,t.BIG_ENDIAN=!1,t.DEFAULT_CAPACITY=16,t.DEFAULT_ENDIAN=t.BIG_ENDIAN,t.DEFAULT_NOASSERT=!1,t.Long=e||null;var n=new ArrayBuffer(0);t.allocate=function(e,n,r){return new t(e,n,r)},t.concat=function(e,n,r,i){("boolean"==typeof n||"string"!=typeof n)&&(i=r,r=n,n=void 0);for(var o,a=0,s=0,u=e.length;u>s;++s)t.isByteBuffer(e[s])||(e[s]=t.wrap(e[s],n)),o=e[s].limit-e[s].offset,o>0&&(a+=o);if(0===a)return new t(0,r,i);var c,l=new t(a,r,i),d=new Uint8Array(l.buffer);for(s=0;u>s;)c=e[s++],o=c.limit-c.offset,0>=o||(d.set(new Uint8Array(c.buffer).subarray(c.offset,c.limit),l.offset),l.offset+=o);return l.limit=l.offset,l.offset=0,l},t.isByteBuffer=function(e){return e&&e instanceof t},t.type=function(){return ArrayBuffer},t.wrap=function(e,n,r,o){if("string"!=typeof n&&(o=r,r=n,n=void 0),"string"==typeof e)switch("undefined"==typeof n&&(n="utf8"),n){case"base64":return t.fromBase64(e,r);case"hex":return t.fromHex(e,r);case"binary":return t.fromBinary(e,r);case"utf8":return t.fromUTF8(e,r);case"debug":return t.fromDebug(e,r);default:throw new TypeError("Unsupported encoding: "+n)}if(null===e||"object"!=typeof e)throw new TypeError("Illegal buffer: null or non-object");var a;if(t.isByteBuffer(e))return a=t.prototype.clone.call(e),a.markedOffset=-1,a;if(e instanceof Uint8Array)a=new t(0,r,o),e.length>0&&(a.buffer=e.buffer,a.offset=e.byteOffset,a.limit=e.byteOffset+e.length,a.view=e.length>0?new DataView(e.buffer):null);else if(e instanceof ArrayBuffer)a=new t(0,r,o),e.byteLength>0&&(a.buffer=e,a.offset=0,a.limit=e.byteLength,a.view=e.byteLength>0?new DataView(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Illegal buffer");for(a=new t(e.length,r,o),a.limit=e.length,i=0;i<e.length;++i)a.view.setUint8(i,e[i])}return a},t.prototype.writeInt8=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view.setInt8(t,e),n&&(this.offset+=1),this},t.prototype.writeByte=t.prototype.writeInt8,t.prototype.readInt8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=this.view.getInt8(e);return t&&(this.offset+=1),n},t.prototype.readByte=t.prototype.readInt8,t.prototype.writeUint8=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view.setUint8(t,e),n&&(this.offset+=1),this},t.prototype.readUint8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=this.view.getUint8(e);return t&&(this.offset+=1),n},t.prototype.writeInt16=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.view.setInt16(t,e,this.littleEndian),n&&(this.offset+=2),this},t.prototype.writeShort=t.prototype.writeInt16,t.prototype.readInt16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=this.view.getInt16(e,this.littleEndian);return t&&(this.offset+=2),n},t.prototype.readShort=t.prototype.readInt16,t.prototype.writeUint16=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.view.setUint16(t,e,this.littleEndian),n&&(this.offset+=2),this},t.prototype.readUint16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=this.view.getUint16(e,this.littleEndian);return t&&(this.offset+=2),n},t.prototype.writeInt32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.view.setInt32(t,e,this.littleEndian),n&&(this.offset+=4),this},t.prototype.writeInt=t.prototype.writeInt32,t.prototype.readInt32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=this.view.getInt32(e,this.littleEndian);return t&&(this.offset+=4),n},t.prototype.readInt=t.prototype.readInt32,t.prototype.writeUint32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.view.setUint32(t,e,this.littleEndian),n&&(this.offset+=4),this},t.prototype.readUint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=this.view.getUint32(e,this.littleEndian);return t&&(this.offset+=4),n},e&&(t.prototype.writeInt64=function(t,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if(!(t&&t instanceof e))throw new TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!==0)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t&&(t=e.fromNumber(t)),n+=8;var i=this.buffer.byteLength;return n>i&&this.resize((i*=2)>n?i:n),n-=8,this.littleEndian?(this.view.setInt32(n,t.low,!0),this.view.setInt32(n+4,t.high,!0)):(this.view.setInt32(n,t.high,!1),this.view.setInt32(n+4,t.low,!1)),r&&(this.offset+=8),this},t.prototype.writeLong=t.prototype.writeInt64,t.prototype.readInt64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=this.littleEndian?new e(this.view.getInt32(t,!0),this.view.getInt32(t+4,!0),!1):new e(this.view.getInt32(t+4,!1),this.view.getInt32(t,!1),!1);return n&&(this.offset+=8),r},t.prototype.readLong=t.prototype.readInt64,t.prototype.writeUint64=function(t,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if(!(t&&t instanceof e))throw new TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!==0)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t&&(t=e.fromNumber(t)),n+=8;var i=this.buffer.byteLength;return n>i&&this.resize((i*=2)>n?i:n),n-=8,this.littleEndian?(this.view.setInt32(n,t.low,!0),this.view.setInt32(n+4,t.high,!0)):(this.view.setInt32(n,t.high,!1),this.view.setInt32(n+4,t.low,!1)),r&&(this.offset+=8),this},t.prototype.readUint64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=this.littleEndian?new e(this.view.getInt32(t,!0),this.view.getInt32(t+4,!0),!0):new e(this.view.getInt32(t+4,!1),this.view.getInt32(t,!1),!0);return n&&(this.offset+=8),r}),t.prototype.writeFloat32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw new TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.view.setFloat32(t,e,this.littleEndian),n&&(this.offset+=4),this},t.prototype.writeFloat=t.prototype.writeFloat32,t.prototype.readFloat32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=this.view.getFloat32(e,this.littleEndian);return t&&(this.offset+=4),n},t.prototype.readFloat=t.prototype.readFloat32,t.prototype.writeFloat64=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw new TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=8,this.view.setFloat64(t,e,this.littleEndian),n&&(this.offset+=8),this},t.prototype.writeDouble=t.prototype.writeFloat64,t.prototype.readFloat64=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+8>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=this.view.getFloat64(e,this.littleEndian);return t&&(this.offset+=8),n},t.prototype.readDouble=t.prototype.readFloat64,t.MAX_VARINT32_BYTES=5,t.calculateVarint32=function(e){return e>>>=0,128>e?1:16384>e?2:1<<21>e?3:1<<28>e?4:5},t.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},t.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},t.prototype.writeVarint32=function(e,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof n||n%1!==0)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,o=t.calculateVarint32(e);n+=o;var a=this.buffer.byteLength;return n>a&&this.resize((a*=2)>n?a:n),n-=o,this.view.setUint8(n,i=128|e),e>>>=0,e>=128?(i=e>>7|128,this.view.setUint8(n+1,i),e>=16384?(i=e>>14|128,this.view.setUint8(n+2,i),e>=1<<21?(i=e>>21|128,this.view.setUint8(n+3,i),e>=1<<28?(this.view.setUint8(n+4,e>>28&15),o=5):(this.view.setUint8(n+3,127&i),o=4)):(this.view.setUint8(n+2,127&i),o=3)):(this.view.setUint8(n+1,127&i),o=2)):(this.view.setUint8(n,127&i),o=1),r?(this.offset+=o,this):o},t.prototype.writeVarint32ZigZag=function(e,n){return this.writeVarint32(t.zigZagEncode32(e),n)},t.prototype.readVarint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r=0,i=0;do n=this.view.getUint8(e+r),5>r&&(i|=(127&n)<<7*r>>>0),++r;while(128===(128&n));return i=0|i,t?(this.offset+=r,i):{value:i,length:r}},t.prototype.readVarint32ZigZag=function(e){var n=this.readVarint32(e);return"object"==typeof n?n.value=t.zigZagDecode32(n.value):n=t.zigZagDecode32(n),n},e&&(t.MAX_VARINT64_BYTES=10,t.calculateVarint64=function(t){"number"==typeof t&&(t=e.fromNumber(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,i=t.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==r?16384>n?128>n?1:2:1<<21>n?3:4:16384>r?128>r?5:6:1<<21>r?7:8:128>i?9:10},t.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):t.unsigned!==!1&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},t.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):t.unsigned!==!1&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},t.prototype.writeVarint64=function(n,r){var i="undefined"==typeof r;if(i&&(r=this.offset),!this.noAssert){if("number"==typeof n)n=e.fromNumber(n);else if(!(n&&n instanceof e))throw new TypeError("Illegal value: "+n+" (not an integer or Long)");if("number"!=typeof r||r%1!==0)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}"number"==typeof n?n=e.fromNumber(n,!1):n.unsigned!==!1&&(n=n.toSigned());var o=t.calculateVarint64(n),a=n.toInt()>>>0,s=n.shiftRightUnsigned(28).toInt()>>>0,u=n.shiftRightUnsigned(56).toInt()>>>0;r+=o;var c=this.buffer.byteLength;switch(r>c&&this.resize((c*=2)>r?c:r),r-=o,o){case 10:this.view.setUint8(r+9,u>>>7&1);case 9:this.view.setUint8(r+8,9!==o?128|u:127&u);case 8:this.view.setUint8(r+7,8!==o?s>>>21|128:s>>>21&127);case 7:this.view.setUint8(r+6,7!==o?s>>>14|128:s>>>14&127);case 6:this.view.setUint8(r+5,6!==o?s>>>7|128:s>>>7&127);case 5:this.view.setUint8(r+4,5!==o?128|s:127&s);case 4:this.view.setUint8(r+3,4!==o?a>>>21|128:a>>>21&127);case 3:this.view.setUint8(r+2,3!==o?a>>>14|128:a>>>14&127);case 2:this.view.setUint8(r+1,2!==o?a>>>7|128:a>>>7&127);case 1:this.view.setUint8(r,1!==o?128|a:127&a)}return i?(this.offset+=o,this):o},t.prototype.writeVarint64ZigZag=function(e,n){return this.writeVarint64(t.zigZagEncode64(e),n)},t.prototype.readVarint64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var r=t,i=0,o=0,a=0,s=0;if(s=this.view.getUint8(t++),i=127&s,128&s&&(s=this.view.getUint8(t++),i|=(127&s)<<7,128&s&&(s=this.view.getUint8(t++),i|=(127&s)<<14,128&s&&(s=this.view.getUint8(t++),i|=(127&s)<<21,128&s&&(s=this.view.getUint8(t++),o=127&s,128&s&&(s=this.view.getUint8(t++),o|=(127&s)<<7,128&s&&(s=this.view.getUint8(t++),o|=(127&s)<<14,128&s&&(s=this.view.getUint8(t++),o|=(127&s)<<21,128&s&&(s=this.view.getUint8(t++),a=127&s,128&s&&(s=this.view.getUint8(t++),a|=(127&s)<<7,128&s))))))))))throw new Error("Data must be corrupt: Buffer overrun");var u=e.from28Bits(i,o,a,!1);return n?(this.offset=t,u):{value:u,length:t-r}},t.prototype.readVarint64ZigZag=function(n){var r=this.readVarint64(n);return r&&r.value instanceof e?r.value=t.zigZagDecode64(r.value):r=t.zigZagDecode64(r),r}),t.prototype.writeCString=function(e,t){var n="undefined"==typeof t;n&&(t=this.offset);var r,i=e.length;if(!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");for(r=0;i>r;++r)if(0===e.charCodeAt(r))throw new RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var a=t;i=o.calculateUTF16asUTF8(o.stringSource(e))[1],t+=i+1;var s=this.buffer.byteLength;return t>s&&this.resize((s*=2)>t?s:t),t-=i+1,o.encodeUTF16toUTF8(o.stringSource(e),function(e){this.view.setUint8(t++,e)}.bind(this)),this.view.setUint8(t++,0),n?(this.offset=t-a,this):i},t.prototype.readCString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r=e,i=-1;return o.decodeUTF8toUTF16(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view.getUint8(e++))?null:i}.bind(this),n=o.stringDestination(),!0),t?(this.offset=e,n()):{string:n(),length:e-r}},t.prototype.writeIString=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,i=t;r=o.calculateUTF16asUTF8(o.stringSource(e),this.noAssert)[1],t+=4+r;var a=this.buffer.byteLength;if(t>a&&this.resize((a*=2)>t?a:t),t-=4+r,this.view.setUint32(t,r,this.littleEndian),t+=4,o.encodeUTF16toUTF8(o.stringSource(e),function(e){this.view.setUint8(t++,e)}.bind(this)),t!==i+4+r)throw new RangeError("Illegal range: Truncated data, "+t+" == "+(t+4+r));return n?(this.offset=t,this):t-i},t.prototype.readIString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n,r=0,i=e;r=this.view.getUint32(e,this.littleEndian),e+=4;var a,s=e+r;return o.decodeUTF8toUTF16(function(){return s>e?this.view.getUint8(e++):null}.bind(this),a=o.stringDestination(),this.noAssert),n=a(),t?(this.offset=e,n):{string:n,length:e-i}},t.METRICS_CHARS="c",t.METRICS_BYTES="b",t.prototype.writeUTF8String=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,i=t;r=o.calculateUTF16asUTF8(o.stringSource(e))[1],t+=r;var a=this.buffer.byteLength;return t>a&&this.resize((a*=2)>t?a:t),t-=r,o.encodeUTF16toUTF8(o.stringSource(e),function(e){this.view.setUint8(t++,e)}.bind(this)),n?(this.offset=t,this):t-i},t.prototype.writeString=t.prototype.writeUTF8String,t.calculateUTF8Chars=function(e){return o.calculateUTF16asUTF8(o.stringSource(e))[0]},t.calculateUTF8Bytes=function(e){return o.calculateUTF16asUTF8(o.stringSource(e))[1]},t.prototype.readUTF8String=function(e,n,r){"number"==typeof n&&(r=n,n=void 0);var i="undefined"==typeof r;if(i&&(r=this.offset),"undefined"==typeof n&&(n=t.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!==0)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}var a,s=0,u=r;if(n===t.METRICS_CHARS){if(a=o.stringDestination(),o.decodeUTF8(function(){return e>s&&r<this.limit?this.view.getUint8(r++):null}.bind(this),function(e){++s,o.UTF8toUTF16(e,a)}.bind(this)),s!==e)throw new RangeError("Illegal range: Truncated data, "+s+" == "+e);return i?(this.offset=r,a()):{string:a(),length:r-u}}if(n===t.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!==0)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+e>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}var c=r+e;if(o.decodeUTF8toUTF16(function(){return c>r?this.view.getUint8(r++):null}.bind(this),a=o.stringDestination(),this.noAssert),r!==c)throw new RangeError("Illegal range: Truncated data, "+r+" == "+c);return i?(this.offset=r,a()):{string:a(),length:r-u}}throw new TypeError("Unsupported metrics: "+n)},t.prototype.readString=t.prototype.readUTF8String,t.prototype.writeVString=function(e,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!==0)throw new TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,a,s=n;i=o.calculateUTF16asUTF8(o.stringSource(e),this.noAssert)[1],a=t.calculateVarint32(i),n+=a+i;var u=this.buffer.byteLength;if(n>u&&this.resize((u*=2)>n?u:n),n-=a+i,n+=this.writeVarint32(i,n),o.encodeUTF16toUTF8(o.stringSource(e),function(e){this.view.setUint8(n++,e)}.bind(this)),n!==s+i+a)throw new RangeError("Illegal range: Truncated data, "+n+" == "+(n+i+a));return r?(this.offset=n,this):n-s},t.prototype.readVString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r=this.readVarint32(e),i=e;e+=r.length,r=r.value;var a=e+r,s=o.stringDestination();return o.decodeUTF8toUTF16(function(){return a>e?this.view.getUint8(e++):null}.bind(this),s,this.noAssert),n=s(),t?(this.offset=e,n):{string:n,length:e-i}},t.prototype.append=function(e,n,r){("number"==typeof n||"string"!=typeof n)&&(r=n,n=void 0);var i="undefined"==typeof r;if(i&&(r=this.offset),!this.noAssert){if("number"!=typeof r||r%1!==0)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}e instanceof t||(e=t.wrap(e,n));var o=e.limit-e.offset;if(0>=o)return this;r+=o;var a=this.buffer.byteLength;return r>a&&this.resize((a*=2)>r?a:r),r-=o,new Uint8Array(this.buffer,r).set(new Uint8Array(e.buffer).subarray(e.offset,e.limit)),e.offset+=o,i&&(this.offset+=o),this},t.prototype.appendTo=function(e,t){return e.append(this,t),this},t.prototype.assert=function(e){return this.noAssert=!e,this},t.prototype.capacity=function(){return this.buffer.byteLength},t.prototype.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},t.prototype.clone=function(e){var n=new t(0,this.littleEndian,this.noAssert);if(e){var r=new ArrayBuffer(this.buffer.byteLength);new Uint8Array(r).set(this.buffer),n.buffer=r,n.view=new DataView(r)}else n.buffer=this.buffer,n.view=this.view;return n.offset=this.offset,n.markedOffset=this.markedOffset,n.limit=this.limit,n},t.prototype.compact=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var r=t-e;if(0===r)return this.buffer=n,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this;var i=new ArrayBuffer(r);return new Uint8Array(i).set(new Uint8Array(this.buffer).subarray(e,t)),this.buffer=i,this.view=new DataView(i),this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=r,this},t.prototype.copy=function(e,n){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof n||n%1!==0)throw new TypeError("Illegal end: Not an integer");if(n>>>=0,0>e||e>n||n>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+n+" <= "+this.buffer.byteLength)}if(e===n)return new t(0,this.littleEndian,this.noAssert);var r=n-e,i=new t(r,this.littleEndian,this.noAssert);return i.offset=0,i.limit=r,i.markedOffset>=0&&(i.markedOffset-=e),this.copyTo(i,0,e,n),i},t.prototype.copyTo=function(e,n,r,i){var o,a;if(!this.noAssert&&!t.isByteBuffer(e))throw new TypeError("Illegal target: Not a ByteBuffer");if(n=(a="undefined"==typeof n)?e.offset:0|n,r=(o="undefined"==typeof r)?this.offset:0|r,i="undefined"==typeof i?this.limit:0|i,0>n||n>e.buffer.byteLength)throw new RangeError("Illegal target range: 0 <= "+n+" <= "+e.buffer.byteLength);if(0>r||i>this.buffer.byteLength)throw new RangeError("Illegal source range: 0 <= "+r+" <= "+this.buffer.byteLength);var s=i-r;return 0===s?e:(e.ensureCapacity(n+s),new Uint8Array(e.buffer).set(new Uint8Array(this.buffer).subarray(r,i),n),o&&(this.offset+=s),a&&(e.offset+=s),this)},t.prototype.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},t.prototype.fill=function(e,t,n){var r="undefined"==typeof t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),"undefined"==typeof t&&(t=this.offset),"undefined"==typeof n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!==0)throw new TypeError("Illegal end: Not an integer");if(n>>>=0,0>t||t>n||n>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;n>t;)this.view.setUint8(t++,e);return r&&(this.offset=t),this},t.prototype.flip=function(){return this.limit=this.offset,this.offset=0,this},t.prototype.mark=function(e){if(e="undefined"==typeof e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},t.prototype.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw new TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},t.prototype.LE=function(e){return this.littleEndian="undefined"!=typeof e?!!e:!0,this},t.prototype.BE=function(e){return this.littleEndian="undefined"!=typeof e?!e:!1,this},t.prototype.prepend=function(e,n,r){("number"==typeof n||"string"!=typeof n)&&(r=n,n=void 0);var i="undefined"==typeof r;if(i&&(r=this.offset),!this.noAssert){if("number"!=typeof r||r%1!==0)throw new TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw new RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}e instanceof t||(e=t.wrap(e,n));var o=e.limit-e.offset;if(0>=o)return this;var a,s=o-r;if(s>0){var u=new ArrayBuffer(this.buffer.byteLength+s);a=new Uint8Array(u),a.set(new Uint8Array(this.buffer).subarray(r,this.buffer.byteLength),o),this.buffer=u,this.view=new DataView(u),this.offset+=s,this.markedOffset>=0&&(this.markedOffset+=s),this.limit+=s,r+=s}else a=new Uint8Array(this.buffer);return a.set(new Uint8Array(e.buffer).subarray(e.offset,e.limit),r-o),e.offset=e.limit,i&&(this.offset-=o),this},t.prototype.prependTo=function(e,t){return e.prepend(this,t),this},t.prototype.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},t.prototype.remaining=function(){return this.limit-this.offset},t.prototype.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},t.prototype.resize=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal capacity: "+e+" (not an integer)");if(e|=0,0>e)throw new RangeError("Illegal capacity: 0 <= "+e)}if(this.buffer.byteLength<e){var t=new ArrayBuffer(e);new Uint8Array(t).set(new Uint8Array(this.buffer)),this.buffer=t,this.view=new DataView(t)}return this},t.prototype.reverse=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t?this:(Array.prototype.reverse.call(new Uint8Array(this.buffer).subarray(e,t)),this.view=new DataView(this.buffer),this)},t.prototype.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(0>t||t>this.buffer.byteLength))throw new RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);
return this.offset=t,this},t.prototype.slice=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},t.prototype.toBuffer=function(e){var t=this.offset,r=this.limit;if(t>r){var i=t;t=r,r=i}if(!this.noAssert){if("number"!=typeof t||t%1!==0)throw new TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof r||r%1!==0)throw new TypeError("Illegal limit: Not an integer");if(r>>>=0,0>t||t>r||r>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+t+" <= "+r+" <= "+this.buffer.byteLength)}if(!e&&0===t&&r===this.buffer.byteLength)return this.buffer;if(t===r)return n;var o=new ArrayBuffer(r-t);return new Uint8Array(o).set(new Uint8Array(this.buffer).subarray(t,r),0),o},t.prototype.toArrayBuffer=t.prototype.toBuffer,t.prototype.toString=function(e){if("undefined"==typeof e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch(e){case"utf8":return this.toUTF8();case"base64":return this.toBase64();case"hex":return this.toHex();case"binary":return this.toBinary();case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw new Error("Unsupported encoding: "+e)}};var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r+="",t.prototype.toBase64=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return"";for(var n,i,o,a,s,u,c,l,d,f="";t>e;)n=this.view.getUint8(e++),i=(a=t>e)?this.view.getUint8(e++):0,o=(s=t>e)?this.view.getUint8(e++):0,u=n>>2,c=(3&n)<<4|i>>4,l=(15&i)<<2|o>>6,d=63&o,s||(d=64,a||(l=64)),f+=r.charAt(u)+r.charAt(c)+r.charAt(l)+r.charAt(d);return f},t.fromBase64=function(e,n,i){if(!i){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if(e.length%4!==0)throw new TypeError("Illegal str: Length not a multiple of 4")}var o,a,s=e.length,u=0;for(o=e.length-1;o>=0&&"="===e.charAt(o);--o)u++;if(u>2)throw new TypeError("Illegal str: Suffix is too large");if(0===s)return new t(0,n,i);var c,l,d,f,p,h,g,m=new t(s/4*3-u,n,i);for(o=0,a=0;s>o;){if(c=r.indexOf(e.charAt(o++)),l=(p=s>o)?r.indexOf(e.charAt(o++)):0,d=(h=s>o)?r.indexOf(e.charAt(o++)):0,f=(g=s>o)?r.indexOf(e.charAt(o++)):0,!i&&(0>c||0>l||0>d||0>f))throw new TypeError("Illegal str: Contains non-base64 characters");m.view.setUint8(a++,c<<2|l>>4),64!==d&&(m.view.setUint8(a++,l<<4&240|d>>2,a),64!==f&&m.view.setUint8(a++,d<<6&192|f))}return m.limit=a,m},t.btoa=function(e){return t.fromBinary(e).toBase64()},t.atob=function(e){return t.fromBase64(e).toBinary()},t.prototype.toBinary=function(e,t){if(e="undefined"==typeof e?this.offset:e,t="undefined"==typeof t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return"";for(var n=[];t>e;)n.push(this.view.getUint8(e++));return String.fromCharCode.apply(String,n)},t.fromBinary=function(e,n,r){if(!r&&"string"!=typeof e)throw new TypeError("Illegal str: Not a string");for(var i,o=0,a=e.length,s=new t(a,n,r);a>o;){if(i=e.charCodeAt(o),!r&&i>255)throw new TypeError("Illegal charCode at "+o+": 0 <= "+i+" <= 255");s.view.setUint8(o++,i)}return s.limit=a,s},t.prototype.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",o="",a="";r>n;){if(-1!==n&&(t=this.view.getUint8(n),i+=16>t?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=t>32&&127>t?String.fromCharCode(t):".")),++n,e&&n>0&&n%16===0&&n!==r){for(;i.length<51;)i+=" ";a+=i+o+"\n",i=o=""}i+=n===this.offset&&n===this.limit?n===this.markedOffset?"!":"|":n===this.offset?n===this.markedOffset?"[":"<":n===this.limit?n===this.markedOffset?"]":">":n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";a+=i+o+"\n"}return e?a:i},t.fromDebug=function(e,n,r){for(var i,o,a=e.length,s=new t((a+1)/3|0,n,r),u=0,c=0,l=!1,d=!1,f=!1,p=!1,h=!1;a>u;){switch(i=e.charAt(u++)){case"!":if(!r){if(d||f||p){h=!0;break}d=f=p=!0}s.offset=s.markedOffset=s.limit=c,l=!1;break;case"|":if(!r){if(d||p){h=!0;break}d=p=!0}s.offset=s.limit=c,l=!1;break;case"[":if(!r){if(d||f){h=!0;break}d=f=!0}s.offset=s.markedOffset=c,l=!1;break;case"<":if(!r){if(d){h=!0;break}d=!0}s.offset=c,l=!1;break;case"]":if(!r){if(p||f){h=!0;break}p=f=!0}s.limit=s.markedOffset=c,l=!1;break;case">":if(!r){if(p){h=!0;break}p=!0}s.limit=c,l=!1;break;case"'":if(!r){if(f){h=!0;break}f=!0}s.markedOffset=c,l=!1;break;case" ":l=!1;break;default:if(!r&&l){h=!0;break}if(o=parseInt(i+e.charAt(u++),16),!r&&(isNaN(o)||0>o||o>255))throw new TypeError("Illegal str: Not a debug encoded string");s.view.setUint8(c++,o),l=!0}if(h)throw new TypeError("Illegal str: Invalid symbol at "+u)}if(!r){if(!d||!p)throw new TypeError("Illegal str: Missing offset or limit");if(c<s.buffer.byteLength)throw new TypeError("Illegal str: Not a debug encoded string (is it hex?) "+c+" < "+a)}return s},t.prototype.toHex=function(e,t){if(e="undefined"==typeof e?this.offset:e,t="undefined"==typeof t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);t>e;)n=this.view.getUint8(e++),16>n?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},t.fromHex=function(e,n,r){if(!r){if("string"!=typeof e)throw new TypeError("Illegal str: Not a string");if(e.length%2!==0)throw new TypeError("Illegal str: Length not a multiple of 2")}for(var i,o=e.length,a=new t(o/2|0,n),s=0,u=0;o>s;s+=2){if(i=parseInt(e.substring(s,s+2),16),!r&&(!isFinite(i)||0>i||i>255))throw new TypeError("Illegal str: Contains non-hex characters");a.view.setUint8(u++,i)}return a.limit=u,a};var o=function(){var e={};return e.encodeUTF8=function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)128>n?t(127&n):2048>n?(t(n>>6&31|192),t(63&n|128)):65536>n?(t(n>>12&15|224),t(n>>6&63|128),t(63&n|128)):(t(n>>18&7|240),t(n>>12&63|128),t(n>>6&63|128),t(63&n|128)),n=null},e.decodeUTF8=function(e,t){for(var n,r,i,o,a=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0===(128&n))t(n);else if(192===(224&n))null===(r=e())&&a([n,r]),t((31&n)<<6|63&r);else if(224===(240&n))(null===(r=e())||null===(i=e()))&&a([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!==(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(o=e()))&&a([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},e.UTF16toUTF8=function(e,t){for(var n,r=null;;){if(null===(n=null!==r?r:e()))break;n>=55296&&57343>=n&&null!==(r=e())&&r>=56320&&57343>=r?(t(1024*(n-55296)+r-56320+65536),r=null):t(n)}null!==r&&t(r)},e.UTF8toUTF16=function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)65535>=n?t(n):(n-=65536,t((n>>10)+55296),t(n%1024+56320)),n=null},e.encodeUTF16toUTF8=function(t,n){e.UTF16toUTF8(t,function(t){e.encodeUTF8(t,n)})},e.decodeUTF8toUTF16=function(t,n){e.decodeUTF8(t,function(t){e.UTF8toUTF16(t,n)})},e.assertByte=function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal byte: "+typeof e);if(-128>e||e>255)throw RangeError("Illegal byte: "+e);return e},e.assertCharCode=function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal char code: "+typeof e);if(0>e||e>65535)throw RangeError("Illegal char code: "+e);return e},e.assertCodePoint=function(e){if("number"!=typeof e||e!==e)throw TypeError("Illegal code point: "+typeof e);if(0>e||e>1114111)throw RangeError("Illegal code point: "+e);return e},e.calculateCodePoint=function(e){return 128>e?1:2048>e?2:65536>e?3:4},e.calculateUTF8=function(t){for(var n,r=0;null!==(n=t());)r+=e.calculateCodePoint(n);return r},e.calculateUTF16asUTF8=function(t){var n=0,r=0;return e.UTF16toUTF8(t,function(t){++n,r+=e.calculateCodePoint(t)}),[n,r]},e}(),a=String.fromCharCode;return o.stringSource=function(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}},o.stringDestination=function(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+a.apply(String,e):(e.length+arguments.length>1024&&(t.push(a.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}},t.prototype.toUTF8=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw new TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw new TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw new RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n,r=this;try{o.decodeUTF8toUTF16(function(){return t>e?r.view.getUint8(e++):null},n=o.stringDestination())}catch(i){if(e!==t)throw new RangeError("Illegal range: Truncated data, "+e+" != "+t)}return n()},t.fromUTF8=function(e,n,r){if(!r&&"string"!=typeof e)throw new TypeError("Illegal str: Not a string");var i=new t(o.calculateUTF16asUTF8(o.stringSource(e),!0)[1],n,r),a=0;return o.encodeUTF16toUTF8(o.stringSource(e),function(e){i.view.setUint8(a++,e)}),i.limit=a,i},t}e.exports=r(n(357))}(this)}).call(t,n(76)(e))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(101),o=r(i),a=n(375);["webkitGetUserMedia"].forEach(function(e){var t=(0,o["default"])(navigator)[e];t&&navigator[e]!==t&&(navigator[e]=t)}),window.URL=window.URL||window.webkitURL,window.AudioContext=window.AudioContext||window.webkitAudioContext,navigator.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia,window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem;var s={MAX_GROUP_SIZE:101,MAX_SUBJECT_LENGTH:25,IMG_MAX_EDGE:1600,IMG_THUMB_MAX_EDGE:100,MAX_MEDIA_UPLOAD_SIZE:16777216,BROWSER_CAPABILITY:{localstorage:!!window.localStorage,sessionstorage:!!window.sessionStorage,indexeddb:!!window.indexedDB,url:!!window.URL,websocket:!!window.WebSocket,worker:!!window.Worker},BROWSER_TYPE:{CHROME:"chrome",CHROMIUM:"chromium",FIREFOX:"firefox",SAFARI:"safari",IE:"ie",OPERA:"opera",EDGE:"edge"},BROWSER_LINK:{CHROME:'<a href="https://www.google.com/chrome">Google Chrome</a>',FIREFOX:'<a href="http://www.firefox.com">Mozilla Firefox</a>',OPERA:'<a href="http://www.opera.com">Opera</a>'},OS_TYPE:{WINDOWS:"windows",MAC:"mac os",CHROMEOS:"chromium os"},LATEST_HASH:"a48192f4558c65a62ebb2ba8008758dec3d691bb",VERSION:{p:0,s:1,t:5349},VERSION_STR:"0.1.5349",CLB_URL:"https://web-crashlog.whatsapp.net/upload.php",PREVIEW_WINDOW:"preview-window",UPLOAD_SELECT:"upload-select",CURRENT_LOCATION_ICON:"https://maps.gstatic.com/mapfiles/ms2/micons/blue-dot.png",CURRENT_LOCATION_SHADOW:"https://maps.gstatic.com/mapfiles/ms2/micons/msmarker.shadow.png",GROUP_DEFAULT_ICON:n(471),USER_DEFAULT_ICON:n(472),NOTIFICATION_TIMEOUT:5e3,CALL_NOTIFICATION_TIMEOUT:45e3,NOTIFICATION_TONE_PATH:"/res/notification.mp3",IDLE_TIMEOUT:6e4,IDLE_TIMEOUT_WAIT:78e4,PING_INTERVAL:24e4,ACK_TIMEOUT:8e3,RETRY_TIMESTEP:20500,SEND_UNAVAILABLE_WAIT:15e3,SEND_PAUSED_WAIT:2500,CLEAR_CHAT_DIRTY_WAIT:2500,MAX_RETRY_GENERATION:4,GIVE_UP_WAIT:12e4,LOG_UPLOAD_INTERVAL:36e5,EMOJI_SYNC_DELAY:3e4,MAX_TXT_MSG_SIZE:65536,DRAG_TYPE_FILE:"Files",DRAG_TYPE_LOCAL_IMAGE:"drag_type_local_image",NUM_COLORS:20,KEY_STORAGE_TEST:"storage_test",KEY_CLIENT_TOKEN:"WAToken1",KEY_SERVER_TOKEN:"WAToken2",KEY_SECRET:"WASecretKey",KEY_SECRET_BUNDLE:"WASecretBundle",KEY_BROWSER_ID:"WABrowserId",KEY_GEOCODER_LOCATION:"WAGeocoderLocation",KEY_GROUP_ASSIGNED_COLOR:"WAGroupAssignedColor",KEY_GMAPS_OVER_LIMIT:"WAGmapsOverLimit",KEY_GLOBAL_MUTE_SOUNDS:"WAGlobalSounds",KEY_GLOBAL_MUTE_NOTIFICATIONS:"WAGlobalNotifications",KEY_GLOBAL_MUTE_PREVIEWS:"WAGlobalPreviews",KEY_LANG:"WALangPref",KEY_LAST_ACTIVE_EMOJI_TAB:"WALastActiveEmojiTab",KEY_UNKNOWN_ID:"WAUnknownID",KEY_VERSION:"WAVersion",KEY_LOAD_RETRY_GENERATION:"WALoadRetryGeneration",KEY_REMEMBER_ME:"remember-me",KEY_LOGOUT_TOKEN:"logout-token",KEY_OLD_LOGOUT_CREDS:"old-logout-cred",KEY_NO_TAKEOVER:"no-takeover",KEY_WHATSAPP_MUTEX:"whatsapp-mutex",KEY_WHATSAPP_LS_VERSION:"ver",KEY_LOCAL_TAKEOVER_OK:"local-takeover-ok",KEY_WAM_BUFFER:"wam-buffer",KEY_WAM_INFO:"wam-info",COOKIE_REF:"ref",COOKIE_TOK:"tok",PAGE_SIZE:50,MSG_PRELOAD_THRESHOLD:20,SCROLL_FUDGE:100,MIN_PIC_SIDE:192,MAX_PIC_SIDE:640,PROF_PIC_THUMB_SIDE:96,MAX_CAPTION_LENGTH:160,MAX_VCARD_PHOTO_SIDE:64,EMOJI_PANEL_HEIGHT:222,GROUP_SET_PIC_CONTEXT:"group",GROUP_CREATE_PIC_CONTEXT:"create_group",PROFILE_PIC_CONTEXT:"profile",PERMISSION_ALLOWED:"granted",PERMISSION_DEFAULT:"default",PERMISSION_DENIED:"denied",PRESENCE_COMPOSING_TIMEOUT:25e3,PRESENCE_RESEND_WAIT:1e4,PTT_CANCEL_AREA:300,PTT_TIME_CHECK:1,PTT_TIME_CANCEL:.75,CANCEL_ANIMATION_DURATION:2700,IMAGE_MIMES:"image/*",VIDEO_MIMES:"video/*",SEARCH_ANIMATION_DURATION:150,SLIDEDOWN_DURATION:100,CSS_TRANSITION_DURATION:1,EARTH_RADIUS:6378137,LOG_SIZE:4999,KEY_LOG_CURSOR:"debugCursor",MAX_STATUS_LENGTH:139,QR_EDGE:240,FILE_ERROR_MISSING:"File missing.",FILE_ERROR_SIZE:"File size is too large.",FILE_ERROR_TYPE:"File type is invalid.",FILE_ERROR_MIN_DIM:"File dimensions are too small.",GMAPS_OVER_LIMIT_DURATION:14400,ACK_ERROR:-1,ACK_PENDING:0,ACK_SERVER:1,ACK_DEVICE:2,ACK_READ:3,ACK_PLAYED:4,BATTERY_LOW_THRESHOLD_1:15,BATTERY_LOW_THRESHOLD_2:5,WAM_MAX_BUFFER_SIZE:5e4,NUX:{SAFARI_LIMITED_SUPPORT:"safari_limited_support"},COLLECTION_HAS_SYNCED:"collection_has_synced",ONE_BY_ONE_TRANS_GIF:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"};for(var u in a)a.hasOwnProperty(u)&&(s[u]=a[u]);e.exports=s},function(e,t,n){"use strict";var r=n(1),i=n(46),o=n(82),a={isMainLoaded:!1,mainLoaded:function(){this.isMainLoaded=!0,this.trigger("main_loaded")},incrementProgress:function(){r.log("Cmd: incrementProgress")(),this.trigger("increment_progress")},logSocketSummary:function(){this.trigger("log_socket_summary")},muteChat:function(e,t,n){this.trigger("mute_chat",e,t,n)},deleteOrExitChat:function(e,t){this.trigger("delete_or_exit_chat",e,t)},archiveChat:function(e,t){this.trigger("archive_chat",e,t)},markChatUnread:function(e,t){this.trigger("mark_chat_unread",e,t)},openChat:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2];this.closeDrawer(),this.trigger("open_chat",e,t,n)},clearChat:function(e){this.trigger("clear_chat",e)},focusChatTextInput:function(e){this.trigger("focus_chat_text_input_"+e.id)},enterChatTextInput:function(e){this.trigger("enter_chat_text_input_"+e.id)},focusChatList:function(){this.trigger("focus_chat_list")},focusChatSearch:function(){this.trigger("focus_chat_search")},pasteChatTextInput:function(e,t){this.trigger("paste_chat_text_input_"+e.id,t)},composeHeightChange:function(e,t){this.trigger("compose_height_change",e,t)},isMsgVisible:function(e,t){this.trigger("is_msg_visible",e,t)},jsHaltDetected:function(e){this.trigger("js_halt_detected",e)},login:function(e){this.trigger("login",e)},openContextMenu:function(e,t){this.trigger("open_context_menu",e,t)},openTooltip:function(e,t){this.trigger("open_tooltip",e,t)},openToast:function(e){this.trigger("open_toast",e)},closeToast:function(e){this.trigger("close_toast",e)},alertNewMsg:function(e){this.trigger("alert_new_msg",e)},alertCall:function(e,t){this.trigger("alert_call",e,t)},cancelCall:function(e){this.trigger("cancel_call",e)},windowError:function(e){},error2412:function(e){},loadEarlierMsgs:function(e){this.trigger("load_earlier_msgs:"+e.get("id"))},openModal:function(e,t,n){this.trigger("open_modal",e,t,n)},closeModal:function(){this.trigger("close_modal")},openDrawer:function(e,t,n){this.trigger("open_drawer",e,t,n)},closeDrawer:function(e){this.trigger("close_drawer",e)},mediaPlaying:function(e){this.trigger("mediaPlaying",e)},uiResize:function(){this.trigger("resize")},localeChange:function(){this.trigger("locale_change")},clearUiBusy:_.debounce(function(){this.uiBusy&&(r.log("cmd:clearUIBusy uibusy timeout")(),this.uiBusy=0,this.trigger("ui_idle"))},5e3),setUiBusy:function(e){var t=this.uiBusy||0;e?(++t,this.clearUiBusy()):t&&--t,this.uiBusy=t,0===t&&(this.clearUiBusy.cancel(),this.trigger("ui_idle"))},windowMouseDown:function(e){this.trigger("window_mousedown",e)},windowClick:function(e){this.trigger("window_click",e)},midnight:function(){this.trigger("midnight")}};_.extend(a,i,o),e.exports=a},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n,r){function i(e){_.isFunction(t)?this.message=t.apply(this,arguments):arguments.length>0?this.message=""+e:t?this.message=t:this.message=this.name;var n=this.message!==this.name?this.name+": "+this.message:this.name,i=new Error(n).stack;if(!i)try{throw new Error(n)}catch(o){i=o.stack,i||(i="Error: "+n+"\n    at (unspecified)")}this.stack=i,_.isFunction(r)&&r.apply(this,_.rest(arguments))}return n=n||Error,i.prototype=(0,l["default"])(n.prototype),i.prototype.name=e,i}function o(e,t){return _.reduce(e,function(e,n,r){var o,a;return _.isString(r)?(o=r,a=n):o=n,e[o]=i(o,a,t),e},{})}function a(e){this.event=e;try{return(0,u["default"])(e)}catch(t){return""+e}}var s=n(22),u=r(s),c=n(113),l=r(c),d=i("WAPStatusCode"),f=i("401",null,d),p=i("404",null,d),h=i("500",null,d),g=i("WapDrop"),m=i("EphemeralDrop",null,g),v=i("EphemeralDrop",null,g),b=i("Server5xxDrop",null,g),y=i("ConventionViolationDrop",null,g),w=i("BrowserReplacedDrop",null,g),E=i("ShouldLoop"),S=i("GaveUpRetry"),C=i("GUMError"),k=o({NotSupportedError:"The operation is not supported.",PermissionDeniedError:"The user did not grant permission for the operation",ConstraintNotSatisfiedError:"One of the mandatory Constraints could not be satisfied.",OverconstrainedError:"Due to changes in the environment, one or more mandatory constraints can no longer be satisfied.",NotFoundError:"The object can not be found here.",AbortError:"The operation was aborted.",SourceUnavailableError:"The source of the MediaStream could not be accessed due to a hardware error (e.g. lock from another process)."},C),T=i("MediaFileError"),$=i("InvalidMediaFileType",null,T),O=i("MediaFileTooLarge",null,T),A=i("MediaEncryptionError",null,T),R=i("ImageError","Image failed to load.",null,function(e){this.src=e,this.target={src:e}}),I=i("ContactBlocked","Contact is blocked",null,function(e){this.contact=e}),N=i("MediaMissing","Media is no longer available on your phone"),j=i("SocketError",a),P=i("SocketClosed",a),L=i("SocketNotOpen",function(e){return"socket not open, is "+e}),D=i("BlockedByProxy");e.exports={define:i,defineAll:o,QueryDrop:i("QueryDrop"),WapDrop:g,EphemeralDrop:m,LogoutDrop:v,Server5xxDrop:b,ConventionViolationDrop:y,BrowserReplacedDrop:w,ShouldLoop:E,GaveUpRetry:S,MediaFileError:T,InvalidMediaFileType:$,MediaFileTooLarge:O,MediaEncryptionError:A,WAPStatusCode:d,E401:f,E404:p,E500:h,SocketError:j,SocketClosed:P,SocketNotOpen:L,BlockedByProxy:D,ImageError:R,ContactBlocked:I,MediaMissing:N,ActionError:i("ActionError","Could not perform action."),GUM:_.defaults(k,{GUMError:C,PERMISSION_DENIED:k.PermissionDeniedError,NOT_SUPPORTED_ERROR:k.ConstraintNotSatisfiedError,MANDATORY_UNSATISFIED_ERROR:k.NotFoundError})}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=n(17),t=e.info();if(t){var r="WhatsApp/"+l.VERSION_STR,i="Web/"+t.ua,o="Device/"+t.os;return r+" "+i+" "+o}}function o(e,t){function n(){h=setTimeout(function(){var e=g;h=0,g=void 0,"undefined"!=typeof e&&o(e?"delayed-"+e:"delayed")},l.LOG_UPLOAD_INTERVAL)}d.logSocketSummary(),u.log("==================================================")(),u.log("wa:uploadLogs ref: "+(Store.Conn.ref||"no conn"))(),u.log("wa:uploadLogs hash: "+l.LATEST_HASH)(),u.log("wa:uploadLogs version: "+l.VERSION_STR)(),u.log("wa:uploadLogs userAgent: "+navigator.userAgent)(),u.log("wa:uploadLogs platform: "+(Store.Conn.platform||"no platform"))(),u.log("wa:uploadLogs url: "+location.href)();var r;"undefined"==typeof e?(r=prompt("Please describe the situation that inspired you to upload logs: what happened, what you were doing before that happened (both in the app and just with your phone and computer in general, like if you had just opened it or moved it around)."),u.log("user report: "+r)()):e&&u.log("reason for logs: "+e)(),u.log("==================================================")();var a=Store.Conn.me,m=a?p.user(a):f.getUnknownId(),v=i();if(!r){if(!(Math.random()<l.UPLOAD_TO_CLB))return u.log("wa:uploadLogs squelched logs")(),s["default"].resolve("deferred");if(h)return u.log("wa:uploadLogs delayed logs")(),"undefined"==typeof g&&(g=e),s["default"].resolve("deferred")}var b=(t?s["default"].resolve(u.getLogs()):s["default"].delay(500).then(u.getLogs.bind(u))).bind(this).then(function(e){e=e.join("\n");var t=new FormData,n=new Blob([e],{type:"text/plain"});return t.append("from",m),t.append("agent",v),t.append("file",n,"logs.txt"),c.post(l.CLB_URL,t)["catch"](_.noop)});return n(),b}var a=n(3),s=r(a),u=n(1),c=n(107),l=n(8),d=n(9),f=n(15),p=n(21),h=0,g=void 0;e.exports={upload:o}},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return e instanceof k}function o(e){var t=m.getOldLogoutCreds();m.setOldLogoutCreds(_.filter(t,_.negate(_.matches(e))))}var a=n(24),s=r(a),u=n(3),c=r(u),l=n(22),d=r(l),f=n(1),p=n(12),h=n(62),g=n(8),m=n(15),v=n(9),b=n(182),y=n(173),w=n(172),E=n(36),S=n(11),C=n(169),k=n(7),T=n(38),$=n(53),O=n(382),A=n(108),R=n(17),I=n(81),N=n(153),j={OPENING:"OPENING",PAIRING:"PAIRING",UNPAIRED:"UNPAIRED",UNPAIRED_IDLE:"UNPAIRED_IDLE",CONNECTED:"CONNECTED",TIMEOUT:"TIMEOUT",CONFLICT:"CONFLICT",UNLAUNCHED:"UNLAUNCHED",PROXYBLOCK:"PROXYBLOCK",TOS_BLOCK:"TOS_BLOCK"},P={DISCONNECTED:"DISCONNECTED",SYNCING:"SYNCING",RESUMING:"RESUMING",CONNECTED:"CONNECTED"},L={NEW:"new",SENT:"sent",WEBDACKED:"webdacked",WILL_RETRY:"will_retry"},D=S.defineAll(["SendCalledWhileDisconnected","ExternalPoke","MustExitLoop","Denied401Failed","Denied409Conflict","DeniedTOS","DeniedUnknown","ForcedRefresh","TooManyRefRequest","UILogout","WindowOffline","PhoneFailedPing","AssertionFailed","TakeoverRequested","PhoneReplacedClient","NoSecretBundle","PhoneKickedClient"]),M={SYNC_INFO:["Conn",C.OBJECT],CHALLENGE:["Cmd",{type:"challenge",challenge:C.STRING}],DISCONNECT:["Cmd",{type:"disconnect",kind:_}],HARD_REFRESH:["Cmd",{type:"update"}],PONG:["Pong",C.BOOLEAN]},x={TAG:function(e){return new C({tag:e,data:C.ANY})},SYNC_INFO:new C({tag:C.ANY,data:M.SYNC_INFO}),CHALLENGE:new C({tag:C.ANY,data:M.CHALLENGE}),DISCONNECT:new C({tag:C.ANY,data:M.DISCONNECT}),HARD_REFRESH:new C({tag:C.ANY,data:M.HARD_REFRESH}),PONG:new C({tag:C.ANY,data:M.PONG})},U=new C({status:function(e){return"number"==typeof e&&e>=500},_:_}),B=5,F=6e4,Y=5,W=500,G=3e3,q=3e3,H=864e5,K=120,V=40,Q=h.extend({extraProperties:"reject",props:{data:"any",tag:"string",state:{type:"string",values:_.values(L),"default":L.NEW},ephemeral:"boolean",ignore:"boolean",clientCacheable:"boolean",onSend:"function",onDrop:"function",age:{type:"number","default":0},resends:{type:"number","default":0},resendTimer:{type:"number","default":0},binaryOpts:"object"},derived:{likelyDead:{deps:["age"],fn:function(){return this.age>=V}},isToPhone:{deps:["data"],fn:function(){return this.data instanceof ArrayBuffer}}},getTag:function(){return this.tag||(this.onSend?this.onSend.tag:void 0)},toString:function(){return this.binaryOpts?this.binaryOpts.debugString:!_.isArray(this.data)||"query"!==this.data[0]&&"action"!==this.data[0]?_.isArray(this.data)?"["+this.data[0]+(this.data.length>1?", ...]":"]"):_.isObject(this.data)?"{...}":this.data+"":"["+this.data[0]+", "+this.data[1]+(this.data.length>2?", ...]":"]")},serialize:function(){var e=this.tag;if(this.binaryOpts){var t=this.binaryOpts,n=k.calculateUTF8Bytes(e)+3,r=new k(n,!1),i=t.metric?t.metric:0,o=(this.ignore?0:1)<<7|(!this.ignore&&t.ackRequest?1:0)<<6|(t.available===!0?1:0)<<5|(t.available===!1?1:0)<<4|(t.expires?1:0)<<3|(t.skipOffline?1:0)<<2;return r.writeString(e),r.writeString(","),r.writeByte(i),r.writeByte(o),r.reset(),k.concat([r,this.data]).toBuffer()}var a=_.isString(this.data)?this.data:(0,d["default"])(this.data);return e+",,"+a}}),z=h.extend({extraProperties:"reject",session:{socketPreload:"object",socket:"object",socketSequence:{type:"number","default":0},launchGeneration:{type:"number","default":0},backoffGeneration:{type:"number","default":0},online:{type:"boolean","default":!0},hasSynced:"boolean",state:{type:"string",values:_.keys(j),"default":j.UNLAUNCHED},stream:{type:"string",values:_.keys(P),"default":P.DISCONNECTED},canSend:"boolean",sendQueue:"array",sendHash:"object",sequence:{type:"number","default":0},shortTagBase:"string",socketWatcher:"object",refWatcher:"object",phoneWatchdog:"object",pendingPhoneReqs:{type:"number","default":0},isIncognito:"boolean",runPromise:"object",streamPromise:"object",logoutMutex:{type:"number","default":0},retryTimestamp:"number",pokeable:"object",conflictPromise:"object",launched:"boolean",mustExitLoop:"boolean",syncTag:"string",lastPhoneMessage:"number"},initialize:function(){this.sendQueue=[],this.sendHash={},this.phoneWatchdog=new w({waitAlgorithm:w.FIBONACCI(G,q,H),onTimeout:this.phoneTimedOut.bind(this),onActivated:this.onPhoneWatchdogActivated.bind(this),onFed:this.onPhoneWatchdogFed.bind(this),onDeactivated:this.onPhoneWatchdogDeactivated.bind(this)}),this.listenTo(this,"change:state",this.onStateChange.bind(this)),this.listenTo(this,"change:stream",this.onStreamChange.bind(this)),c["default"].delay(0).then(E.determineIncognito).bind(this).then(function(e){this.isIncognito=e}),this.listenTo(v,"log_socket_summary",this.summary)},STATE:j,STREAM:P,preload:function(e){this.socketPreload=e||new O},send:function(e){var t=new Q(e);this.sendQueue.push(t),this.flushQueue()},shortTag:function(){this.shortTagBase||(this.shortTagBase=(moment().unix()%1e3).toString());var e=g.FLAVOR_TAGS?"w":".--";return this.shortTagBase+e+this.sequence++},tag:function(e){var t=g.FLAVOR_TAGS?"w":".--",n=moment().unix()+t+this.sequence++;return e&&g.FLAVOR_TAGS?n+"-"+e:n},launch:function(e,t){function n(){f.log("ws2:socket loop closed")(),this.socketPreload&&this.socketPreload.deactivate(),this.clearState(),this.set({state:j.UNLAUNCHED,mustExitLoop:!1,launched:!1,socketPreload:null})}f.log("ws2:Launch gen"+this.launchGeneration+" (backoff gen"+this.backoffGeneration+")")(),t=t||0;var r=Date.now()+300*I.expBackoff(this.backoffGeneration,100),i=r+F;if(this.launched){var o=new Error;return f.error("ws2:launch redundantly called!")(),f.errorVerbose(o.stack)(),void p.upload("redundant-launch")}this.mustExitLoop?n.call(this):(this.launched=!0,this.run(t,e).then(function(e){return[e,!1]}).bind(this)["catch"](D.MustExitLoop,function(){return this.mustExitLoop=!0,[!1,!1]})["catch"](D.TakeoverRequested,function(){return[!1,!0]})["catch"](function(e){return f.error("ws2:run error unknown!")(e),f.errorVerbose(e.stack)(),p.upload("unknown-error-in-ws-loop"),this.clearState(),[!0,!1]}).spread(function(e,t){if(this.mustExitLoop)n.call(this);else{var o=Date.now();this.launchGeneration++,this.backoffGeneration=e&&i>o?this.backoffGeneration+1:0,this.launched=!1,this.launch(t,r>o?r-o:0)}}))},poke:function(){this.pokeable?this.pokeable.poke():this.phoneWatchdog.forceTimeout()},takeover:function(){if(!this.conflictPromise)throw"Takeover called without conflict!";this.conflictPromise.cancel(new D.TakeoverRequested)},exitLoop:function(){this.mustExitLoop=!0,this.runPromise&&this.runPromise.cancel(new D.MustExitLoop)},logout:function(e){var t=this.runPromise;f.info("ws2:user logged out")(),this.stream===P.DISCONNECTED||e?this.sendCurrentLogout():this.sendCurrentLogout(this.socket),this.clearCredentials(),t&&t.cancel(new D.UILogout),this.state===j.OPENING&&this.trigger("change:state")},summary:function(){f.log("ws:summary --------------------------------")(),f.log("ws state           "+this.state)(),f.log("wd online:         "+navigator.onLine)(),f.log("ws socket id:      "+(this.socket?this.socket.id:"n/a"))(),f.log("ws queue:")(),_.isEmpty(this.sendQueue)||b.printArray(_.map(this.sendQueue,function(e){var t=_.pick(e,"tag","state","age","ephemeral","isToPhone");return e&&e.toString&&(t.debug=e.toString()),t})).split(/\n/).forEach(function(e){f.log(e)()}),f.log("ws hash:")(),_.isEmpty(this.sendHash)||b.printArray(_.map(this.sendHash,function(e){var t=_.pick(e,"tag","state","age","ephemeral","isToPhone");return e&&e.toString&&(t.debug=e.toString()),t})).split(/\n/).forEach(function(e){f.log(e)()})},onStateChange:function(){f.log("ws2:state change: "+this.state)()},onStreamChange:function(){f.log("ws2:stream change: "+this.stream)(),this.stream===P.DISCONNECTED&&this.onRefCycle()},onRefCycle:function(){f.log("ws2:onRefCycle")(),this.sendQueue.forEach(function(e){e.state=L.NEW,e.age=0}),this.clearSendHash()},onActivity:function(e){if(e){var t=e.data;if(x.HARD_REFRESH.test(e))f.error("ws2:hard refresh!")(),A.update(0);else if(t){var n=_.isArray(t)?" ["+t[0]+", ...]":"";f.logColor("green","    recv: "+e.tag+n,t)()}else f.logColor("#669999","     ack: "+e.tag)()}else N.setSkew(this.socket.timeSkew||0);this.sendRemainingLogouts()},onPhoneWatchdogActivated:function(){},onPhoneWatchdogFed:function(){this.state=j.CONNECTED},onPhoneWatchdogDeactivated:function(){},flushQueue:function(){if(this.canSend&&this.sendQueue.length){var e=_.where(this.sendQueue,{state:L.NEW}),t=N.localUnixTime(),n=_.partition(e,function(e){return e.binaryOpts&&e.binaryOpts.expires?t-e.binaryOpts.expires>K:!1}),r=n[0],i=n[1];this.sendQueue=_.difference(this.sendQueue,r),r.forEach(function(e){delete this.sendHash[e.tag],e.onSend({status:408})},this),i.length&&i.forEach(this._send,this)}},phoneTimedOut:function(){if(1===this.phoneWatchdog.failGeneration){f.warn("ws2:Phone timed out")();var e=_.pluck(this.sendHash,"tag");f.warn("ws2:Outstanding Reqs: "+e.join(","))()}var t=this.phoneWatchdog.waitAlgorithm(this.phoneWatchdog);return this.set({state:j.TIMEOUT,retryTimestamp:Date.now()+t}),this._basicSend({tag:this.tag("ping"),data:["admin","test"]},"ping"),!0},clearSendHash:function(e){if(e)_.each(this.sendHash,function(e){e.resendTimer&&clearTimeout(e.resendTimer),e.onDrop(new S.LogoutDrop(e.toString()))});else{var t=_.filter(this.sendHash,"ephemeral");f.warn("Ephemeral Drop: "+_.pluck(t,"tag").join(","))(),t.forEach(function(e){e.resendTimer&&clearTimeout(e.resendTimer),e.onDrop(new S.EphemeralDrop(e.toString()))})}this.sendHash={},this.pendingPhoneReqs=0,this.phoneWatchdog.deactivate()},_basicSend:function(e,t){f.logColor("blue","low-send: "+t+" "+e.tag,e.data)(),this.socket.cast(e.tag+","+(0,d["default"])(e.data))},_send:function(e){e.tag=e.getTag()||this.shortTag(),this.sendHash[e.tag]=e;var t=e.binaryOpts?e.binaryOpts.debugObj:e.data;f.logColor("blue","    send: "+e.tag+", "+e.toString(),t)(),this.socket.send(e.serialize()),e.isToPhone&&(this.pendingPhoneReqs++,
this.phoneWatchdog.activate()),e.state=L.SENT},sendBasic:function(e){return this.socket?(e.tag=this.tag(),this._basicSend(e,"external"),this.socket.nextMessage(x.TAG(e.tag))):c["default"].reject("socket not open")},sendEphemeral:function(e){e.ephemeral=!0;var t=new Q(e);this.canSend?this._send(t):t.onDrop(new S.EphemeralDrop(t.toString()))},sendEphemeralIgnore:function(e){e.ephemeral=!0,e.ignore=!0,e.tag=this.tag();var t=new Q(e);if(this.canSend){var n=t.serialize();this.socket.send(n),f.logColor("blue","sending: "+t.tag+", "+t.toString(),t.data)()}else t.onDrop(new S.EphemeralDrop(t.toString()))},onMessage:function(e){var t=e.tag,n=e.data;if(i(n)&&(this.lastPhoneMessage=moment().unix()),x.PONG.test(e))if(n[1]){var r=0,o=!1;_.each(this.sendHash,function(e){if(e.isToPhone){var t=e.likelyDead;e.age++,e.likelyDead&&!t?(o=!0,f.error(e.tag+" likely dead: "+e.toString(),e)(),v.error2412("("+e.tag+") "+e.toString()),Store.Wap.error2412()):e.likelyDead||r++}}),this.pendingPhoneReqs=r,this.phoneWatchdog.feed(),0===r&&this.phoneWatchdog.deactivate(),o&&p.upload("error-2412")}else this.state!==j.TIMEOUT?f.error("ws2:Pang while not timed-out")():this.runPromise.cancel(new D.PhoneFailedPing);else{var a=this.sendHash[t];if(a){if(!n)return void(a.state=L.WEBDACKED);var s;try{s=a.onSend(n)}catch(u){if(u instanceof S.E401)return void this.logout();f.error("ws2:onMessage error")(u),a.onDrop(u)}U.test(s)?(f.error("ws2:onMessage 5xx error "+a.tag,s)(),a.resends>=B?(f.error("ws2:onMessage dropping "+a.tag)(),a.onDrop(new S.Server5xxDrop),delete this.sendHash[t],this.sendQueue=_.without(this.sendQueue,a)):this.resendRequestEventually(a)):(delete this.sendHash[t],this.sendQueue=_.without(this.sendQueue,a),a.isToPhone&&(a.likelyDead||this.pendingPhoneReqs--,this.phoneWatchdog.feed(),0===this.pendingPhoneReqs&&this.phoneWatchdog.deactivate()))}else if(n){var c;if(k.isByteBuffer(n))c=Store.Wap;else{var l=_.isFunction(n.shift)?n.shift():n;c=Store[l]}c?c.handle(n,this,t):f.error("ws2: Invalid type received",n)(),i(n)&&this.phoneWatchdog.feed()}}},run:function(e,t){return this.runPromise=T.resolve(e).bind(this).cancellable().then(function(e){if(this.state=j.OPENING,v.incrementProgress(),e>0){f.log("ws2:Run Backoff "+e+"ms")();var t=T.delay(e).cancellable()["catch"](D.ExternalPoke,_.noop);return this.setPokeable(t,Date.now()+e),t}})["finally"](function(){this.unset("pokeable"),this.unset("retryTimestamp")}).then(function(){return v.incrementProgress(),f.log("ws2:Running")(),this.openSocket()}).then(function(e){return v.incrementProgress(),this.online=!0,e.onactivity=this.onActivity.bind(this),this.socket=e,this.socketWatcher=E.attachWatcher(this.runPromise,this.throwOnClose()),this.state=j.PAIRING,"undefined"==typeof this.isIncognito?E.waitForBBEvent(this,"change:isIncognito"):void 0}).then(function(){var e=this;v.incrementProgress(),this.shortTagBase=(moment().unix()%1e3).toString();var n=this.initConn();if(!m.knowsPhone())return n.bind(this).then(function(){this.set({state:j.UNPAIRED,refWatcher:E.attachWatcher(this.runPromise,this.manageRef())})});var r=function(){var r=e.requestSync(t);return{v:c["default"].all([n,r])["finally"](function(){n.cancel(),r.cancel()})}}();return"object"===("undefined"==typeof r?"undefined":(0,s["default"])(r))?r.v:void 0}).then(this.waitForSyncInfo)["finally"](function(){this.refWatcher&&(this.refWatcher.cancel(),this.unset("refWatcher"))}).then(function(e){return v.incrementProgress(),f.log("ws2:completed "+(this.hasSynced?"re-auth":"auth"))(),this.state=j.CONNECTED,E.waitForMain()["return"](e)}).then(function(e){f.log("ws2:main loaded")(),e.initial=!0,Store.Conn.handle([e]);var t=this.openStream();return this.streamPromise=t,t}).then(function(){return new T})["catch"](S.SocketClosed,function(e){throw e.event instanceof D.UILogout?e.event:e})["catch"](function(e){f.warn("ws2:run loop interrupt: "+e)(e),this.set({canSend:!1,stream:P.DISCONNECTED,runPromise:null}),this.phoneWatchdog.deactivate(),this.streamPromise&&(this.streamPromise.cancel(),this.unset("streamPromise")),this.socketWatcher&&(this.socketWatcher.cancel(),this.unset("socketWatcher"));var t=this.socket;return t&&"closed"!==t.state&&(t.detachCallbacks(),t.close(!0,e)),this.unset("socket"),c["default"].reject(e)})["catch"](S.E401,D.PhoneFailedPing,function(){return!1})["catch"](D.ForcedRefresh,function(){return this.clearState(),!1})["catch"](S.SocketClosed,S.SocketError,function(){return!0})["catch"](D.DeniedUnknown,function(e){return f.error("ws2:sync rejected, logging out")(),this.sendCurrentLogout(),this.clearCredentials(),!1})["catch"](D.Denied401Failed,D.PhoneKickedClient,function(e){return f.log("ws2:phone disassociated via "+e)(),this.clearCredentials(),!1})["catch"](D.NoSecretBundle,function(){return f.error("ws2:No secret bundle!")(),this.clearCredentials(),p.upload("no-secret-bundle"),!1})["catch"](D.TooManyRefRequest,function(){return this.state=j.UNPAIRED_IDLE,this.setPokeable(E.waitForOfflineNaive()["throw"](new D.WindowOffline)["catch"](D.ExternalPoke,_.constant(!1)))})["catch"](S.BlockedByProxy,function(){return R.promptUnloadGuards++,this.state=j.PROXYBLOCK,this.setPokeable((new T)["catch"](D.ExternalPoke,_.constant(!1))["finally"](function(){R.promptUnloadGuards--}))})["catch"](D.DeniedTOS,function(){f.log("ws2:denied tos")();var e=this.setPokeable((new T).cancellable()["catch"](D.ExternalPoke,_.constant(!1))).cancellable();return this.clearState(),this.set({state:j.TOS_BLOCK,runPromise:e}),e})["catch"](D.Denied409Conflict,D.PhoneReplacedClient,function(e){e instanceof D.Denied409Conflict?f.log("ws2:phone denied (conflict)")():f.log("ws2:phone replaced")(),this.clearState();var t=(new T).cancellable();return this.set({state:j.CONFLICT,conflictPromise:t,runPromise:t}),t})["finally"](function(){this.conflictPromise&&this.conflictPromise.cancel()})["catch"](D.UILogout,D.WindowOffline,function(){return!1})},openSocket:function(){var e=this,t=this.socketPreload;if(this.socketPreload=null,t&&t.socket&&"open"===t.socket.state)return this.socketSequence+=t.attempts,this.online=!0,c["default"].resolve(t.socket);t&&t.active?(this.socketSequence+=t.attempts,this.online=t.online):t=new O({online:this.online,startId:this.socketSequence});var n=function(){e.online=t.online},r=function(){e.socketSequence++},i=function(){e.retryTimestamp=t.retryTimestamp};t.on("change:online",n),t.on("change:attempts",r),t.on("change:retryTimestamp",i),this.pokeable=t;var o=E.waitForBBEvent(t,"change:socket").cancellable().then(function(){return t.socket})["finally"](function(){t.off("change:online",n),t.off("change:attempts",r),t.off("change:retryTimestamp",i),t.onerror=null,t.deactivate(),e.pokeable=null});return t.onerror=function(e){o.cancel(e)},o},initConn:function(){return new c["default"](function(e,t){var n=g.VERSION,r=this.tag("init"),i=R.info();return this._basicSend({tag:r,data:["admin","init",[n.p,n.s,n.t],[i.os||"Unknown",i.name||"Unknown"],R.id(),!this.isIncognito&&!!m.getRememberMe()]},"init"),this.socket.nextMessage(x.TAG(r)).get("data")["catch"](t).then(e)}.bind(this)).then(function(e){A.update(e.update,e.curr),N.setSkew(Date.now()-e.time),Store.Conn.handle([{id:1,ref:e.ref,refTTL:e.ttl}])})},manageRef:function(){var e=this;return E.loopOnError(S.ShouldLoop,function(t){var n=Store.Conn.refExpiry-Date.now()-W;return c["default"].delay(Math.max(n,0)).cancellable().then(function(){if(t>=Y)throw new D.TooManyRefRequest;f.log("ws2:Requesting Ref Update")();var n=e.tag("qr"+t);return e._basicSend({tag:n,data:["admin","Conn","reref"]},"reref"),e.socket.nextMessage(x.TAG(n))}).then(function(e){var t=e.data;switch(t.status){case 200:throw f.log("ws2:Updating Ref")(),Store.Conn.handle([{ref:t.ref,refTTL:t.ttl}]),new S.ShouldLoop;case 304:return void f.log("ws2:Keeping Ref")();case 429:throw f.log("ws2:Server denied new ref")(),new D.TooManyRefRequest;default:throw f.error("ws2:Bad Ref Response!",t)(),new D.AssertionFailed("unrecognized ref request status ("+t.status+")")}})}).cancellable()},requestSync:function(e){var t=this;if(this.syncTag=this.tag("sync"),!$.load())throw new D.NoSecretBundle;var n=m.getLoginTokens(),r=n.client,i=n.server,o=["admin","login",r,i,R.id()];e?o.push("takeover"):this.hasSynced&&(o.push("reconnect"),o.push(Store.Conn.me));var a=function(){return t._basicSend({tag:t.syncTag,data:o},"sync"),!0},s=new w({waitAlgorithm:w.FIBONACCI(0,8500,6e4),onTimeout:a});s.on("change:ts",function(){t.retryTimestamp=s.ts}),this.pokeable=s,s.activate(),a();var u=this.socket.nextMessage(x.TAG(this.syncTag)),l=this.lookForAndHandleChallenge()["catch"](c["default"].CancellationError,_.noop)["catch"](u.cancel.bind(u));return u.then(function(e){f.log("ws2:login",e)();var t=e.data;switch(t.status){case 200:return e;case 401:return c["default"].reject(new D.Denied401Failed);case 403:return c["default"].reject(t.tos>=2?new D.DeniedTOS:new D.DeniedUnknown);case 405:return f.error("ws2:Already authorized!")(),p.upload("already-authorized"),c["default"].reject(new D.ForcedRefresh);case 409:return c["default"].reject(new D.Denied409Conflict);default:return f.error("ws2:unknown error! status:"+t.status,e)(),c["default"].reject(new D.DeniedUnknown)}})["finally"](function(){l.cancel(),s.deactivate(),t.unset("pokeable"),t.unset("retryTimestamp")})},waitForSyncInfo:function(){return this.socket.nextMessage(x.SYNC_INFO).then(function(e){return e.data[1]})},lookForAndHandleChallenge:function(){return this.socket.nextMessage(x.CHALLENGE).bind(this).then(function(e){f.log("ws2:challenged!")();var t=CryptoJS.enc.Base64.parse(e.data[1].challenge),n=$.getSecurityToken(t),r=m.getLoginTokens(),i=r?r.server:void 0;if(!i)return f.error("ws2:handleChallenge no server token!",r)(),c["default"].reject(new Error("Handle challenge no server token"));var o=this.tag("challenge");return this._basicSend({tag:o,data:["admin","challenge",n,i,R.id()]},"challenge"),this.socket.nextMessage(x.TAG(o))}).then(function(e){return e.data.status>=400?(f.error("ws2:handleChallenge failed challenge!",e.data)(),c["default"].reject(new D.Denied401Failed)):void f.log("ws2:handleChallenge passed challenge")()})},throwOnClose:function(){return this.socket.nextMessage(x.DISCONNECT).then(function(e){var t=e.data[1];throw"replaced"===t.kind?new D.PhoneReplacedClient:new D.PhoneKickedClient})},openStream:function(){this.canSend=!0;var e,t;return this.hasSynced?e=c["default"].join(this.queryReceivedActions(),Store.Chat.resyncMessages(),Store.Msg.resyncReceipts(),_.noop).bind(this).then(function(){this.flushQueue(),this.stream=P.CONNECTED})["catch"](S.EphemeralDrop,c["default"].CancellationError,function(){this.stream=P.DISCONNECTED})["catch"](function(e){throw f.error("ws2:error during resume, resyncing: "+e)(e),f.errorVerbose(e.stack)(),p.upload("error-on-resume"),this.stream=P.DISCONNECTED,new D.ForcedRefresh}):(t=Store.Chat.sync().cancellable().bind(this).then(function(){this.set({hasSynced:!0,stream:P.CONNECTED})})["catch"](c["default"].CancellationError,_.noop),e=c["default"].join(t,Store.Contact.sync(),_.noop).bind(this)["catch"](function(e){return t.cancel(),this.set({hasSynced:!1,stream:P.DISCONNECTED}),c["default"].reject(e)})["catch"](c["default"].CancellationError,_.noop)),c["default"].resolve().cancellable().bind(this).then(function(){return this.stream=this.hasSynced?P.RESUMING:P.SYNCING,this.socket.onmessage=this.onMessage.bind(this),this.socket.releaseMessages(),e})["catch"](c["default"].CancellationError,function(){e.cancel()})},queryReceivedActions:function(){var e=this,t=_.filter(this.sendQueue,"clientCacheable",!0),n=_.pluck(t,"tag").filter(function(e){return e});return f.log("ws2:queryReceivedActions")(),0===n.length?c["default"].resolve():Store.Wap.queryReceivedActions(n).then(function(n){_.isArray(n)?n.forEach(function(t){var n=_.find(e.sendQueue,"tag",t.id);if(n)if(f.log("ws2:queryReceivedActions found dup: "+t.id+","+t.code)(),delete e.sendHash[t.id],e.sendQueue=_.without(e.sendQueue,n),n.onSend){var r=n.onSend({status:t.code,_duplicate:!0});U.test(r)&&n.onDrop(new S.Server5xxDrop)}else f.error("ws2:queryReceivedActions onSendDup undefined; should be defined: "+t.id)(),n.onDrop(new S.ConventionViolationDrop);else f.error("ws2:queryReceivedActions unknown tag in response: "+t.id)()}):"replaced"===n?(t.forEach(function(e){e.onDrop(new S.BrowserReplacedDrop)}),e.sendQueue=_.difference(e.sendQueue,t)):f.error("ws2:queryReceivedActions error",n)()})},setPokeable:function(e){var t=arguments.length<=1||void 0===arguments[1]?this.retryTimestamp:arguments[1];return this.set({pokeable:{poke:function(){e.cancel(new D.ExternalPoke)}},retryTimestamp:t}),e},clearCredentials:function(){this.clearState(),m.setBrowserId(),m.setUnknownId(),m.clearTokens(),m.clearAllLocalState(),$.clear()},clearState:function(){this.sendQueue=[],this.clearSendHash(!0),this.unset("hasSynced"),_.each(Store,function(e){_.isFunction(e["delete"])&&e["delete"]()})},resendRequestEventually:function(e){var t=this,n=300*I.expBackoff(e.resends,100);f.log("ws2:Resending "+e.toString()+" in "+n+"ms")();var r=_.delay(function(){e.resends++,e.resendTimer=0,t.sendHash[e.tag]===e&&t._send(e)},n);e.set({resendTimer:r,state:L.WILL_RETRY})},sendCurrentLogout:function(e){if($.load()){var t={t:m.getLogoutToken(),m:Store.Wap.logoutToken()},n=m.getOldLogoutCreds();n.push(t),m.setOldLogoutCreds(n)}if(e&&e.state===y.STATE.OPEN){var r=this.logoutMutex;this.logoutMutex=0>=r?r=1:++r,f.info("ws2:logout through socket")(),e.partingSend(new D.UILogout,'goodbye,,["admin","Conn","disconnect"]',_.matches("goodbye,")).bind(this).then(function(e){e?(f.log("ws2:logout through socket success")(),o(t)):f.warn("ws2:logout through socket failure, will POST")()})["finally"](function(){this.logoutMutex===r&&(this.logoutMutex=0)})}else this.logoutMutex<0&&(this.logoutMutex=0),this.sendRemainingLogouts()},sendRemainingLogouts:function(){var e=this.logoutMutex;if(0===e){var t=n(107),r=m.getOldLogoutCreds();if(0===r.length)return void(this.logoutMutex=-1);this.logoutMutex=e=1,c["default"].all(_.map(r,function(e){return f.info("ws2:POST logout")(),t.post(g.LOGOUT_URL,e).then(function(){o(e)})["catch"](function(e){f.warn("ws2:POST logout failure")()})})).bind(this)["finally"](function(){e===this.logoutMutex&&(this.logoutMutex=0)})}}});e.exports=new z},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(22),o=r(i),a=n(8),s=n(23),u=n(1),c=n(350),l=n(170),d=[a.KEY_LOGOUT_TOKEN,a.KEY_CLIENT_TOKEN,a.KEY_SERVER_TOKEN,a.KEY_SECRET_BUNDLE],f=[a.KEY_LOG_CURSOR,a.KEY_WHATSAPP_MUTEX,a.KEY_REMEMBER_ME,a.KEY_WHATSAPP_LS_VERSION],p=[a.KEY_WHATSAPP_MUTEX,a.KEY_REMEMBER_ME,a.KEY_OLD_LOGOUT_CREDS],h=[a.KEY_VERSION],g=1,m={v0:function(){var e=localStorage.getItem(a.KEY_SECRET_BUNDLE);e&&(e=JSON.parse(e),e=_.isObject(e)?(0,o["default"])(e):e,localStorage.setItem(a.KEY_SECRET_BUNDLE,e)),this._setLSVersion(1)}},v="x"+Math.round(1e9*Math.random()),b=function(e){if(e.key!==a.KEY_WHATSAPP_MUTEX)return!1;var t=e.newValue||"";return-1===t.indexOf(v)?!0:!1},y=function(e){if(e.key!==a.KEY_LOCAL_TAKEOVER_OK)return!1;var t=e.newValue||"";return-1===t.indexOf(v)?!0:!1},w={thisTabId:v,getRememberMe:function(){var e=this._getPS(a.KEY_REMEMBER_ME);return _.isNull(e)&&(e=!0,this._setPS(a.KEY_REMEMBER_ME,!0)),e},setRememberMe:function(e){if(e=!!e,e!==this.getRememberMe()){u.log("UserPrefs:setRememberMe: "+e)();var t,n;if(t=this._storage(),this._setPS(a.KEY_REMEMBER_ME,e),n=this._storage(),t!==n){var r=_.difference(_.keys(t),f,p);r.forEach(function(e){_.isFunction(t[e])||(n[e]=t[e],t.removeItem(e))})}e||u.clearLogs()}},_storage:function(){return this.getRememberMe()?s.permanentStorage:s.temporaryStorage},clear:function(){var e=this._getPreservedKeys();this._storage().clear(),this._setPreservedKeys(e)},_getKeys:function(e,t){return _.object(t,t.map(function(t){return e.getItem(t)}))},_setKeys:function(e,t){_.each(t,function(t,n){e.setItem(n,t)})},_getPreservedKeys:function(){return this._getKeys(s.permanentStorage,p)},_setPreservedKeys:function(e){return this._setKeys(s.permanentStorage,e)},_getAllKeyValues:function(){var e=this._storage();return _.object(_.keys(e).map(function(t){return[t,e.getItem(t)]}))},_setAllKeyValues:function(e){var t=this._storage();_.keys(e).forEach(function(n){t.setItem(n,e[n])})},_getPS:function(e){return this._get(e,s.permanentStorage)},_setPS:function(e,t){return this._set(e,t,s.permanentStorage)},_getTS:function(e){return this._get(e,s.temporaryStorage)},_setTS:function(e,t){return this._set(e,t,s.temporaryStorage)},_get:function(e,t,r){if(_.isUndefined(e))throw new Error("_get called with no key");t=t||this._storage();var i=t.getItem(e);if(r||_.isUndefined(i))return i;try{return JSON.parse(i)}catch(o){u.log("userPrefs:_get("+e+") '"+o+"' "+i)();var a=n(12);return a.upload("userprefs-parse-error"),void t.removeItem(e)}},_set:function(e,t,n,r){if(_.isUndefined(e))throw new Error("_set called with no key");n=n||this._storage(),_.isUndefined(t)?n.removeItem(e):n.setItem(e,r?t:(0,o["default"])(t))},_getUser:function(e){if(!Store.Conn.me)return u.error("userPrefs: Me has not loaded yet.")(),null;var t=c([Store.Conn.me,e].join(":"));return this._get(t)},_setUser:function(e,t){if(!Store.Conn.me)return u.error("userPrefs: Me has not loaded yet.")(),null;var n=c([Store.Conn.me,e].join(":"));return this._set(n,t)},getLoginTokens:function(){return{client:this._get(a.KEY_CLIENT_TOKEN),server:this._get(a.KEY_SERVER_TOKEN)}},setLoginTokens:function(e){var t=e.client,n=e.server;t&&n&&!_.isUndefined(t)&&(u.log("UserPrefs:setLoginTokens")(),this._set(a.KEY_CLIENT_TOKEN,t),this._set(a.KEY_SERVER_TOKEN,n))},knowsPhone:function(){var e=this.getLoginTokens();return!(!e.client||!e.server)},setRefTokCookies:function(e,t){w.clearCookies(),w.clearDeprecatedKeys(),l.setCookie({name:a.COOKIE_REF,value:e,path:a.PP_REF,domain:a.COOKIE_DOMAIN,secure:!0}),l.setCookie({name:a.COOKIE_TOK,value:t,path:a.PP_TOK,domain:a.COOKIE_DOMAIN,secure:!0})},clearCookies:function(){[a.COOKIE_REF,a.COOKIE_TOK].forEach(function(e){l.setCookie({name:e,expirationDate:0,path:"/"}),l.setCookie({name:e,expirationDate:0,path:"/",domain:a.COOKIE_DOMAIN}),l.setCookie({name:e,expirationDate:0,path:e===a.COOKIE_REF?a.PP_REF:a.PP_TOK,domain:a.COOKIE_DOMAIN})})},clearDeprecatedKeys:function(){h.forEach(function(e){s.permanentStorage.removeItem(e)})},getSecretBundle:function(){var e=this._get(a.KEY_SECRET_BUNDLE);return e?_.object(_.map(e,function(e,t){return[t,CryptoJS.enc.Base64.parse(e)]})):(u.error("UserPrefs:Attempted to load non-existent secret bundle!",e)(),null)},setSecretBundle:function(e){return this._set(a.KEY_SECRET_BUNDLE,_.object(_.map(e,function(e,t){return[t,CryptoJS.enc.Base64.stringify(e)]})))},clearTokens:function(){d.forEach(function(e){this._set(e)},this)},getNUX:function(e){return this._getUser(e)},setNUX:function(e,t){return this._setUser(e,t)},getUnknownId:function(){var e=this._get(a.KEY_UNKNOWN_ID);return e||(e="unknown"+Math.floor(1e10*Math.random()),this.setUnknownId(e)),e},setUnknownId:function(e){return this._set(a.KEY_UNKNOWN_ID,e)},getBrowserId:function(){return this._get(a.KEY_BROWSER_ID)},setBrowserId:function(e){this._set(a.KEY_BROWSER_ID,e)},setLastEmojiTab:function(e){return this._setUser(a.KEY_LAST_ACTIVE_EMOJI_TAB,e)},getLastEmojiTab:function(){return this._getUser(a.KEY_LAST_ACTIVE_EMOJI_TAB)},getCollection:function(e){return this._getUser(e)},setCollection:function(e,t){return this._setUser(e,t)},getGlobalSounds:function(){return!this._getUser(a.KEY_GLOBAL_MUTE_SOUNDS)},setGlobalSounds:function(e){return this._setUser(a.KEY_GLOBAL_MUTE_SOUNDS,!e)},getGlobalNotifications:function(){return!this._getUser(a.KEY_GLOBAL_MUTE_NOTIFICATIONS)},setGlobalNotifications:function(e){return this._setUser(a.KEY_GLOBAL_MUTE_NOTIFICATIONS,!e)},getGlobalPreviews:function(){return!this._getUser(a.KEY_GLOBAL_MUTE_PREVIEWS)},setGlobalPreviews:function(e){return this._setUser(a.KEY_GLOBAL_MUTE_PREVIEWS,!e)},getGeocoderLocation:function(){return this._getUser(a.KEY_GEOCODER_LOCATION)},setGeocoderLocation:function(e){this._setUser(a.KEY_GEOCODER_LOCATION,e)},getMapsOverQuota:function(){return this._get(a.KEY_GMAPS_OVER_LIMIT)},setMapsOverQuota:function(e){return this._set(a.KEY_GMAPS_OVER_LIMIT,e)},getGroupParticipantAssignedColor:function(e){return this._getUser(a.KEY_GROUP_ASSIGNED_COLOR+"-"+e)},setGroupParticipantAssignedColor:function(e,t){this._setUser(a.KEY_GROUP_ASSIGNED_COLOR+"-"+e,t)},getMutex:function(){var e=this._getPS(a.KEY_WHATSAPP_MUTEX);return e},setMutex:function(e){var t=e?v+":"+e:e;return this._setPS(a.KEY_WHATSAPP_MUTEX,t)},removeMutex:function(){return this._setPS(a.KEY_WHATSAPP_MUTEX)},parseMutex:function(e){return e=e?JSON.parse(e):"",e?e.toString().split(/:/).pop():e},mutexFilter:b,localTakeoverSuccess:function(){var e=this.getRememberMe()?{}:_.omit(this._getAllKeyValues(),f);e.wa_tab_src=v,this._setPS(a.KEY_LOCAL_TAKEOVER_OK,e),this._setPS(a.KEY_LOCAL_TAKEOVER_OK)},parseTakeover:function(e){return e=e?JSON.parse(e):{},_.isObject(e)?(delete e.wa_tab_src,e):{}},takeoverFilter:y,getLangPref:function(){return this._get(a.KEY_LANG)},setLangPref:function(e){return this._set(a.KEY_LANG,e)},getLogoutToken:function(){return this._getPS(a.KEY_LOGOUT_TOKEN)},setLogoutToken:function(e){return this._setPS(a.KEY_LOGOUT_TOKEN,e)},getOldLogoutCreds:function(){return this._getPS(a.KEY_OLD_LOGOUT_CREDS)||[]},setOldLogoutCreds:function(e){return this._setPS(a.KEY_OLD_LOGOUT_CREDS,e)},setLogCursor:function(e){e%=a.LOG_SIZE,this._setPS(a.KEY_LOG_CURSOR,e)},_getLSVersion:function(){return this._getPS(a.KEY_WHATSAPP_LS_VERSION)||0},_setLSVersion:function(e){return this._setPS(a.KEY_WHATSAPP_LS_VERSION,e)},_version:function(){return g},compareVersion:function(){var e=this._getLSVersion();return g-e},_migrate:function(e){if(e>5)throw new Error("too many migrations");var t=this.compareVersion();if(0!==t){var n,r=this._getLSVersion();if(!(t>0))throw new Error("downgrades not supported");if(n=m["v"+r],!n)throw new Error("no migration for: "+r);u.log("userPrefs:migrate from: "+r+" towards: "+g)(),n.call(this),this._migrate(e+1)}},maybeMigrate:function(){if(!_.isEmpty(localStorage)||!_.isEmpty(sessionStorage)){var e=_.flatten([d,a.KEY_BROWSER_ID,a.KEY_LOG_CURSOR]),t=_.pick(localStorage,e);try{this._migrate(0)}catch(n){u.error("userPrefs:error migrating")(n),this.clear(),this._setAllKeyValues(t),this._setLSVersion(g)}}},clearAllLocalState:function(){var e=this._getPreservedKeys();localStorage.clear(),this._setPreservedKeys(e),sessionStorage.clear(),this.clearCookies(),u.clearLogs()},setNoTakeover:function(e){return this._setTS(a.KEY_NO_TAKEOVER,e)},getNoTakeover:function(){return this._getTS(a.KEY_NO_TAKEOVER)},getWamBuffer:function(){return this._get(a.KEY_WAM_BUFFER,void 0,!0)},setWamBuffer:function(e){this._set(a.KEY_WAM_BUFFER,e,void 0,!0)},getWamInfo:function(){return this._get(a.KEY_WAM_INFO)},setWamInfo:function(e){return this._set(a.KEY_WAM_INFO,e)},getWamOldBuffer:function(){return this._get(a.KEY_WAM_OLD_BUFFER)},setWamOldBuffer:function(e){this._set(a.KEY_WAM_OLD_BUFFER,e)},clearWamBuffer_old:function(){this._set("WaWamBuffer",void 0)},clearWamStatus_old:function(){this._set("WAWamStatus",void 0)},clearWamLastRotate_old:function(){this._set("WAWamLastRotate",void 0)},clearWamDimensionCache_old:function(){this._set("WAWamDimensionCache",void 0)}};e.exports=w},function(e,t){var n=Object;e.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(e,t,n){"use strict";var r=n(45),i=!1,o=_.debounce(function(){return i=!1},500);e.exports={id:function a(){var e=n(15),a=e.getBrowserId();if(a)return a;var t=new Uint32Array(4);window.crypto.getRandomValues(t);var r=CryptoJS.lib.WordArray.create(t);return a=CryptoJS.enc.Base64.stringify(r),e.setBrowserId(a),a},info:function(){var e=r.parser.getResult();return{os:e.os.name+(e.os.version?" "+e.os.version:""),name:e.browser.name,ua:e.browser.name+" "+e.browser.version}},hardRefresh:function(e){if(this.promptUnloadGuards++,e){var t=n(15);t.setNoTakeover(!0)}location.reload(!0)},startDownloading:function(){i=!0,o()},clearDownloading:function(){i=!1},isDownloading:function(){return i},promptUnloadGuards:0}},,,,function(e,t,n){"use strict";function r(e,t){return _.isString(t)?t.split("@")[1]===e:("undefined"!=typeof t&&o.log("wid:isXWid called on nonstring: "+t)(),!1)}function i(e){return _.isString(e)?e.split("@")[0]:void 0}var o=n(1),a=n(374),s=["c.us","g.us","broadcast"],u=_.memoize(function(e){return"Server"===e?e:a.format(e)});e.exports={userToLegacy:function(e){if(_.isString(e)){var t=e.split("@");if(2===t.length&&"c.us"===t[1])return t[0]+"@s.whatsapp.net"}return e},isUser:function(e){return r("c.us",e)},isBroadcast:function(e){return r("broadcast",e)},isGroup:function(e){return r("g.us",e)},isWid:function(e){return _.isString(e)?_.contains(s,e.split("@")[1]):!1},user:i,formattedUser:function(e){if(e){var t=i(e);if(t)return l10n.numAndPunc(u(t))}return""}}},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){this.initializeStorage(),this._dbName="wawc",this._db=new u(this._dbName),this._db.version(1).stores({logs:"line,log"}),this._db.version(2).stores({logs:"line,log",assets:"key,hash,data"}),this._db.version(3).stores({logs:"line,log",assets:"key,hash,data",wam:",buffer,prevValues,lastSend"}),this.openAttempt=0,this.openDB(),this._dbState=p.OPENING,this.deleteLegacyDBs()}var o=n(3),a=r(o),s=n(8),u=n(445),c=n(1),l=n(45),d=n(47),f="WA",p={ERROR:"error",OPENING:"opening",BLOCKED:"blocked",OPEN:"open"};i.prototype.initializeStorage=function(){var e=window.localStorage,t=window.sessionStorage,n={setItem:function(e,t){this[e]=t},getItem:function(e,t){return this[e]},removeItem:function(e){delete this[e]},clear:function(){for(var e in this)this.hasOwnProperty(e)&&"function"!=typeof e&&delete this[e]}};this.permanentStorage=this._hasLocalStorage()?e:n,this.temporaryStorage=this._hasSessionStorage()?t:n},i.prototype._hasLocalStorage=function(){try{return localStorage.setItem(s.KEY_STORAGE_TEST,s.KEY_STORAGE_TEST),!0}catch(e){return!1}},i.prototype._hasSessionStorage=function(){try{return sessionStorage.setItem(s.KEY_STORAGE_TEST,s.KEY_STORAGE_TEST),!0}catch(e){return!1}},i.prototype.openDB=function(){var e=new d.WebcIdbOpen;this._openDB().then(function(){e.markWebcIdbOpenT(),e.webcIdbOpenSuccess=!0,e.commit()})["catch"](function(){e.markWebcIdbOpenT(),e.webcIdbOpenSuccess=!1,e.commit()})},i.prototype._openDB=function(){var e=this;this._db.isOpen()&&this._db.close();var t=a["default"].resolve(this._db.open()).bind(this).timeout(1e4).then(function(){return c.info("db: Successfully opened db")(),e._dbState=p.OPEN,p.OPEN})["catch"](a["default"].TimeoutError,function(t){return c.info("db:openDB blocked"),e._dbState=p.BLOCKED,p.BLOCKED})["catch"](function(t){return c.error("db:openDB:Error "+t)(),e.openAttempt>1||l.isSafari?(e.opening=void 0,e._dbState=p.ERROR,a["default"].reject(p.ERROR)):(e.openAttempt+=1,e._db["delete"]().then(function(){return e.openDB()}))}).then(function(t){return e.opening=void 0,t===p.BLOCKED?a["default"].reject(p.BLOCKED):e._db});return this.opening||(this.opening=t),t},i.prototype.idb=function(){return this._db.hasFailed()?a["default"].reject(p.FAILED):this._db.isOpen()?a["default"].resolve(this._db):this._dbState===p.BLOCKED?a["default"].reject(p.BLOCKED):this.opening?this.opening:(c.error("db:idb bad state: "+this._dbState)(),a["default"].reject(p.FAILED))},i.prototype.deleteLegacyDBs=function(){return u.getDatabaseNames().then(function(e){e.forEach(function(e){e===f&&(localStorage.setItem(s.KEY_LOG_CURSOR,0),u["delete"](e))})})},i.State=p,e.exports=new i},,function(e,t,n){var r=n(179)("wks"),i=n(31).Symbol;e.exports=function(e){return r[e]||(r[e]=i&&i[e]||(i||n(122))("Symbol."+e))}},,,,,,function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(t){return"number"==typeof t.status&&t.status>=500?t:void e(t)}}function o(e){return CryptoJS.lib.WordArray.create(new Uint8Array(e))}var a,s=n(3),u=r(s),c=n(1),l=n(12),d=n(53),f=n(14),p=n(163),h=n(353),g=n(171),m=n(17),v=n(389),b=n(390),y=n(391),w=n(392),E=n(393),S={setVersion:function(e,t){var n=e[0],r=e[1];switch(c.log("wap:setVersion "+[n,r,t].join("."))(),n){case 0:switch(r){case 2:v.setSubProtocol(1),a=v;break;case 3:v.setSubProtocol(r),a=v;break;case 4:b.setSubProtocol(r),a=b;break;case 5:case 6:y.setSubProtocol(r),a=y;break;case 7:w.setSubProtocol(t),a=w;break;case 8:E.setSubProtocol(t),a=E}}a||(c.error("wap:setVersion unknown version. attempting to update")(),l.upload("wap_unknown_version",!0)["finally"](function(){return m.hardRefresh()}))},"delete":function(){return a?a["delete"].apply(this,arguments):void 0},error2412:function(){return a.error2412.apply(this,arguments)},setSharedSecret:function(e){c.log("Wap:saveSharedSecret start")();var t=p.decode(e,!0),n=t.slice(0,32),r=p.encode(t.slice(32,64)),i=t.slice(64),a=o(n.concat(i)),s=d.get().keyPair.privKey,u=g.sharedSecret(n,s),l=h.extractAndExpand(u,void 0,"",80,!0),f=o(l.slice(0,32)),m=o(l.slice(32,64)),_=o(l.slice(64,80)),v=CryptoJS.HmacSHA256(a,m),b=v.toString(CryptoJS.enc.Base64);if(r!==b)return void c.error("Wap:saveSharedSecret hmac mismatch "+r+" "+b)();var y=CryptoJS.AES.decrypt({ciphertext:o(i),salt:void 0},f,{iv:_,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}),w=p.decode(y.toString(CryptoJS.enc.Base64),!0),E=o(w.slice(0,32)),S=o(w.slice(32,64));d.setSecretKeys("0.1",E,S),c.log("Wap:saveSharedSecret done")()},dispatch:function(e,t,n){var r=a[e];return"function"!=typeof r?n?u["default"].resolve(n):u["default"].reject("wap:"+e+":unsupported"):r.apply(this,t)},handle:function(){return a.handle.apply(this,arguments)},queryServerProps:function(){return new u["default"](function(e,t){f.sendEphemeral({data:["query","props"],onSend:e,onDrop:t})})},resyncPictures:function(e){return new u["default"](function(t,n){f.sendEphemeral({data:["query","resumePic",e],onSend:i(t),onDrop:n})})},setRememberMe:function(e){return f.sendBasic({data:["admin","remember",!!e]})},requestMediaUpload:function(e,t,n){return new u["default"](function(r,o){var a=function(e){switch(e.status){case 200:r({result:"ok",data:e.url,size:n});break;case 299:r({result:"duplicate",data:e.params,size:n});break;default:o({size:n})}};f.send({data:["action","upload",e,t,n.toString()],onSend:i(a),onDrop:o})})},sendMedia:function(e){return new u["default"](function(t,n){var r=_.clone(e),o=function(e){t(_.merge(r,e))};f.send({data:["query","sendMedia",r.url],onSend:i(o),onDrop:n})})},contactFindBroadcast:function(e){return new u["default"](function(t,n){f.send({data:["query","contact",e],onSend:i(t),onDrop:n})})},commonGroupsFind:function(e){return new u["default"](function(t,n){f.send({data:["query","group","common",e],onSend:t,onDrop:n})})},groupMetadataFind:function(e){return new u["default"](function(t,n){f.sendEphemeral({data:["query","GroupMetadata",e],onSend:i(t),onDrop:n})})},groupMetadataFindFromPhone:function(e){return a.groupMetadataFindFromPhone.apply(this,arguments)},lastseenFind:function(e){return new u["default"](function(t,n){f.sendEphemeral({data:["query","Presence","lastseen",e],onSend:i(t),onDrop:n})})},profilePicFind:function(e,t){return"ProfilePicThumb"===e?new u["default"](function(n,r){f.sendEphemeral({data:["query",e,t],onSend:i(n),onDrop:r})}):void 0},profilePicFindThumbFromPhone:function(e,t){return a.profilePicFindThumbFromPhone.apply(this,arguments)},statusFind:function(e){return new u["default"](function(t,n){f.sendEphemeral({data:["query","Status",e],onSend:i(t),onDrop:n})})},sendPing:function(e){return new u["default"](function(e,t){
f.send({data:["admin","test"],onSend:i(e),onDrop:t})})},requestDeviceUploadLogs:function(){return this.dispatch("requestDeviceUploadLogs",arguments)},resyncMessages:function(){return this.dispatch("resyncMessages",arguments)},resyncReceipts:function(){return this.dispatch("resyncReceipts",arguments)},queryReceivedActions:function(){return this.dispatch("queryReceivedActions",arguments,[])},addParticipant:function(){return this.dispatch("addParticipant",arguments)},changeSubject:function(){return this.dispatch("changeSubject",arguments)},createGroup:function(){return this.dispatch("createGroup",arguments)},leaveGroup:function(){return this.dispatch("leaveGroup",arguments)},removeParticipant:function(){return this.dispatch("removeParticipant",arguments)},promoteParticipant:function(){return this.dispatch("promoteParticipant",arguments)},requestMediaReupload:function(){return this.dispatch("requestMediaReupload",arguments)},sendConversationSeen:function(){return this.dispatch("sendConversationSeen",arguments)},sendConversationUnseen:function(){return this.dispatch("sendConversationUnseen",arguments)},sendConversationClear:function(){return this.dispatch("sendConversationClear",arguments)},sendConversationDelete:function(){return this.dispatch("sendConversationDelete",arguments)},sendConversationArchive:function(){return this.dispatch("sendConversationArchive",arguments)},sendConversationMute:function(){return this.dispatch("sendConversationMute",arguments)},sendConversationNotSpam:function(){return this.dispatch("sendConversationNotSpam",arguments)},sendMessagePlayed:function(){return this.dispatch("sendMessagePlayed",arguments)},sendMessageDelete:function(){return this.dispatch("sendMessageDelete",arguments)},sendMessageStarred:function(){return this.dispatch("sendMessageStarred",arguments)},sendUnstarAll:function(){return this.dispatch("sendUnstarAll",arguments)},sendPresenceAvailable:function(){return this.dispatch("sendPresenceUpdate",["available"])},sendPresenceUnavailable:function(){return this.dispatch("sendPresenceUpdate",["unavailable"])},sendChatstateComposing:function(e){return this.dispatch("sendChatstateUpdate",["composing",e])},sendChatstatePaused:function(e){return this.dispatch("sendChatstateUpdate",["paused",e])},sendChatstateRecording:function(e){return this.dispatch("sendChatstateUpdate",["recording",e])},sendSetPicture:function(){return this.dispatch("sendSetPicture",arguments)},deletePicture:function(){return this.dispatch("deletePicture",arguments)},sendSetStatus:function(){return this.dispatch("sendSetStatus",arguments)},sendSetBlock:function(){return this.dispatch("sendSetBlock",arguments)},sendSpamReport:function(){return this.dispatch("sendSpamReport",arguments)},chatFindQuery:function(){return this.dispatch("chatFindQuery",arguments)},contactFindQuery:function(){return this.dispatch("contactFindQuery",arguments)},msgCreateRecord:function(){return this.dispatch("msgCreateRecord",arguments)},msgFindQuery:function(){return this.dispatch("msgFindQuery",arguments)},queryMsgInfo:function(){return this.dispatch("queryMsgInfo",arguments)},presenceSubscribe:function(){return this.dispatch("presenceSubscribe",arguments)},recentEmojiQuery:function(){return this.dispatch("recentEmojiQuery",arguments)},logoutToken:function(){var e=d.get().encKey.toString(CryptoJS.enc.Base64),t=d.get().macKey.toString(CryptoJS.enc.Base64),n=CryptoJS.enc.Base64.parse(e),r=CryptoJS.enc.Base64.parse(t);return CryptoJS.HmacSHA256(n,r).toString(CryptoJS.enc.Base64)}};e.exports=S},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){function e(e){var s=h["default"].resolve([a++,e]).cancellable().spread(i).then(function(){return n.apply(void 0,arguments)});t=s["catch"].apply(s,o)["catch"](function(){return r.apply(void 0,arguments)})}var t,n,r,i=_.last(arguments),o=_.initial(arguments),a=0;return o.push(e),h["default"].resolve().then(function(){return new h["default"](function(t,i){n=t,r=i,e()}).cancellable()["catch"](function(e){if(t&&t.isPending())return new h["default"](function(i,o){n=i,r=o,t.cancel(e)});throw e})})}function o(e){return new h["default"](function(t){function n(){t(r.status&&r.status<12e3?r:null)}var r=new XMLHttpRequest;r.onload=n,r.onreadystatechange=function(){4===r.readyState?n():0===r.readyState&&t(null)},r.onerror=t.bind(void 0,null),r.ontimeout=t.bind(void 0,null),r.open("GET",e,!0),r.send()})}function a(e,t){return t["catch"](h["default"].CancellationError,_.noop)["catch"](function(t){e.cancel(t)})}function s(){return c(window,"offline")}function u(){var e,t;return new h["default"](function(n){function r(){t&&t+1500<Date.now()?n(!0):(t=Date.now(),e=_.delay(r,1e3))}r()}).cancellable()["finally"](function(){clearTimeout(e)})}function c(e,t,n){var r;return new h["default"](function(i){r=n?function(){n.apply(this,arguments)&&i.apply(this,arguments)}:i,e.addEventListener(t,r)}).cancellable()["finally"](function(){e.removeEventListener(t,r)})}function l(e,t,n){var r;return new h["default"](function(i){r=n?function(){n.apply(this,arguments)&&i(arguments)}:function(){i(arguments)},e.on(t,r)}).cancellable()["finally"](function(){e.off(t,r)})}function d(){return v.isMainLoaded?h["default"].resolve():l(v,"main_loaded")}function f(){return new h["default"](function(e,t){function n(){e(!1)}if(window.requestFileSystem)window.requestFileSystem(window.TEMPORARY,1,n,function(t){e("SecurityError"===t.name)});else if(window.indexedDB){var r=window.indexedDB.open("pb_detect");r?(r.onsuccess=n,r.onerror=function(t){t.preventDefault(),e(!0)}):n()}else n()}).then(function(e){if(e)return e;try{return window.localStorage.setItem("INCOG",0),window.localStorage.removeItem("INCOG"),!1}catch(t){return"QuotaExceededError"===t.name?!0:h["default"].reject(t)}}).timeout(100,"detectIncognitoTimeout")["catch"](h["default"].TimeoutError,function(){return!1})["catch"](function(e){return g.error("promiseUtil:determineIncognito failed check: "+e)(e),m.upload("incog-throw"),!1})}var p=n(3),h=r(p),g=n(1),m=n(12),v=n(9);e.exports={loopOnError:i,attachWatcher:a,getResponseIfOnline:o,waitForOfflineNaive:s,waitForEvent:c,waitForBBEvent:l,determineIncognito:f,waitForSkip:u,waitForMain:d}},function(e,t,n){e.exports={"default":n(401),__esModule:!0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){this._parent=null,this._subs=[],this._catchTypes=null,this._onResolve=null,this._onReject=null,this.type=p.ROOT,this.state=h.PENDING,this.value=void 0,this._forceable=!1,this._cancellable=!1;var e,t;switch(arguments.length){case 0:break;case 1:e=arguments[0];break;case 2:t=arguments[0],e=arguments[1];break;default:throw new Error("TightPromise constructor with "+arguments.length+" arguments")}if(this.context=t,arguments.length>0)try{e.call(t,o.bind(this),a.bind(this))}catch(n){a.call(this,n)}}function o(e){this.state===h.PENDING&&(s(e)?e.then(o.bind(this),a.bind(this)):(this.value=e,this.state=h.FULFILLED,this._notifySubs()))}function a(e){this.state===h.PENDING&&(this.value=e,this.state=h.REJECTED,this._notifySubs())}function s(e){return("object"===("undefined"==typeof e?"undefined":(0,l["default"])(e))||"function"==typeof e)&&"function"==typeof e.then}function u(e){setTimeout(function(e){throw e},0,e)}var c=n(24),l=r(c),d=n(3),f=r(d),p={ROOT:1,THENABLE:2,FINALLY:3,META:4},h={PENDING:1,FULFILLED:2,REJECTED:3};i.STATE=h,i.TYPE=p,i.prototype={isPending:function(){return this.state===h.PENDING},then:function(e,t){if(!e&&!t)return this;var n=new i;return n.type=p.THENABLE,n._onResolve=e||null,n._onReject=t||null,this._addChild(n),n},"catch":function(){var e=new i;return e.type=p.THENABLE,e._onReject=arguments[arguments.length-1],arguments.length>1&&(e._catchTypes=Array.prototype.slice.call(arguments,0,arguments.length-1),e._catchTypes.forEach(function(e){if("function"!=typeof e)throw new Error("expected type, got "+e)})),this._addChild(e),e},"finally":function(e){var t=new i;return t.type=p.FINALLY,t._onResolve=e,this._addChild(t),t},bind:function(e){var t=new i;return t.type=p.META,this._addChild(t),t.context=e,t},spread:function(e){return this.then(function(t){e.apply(this,t)})},get:function(e){return this.then(function(t){return t[e]})},forceable:function(){var e=new i;return e.context=this.context,e.type=p.META,this._addChild(e),e._forceable=!0,e},cancellable:function(){var e=new i;return e.context=this.context,e.type=p.META,this._addChild(e),e._cancellable=!0,e},force:function(e){if(this._forceable){for(var t=this;t.type===p.META;){var n=t._parent;if(!n||!n._forceable||n.state!==h.PENDING)break;t=n}o.call(this,e)}},cancel:function(e){if(this._cancellable){e=e||new f["default"].CancellationError;var t=this,n=!1;do{var r=t._parent;r&&r._cancellable&&r.state===h.PENDING?t=r:n=!0}while(!n);a.call(t,e)}},timeout:function(e,t){var n=new i;return n.type=p.META,this._addChild(n),n.state===h.PENDING&&setTimeout(a.bind(n,new f["default"].TimeoutError(t)),e),n},loosen:function(){return f["default"].resolve(this)},_run:function(e,t){var n;try{n=e.call(this.context,t)}catch(r){return void a.call(this,r)}o.call(this,n)},_handle:function(){if(this.state===h.PENDING){var e=this._parent;switch(this.type){case p.THENABLE:if(e.state===h.FULFILLED){var t=this._onResolve;t?this._run(t,e.value):o.call(this,e.value)}else if(this._onReject){var n=this._catchTypes,r=n?n.length:0,i=e.value;if(0===r)return void this._run(this._onReject,i);for(var s=0;r>s;s++)if(i instanceof n[s])return void this._run(this._onReject,i);a.call(this,i)}else a.call(this,e.value);return;case p.FINALLY:try{this._onResolve.call(this.context)}catch(c){u(c)}default:e.state===h.FULFILLED?o.call(this,e.value):a.call(this,e.value)}}},_addChild:function(e){e._parent=this,e.context=this.context,e._cancellable=this._cancellable,e.type===p.META&&(e._forceable=this._forceable),this.state===h.PENDING?this._subs.push(e):e._handle()},_notifySubs:function(){this._subs.forEach(function(e){e._handle()})}},i.delay=function(){var e,t;switch(arguments.length){case 0:e=0;break;case 1:e=arguments[0];break;default:e=arguments[1],t=arguments[0]}return new i(function(n){setTimeout(n.bind(null,t),e)})},i.resolve=function(e){var t=new i;return o.call(t,e),t},i.reject=function(e){var t=new i;return a.call(t,e),t},e.exports=i},,,function(e,t){"use strict";var n={build:function(e,t){return t&&(t=_.chain(t).map(function(e,t){return e?encodeURIComponent(t)+"="+encodeURIComponent(e):null}).compact().join("&").value()),t?e+"?"+t:e},relToAbs:function(e){var t=this.A_TAG=this.A_TAG||document.createElement("a");return t.href=e,t.href},isHttp:function(e){return e&&("https://"===e.substring(0,8)||"http://"===e.substring(0,7))},isBlob:function(e){return _.isString(e)&&"blob:"===e.substring(0,5)},isEncryptedMedia:function(e){return e&&_.isString(e)&&_.endsWith(e,".enc")},parseDataURL:function(e){var t=e.indexOf(":"),n=e.indexOf(";"),r=e.indexOf(",");return{mimetype:e.substring(t+1,n),data:e.substring(r+1)}}};e.exports=n},,,,function(e,t,n){"use strict";function r(e,t){var n,r,i,o=/(\.0)+[^\.]*$/;for(e=(e+"").replace(o,"").split("."),t=(t+"").replace(o,"").split("."),i=Math.min(e.length,t.length),n=0;i>n;n++)if(r=parseInt(e[n],10)-parseInt(t[n],10),0!==r)return r;return e.length-t.length}function i(e,t){return r(e,t)>=0}var o,a=n(608),s=window.navigator.userAgent;o=new a,o.setUA(s);var u=(o.getBrowser().name||"").toUpperCase(),c=o.getBrowser().version||"0.0.0",l=(o.getEngine().name||"").toUpperCase(),d=(o.getOS().name||"").toUpperCase(),f=o.getOS().version||"0.0.0",p=!l||"WEBKIT"===l,h="SAFARI"===u,g="CHROME"===u,m="TRIDENT"===l||"EDGEHTML"===l,_="GECKO"===l,v=!1;switch(d){case"MAC OS":g?v=i(f,"10.10")&&i(c,"41.0.0"):i(f,"10.7")&&(v=!0);break;case"WINDOWS":i(f,"8.1")&&(_?v=!0:g&&i(c,"41.0.0")&&(v=!0))}e.exports={isWebkit:p,isGecko:_,isTrident:m,isSafari:h,hasEmoji:v,os:d.toLowerCase(),browser:u.toLowerCase(),parser:o},window.notMSEdge=function(){e.exports.isTrident=!1}},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return"number"==typeof e&&e===Math.floor(e)}function o(e,t,n){var r=this;this.name=e,this.id=t,this.type=n,_.isObject(n)?!function(){var e=_.invert(n);r.validator=function(t){return t in e}}():n===y||n===S?this.validator=i:this.validator=n}function a(e,t,n){return C[e]?C[e]:C[e]=new o(e,t,n)}function s(e,t,n){var r={id:t},i={};for(var o in n){var s=n[o];s[1]===S&&(r["mark"+_.capitalize(o)]=l(o));var u=a(o,s[0],s[1]);i[o]=u.validator}var c=m.define(e,i,d);_.extend(c.prototype,r),k[e]=c}function u(e){for(var t in e){var n=e[t];s(t,n[0],n[1])}}function c(e){var t={},n=function(n){var r=e[n],i=a(n,r[0],r[1]);t[n]={type:i.validator,allowNull:!0,set:function(e){this.commitOnSet&&v.set(i,e)}}};for(var r in e)n(r);var i=m.define("Global",t,f);p=new i}function l(e){return function(){this[e]=Date.now()-this.eventTime}}function d(){this.eventTime=Date.now(),this.commitTime=void 0}function f(){this.commitOnSet=!0}var p,h=n(113),g=r(h),m=n(394),v=n(174),b="boolean",y="integer",w="number",E="string",S="timer",C={},k={};d.prototype=_.extend((0,g["default"])(m.prototype),{commit:function(){v.commit(this)},setTime:function(e){this.eventTime=e||Date.now()}});var T={IPHONE:1,ANDROID:2,BB:3,BBX:7,S40:4,SYMBIAN:5,WP:6,WEBCLIENT:8,OSMETA:11,TEST:9,UNKNOWN:10},$={NAVIGATE_NEXT:0,RELOAD:1,BACK_FORWARD:2,UNDEFINED:255},O={UNCACHED:0,IDLE:1,CHECKING:2,DOWNLOADING:3,UPDATEREADY:4,OBSOLETE:5},A={OFFLINE:0,OPENING:1,PAIRING:2,SYNCING:3,RESUMING:4,CONNECTING:5,NORMAL:6,TIMEOUT:7},R={QR:0,MAIN:1,SYNCING:2,OFFLINE:3,CONFLICT:4,PROXYBLOCK:5},I={PROD:0,INTERN:1,DEV:2};f.prototype=(0,g["default"])(m.prototype),c({appIsBetaRelease:[21,b],appVersion:[17,E],browser:[779,E],browserVersion:[295,E],deviceName:[13,E],platform:[11,T],webcEnv:[633,I],webcPhoneCharging:[783,b],webcPhonePlatform:[707,T]}),u({WebcPageLoad:[642,{webcUnloadEventStart:[648,S],webcUnloadEventEnd:[650,S],webcRedirectStart:[652,S],webcRedirectEnd:[654,S],webcFetchStart:[656,S],webcDomainLookupStart:[658,S],webcDomainLookupEnd:[660,S],webcConnectStart:[662,S],webcConnectEnd:[664,S],webcSecureConnectionStart:[666,S],webcRequestStart:[668,S],webcResponseStart:[670,S],webcResponseEnd:[672,S],webcDomLoading:[674,S],webcDomInteractive:[676,S],webcDomContentLoadedEventStart:[678,S],webcDomContentLoadedEventEnd:[680,S],webcDomComplete:[682,S],webcLoadEventStart:[684,S],webcLoadEventEnd:[686,S],webcExeStart:[760,S],webcExeDone:[756,S],webcWsOpening:[704,S],webcWsPairing:[706,S],webcWsSyncing:[708,S],webcWsNormal:[710,S],webcWsAttempts:[712,w],webcAppcacheStatus:[629,O],webcCached:[565,b],webcQrCode:[601,b],webcNavigation:[591,$],webcRedirectCount:[700,w],webcPageLoadT:[644,S]}],WebcPageResume:[884,{webcResumeCount:[785,y]}],WebcResourceLoad:[688,{webcResourceName:[567,E],webcResourceDuration:[690,S],webcResourceCached:[569,b]}],WebcWsOpen:[740,{webcWsOpenT:[738,S]}],WebcWsTimeout:[742,{webcWsTimeoutT:[744,S]}],WebcStreamInfoChange:[768,{webcStreamInfo:[641,A],webcStreamInfoDuration:[774,S]}],WebcStreamModeChange:[770,{webcStreamMode:[643,R]}],WebcAvailableChange:[772,{webcAvailable:[645,b],webcAvailableDuration:[776,S]}],WebcNotificationSet:[830,{webcNotificationOn:[709,b]}],WebcChatOpen:[864,{webcUnreadCount:[866,w],webcChatOpenT:[868,S]}],WebcIdbOpen:[874,{webcIdbOpenT:[876,S],webcIdbOpenSuccess:[781,b]}],WebcPhoneDisconnected:[878,{webcPhoneDisconnectedT:[880,S],webcPhoneBbarShownT:[882,S]}],WebcManualWebsocketAttempt:[896,{webcManualWebsocketAttemptSuccessful:[811,b]}]}),e.exports=_.defaults({},k,{METRICS:C,Global:p,WamEvent:d,PLATFORM_TYPE:T,WEBC_NAVIGATION_TYPE:$,WEBC_APPCACHE_STATUS_CODE:O,WEBC_STREAM_INFO_CODE:A,WEBC_STREAM_MODE_CODE:R,WEBC_ENV_CODE:I})},function(e,t,n){"use strict";var r=n(1),i=n(53),o=n(7),a={getKeys:function(){var e=i.get().encKey.toString(CryptoJS.enc.Base64),t=i.get().macKey.toString(CryptoJS.enc.Base64);return{enc:CryptoJS.enc.Base64.parse(e),mac:CryptoJS.enc.Base64.parse(t)}},encrypt:function(e){var t=CryptoJS.lib.WordArray.create(e),n=new Uint32Array(4),r=this.getKeys();window.crypto.getRandomValues(n);var i=CryptoJS.AES.encrypt(t,r.enc,{iv:CryptoJS.lib.WordArray.create(n),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}),a=i.iv.concat(i.ciphertext),s=CryptoJS.HmacSHA256(a,r.mac),u=s.concat(a);return o.fromBase64(u.toString(CryptoJS.enc.Base64)).toBuffer()},decrypt:function(e){var t=o.wrap(e),n=t.slice(t.offset,t.offset+32).toBase64(),i=t.slice(t.offset+32).toBuffer(),a=this.getKeys(),s=CryptoJS.lib.WordArray.create(i),u=CryptoJS.HmacSHA256(s,a.mac).toString(CryptoJS.enc.Base64);if(n!==u)throw r.error("bp:03:decrypt hmac dont match "+n+" "+u)(),new Error("hmac mismatch");var c=t.slice(t.offset+32,t.offset+48).toBuffer(),l=t.slice(t.offset+48).toBuffer(),d=CryptoJS.AES.decrypt({ciphertext:CryptoJS.lib.WordArray.create(l),salt:void 0},a.enc,{iv:CryptoJS.lib.WordArray.create(c),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return o.fromBase64(d.toString(CryptoJS.enc.Base64)).toBuffer()}};e.exports=a},function(e,t,n){"use strict";function r(e){var t=!1,n=i.wrap(e,void 0,t);this.readByte=function(){return n.readUint8()},this.readInt16=function(){return n.readUint16()},this.readInt20=function(){var e=15&n.readUint8(),t=n.readUint8(),r=n.readUint8();return(e<<16)+(t<<8)+r},this.readInt32=function(){return n.readUint32()},this.readString=function(e){return n.readString(e,i.METRICS_BYTES)},this.readBytes=function(e){var t=n.copy(n.offset,n.offset+e);return n.offset+=e,t},this.debugInfo=function(){return"offset: "+n.offset+" byte: "+n.readUint8(n.offset)}}var i=n(7);e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!e)return"undefined";var n=i(e[1],t),r=o(e[2],t);return"<"+e[0]+n+(r?">\n"+r+"\n</"+e[0]+">":"/>")}function i(e,t){if(e){var n="";for(var r in e){var i="string"==typeof e[r]?t?"...":'"'+e[r]+'"':e[r];n+=" "+r+"="+i}return n}return""}function o(e,t){return a.isByteBuffer(e)?"<<bin:"+e.limit+">>":"string"==typeof e?t?"<<string:"+e.length+">>":e:_.isArray(e)?e.map(_.partial(r,_,t)).join("\n"):void 0}var a=n(7),s={tag:function(e){return e&&e[0]},attr:function(e,t){return t&&t[1]?t[1][e]:void 0},attrs:function(e){return e[1]},child:function u(e,t){var n=t[2];if(_.isArray(n))for(var r=n.length,i=0;r>i;i++){var u=n[i];if(_.isArray(u)&&u[0]===e)return u}},children:function(e){return e&&e[2]},dataStr:function(e){if(!e)return"";var t=e[2];return"string"==typeof t?t:a.isByteBuffer(t)?t.readString(t.limit,a.METRICS_BYTES,0).string:void 0},toString:r};e.exports=s},function(e,t,n){"use strict";function r(){function e(e){n++,r.push(e)}var t=!1,n=0,r=[];this.pushInt16=function(t){if("number"!=typeof t)throw new Error("invalid int16");e((65280&t)>>8),e((255&t)>>0)},this.pushInt20=function(t){if("number"!=typeof t)throw new Error("invalid int20");e((983040&t)>>16),e((65280&t)>>8),e((255&t)>>0)},this.pushInt32=function(t){if("number"!=typeof t)throw new Error("invalid int32");e((4278190080&t)>>24),e((16711680&t)>>16),e((65280&t)>>8),e((255&t)>>0)},this.pushByte=function(t){if("number"!=typeof t||0>t||t>255)throw new Error("invalid byte value: "+t);e(t)},this.pushBytes=function(e){if(!i.isByteBuffer(e))throw new Error("invalid byte buffer");n+=e.limit,r.push(e)},this.pushUint8Array=function(e){if("[object Uint8Array]"!==Object.prototype.toString.call(e))throw new Error("invalid Uint8Array");n+=e.length;for(var t=0;t<e.length;t++)r.push(e[t])},this.pushString=function(e){if("string"!=typeof e)throw new Error("invalid string");n+=i.calculateUTF8Bytes(e),r.push(e)},this.toBuffer=function(){for(var e=new i(n,t),o=r.length,a=0;o>a;a++){var s=r[a];"string"==typeof s?e.writeString(s):i.isByteBuffer(s)?(s.reset(),e.append(s)):e.writeByte(s)}return e.reset(),e.toBuffer(!0)}}var i=n(7);e.exports=r},function(e,t,n){"use strict";var r=n(6),i=r.createClass({displayName:"ErrorDialog",propTypes:{title:r.PropTypes.node,body:r.PropTypes.node.isRequired,tip:r.PropTypes.node,cancelLabel:r.PropTypes.node,onCancel:r.PropTypes.func,defaultLabel:r.PropTypes.node,onDefault:r.PropTypes.func},render:function(){var e=this.props.tip?r.createElement("div",{className:"popup-contents"},this.props.body,r.createElement("hr",null),r.createElement("div",{className:"text text-tip"},this.props.tip)):r.createElement("div",{className:"popup-contents"},this.props.body),t=this.props.title?r.createElement("div",{className:"popup-title",dir:"auto"},this.props.title):null,n=[];return this.props.onCancel&&this.props.cancelLabel&&n.push(r.createElement("button",{className:"btn-plain popup-controls-item",onClick:this.props.onCancel,key:"secondary"},this.props.cancelLabel)),this.props.onDefault&&this.props.defaultLabel&&n.push(r.createElement("button",{className:"btn-plain btn-default popup-controls-item",onClick:this.props.onDefault,key:"primary"},this.props.defaultLabel)),n.length&&(n=r.createElement("div",{className:"popup-controls"},n)),r.createElement("div",null,r.createElement("div",{className:"backdrop backdrop-transparent"},r.createElement("div",{className:"popup-container"},r.createElement("div",{className:"popup"},r.createElement("div",{className:"popup-body"},t,e),n))))}});e.exports=i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){g=e}function o(){g=void 0}function a(){return g}function s(){if(!g)return w.log("secret_bundle:getSecurityToken: no secret bundle!")(),"nosecretbundle!";var e=f(_.toArray(arguments));return e.toString(CryptoJS.enc.Base64)}function u(e,t,n){"0.1"===e?t&&n?(g.encKey=t,g.macKey=n,g.key=n):w.error("secret_bundle:setSecretKeys v"+e+" "+t+" "+n)():w.log("secret_bundle:setSecretKeys unknown version: v"+e)()}function c(){if(g&&g.key&&g.keyPair)return g.key.toString(CryptoJS.enc.Base64);var e=y.keyPair(),t=CryptoJS.lib.WordArray.create(e.pubKey),n=CryptoJS.enc.Base64.stringify(t),r={key:CryptoJS.enc.Base64.parse(n),keyPair:e};return i(r),n}function l(){var e=E.getSecretBundle();return e?(i(e),e):(w.log("secret_bundle:load: attempted to load non-existent secret bundle!")(),null)}function d(){return g?(delete g.keyPair,void E.setSecretBundle(g)):void w.log("secret_bundle:save: trying to save empty secret bundle!")()}function f(e){for(var t=g.key.toString(CryptoJS.enc.Base64),n=p(e),r=[],i=0;i<n.length;i++){var o=CryptoJS.enc.Base64.parse(t);r.push(CryptoJS.HmacSHA256(n[i],o))}return r.reduce(h)}function p(e){var t=[];if(null===e||"undefined"==typeof e)return[];if(_.isArray(e))for(var n=0;n<e.length;n++)t=t.concat(p(e[n]));else if("object"===("undefined"==typeof e?"undefined":(0,v["default"])(e)))if("undefined"!=typeof e.words&&"undefined"!=typeof e.sigBytes)t.push(e);else for(var r in e){var i=e[r];i&&(t=t.concat(p(i)))}else t.push(b.userToLegacy(e.toString()));return t}function h(e,t){var n,r;e.sigBytes>t.sigBytes?(r=e,n=t):(r=t,n=e);for(var i=n.words.length,o=0;i>o;o++)r.words[o]=n.words[o]^r.words[o];return r}var g,m=n(24),v=r(m),b=n(21),y=n(171),w=n(1),E=n(15);e.exports={set:i,get:a,clear:o,getOrGenerate:c,load:l,save:d,getSecurityToken:s,setSecretKeys:u}},function(e,t,n){var r=n(86);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(3),o=r(i),a=n(1),s=n(62),u=n(82),c=s.extend(u,{extraProperties:"allow",session:{_uiObservers:{type:"number","default":0},_promises:{type:"array","default":function(){return[]}},_waitPromise:"object",stale:"boolean"},derived:{isObserved:{deps:["_uiObservers"],fn:function(){return this._uiObservers>0}}},update:function(){return this.getCollection().update(this.id)},find:function(){return this.getCollection().find(this.id)},getCollection:function(){return this.Collection?Store[this.Collection]:a.error("baseState:getCollection Attempting to get a non existing collection")()},getp:function(e){if(_.isString(e)){for(var t=e.split("."),n=this,r=0;r<t.length;r++){if(!n)throw Error("Path: "+e+" is not defined");n=n.get(t[r])}return n}},regCancellablePromise:function(e){var t=this;return this._promises.push(e),e.cancellable()["finally"](function(){t._promises=_.without(t._promises,e)})},hasPendingPromises:function(){return this._promises&&this._promises.length>0||this._waitPromise},cancelPendingPromises:function(){this.hasPendingPromises()&&(this._promises.forEach(function(e){e.cancel()}),this._promises=[]),this._waitPromise&&this.unset("_waitPromise")},waitForPromises:function(){var e=this;if(this._waitPromise)return this._waitPromise;var t=this._promises;return t&&0!==t.length?this._waitPromise=o["default"].settle(t)["finally"](function(){e.unset("_waitPromise")}):o["default"].resolve(!0)},set:function(e,t){return t&&t.merge&&_.isObject(e)?s.prototype.set.call(this,_.omit(e,_.isUndefined),t):s.prototype.set.call(this,e,t)},"delete":function(){this.stopListening()}});e.exports=c},function(e,t,n){"use strict";function r(e,t,n,r,s){this._from=e,this._to=t,this._id=n,this._participant=r,this._selfDir=s;var u,c;if(!(e&&t&&n&&Store.Conn.me))throw new Error("MsgKey error: "+[e,t,n,Store.Conn.me].join());s=e===t?s:void 0,e===t&&e===Store.Conn.me?(u="out"===s,c=Store.Conn.me):e===Store.Conn.me?(u=!0,c=t):t===Store.Conn.me?(u=!1,c=e):e===t&&(o.isGroup(e)||o.isBroadcast(e))?(u=!0,c=e):i.error("MsgKey case error: "+[e,t,n,Store.Conn.me].join())(),this.fromMe=u,this.remote=c,this.id=n;var l=[this.fromMe,this.remote,this.id];"undefined"!=typeof s&&(this.self=s,l.push(this.self)),a.gte([0,5])&&a.supportsFeature("KEY_PARTICIPANT")&&"undefined"!=typeof r&&(this.participant=r,l.push(this.participant)),this._serialized=l.join("_")}var i=n(1),o=n(21),a=n(80);r.prototype={toString:function(){return this._serialized},clone:function(){return new r(this._from,this._to,this._id,this._participant,this._selfDir)}},e.exports=r},function(e,t,n){var r=n(31),i=n(29),o="prototype",a=function(e,t){return function(){return e.apply(t,arguments)}},s=function(e,t,n){var u,c,l,d,f=e&s.G,p=e&s.P,h=f?r:e&s.S?r[t]:(r[t]||{})[o],g=f?i:i[t]||(i[t]={});f&&(n=t);for(u in n)c=!(e&s.F)&&h&&u in h,c&&u in g||(l=c?h[u]:n[u],f&&"function"!=typeof h[u]?d=n[u]:e&s.B&&c?d=a(l,r):e&s.W&&h[u]==l?!function(e){d=function(t){return this instanceof e?new e(t):e(t)},d[o]=e[o]}(l):d=p&&"function"==typeof l?a(Function.call,l):l,g[u]=d,p&&((g[o]||(g[o]={}))[u]=l))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,e.exports=s},,function(e,t,n){"use strict";function r(e){"number"==typeof e&&(e="v"+e);var t=h[e];t||(i.error("binaryProtocol unknown version: "+e)(),a.upload("bp_unknown_version",!0)["finally"](function(){return o.hardRefresh()}));var n=t.OutputStream,r=new t.Writer(t.Dictionary),s=t.InputStream,u=new t.Reader(t.Dictionary),c=t.Crypto;this.Node=t.Node,this.read=function(e){var t;try{var n=new s(c.decrypt(e));t=u.readNode(n)}catch(r){i.errorVerbose("binaryProtocol:read error "+r.stack)()}return t},this.write=function(e){var t;try{var o=new n;r.writeNode(o,e),t=c.encrypt(o.toBuffer())}catch(a){i.errorVerbose("binaryProtocol:write error "+a.stack)()}return t}}var i=n(1),o=n(17),a=n(12),s={OutputStream:n(365),Writer:n(367),InputStream:n(363),Reader:n(366),Dictionary:n(362),Node:n(364),Crypto:n(361)},u={OutputStream:n(51),Writer:n(110),InputStream:n(49),Reader:n(109),Dictionary:n(368),Node:n(50),Crypto:n(48)},c={OutputStream:n(51),Writer:n(110),InputStream:n(49),Reader:n(109),Dictionary:n(369),Node:n(50),Crypto:n(48)},l={OutputStream:n(51),Writer:n(110),InputStream:n(49),Reader:n(109),Dictionary:n(166),Node:n(50),Crypto:n(48)},d={OutputStream:n(51),Writer:n(112),InputStream:n(49),Reader:n(111),Dictionary:n(166),Node:n(50),Crypto:n(48)},f={OutputStream:n(51),Writer:n(112),InputStream:n(49),Reader:n(111),Dictionary:n(370),Node:n(50),Crypto:n(48)},p={OutputStream:n(51),Writer:n(112),InputStream:n(49),Reader:n(111),Dictionary:n(371),Node:n(50),Crypto:n(48)},h={"01":s,"03":u,"04":c,"05":l,"06":d,v1:l,v2:d,v3:f,v4:p};e.exports=r},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports={}},,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&_.isFunction(e.isMounted)&&e.isMounted()?o.findDOMNode(e):null}function i(e,t){var n;return e&&t&&(n=r(e.component))&&n.contains(t)}var o=n(30),a=n(9),s=n(45),u={TOOLTIP:"tooltip",MENU:"menu",MODAL:"modal",EMOJI:"emoji",DRAWER_LEFT:"drawer_left",DRAWER_MID:"drawer_mid",DRAWER_RIGHT:"drawer_right",PTT:"ptt_recorder",MAIN:"main",CONVERSATION_FOOTER:"conversation_footer",MEDIA_VIEWER:"media_viewer",STATUS_INPUT:"status_input",ADVANCED_INPUT:"advanced_input",SUBJECT_INPUT:"subject_input",COMPOSE_INPUT:"compose_input",CAPTION_INPUT:"caption_input",CONTACT_SEARCH:"contact_search",CHAT_SEARCH:"chat_search",CHATLIST_PANEL:"chatlist_panel",IGNORE_ANY:"any",IGNORE_CONTEXT:"contextmenu",_stack:[],_base:null,_events:!1,push:function(e,t){var n,r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];(n=this.find(t))&&(this._stack=_.without(this._stack,n)),n={component:e,type:t,popable:!!r.popable,escapable:!!r.escapable||!!r.popable,maintainFocus:!!r.maintainFocus,parent:r.parent},this._stack.push(n),this._listeners(),this._focus()},pop:function(e,t){if(this._stack.length){var n;if(e?n=this.find(e):(n=_.last(this._stack),n=n.popable?n:null),n){var r=this._deps(n.component);r.push(n),this._close(r,t)}}},popDependents:function(e){this._close(this._deps(e))},stealFocus:function(e){for(var t,n=function(t){return t.maintainFocus&&t.type!==e};t=_.find(this._stack,n);){var r=this._deps(t.component);r.push(t),this._close(r)}},_close:function(e,t){if(!_.isEmpty(e)){var n=this._stack;e.forEach(function(e){e.index=_.findIndex(n,e)}),e=e.sort(function(e,t){return t.index-e.index});var o=_.findLast(e,"parent"),a=this,s=document.activeElement;e.forEach(function(e){a.unregBubbleTrap(e),n=_.without(n,e),i(e,s)&&s.blur(),_.isFunction(e.component.uimClose)&&e.component.uimClose(e.type,t)}),this._stack=n,this._listeners(),document.activeElement===document.body&&(o?this.focusNodeOrParent(r(o.parent)):this._focus(t))}},focusNodeOrParent:function(e){for(;e&&_.isFunction(e.focus);){if(e.focus(),document.activeElement===e)return;e=e.parentNode}},_deps:function(e){var t=this,n=_.filter(this._stack,{parent:e});return _.flatten(n,_.chain(n).pluck("component").map(function(e){return t._deps(e)}).value())},top:function(){return _.last(this._stack)||this._base},find:function(e){return _.find(this._stack,{type:e})},_listeners:function(){var e=this.top();e&&e.popable?this.regListeners():this.unregListeners()},_focus:function(e){var t=this.top();t&&_.isFunction(t.component.uimFocus)&&t.component.isMounted()&&t.component.uimFocus(t.type,e)},regListeners:function(){this._events||(window.addEventListener("DOMMouseScroll",this.maybePreventDefault,!0),window.addEventListener("mousewheel",this.maybePreventDefault,!0),a.on("window_mousedown",this.onMouseDown),window.addEventListener("resize",this.onResize,!0),this._events=!0)},unregListeners:function(){this._events&&(window.removeEventListener("DOMMouseScroll",this.maybePreventDefault,!0),window.removeEventListener("mousewheel",this.maybePreventDefault,!0),a.off("window_mousedown",this.onMouseDown),window.removeEventListener("resize",this.onResize,!0),this._events=!1)},regBubbleTrap:function(e){var t=r(e.parent);t&&(t.addEventListener("click",this.stopEvent),t.addEventListener("contextmenu",this.stopEvent))},unregBubbleTrap:function(e){var t=r(e.parent);t&&(t.removeEventListener("click",this.stopEvent),t.removeEventListener("contextmenu",this.stopEvent))},stopEvent:function(e){e.preventDefault(),e.stopPropagation()},maybePreventDefault:function(e){return i(this.top(),e.target)?!0:(e.preventDefault(),void e.stopPropagation())},maintainFocus:function(e){var t=_.findLast(this._stack,"maintainFocus");t&&t.component.uimFocus&&(i(t,e.target)||(e.preventDefault(),t.component.uimFocus()))},onMouseDown:function(e){this.unregEatClick();var t=e.target,n=_.last(this._stack);if(i(n,t))return void this.maintainFocus(e);var r="click";e.button>0&&(r="contextmenu");for(var o=!0;t!==document;){var a=t.getAttribute("data-ignore-capture");
if(a){if(a===u.IGNORE_ANY||a===r){o=!1;break}break}t=t.parentNode}this.pop(),this.maintainFocus(e),o&&this.regEatClick()},regEatClick:function(){a.on("window_click",this.onClick),a.on("window_mousedown",this.unregEatClick)},unregEatClick:function(){a.off("window_click",this.onClick),a.off("window_mousedown",this.unregEatClick)},onClick:function(e){s.isGecko&&"click"===e.type&&e.button>0||(this.unregEatClick(),e.defaultPrevented||(e.preventDefault(),e.stopPropagation()))},onResize:function(e){for(var t=this.top();t&&t.popable;)this.pop(),t=this.top()}};"maybePreventDefault stopEvent onMouseDown regEatClick unregEatClick onClick onResize".split(/ /).forEach(function(e){u[e]=u[e].bind(u)}),window.addEventListener("keydown",function(e){if(27===e.keyCode){e.stopPropagation(),e.preventDefault();var t=_.last(u._stack);t&&t.escapable&&u.pop(t.type)}}),e.exports=u},function(e,t,n){"use strict";var r=n(9),i={getCmds:function(){return this._cmds||(this._cmds=[]),this._cmds},regCmd:function(e,t){if(!_.isFunction(t))throw Error("handler is not a function");this.getCmds().push({cmd:e,handler:t}),this.isMounted()&&r.on(e,t)},unregCmd:function(e,t){r.off(e,t),this._cmds=_.reject(this._cmds,_.matches({cmd:e,handler:t}))},registerCmds:function(){this._cmds&&this.getCmds().forEach(function(e){r.on(e.cmd,e.handler)})},unregisterCmds:function(){this._cmds&&(this.getCmds().forEach(function(e){r.off(e.cmd,e.handler)}),delete this._cmds)},componentDidMount:function(){this.registerCmds()},componentWillUnmount:function(){this.unregisterCmds()}};e.exports=i},function(e,t){"use strict";function n(){this.proto=[0,0],this.F=_(r).flatten().map(_.keys).flatten().concat(_.keys(i)).uniq().map(function(e){return[e,e]}).zipObject().value()}var r=[[{RESEND_ICON:!1},{},{},{FORWARD_MESSAGE:!0},{SET_STATUS:!0,SET_PROFILE_PIC:!0,SET_BLOCK:!0,MUTE:!0,ARCHIVE:!0,ARCHIVE_BROADCAST:!0,DELETE:!0,GROUP_CREATE:!0,GROUP_EXIT:!0,GROUP_SET_SUBJECT:!0,GROUP_SET_PIC:!0,GROUP_ADD_PARTICIPANT:!0,GROUP_REMOVE_PARTICIPANT:!0,GROUP_PROMOTE_PARTICIPANT:!0},{RECENT_EMOJI_SYNC:!0,MESSAGE_DELETE:!0,CHAT_MARK_UNSEEN:!0,MESSAGE_INFO:!0},{},{MUTE_1_1:!0,MEDIA_RETRY:!0},{}]],i={KEY_PARTICIPANT:!1,MEDIA_RETRY:!1,STARRED:!1,DOCUMENT:!1,URL:!1};n.prototype={setVersion:function(e){if(this.proto.length!==e.length||this.proto[0]!==e[0]||this.proto[1]!==e[1]){this.proto=e;var t=r.slice(0,e[0]+1),n=r.slice(e[0]+1,r.length),i=t[e[0]],o=i.slice(0,e[1]+1),a=i.slice(e[1]+1,i.length);t[e[0]]=o,n.unshift(a),this.features=_.merge(_.omit(_.merge.apply(_,[{}].concat(_.flatten(t))),function(e){return!e}),this.features||{});var s=_.merge.apply(_,[{}].concat(_.flatten(n)));this.features=_.omit(this.features,function(e,t){return!!s[t]}),this.VF=_(_.keys(_.merge.apply(_,[{}].concat(_.flatten(t))))).map(function(e){return[e,e]}).zipObject().value()}},setPlatform:function(e){switch(e){case"iphone":this.features.RECENT_EMOJI_SYNC=!1,this.features.ARCHIVE_BROADCAST=!1,this.features.RESEND_ICON=!0;break;case"symbian":case"s40":case"bb":this.features.CHAT_MARK_UNSEEN=!1}},setFeature:function(e,t){var n=this.features[e]!==t;return this.features[e]=t,n},setFeatures:function(e){var t={},n=_.merge({},i,e);for(var r in n)r in this.VF||(t[r]=this.setFeature(r,!!n[r]));return t},supportsFeature:function(e){return!!this.features[e]},lt:function(e){var t=this.proto;return e[0]>t[0]||e[0]===t[0]&&e[1]>t[1]},lte:function(e){var t=this.proto;return e[0]>t[0]||e[0]===t[0]&&e[1]>=t[1]},gt:function(e){var t=this.proto;return e[0]<t[0]||e[0]===t[0]&&e[1]<t[1]},gte:function(e){var t=this.proto;return e[0]<t[0]||e[0]===t[0]&&e[1]<=t[1]}};var o=new n;e.exports=o},function(e,t){"use strict";function n(e,t,n,r){var i;return i=0===e?n||0:Math.pow(2,e),_.isFinite(t)&&i>t&&(i=t),_.isFinite(n)&&n>i&&(i=n),r&&(i*=1+r*Math.random()),i}e.exports={expBackoff:n}},function(e,t,n){"use strict";var r=n(46),i={listenTo:function(e,t,n){if(!_.isObject(e))throw Error("obj is not an object");if(_.isObject(t));else if(!_.isFunction(n))throw Error("callback is not a function");r.listenTo.apply(this,arguments)},listenToOnce:function(e,t,n){if(!_.isObject(e))throw Error("obj is not an object");if(_.isObject(t));else if(!_.isFunction(n))throw Error("callback is not a function");r.listenToOnce.apply(this,arguments)}};e.exports=i},function(e,t){"use strict";function n(){this.cancel(),this.foo.apply(this.context,arguments)}var r=function(){1===arguments.length?(this.context=null,this.foo=arguments[0]):(this.context=arguments[0],this.foo=arguments[1]),this.timer=0,this.ts=0,this._before=0,this._after=0,this.trigger=n.bind(this)};r.prototype={before:function(e){var t=e+Date.now(),n=this.ts;return this._before&&this._before<t?n:this._after&&t<this._after?n:(this._before=t,(!n||n>t)&&(arguments[0]=t,n=this.set.apply(this,arguments)),n)},after:function(e){var t=e+Date.now(),n=this.ts;return this._after&&this._after>t?n:this._before&&t>this._before?n:(this._after=t,(!n||n>t)&&(arguments[0]=t,n=this.set.apply(this,arguments)),n)},debounce:function(e){return arguments[0]=e+Date.now(),this.set.apply(this,arguments)},debounceAndCap:function(e,t){if(arguments.length<=2)this.debounce(e),this.before(t);else{for(var n=new Array(arguments.length-1),r=2;r<arguments.length;r++)n[r-1]=arguments[r];n[0]=e,this.debounce.apply(this,n),n[0]=t,this.before.apply(this,n)}},set:function(e){for(var t=this,r=arguments.length,i=Array(r>1?r-1:0),o=1;r>o;o++)i[o-1]=arguments[o];var a=Date.now();if(e=Math.max(e,a),this._before&&this._before<e||this._after&&this._after>e)return this.ts;this.timer&&clearTimeout(this.timer);var s=e-a;return this.timer=i.length>0?setTimeout(function(){n.apply(t,i)},s):setTimeout(this.trigger,s),this.ts=e},cancel:function(){this.timer&&(clearTimeout(this.timer),this.timer=0,this.ts=0,this._before=0,this._after=0)}},e.exports=r},function(e,t,n){var r=n(114);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(85)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(16).setDesc,i=n(116),o=n(25)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r=n(176),i=n(115);e.exports=function(e){return r(i(e))}},,,,,,,,,,,,function(e,t,n){e.exports={"default":n(400),__esModule:!0}},,function(e,t,n){"use strict";var r=n(46),i={componentWillMount:function(){this._observer=r.createEmitter()},getInitialState:function(){return{_observedStateIndex:0}},addObserver:function(e,t,n){if(!this._isObservable(e))throw Error("Attempting to observe non-observable object");this._observer.listenTo(e,t,this._cbWrapper(n)),e.isState&&e._uiObservers++},addObserverAndRun:function(e,t,n){this.addObserver(e,t,n);var r=this._cbWrapper(n);r(e,t)},removeObserver:function(e,t){if(!this._isObservable(e))throw Error("Attempting to observe non-observable object");this._observer.stopListening(e,t),e.isState&&e._uiObservers--},_cbWrapper:function(e){var t=this;return function(){return t.isMounted()?_.isFunction(e)?e.apply(t,arguments):t.setState({_observedStateIndex:t.state._observedStateIndex+1}):void 0}},_isObservable:function(e){return e?_.isFunction(e.trigger):!1},componentWillUnmount:function(){var e=this._observer._listeningTo;for(var t in e){var n=e[t];n.isState&&n._uiObservers--}this._observer.stopListening()}};e.exports=i},function(e,t,n){"use strict";var r=n(1),i=n(161),o={_nativeEventSafeIsMounted:function(){return this.isMounted()&&"UNMOUNTING"!==this._compositeLifeCycleState},getEvents:function(){return this._events||(this._events=[]),this._events},regNativeListener:function(e,t,n,r){if(!_.isFunction(n))throw Error("handler is not a function");t=i.prefix(t,e);var o=this,a=function(){return o._nativeEventSafeIsMounted()?n.apply(null,arguments):void 0};this.getEvents().push({src:e,evnt:t,handler:n,fn:a,capture:r}),this.isMounted()&&e.addEventListener(t,a,r)},unregNativeListener:function(e,t,n,o){t=i.prefix(t,e);var a=_.matches({src:e,evnt:t,handler:n,capture:o}),s=_.find(this.getEvents(),a);s?(this._events=_.without(this._events,s),s.src.removeEventListener(s.evnt,s.fn,s.capture)):r.error("nativeEventMixin:unregNativeListener unreg could not find event:"+t)()},unregisterListeners:function(){this._events&&(this.getEvents().forEach(function(e){e.src.removeEventListener(e.evnt,e.fn,e.capture)}),delete this._events)},componentDidMount:function(){this._events&&this.getEvents().forEach(function(e){e.src.addEventListener(e.evnt,e.fn,e.capture)})},componentWillUnmount:function(){this.unregisterListeners()}};e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(158),o=r(i),a=n(3),s=r(a),u=n(30),c=n(6),l=n(1),d=n(388),f=n(9),p=n(547),h=c.createClass({displayName:"VelocityTransitionGroupChild",propTypes:{transitionName:c.PropTypes.string.isRequired,delay:c.PropTypes.number},_getTransition:function(){return d[this.props.transitionName]||l.log("TransitionName "+this.props.transitionName+" wasn't found in VelocityTransitionGroupChild transitions.")(),d[this.props.transitionName]||d["default"]},componentWillEnter:function(e){var t=this._getTransition();this.animateTransitions(t.enter)["finally"](this._cbWrapper(e))},componentWillLeave:function(e){var t=this._getTransition();this.animateTransitions(t.leave)["finally"](this._cbWrapper(e))},_cbWrapper:function(e){var t=this;return function(){return t.isMounted()&&_.isFunction(e)?e():void 0}},animateTransitions:function(e){var t=this._getTransition();if(!t||!e)return s["default"].resolve();var n=u.findDOMNode(this),r=this.props.delay,i=_.omit(t,"leave","enter"),o={},a=c.Children.only(this.props.children);e=_.filter(_.forceArray(e),function(e){if(_.isString(e.selector)||o[e.selector]){var t=n.querySelectorAll(e.selector);if(!t.length)return!1;o[e.selector]=t}return!0}),a.props.staggerDelay||r||_.forEach(e,function(e){if(!e.delay&&!i.delay){var t=e.selector?o[e.selector]:n;_.forEach(e.props,function(e,n){_.isArray(e)&&Velocity.hook(t,n,e[1])})}}),f.setUiBusy(!0);var d=this;return s["default"].map(e,function(e){var t=e.selector?o[e.selector]:n,u=Velocity(t,e.props,{easing:e.easing||i.easing||"easeInSine",duration:e.duration||i.duration||0,delay:a.props.staggerDelay||r||e.delay||i.delay||0,queue:i.queue||!1,stagger:e.stagger||!1,drag:e.drag||!1});return u?u.then(function(){i.cleanOnComplete&&(_.isArray(t)?_.forEach(t,function(e){e.removeAttribute("style")}):t.removeAttribute("style"))}):(l.log("VelocityTransitionGroup:animationTransitions:error "+d.props.transitionName)(),s["default"].resolve())})["finally"](function(){f.setUiBusy(!1)})},componentWillUnmount:function(){var e=u.findDOMNode(this);Velocity(e,"stop")},render:function(){return c.Children.only(this.props.children)}}),g=c.createClass({displayName:"VelocityTransitionGroup",propTypes:{transitionName:c.PropTypes.string.isRequired,delay:c.PropTypes.number},_wrapChild:function(e){return c.createElement(h,{delay:this.props.delay,transitionName:this.props.transitionName},e)},render:function(){return c.createElement(p,(0,o["default"])({childFactory:this._wrapChild},this.props))}});e.exports=g},function(e,t,n){"use strict";function r(){switch(d.state){case d.STATE.TIMEOUT:return v.TIMEOUT;case d.STATE.OPENING:return d.online?v.OPENING:v.OFFLINE;case d.STATE.PAIRING:return d.hasSynced?v.RESUMING:v.PAIRING;case d.STATE.CONNECTED:return d.stream!==d.STREAM.CONNECTED?d.hasSynced?v.NORMAL:v.SYNCING:v.NORMAL;case d.STATE.UNLAUNCHED:case d.STATE.PROXYBLOCK:default:return v.NORMAL}}function i(){if(!m.knowsPhone()&&d.state!==d.STATE.PROXYBLOCK)return b.QR;var e=d.hasSynced;switch(d.state){case d.STATE.PROXYBLOCK:return b.PROXYBLOCK;case d.STATE.CONFLICT:return b.CONFLICT;case d.STATE.TOS_BLOCK:return b.TOS_BLOCK;case d.STATE.UNLAUNCHED:return b.SYNCING;case d.STATE.UNPAIRED_IDLE:case d.STATE.UNPAIRED:return b.QR;case d.STATE.OPENING:if(!d.online&&!d.hasSynced)return b.OFFLINE;default:return e||d.stream===d.STREAM.CONNECTED?b.MAIN:b.SYNCING}}function o(e,t){switch(t){case y.SHOW:return e;case y.HIDE:return d.hasSynced?v.NORMAL:v.CONNECTING;case y.OBSCURE:switch(e){case v.OPENING:case v.PAIRING:case v.SYNCING:case v.RESUMING:return v.CONNECTING;default:return e}}}var a=n(8),s=n(1),u=n(59),c=n(47),l=n(151),d=n(14),f=n(11),p=n(35),h=n(108),g=n(83),m=n(15),v={OFFLINE:"OFFLINE",OPENING:"OPENING",PAIRING:"PAIRING",SYNCING:"SYNCING",RESUMING:"RESUMING",CONNECTING:"CONNECTING",NORMAL:"NORMAL",TIMEOUT:"TIMEOUT"},b={QR:"QR",MAIN:"MAIN",SYNCING:"SYNCING",OFFLINE:"OFFLINE",CONFLICT:"CONFLICT",PROXYBLOCK:"PROXYBLOCK",TOS_BLOCK:"TOS_BLOCK"},y={SHOW:"SHOW",OBSCURE:"OBSCURE",HIDE:"HIDE"},w=3e3,E=u.extend({extraProperties:"reject",session:{info:{type:"string",values:_.values(v),"default":v.NORMAL},obscurity:{type:"string",values:_.values(y),"default":y.HIDE},mode:{type:"string",values:_.values(b),"default":b.SYNCING},needsUpdate:"boolean",couldForce:"boolean",uiActive:"boolean",available:["boolean",!1,!0],unavailableShiftTimer:"object",unobscureShiftTimer:"object",timeoutEvent:"object",resumeCount:{type:"number","default":0},phoneActive:"boolean",phoneAuthed:["boolean",!1,!1]},derived:{displayInfo:{deps:["info","obscurity"],fn:function(){return o(this.info,this.obscurity)}}},initialize:function(){this.unavailableShiftTimer=new g(this,this.markUnavailable),this.unobscureShiftTimer=new g(this,this.unobscure),this.listenTo(d,"change:state change:stream change:hasSynced change:online",this.onSocketUpdate),this.listenTo(this,"change:available",this.onAvailableUpdate),this.listenTo(this,"change:phoneAuthed",this.onPhoneAuthedUpdate),this.listenTo(this,"change:info change:displayInfo change:mode",_.debounce(this.onSelfUpdate)),this.listenTo(this,"change:info",this.logPageResume),this.listenTo(this,"change:info",this.updateWamLog),this.listenTo(this,"change:available change:uiActive",this.updateCouldForce.bind(this,!1)),document.addEventListener("visibilitychange",this.updateCouldForce.bind(this,!1)),this.updateCouldForce(!1)},"delete":function(){},INFO:v,MODE:b,handle:function(e){switch(e[0]){case"awake":this.phoneActive=!1,this.phoneActive=!0;break;case"asleep":this.phoneActive=!1;break;case"update":h.update(e[1],e[2]);break;default:s.error("Stream:handle unknown cmd "+e[0],e)()}},markAvailable:function(){this.unavailableShiftTimer.cancel(),this.available=!0},markUnavailable:function(e){e?this.unavailableShiftTimer.before(e):(this.unavailableShiftTimer.cancel(),this.available=!1)},onSelfUpdate:function(){var e=this.timeoutEvent;this.info===v.TIMEOUT?(e||(this.timeoutEvent=e=new c.WebcPhoneDisconnected),this.displayInfo!==v.TIMEOUT||e._bbarTime||(e._bbarTime=Date.now())):e&&(e.markWebcPhoneDisconnectedT(),e._bbarTime&&(e.webcPhoneBbarShownT=Date.now()-e._bbarTime),e.commit(),this.timeoutEvent=null),s.log("Stream:onSelfUpdate mode:"+this.mode+(" info:"+this.info+" view:"+this.displayInfo))()},onSocketUpdate:function(){var e={},t=d.previousAttributes();t.stream!==d.stream&&d.stream===d.STREAM.DISCONNECTED&&(e.phoneActive=!1);var n=r();if(e.info=n,e.mode=i(),e.phoneAuthed=d.stream!==d.STREAM.DISCONNECTED,n===v.NORMAL)this.unobscureShiftTimer.cancel(),e.obscurity=y.HIDE;else if(n===v.OFFLINE)this.unobscureShiftTimer.cancel(),e.obscurity=y.OBSCURE;else switch(this.obscurity){case y.HIDE:this.unobscureShiftTimer.before(a.DIAGNOSTIC_DELAY);break;case y.OBSCURE:this.unobscureShiftTimer.before(w);break;case y.SHOW:}this.set(e)},unobscure:function(){this.obscurity=y.SHOW},onPhoneAuthedUpdate:function(){this.phoneAuthed&&(this.sendAvailability(!0),Store.RecentEmoji.sync())},onAvailableUpdate:function(){s.log("Stream:onAvailableUpdate user "+(this.available?"available":"unavailable"))(),this.sendAvailability(!1)},sendAvailability:function(e){(e||this.uiActive)&&(this.available?p.sendPresenceAvailable()["catch"](f.WapDrop,_.noop):p.sendPresenceUnavailable()["catch"](f.WapDrop,_.noop))},updateCouldForce:function(){this.couldForce=!this.uiActive||!this.available&&document.hidden},logPageResume:function(){this.info===v.RESUMING&&(this.resumeCount++,new c.WebcPageResume({webcResumeCount:this.resumeCount}).commit())},updateWamLog:function(){var e=this.info===v.NORMAL;l.streamInfoChange(this.info,d.socketSequence,e),e&&this.stopListening(null,"change:info",this.updateWamLog)}});e.exports=new E},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n,r,i){var o=new XMLHttpRequest,a=new l["default"](function(a,s){o.onload=function(e){4===o.readyState?a(o):s(e)},o.onerror=s,o.ontimeout=s,o.onprogress=i,o.onabort=s,n instanceof FormData?(o.open(t||f.POST,e,!0),r&&(o.responseType=r),o.send(n)):n instanceof Object?(e=d.build(e,n),o.open(t||f.GET,e,!0),r&&(o.responseType=r),o.send()):(o.open(t||f.GET,e,!0),r&&(o.responseType=r),o.send())});return a.cancellable()["catch"](l["default"].CancellationError,function(){o.abort()})}function o(e,t){return i(e,f.GET,null,t)}function a(e,t){return i(e,f.POST,t)}function s(e){return i(e,f.HEAD)}function u(e){return window.jsonp||(window.jsonp={}),new l["default"](function(t,n){var r=_.uniqueId("jsonp_");e+="&JsonType=callback&JsonCallback="+r;var i=document.createElement("script");i.type="text/javascript",i.src=e,i.onerror=function(e){delete window.jsonp[r],document.head.removeChild(i),n(e)},window.jsonp[r]=function(e){delete window.jsonp[r],document.head.removeChild(i),t(e)},document.head.appendChild(i)})}var c=n(3),l=r(c),d=n(41),f={GET:"GET",POST:"POST",HEAD:"HEAD",PUT:"PUT"},p={BLOB:"blob",ARRAY_BUFFER:"arraybuffer"};e.exports={head:s,get:o,post:a,request:i,jsonp:u,VERB:f,RESP_TYPE:p}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){this.Type=g,this.Mode=m,this.pendingUpdate=void 0,this.pendingHardRefreshTimer=void 0,this.mode=m.IDLE,this.appcacheVersion=u.VERSION_STR}var o=n(3),a=r(o),s=n(160),u=n(8),c=n(36),l=n(1),d=n(46),f=n(82),p=n(11),h=n(81),g={SILENT:"silent",SOFT:"soft",HARD:"hard"},m={IDLE:"idle",REFRESHING:"refreshing",PENDING_REFRESH:"pending_refresh"};i.prototype.update=function(e,t){var r=this;l.log("AppUpdate:update: "+e+" current: "+this.appcacheVersion+" latest: "+t)();var i=void 0;if(_.isNumber(e))i=g.HARD;else if(e)i=g.SOFT;else{if(this.appcacheVersion===t)return;i=g.SILENT}var o=i===g.HARD?Date.now()+e:void 0;return this.clearHardRefresh(),i===g.HARD&&this.setMode(m.REFRESHING),this._update(t).then(function(e){var t=n(17);i!==g.SILENT&&(Store.Stream.needsUpdate=e),i===g.HARD&&(r.setMode(m.PENDING_REFRESH),r.pendingHardRefreshTimer=s.setTimeout(function(){t.hardRefresh(!0),r.clearHardRefresh()},o),r.listenTo(Store.Stream,"change:couldForce",function(){t.hardRefresh(!0),r.clearHardRefresh()}))})},i.prototype.setMode=function(e){this.mode=e,this.trigger("change:mode",e)},i.prototype._update=function(e){return this.appcacheVersion!==e&&window.applicationCache&&window.applicationCache.status!==window.applicationCache.UNCACHED?this.pendingUpdate||this.fetch(e).then(function(){return window.applicationCache.status===window.applicationCache.UPDATEREADY?(l.info("Updater:handleUpdate:ApplicationCacheSuccess")(),!0):(l.log("Updater:handleUpdate:ApplicationNoUpdate")(),!1)})["catch"](function(e){return l.error("Updater:handleUpdate:ApplicationCacheError "+e)(e),!1}):a["default"].resolve(this.appcacheVersion!==e)},i.prototype.clearHardRefresh=function(){this.setMode(m.IDLE),this.pendingHardRefreshTimer&&(s.clearTimeout(this.pendingHardRefreshTimer),this.pendingHardRefreshTimer=void 0),this.stopListening(Store.Stream,"change:couldForce")},i.prototype.restart=function(){var e=n(17);e.hardRefresh()},i.prototype.fetch=function(e){var t=this;return this.pendingUpdate=c.loopOnError(p.ShouldLoop,function(n){return a["default"].delay(1e3*h.expBackoff(n,120,1,.1)).then(function(){return new a["default"](function(n,r){function i(){window.applicationCache.removeEventListener("updateready",a),window.applicationCache.removeEventListener("error",s),window.applicationCache.removeEventListener("noupdate",o)}function o(){i(),u.appcacheVersion=e,n()}function a(){i(),u.appcacheVersion=e,n()}function s(e){i(),r(new p.ShouldLoop("AppCache Error. Retrying..."))}var u=t;window.applicationCache.addEventListener("updateready",a),window.applicationCache.addEventListener("error",s),window.applicationCache.addEventListener("noupdate",o),(window.applicationCache.status===window.applicationCache.IDLE||window.applicationCache.status===window.applicationCache.UPDATEREADY)&&window.applicationCache.update()})})})["finally"](function(){t.pendingUpdate=void 0})},e.exports=new i,_.extend(e.exports,d,f)},function(e,t,n){"use strict";function r(e){var t=e.singleByte,n=e.doubleByte,r=e.nibbleDecode;this.readNode=function(e){var t=e.readByte(),n=this.readListSize(e,t);if(t=e.readByte(),t===i.STREAM_END)throw new Error("unexpected stream end "+e.debugInfo());var r=this.readString(e,t);if(0===n||!r)throw new Error("invalid node. 0 list or empty tag"+e.debugInfo());var o=n-2+n%2>>1,a=this.readAttributes(e,o);if(n%2===1)return[r,a,void 0];var s;if(t=e.readByte(),this.isListTag(t))s=this.readList(e,t);else if(t===i.BINARY_8){var u=e.readByte();s=e.readBytes(u)}else if(t===i.BINARY_20){var c=e.readInt20();s=e.readBytes(c)}else if(t===i.BINARY_32){var l=e.readInt32();s=e.readBytes(l)}else s=this.readString(e,t);return[r,a,s]},this.isListTag=function(e){return e===i.LIST_EMPTY||e===i.LIST_8||e===i.LIST_16},this.readListSize=function(e,t){if(t===i.LIST_EMPTY)return 0;if(t===i.LIST_8)return e.readByte();if(t===i.LIST_16)return e.readInt16();throw new Error("invalid list size "+e.debugInfo())},this.readString=function(e,t){if(-1===t)throw new Error("invalid start token readString"+e.debugInfo());if(t>2&&236>t){var n=this.getToken(t);return"s.whatsapp.net"===n&&(n="c.us"),n}switch(t){case i.DICTIONARY_0:case i.DICTIONARY_1:case i.DICTIONARY_2:case i.DICTIONARY_3:var r=e.readByte();return this.getTokenDouble(t-i.DICTIONARY_0,r);case i.LIST_EMPTY:return;case i.BINARY_8:return e.readString(e.readByte());case i.BINARY_20:return e.readString(e.readInt20());case i.BINARY_32:return e.readString(e.readInt32());case i.JID_PAIR:var o=this.readString(e,e.readByte()),a=this.readString(e,e.readByte());if("undefined"!=typeof o&&"undefined"!=typeof a)return o+"@"+a;if("undefined"!=typeof a)return a;throw new Error("invalid jid "+o+","+a+" "+e.debugInfo());case i.NIBBLE_8:return this.nibblesToBytes(e);default:throw new Error("invalid string "+e.debugInfo())}},this.getToken=function(e){var n;if(e>=0&&e<t.length&&(n=t[e]),"undefined"==typeof n)throw new Error("invalid token "+e);return n},this.getTokenDouble=function(e,t){var r,i=256*e+t;if(i>=0&&i<n.length&&(r=n[i]),"undefined"==typeof r)throw new Error("invalid double byte token "+e+" "+t);return r},this.readAttributes=function(e,t){for(var n,r,i=t?{}:void 0,o=0;t>o;o++)n=this.readString(e,e.readByte()),r=this.readString(e,e.readByte()),i[n]=r;return i},this.readList=function(e,t){for(var n=[],r=this.readListSize(e,t),i=0;r>i;i++)n.push(this.readNode(e));return n},this.nibblesToBytes=function(e){for(var t=e.readByte(),n=t>>7,r=127&t,i="",o=0;r>o;o++){var a=e.readByte(),s=this.unpackBytePair(a);i+=s[0],i+=s[1]}return n&&(i=i.substring(0,i.length-1)),i},this.unpackBytePair=function(e){var t=(240&e)>>4,n=15&e;if(!r.hasOwnProperty(t))throw new Error("invalid nibble to unpack: "+t);if(!r.hasOwnProperty(n))throw new Error("invalid nibble to unpack: "+n);var i=r[t],o=r[n];return[i,o]},this.bytesToString=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t}}var i=n(165);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t,n={},r=e.nibbleEncode;for(t=0;t<e.singleByte.length;t++)e.singleByte[t]&&(n[e.singleByte[t]]=t);for(t=0;t<e.doubleByte.length;t++)e.doubleByte[t]&&(n[e.doubleByte[t]]=t+c.SINGLE_BYTE_MAX);this.writeNode=function(e,t){if(t){if(3!==t.length)throw new Error("invalid node");var n=t[1]?2*(0,a["default"])(t[1]).filter(function(e){return!!t[1][e]}).length:0;this.writeListStart(e,1+n+(t[2]?1:0)),this.writeString(e,t[0]),this.writeAttributes(e,t[1]),this.writeChildren(e,t[2])}},this.writeString=function(e,t,r){if("string"!=typeof t)throw new Error("invalid string");var i,o,a=n[t];if("c.us"!==t||r)if("undefined"==typeof a){var s=t.indexOf("@");if(1>s)this.writeStringRaw(e,t);else{var u=t.substring(0,s),l=t.substring(s+1);this.writeJid(e,u,l)}}else{if(a<c.SINGLE_BYTE_MAX)this.writeToken(e,a);else{var d=a-c.SINGLE_BYTE_MAX,f=d>>8;switch(o=d%256,f){case 0:i=c.DICTIONARY_0;break;case 1:i=c.DICTIONARY_1;break;case 2:i=c.DICTIONARY_2;break;case 3:i=c.DICTIONARY_3;break;default:throw new Error("double byte dictionary token out of range: "+t+" "+a)}}this.writeToken(e,i),this.writeToken(e,o)}else this.writeToken(e,n["s.whatsapp.net"])},this.writeStringRaw=function(e,t){var n=u.calculateUTF8Bytes(t);if(n>=4294967296)throw new Error("string too large to encode (len = "+n+"): "+t);n>=1<<20?(e.pushByte(c.BINARY_32),e.pushInt32(n)):n>=256?(e.pushByte(c.BINARY_20),e.pushInt20(n)):(e.pushByte(c.BINARY_8),e.pushByte(n)),e.pushString(t)},this.writeJid=function(e,t,n){if(e.pushByte(c.JID_PAIR),t)try{this.writeNibbles(e,t)}catch(r){s.warnVerbose("writer:encode-fallback "+r.message,t)(),this.writeString(e,t)}else this.writeToken(e,c.LIST_EMPTY);this.writeString(e,n)},this.writeToken=function(e,t){if(245>t)e.pushByte(t);else if(500>=t)throw new Error("invalid token")},this.writeAttributes=function(e,t){if(t)for(var n in t)t[n]&&(this.writeString(e,n),this.writeString(e,t[n]))},this.writeChildren=function(e,t){var n;if(t)if("string"==typeof t)this.writeString(e,t,!0);else if(u.isByteBuffer(t)){if(n=t.limit,n>=4294967296)throw new Error("invalid children; too long (len = "+n);n>=1<<20?(e.pushByte(c.BINARY_32),e.pushInt32(n)):n>=256?(e.pushByte(c.BINARY_20),e.pushInt20(n)):(e.pushByte(c.BINARY_8),e.pushByte(n)),e.pushBytes(t)}else{if(!_.isArray(t))throw new Error("invalid children");n=t.length,this.writeListStart(e,n);for(var r=0;n>r;r++)this.writeNode(e,t[r])}},this.writeListStart=function(e,t){0===t?e.pushByte(c.LIST_EMPTY):256>t?(e.pushByte(c.LIST_8),e.pushByte(t)):(e.pushByte(c.LIST_16),e.pushInt16(t))},this.writeNibbles=function(e,t){var n=u.calculateUTF8Bytes(t);if(n>c.NIBBLE_MAX)throw new Error("too many bytes to nibble-encode: len = "+n);var r,i=Math.ceil(n/2),o=[],a=0;n%2>0&&(a=128);var s=a|i;o.push(c.NIBBLE_8),o.push(s);for(var l=Math.floor(n/2),d=0;l>d;d++)r=this.packBytePair(t[2*d],t[2*d+1]),o.push(r);a>0&&(r=this.packBytePair(t[n-1],"\x00"),o.push(r));var f=new Uint8Array(o);e.pushUint8Array(f)},this.packBytePair=function(e,t){if(!r.hasOwnProperty(e))throw new Error("invalid byte to nibble-pack: "+e);if(!r.hasOwnProperty(t))throw new Error("invalid byte to nibble-pack: "+t);var n=r[e],i=r[t];return n<<4|i}}var o=n(37),a=r(o),s=n(1),u=n(7),c=n(165);e.exports=i},function(e,t,n){"use strict";function r(e){var t=e.singleByte,n=e.doubleByte,r=e.nibbleDecode;this.readNode=function(e){var t=e.readByte(),n=this.readListSize(e,t);if(t=e.readByte(),t===i.STREAM_END)throw new Error("unexpected stream end "+e.debugInfo());var r=this.readString(e,t);if(0===n||!r)throw new Error("invalid node. 0 list or empty tag"+e.debugInfo());var o=n-2+n%2>>1,a=this.readAttributes(e,o);if(n%2===1)return[r,a,void 0];var s;if(t=e.readByte(),this.isListTag(t))s=this.readList(e,t);else if(t===i.BINARY_8){var u=e.readByte();s=e.readBytes(u)}else if(t===i.BINARY_20){var c=e.readInt20();s=e.readBytes(c)}else if(t===i.BINARY_32){var l=e.readInt32();s=e.readBytes(l)}else s=this.readString(e,t);return[r,a,s]},this.isListTag=function(e){return e===i.LIST_EMPTY||e===i.LIST_8||e===i.LIST_16},this.readListSize=function(e,t){if(t===i.LIST_EMPTY)return 0;if(t===i.LIST_8)return e.readByte();if(t===i.LIST_16)return e.readInt16();throw new Error("invalid list size "+e.debugInfo())},this.readString=function(e,t){if(-1===t)throw new Error("invalid start token readString"+e.debugInfo());if(t>2&&236>t){var n=this.getToken(t);return"s.whatsapp.net"===n&&(n="c.us"),n}switch(t){case i.DICTIONARY_0:case i.DICTIONARY_1:case i.DICTIONARY_2:case i.DICTIONARY_3:var r=e.readByte();return this.getTokenDouble(t-i.DICTIONARY_0,r);case i.LIST_EMPTY:return;case i.BINARY_8:return e.readString(e.readByte());case i.BINARY_20:return e.readString(e.readInt20());case i.BINARY_32:return e.readString(e.readInt32());case i.JID_PAIR:var o=this.readString(e,e.readByte()),a=this.readString(e,e.readByte());if("undefined"!=typeof o&&"undefined"!=typeof a)return o+"@"+a;if("undefined"!=typeof a)return a;throw new Error("invalid jid "+o+","+a+" "+e.debugInfo());case i.NIBBLE_8:case i.HEX_8:return this.readPacked8(t,e);default:throw new Error("invalid string "+e.debugInfo())}},this.getToken=function(e){var n;if(e>=0&&e<t.length&&(n=t[e]),"undefined"==typeof n)throw new Error("invalid token "+e);return n},this.getTokenDouble=function(e,t){var r,i=256*e+t;if(i>=0&&i<n.length&&(r=n[i]),"undefined"==typeof r)throw new Error("invalid double byte token "+e+" "+t);return r},this.readAttributes=function(e,t){for(var n,r,i=t?{}:void 0,o=0;t>o;o++)n=this.readString(e,e.readByte()),r=this.readString(e,e.readByte()),i[n]=r;return i},this.readList=function(e,t){for(var n=[],r=this.readListSize(e,t),i=0;r>i;i++)n.push(this.readNode(e));return n},this.readPacked8=function(e,t){for(var n=t.readByte(),r=n>>7,i=127&n,o="",a=0;i>a;a++){var s=t.readByte();o+=this.unpackByte(e,(240&s)>>4),o+=this.unpackByte(e,15&s)}return r&&(o=o.substring(0,o.length-1)),o},this.unpackByte=function(e,t){switch(e){case i.NIBBLE_8:return this.unpackNibble(t);case i.HEX_8:return this.unpackHex(t);default:throw new Error("unpack non-nibble/hex type: "+e)}},this.unpackNibble=function(e){if(!r.hasOwnProperty(e))throw new Error("invalid nibble to unpack: "+e);return r[e]},this.unpackHex=function(e){if(e>=0&&15>=e)return e.toString(16).toUpperCase();throw new Error("invalid hex to unpack: "+e)}}var i=n(167);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t,n={},r=e.nibbleEncode;for(t=0;t<e.singleByte.length;t++)e.singleByte[t]&&(n[e.singleByte[t]]=t);for(t=0;t<e.doubleByte.length;t++)e.doubleByte[t]&&(n[e.doubleByte[t]]=t+c.SINGLE_BYTE_MAX);this.writeNode=function(e,t){if(t){if(3!==t.length)throw new Error("invalid node");var n=t[1]?2*(0,a["default"])(t[1]).filter(function(e){return!!t[1][e]}).length:0;this.writeListStart(e,1+n+(t[2]?1:0)),this.writeString(e,t[0]),this.writeAttributes(e,t[1]),this.writeChildren(e,t[2])}},this.writeString=function(e,t,r){if("string"!=typeof t)throw new Error("invalid string");var i,o,a=n[t];if("c.us"!==t||r)if("undefined"==typeof a){var s=t.indexOf("@");if(1>s)this.writeStringRaw(e,t);else{var u=t.substring(0,s),l=t.substring(s+1);this.writeJid(e,u,l)}}else{if(a<c.SINGLE_BYTE_MAX)this.writeToken(e,a);else{var d=a-c.SINGLE_BYTE_MAX,f=d>>8;switch(o=d%256,f){case 0:i=c.DICTIONARY_0;break;case 1:i=c.DICTIONARY_1;break;case 2:i=c.DICTIONARY_2;break;case 3:i=c.DICTIONARY_3;break;default:throw new Error("double byte dictionary token out of range: "+t+" "+a)}}this.writeToken(e,i),this.writeToken(e,o)}else this.writeToken(e,n["s.whatsapp.net"])},this.writeStringRaw=function(e,t){var n=u.calculateUTF8Bytes(t);if(n>=4294967296)throw new Error("string too large to encode (len = "+n+"): "+t);n>=1<<20?(e.pushByte(c.BINARY_32),e.pushInt32(n)):n>=256?(e.pushByte(c.BINARY_20),e.pushInt20(n)):(e.pushByte(c.BINARY_8),e.pushByte(n)),e.pushString(t)},this.writeJid=function(e,t,n){if(e.pushByte(c.JID_PAIR),t)try{this.writePackedBytes(e,t)}catch(r){s.warnVerbose("writer:encode-fallback "+r.message,t)(),this.writeString(e,t);
}else this.writeToken(e,c.LIST_EMPTY);this.writeString(e,n)},this.writeToken=function(e,t){if(245>t)e.pushByte(t);else if(500>=t)throw new Error("invalid token")},this.writeAttributes=function(e,t){if(t)for(var n in t)t[n]&&(this.writeString(e,n),this.writeString(e,t[n]))},this.writeChildren=function(e,t){var n;if(t)if("string"==typeof t)this.writeString(e,t,!0);else if(u.isByteBuffer(t)){if(n=t.limit,n>=4294967296)throw new Error("invalid children; too long (len = "+n);n>=1<<20?(e.pushByte(c.BINARY_32),e.pushInt32(n)):n>=256?(e.pushByte(c.BINARY_20),e.pushInt20(n)):(e.pushByte(c.BINARY_8),e.pushByte(n)),e.pushBytes(t)}else{if(!_.isArray(t))throw new Error("invalid children");n=t.length,this.writeListStart(e,n);for(var r=0;n>r;r++)this.writeNode(e,t[r])}},this.writeListStart=function(e,t){0===t?e.pushByte(c.LIST_EMPTY):256>t?(e.pushByte(c.LIST_8),e.pushByte(t)):(e.pushByte(c.LIST_16),e.pushInt16(t))},this.writePackedBytes=function(e,t){try{this.writePackedBytesImpl(e,t,c.NIBBLE_8)}catch(n){s.warn("writer:enc nib fail, try hex "+n.message,t)(),this.writePackedBytesImpl(e,t,c.HEX_8)}},this.writePackedBytesImpl=function(e,t,n){var r=u.calculateUTF8Bytes(t);if(r>c.PACKED_MAX)throw new Error("too many bytes to nibble-encode: len = "+r);var i,o=Math.ceil(r/2),a=[],s=0;r%2>0&&(s=128);var l=s|o;a.push(n),a.push(l);for(var d=Math.floor(r/2),f=0;d>f;f++)i=this.packBytePair(n,t[2*f],t[2*f+1]),a.push(i);s>0&&(i=this.packBytePair(n,t[r-1],"\x00"),a.push(i));var p=new Uint8Array(a);e.pushUint8Array(p)},this.packBytePair=function(e,t,n){var r,i;switch(e){case c.NIBBLE_8:r=this.packNibble(t),i=this.packNibble(n);break;case c.HEX_8:r=this.packHex(t),i=this.packHex(n);break;default:throw new Error("invalid byte pack type: "+e)}return r<<4|i},this.packNibble=function(e){if(!r.hasOwnProperty(e))throw new Error("invalid byte to nibble-pack: "+e);return r[e]},this.packHex=function(e){switch(e){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"A":case"B":case"C":case"D":case"E":case"F":return parseInt(e,16);case"\x00":return 15;default:throw new Error("packHex:invalid byte: "+e)}}}var o=n(37),a=r(o),s=n(1),u=n(7),c=n(167);e.exports=i},function(e,t,n){e.exports={"default":n(399),__esModule:!0}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(16),i=n(119);e.exports=n(87)?function(e,t,n){return r.setDesc(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=!0},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){e.exports=n(117)},function(e,t,n){var r=n(115);e.exports=function(e){return Object(r(e))}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e,t,n){var r=Math.floor(window.performance.now());l[e]=r,n&&(l.socketSequence=t,i(),o(),u.resumeJobs())}function i(){function e(e){var n=0|t[e];return n&&n-r}if(!(window.performance&&window.performance.timing&&window.performance.navigation))return void a.log("MetricReporter:logPageLoad metrics not provided by browser!","red")();var t=window.performance.timing,n=window.performance.navigation,r=0|t.navigationStart,o=(0|t.loadEventEnd)-r;return 0>=o?(a.log("MetricReporter:logPageLoad delayed","blue")(),void _.delay(i,1e4)):(c.set({webcPageLoadT:o,webcUnloadEventStart:e("unloadEventStart"),webcUnloadEventEnd:e("unloadEventEnd"),webcRedirectStart:e("redirectStart"),webcRedirectEnd:e("redirectEnd"),webcFetchStart:e("fetchStart"),webcDomainLookupStart:e("domainLookupStart"),webcDomainLookupEnd:e("domainLookupEnd"),webcConnectStart:e("connectStart"),webcConnectEnd:e("connectEnd"),webcSecureConnectionStart:e("secureConnectionStart"),webcRequestStart:e("requestStart"),webcResponseStart:e("responseStart"),webcResponseEnd:e("responseEnd"),webcDomLoading:e("domLoading"),webcDomInteractive:e("domInteractive"),webcDomContentLoadedEventStart:e("domContentLoadedEventStart"),webcDomContentLoadedEventEnd:e("domContentLoadedEventEnd"),webcDomComplete:e("domComplete"),webcLoadEventStart:e("loadEventStart"),webcLoadEventEnd:e("loadEventEnd"),webcAppcacheStatus:window.applicationCache?window.applicationCache.status:void 0,webcCached:t.fetchStart===t.domainLookupEnd,webcNavigation:n.type,webcRedirectCount:n.redirectCount,webcWsOpening:l.OPENING,webcWsPairing:l.PAIRING,webcWsSyncing:l.SYNCING,webcWsNormal:l.NORMAL,webcWsAttempts:l.socketSequence,webcQrCode:!l.SYNCING}),c.commit(),void(c=null))}function o(){if(window.performance.getEntriesByType){var e,t=window.performance.getEntriesByType("resource"),n=document.createElement("a");t.forEach(function(t){n.href=t.name,e=n.pathname+n.search+n.hash,new s.WebcResourceLoad({webcResourceName:e,webcResourceDuration:Math.round(t.duration),webcResourceCached:t.domainLookupEnd===t.fetchStart}).commit()})}}var a=n(1),s=n(47),u=n(174),c=new s.WebcPageLoad,l={};e.exports={PageLoad:c,streamInfoChange:r}},,function(e,t){"use strict";function n(e){_=e}function r(e){v=e,b=Math.round(e/1e3)}function i(e){return void 0!==e?e+b:Math.floor(Date.now()/1e3)}function o(e){return void 0!==e?e-b:Math.floor((Date.now()-v)/1e3)}function a(e){return moment.unix(e).format(_?"HH:mm":"LT")}function s(e){return moment.unix(e).format("l")}function u(e,t){var n=moment().startOf("day"),r=moment.unix(e).startOf("day"),i=n.diff(r,"days"),o=t&&a(e);if(0===i)return t?l10n.t("web_today_at",{time:o}):l10n.t("web_today");if(1===i)return t?l10n.t("web_yesterday_at",{time:o}):l10n.t("web_yesterday");if(!t&&6>i)return moment.unix(e).format("dddd");var u=s(e);return t?l10n.t("web_time_at",{date:u,time:o}):u}function c(e){var t=e+b;return t>=moment().startOf("day").unix()?a(t):u(t,!1)}function l(e){return u(e+b,!1)}function d(e){return u(e+b,!0)}function f(e){return moment.unix(e+b).format(_?"HH:mm, l":"LT, l")}function p(e){return a(e+b)}function h(e){var t=e+b,n=a(t),r=moment.unix(t).startOf("day");switch(moment().startOf("day").diff(r,"days")){case 0:return l10n.t("web_conversation_last_seen_today",{time:n});case 1:return l10n.t("web_conversation_last_seen_yesterday",{time:n});default:var i=u(t,!1);return l10n.t("web_conversation_last_seen_date",{date:i,time:n})}}function g(e){var t=moment.utc(1e3*e);return t.isValid()?t.format("m:ss"):""}function m(e){var t=e.startOfDaySkew;return void 0!==t&&t>b-30&&b+30>t?e.startOfDay:(e.startOfDaySkew=b,e.startOfDay=moment.unix(e.t+b).startOf("day").unix())}var _=!1,v=0,b=0;e.exports={setIs24Hour:n,setSkew:r,localUnixTime:i,globalUnixTime:o,relativeStr:c,relativeDateStr:l,relativeDateAndTimeStr:d,timeStr:f,timestampStr:p,lastSeenStr:h,durationStr:g,dayOfMsg:m}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(101),o=r(i),a={getInitialState:function(){return this._timer_mixin_timers={},this._timer_mixin_seq=0,{}},componentWillUnmount:function(){var e=this._timer_mixin_timers;e&&_.values(e).forEach(function(e){e()})},safeIsMounted:function(){return this.isMounted()&&"UNMOUNTING"!==this._compositeLifeCycleState},safeInterval:function(e,t){e=e.bind===(0,o["default"])(e).bind?e.bind(this):e;var n=setInterval(e,t);return this._regTimer(clearInterval.bind(void 0,n))},safeDelay:function(){var e,t=_.toArray(arguments),n=t.shift(),r=t.shift(),i=_.delay(function(r){delete r._timer_mixin_timers[e],n.apply(r,t)},r,this);return e=this._regTimer(clearTimeout.bind(void 0,i))},safeDefer:function(){var e,t=_.toArray(arguments),n=t.shift(),r=_.defer(function(r){delete r._timer_mixin_timers[e],n.apply(r,t)},this);return e=this._regTimer(clearTimeout.bind(void 0,r))},safeDebounce:function(e,t,n){var r,i=this,o=this._timer_mixin_timers,a=function(){delete o[r],e()},s=_.debounce(a,t,n);return function(){r&&delete o[r],s(),r=i._regTimer(s.cancel)}},clearSafeTimeout:function(e){var t=this._timer_mixin_timers[e];t&&t()},clearSafeInterval:function(e){return this.clearSafeTimeout(e)},_regTimer:function(e){var t=this._timer_mixin_timers,n=++this._timer_mixin_seq;return t[n]=function(){delete t[n],e()},n}};e.exports=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(158),o=r(i),a=n(344),s=r(a),u=n(6),c=n(77),l=20,d=u.createClass({displayName:"Spinner",propTypes:{size:u.PropTypes.number.isRequired,stroke:u.PropTypes.number.isRequired},getDefaultProps:function(){return{size:65,stroke:4}},shouldComponentUpdate:function(e,t){return!1},render:function(){var e=this.props,t=e.size,n=e.stroke,r=e.className,i=(0,s["default"])(e,["size","stroke","className"]),a={width:t,height:t},d=2*l+n,f="0 0 "+d+" "+d;return u.createElement("svg",(0,o["default"])({className:c("spinner-container",r),style:a,viewBox:f},i),u.createElement("circle",{className:"path",cx:d/2,cy:d/2,r:l,fill:"none",strokeWidth:n}))}});e.exports=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(3),o=r(i),a=n(6),s=n(1),u=n(21),c=n(162),l=n(59),d=n(35),f=n(349),p=n(352),h=n(9),g=n(80),m=n(159),_=l.extend({Collection:"Contact",props:{id:"string",name:"string",shortName:"string",type:{type:"string",values:["in","out"],"default":"in"}},session:{pendingAction:"number",checked:"boolean",notifyName:{type:"any","default":null}},derived:{userid:{fn:function(){return this.isUser?u.user(this.id):null}},searchName:{deps:["name"],fn:function(){return this.name?l10n.accentFold(this.name):null}},header:{deps:["name"],fn:function(){if(this.name){var e=this.name.charAt(0).toLowerCase();if(c.alpha.test(e)){var t=l10n.removeAccents(e);return _.Collator.compare(t,e)?e:t}return"#"}}},isMe:{fn:function(){return Store.Conn.me===this.id}},isUser:{fn:function(){return u.isUser(this.id)}},isGroup:{fn:function(){return u.isGroup(this.id)}},isBroadcast:{fn:function(){return u.isBroadcast(this.id)}},formattedShortNameWithNonBreakingSpaces:{deps:["shortName","formattedName","id"],fn:function(){return this.id?this.isMe?l10n.t("web_you"):this.shortName||this.formattedName.replace(/\s/g,""):void 0}},formattedShortName:{deps:["shortName","formattedName","id"],fn:function(){return this.id?this.isMe?l10n.t("web_you"):this.shortName||this.formattedName:void 0}},formattedName:{deps:["name","id"],fn:function(){if(this.id){if(this.isMe)return l10n.t("web_you");var e;return this.name||(e=l10n.isRTL()?l10n.embedLTR(u.formattedUser(this.id)):u.formattedUser(this.id)),this.name||e}}},formattedUser:{deps:["name","id"],fn:function(){return this.id?this.name?this.name:l10n.isRTL()?l10n.embedLTR(u.formattedUser(this.id)):u.formattedUser(this.id):void 0}},isWAContact:{deps:["type"],fn:function(){return this.isUser&&"in"===this.type}},isMyContact:{deps:["name"],fn:function(){return!!(this.isUser&&this.name&&this.name.length)}}},children:{status:f,profilePicThumb:p},initialize:function(){this.id&&(this.status=Store.Status.gadd(this.id),this.listenTo(this.status,"all",this._getEventBubblingHandler("status")),this.listenTo(h,"locale_change",function(){this.trigger("change:name",this,this.name)}),this.profilePicThumb=Store.ProfilePicThumb.gadd(this.id),this.listenTo(this.profilePicThumb,"all",this._getEventBubblingHandler("profilePicThumb")),this.pendingAction=0,this.listenTo(this,"change:pendingAction",this.onPendingActionUpdate))},onPendingActionUpdate:function(){this.pendingAction<0&&(s.log("contact:onPendingActionUpdate pendingAction value is invalid")(),this.pendingAction=0)},canBlock:function(){return g.supportsFeature(g.F.SET_BLOCK)},setBlock:function(e){var t=this;if(e&&Store.Blocklist.get(this.id))return o["default"].resolve();if(!e&&!Store.Blocklist.get(this.id))return o["default"].resolve();var n=d.sendSetBlock(e,[{jid:this.id}]),r=e?l10n.t("action_blocking",{participant:this.formattedName}):l10n.t("action_unblocking",{participant:this.formattedName}),i=n.bind(this)["catch"](function(t){s.error("models:contact:setBlock dropped")(t);var n=e?l10n.t("action_block_failed",{participant:this.formattedName}):l10n.t("action_unblock_failed",{participant:this.formattedName});return o["default"].reject(n)}).then(function(n){if(200===n.status)return e?l10n.t("action_blocked",{participant:t.formattedName}):l10n.t("action_unblocked",{participant:t.formattedName});if(n.status>=400){var r=e?l10n.t("action_block_failed",{participant:t.formattedName}):l10n.t("action_unblock_failed",{participant:t.formattedName});return o["default"].reject(r)}});return h.openToast(a.createElement(m,{id:m.genId(),pendingText:r,actionText:i,retry:this.setBlock.bind(this,e)})),n.bind(this).then(function(n){200!==n.status||n._duplicate||(e?Store.Blocklist.add({id:t.id}):Store.Blocklist.remove(t.id))})},isBlocked:function(){return!!Store.Blocklist.get(this.id)},findCommonGroups:function(){var e=this.id;return new o["default"](function(t,n){d.commonGroupsFind(e).then(function(e){if(200===e.status){var r=e.groups.map(function(e){return Store.Chat.get(e)});t(r)}else s.error("models:Contact:findCommonGroups error: "+e.status)(),n(new Error("models:Contact:findCommonGroups error: "+e.status))})})},searchMatch:function(e){return this.searchName?this.searchName.indexOf(e)>-1:e&&this.userid?this.userid.indexOf(e)>-1:!1}});_.setCollator=function(e){_.Collator=window.Intl?window.Intl.Collator([e],{sensitivity:"base"}):{compare:function(e,t){return e.localeCompare(t)}}},_.Comparator=function(e,t){var n=e.id,r=t.id;if(n===Store.Conn.me)return 1;if(r===Store.Conn.me)return-1;var i=e.name,o=t.name;if(!i&&o)return 1;if(i&&!o)return-1;if(i&&o){var a=_.Collator.compare(e.header,t.header);return 0===a?_.Collator.compare(i,o):a}return n&&r?n.localeCompare(r):-1},e.exports=_},function(e,t,n){"use strict";var r=n(78),i={uimPush:function(e,t,n){r.push(e,t,n),this._uim=this._uim||[],this._uim.push({component:e,type:t})},uimPop:function(e){r.pop(e),this._uim&&(this._uim=_.reject(this._uim,{type:e}))},componentWillUnmount:function(){if(this._uim)for(var e;e=this._uim.shift();)r.pop(e.type),r.popDependents(e.component)}};e.exports=i},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(3),o=r(i),a=n(6),s=n(9),u=n(154),c=n(77),l=3e3,d={PENDING:0,SUCCESS:1,FAILURE:-1},f=a.createClass({displayName:"ActionToast",mixins:[u],propTypes:{id:a.PropTypes.string.isRequired,pendingText:a.PropTypes.string.isRequired,actionText:a.PropTypes.instanceOf(o["default"]).isRequired,retry:a.PropTypes.func},statics:{genId:function(e){return _.uniqueId(e||"action_toast")}},getInitialState:function(){return{text:this.props.pendingText,state:d.PENDING}},componentWillMount:function(){this.props.actionText.bind(this).then(function(e){this.setState({text:e,state:d.SUCCESS})})["catch"](function(e){this.setState({text:e,state:d.FAILURE})})["finally"](function(){this.safeDelay(function(){this.isMounted()&&s.closeToast(this)},l)})},onDismiss:function(){s.closeToast(this)},render:function(){var e,t,n=this.props,r=n.retry,i=n.className;return this.state.state===d.FAILURE&&r.retry&&(t=a.createElement("button",{className:"action",onClick:r.retry},l10n.t("action_try_again"))),this.state.state===d.SUCCESS&&(e=a.createElement("button",{className:"icon icon-x-alt",onClick:this.onDismiss})),a.createElement("div",{className:c("toast",i)},a.createElement("span",null,this.state.text),t,e)}});e.exports=f},function(e,t,n){"use strict";function r(e){this._alarms={},this._initialize(e)}var i=n(1),o=1e4,a=3e3,s=Math.pow(2,31)-1,u=n(9);r.prototype._initialize=function(e){var t,n,r,o=this;t=window.performance.now(),window.setInterval(function(){n=window.performance.now(),r=Math.abs(n-t-e),r>a&&(_.isEmpty(o._alarms)||o._validateTimeouts(),i.log("Alarm:validate js halt detected.")(),u.jsHaltDetected(r)),t=n},e)},r.prototype._validateTimeouts=function(){var e=this;_.forEach(_.keys(this._alarms),function(t){var n=e._alarms[t];n&&(n.expiration<Date.now()?(e.clearTimeout(t),n.fn()):e.setTimeout(n.fn,n.expiration,t,!0))})},r.prototype.setTimeout=function(e,t,n,r){var o=this;n&&this.clearTimeout(n),n=n||_.uniqueId("alarm_timer_");var u=t-Date.now(),c=Math.min(u,s);if(0>u)return i.log("Alarm:setTimeout:Cannot set alarm in the past.")(),e(),n;var l=window.setTimeout(function(){t-Date.now()<a?(delete o._alarms[n],e()):o.setTimeout(e,t,n)},c);return this._alarms[n]={fn:e,expiration:t,timeoutId:l},r||i.log("Alarm:setTimeout:"+n+" set",this._alarms[n])(),n},r.prototype.clearTimeout=function(e){var t=this._alarms[e];t&&(window.clearTimeout(t.timeoutId),delete this._alarms[e])},e.exports=new r(o)},function(e,t){"use strict";var n="animation",r="transition",i={_normalize:function(e,t,n){var r=e.toLowerCase().indexOf(t),i=e.slice(0,r).toLowerCase();return 0===e.indexOf(t)?i+e.slice(r)+n.toLowerCase():i+e.slice(r)+n},prefix:function(e,t){var i;return 0===e.indexOf(n)?(i=e.substring(n.length),this._normalize(window.Modernizr.prefixed(n),n,i)):0===e.indexOf(r)?(i=e.substring(r.length),this._normalize(window.Modernizr.prefixed(r),r,i)):window.Modernizr.prefixed(e,t,!1)||e}};e.exports=i},function(e,t){"use strict";e.exports={alpha:new RegExp("[A-Za-z-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]"),mark:new RegExp("[----------------------------------------------------------------------------------------------------------]","g"),arabic:"[-------------------]"}},function(e,t){"use strict";function n(e){"string"==typeof e?e=e.split(""):"undefined"==typeof e.length&&(e=new Uint8Array(e));for(var t=Math.ceil(4*e.length/3),n=4*Math.ceil(e.length/3),r=new Array(n),i=0,o=0;n>i;i+=4,o+=3){var a=e[o]<<16|e[o+1]<<8|e[o+2];r[i]=a>>18,r[i+1]=a>>12&63,r[i+2]=a>>6&63,r[i+3]=63&a}for(var i=0;t>i;i++){var s=r[i];if(0>s||s>=64)return null;26>s?r[i]=65+s:52>s?r[i]=71+s:62>s?r[i]=s-4:62===s?r[i]=43:r[i]=47}for(var i=t;n>i;i++)r[i]=61;return String.fromCharCode.apply(String,r)}function r(e,t){for(var n=e.length,r=new Int32Array(n+n%4),i=0;n>i;i++){var o=e.charCodeAt(i);if(o>=65&&90>=o)r[i]=o-65;else if(o>=97&&122>=o)r[i]=o-71;else if(o>=48&&57>=o)r[i]=o+4;else if(43===o)r[i]=62;else{if(47!==o){if(61===o){n=i;break}return null}r[i]=63}}for(var a=r.length/4,i=0,s=0;a>i;i++,s+=4)r[i]=r[s]<<18|r[s+1]<<12|r[s+2]<<6|r[s+3];for(var u=Math.floor(3*n/4),c=new Uint8Array(u),l=0,d=0;u>=d+3;l++,d+=3){var f=r[l];c[d]=f>>16,c[d+1]=f>>8&255,c[d+2]=255&f}switch(u-d){case 2:c[d]=r[l]>>16,c[d+1]=r[l]>>8&255;break;case 1:c[d]=r[l]>>16}return t?Array.prototype.slice.call(c):c}function i(e){return e.replace(/\+/g,"-").replace(/\//g,"_")}e.exports={encode:n,decode:r,urlSafe:i}},function(e,t){"use strict";var n={STREAM_END:2,LIST_EMPTY:0,DICTIONARY_0:236,DICTIONARY_1:237,DICTIONARY_2:238,DICTIONARY_3:239,LIST_8:248,LIST_16:249,JID_PAIR:250,BINARY_8:252,BINARY_20:253,SINGLE_BYTE_MAX:256};e.exports=n},function(e,t){"use strict";var n={STREAM_END:2,LIST_EMPTY:0,DICTIONARY_0:236,DICTIONARY_1:237,DICTIONARY_2:238,DICTIONARY_3:239,LIST_8:248,LIST_16:249,JID_PAIR:250,BINARY_8:252,BINARY_20:253,BINARY_32:254,NIBBLE_8:255,SINGLE_BYTE_MAX:256,NIBBLE_MAX:254};e.exports=n},function(e,t){"use strict";var n={singleByte:[void 0,void 0,void 0,"200","400","404","500","501","502","action","add","after","archive","author","available","battery","before","body","broadcast","chat","clear","code","composing","contacts","count","create","debug","delete","demote","duplicate","encoding","error","false","filehash","from","g.us","group","groups_v2","height","id","image","in","index","invis","item","jid","kind","last","leave","live","log","media","message","mimetype","missing","modify","name","notification","notify","out","owner","participant","paused","picture","played","presence","preview","promote","query","raw","read","receipt","received","recipient","recording","relay","remove","response","resume","retry","s.whatsapp.net","seconds","set","size","status","subject","subscribe","t","text","to","true","type","unarchive","unavailable","url","user","value","web","width","mute","read_only","admin","creator","short","update","powersave","checksum","epoch","block","previous","409","replaced","reason","spam","modify_tag","message_info","delivery","emoji"],doubleByte:[],nibbleEncode:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,"-":10,".":11,"\x00":15},nibbleDecode:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"-",11:".",15:String.fromCharCode("\x00")}};e.exports=n},function(e,t){"use strict";var n={STREAM_END:2,LIST_EMPTY:0,DICTIONARY_0:236,DICTIONARY_1:237,DICTIONARY_2:238,DICTIONARY_3:239,LIST_8:248,LIST_16:249,JID_PAIR:250,HEX_8:251,BINARY_8:252,BINARY_20:253,BINARY_32:254,NIBBLE_8:255,SINGLE_BYTE_MAX:256,PACKED_MAX:254};e.exports=n},function(e,t,n){"use strict";var r=n(8),i=n(59),o=n(15),a=n(47),s=n(1),u=n(53),c=n(35),l=n(80),d=n(153),f=n(17),p={ANDROID:"android",BB:"bb",BBX:"bbx",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",S40:"s40",SYMBIAN:"symbian",WP7:"wp7"},h=i.extend({props:{id:"number",ref:"string",refTTL:"number",refId:"number",wid:"string",connected:"boolean",me:"string",clientToken:"string",serverToken:"string",secret:"string",isResponse:"string",battery:"number",plugged:"boolean",lc:"string",lg:"string",is24h:"boolean",platform:"string",tos:"number"},derived:{isBatteryLow:{deps:["battery","plugged"],fn:function(){return _.isNumber(this.battery)&&!this.plugged&&this.battery<=r.BATTERY_LOW_THRESHOLD_1}},scaledBatteryLevel:{deps:["battery"],fn:function(){return _.isNumber(this.battery)?Math.round(this.battery/10):void 0}},refExpiry:{deps:["ref","refTTL"],fn:function(){return Date.now()+this.refTTL}},locale:{deps:["lg","lc"],fn:function(){return this.lg?this.lc?this.lg+"-"+this.lc:this.lg:null}},platformField:{deps:["platform"],fn:function(){return"wp7"===this.platform?a.PLATFORM_TYPE.WP:this.platform?a.PLATFORM_TYPE[this.platform.toUpperCase()]||a.PLATFORM_TYPE.UNKNOWN:a.PLATFORM_TYPE.UNKNOWN}},tosShowCallNotification:{deps:["tos"],fn:function(){return this.tos<2}}},initialize:function(){var e=this;this.listenTo(this,"change:locale",function(e,t){o.setLangPref(t),l10n.init(t)}),this.listenTo(this,"change:plugged",_.debounce(function(){a.Global.webcPhoneCharging=e.plugged},5e3,{leading:!0}))},"delete":function(){this.clear()},handle:function(e){var t,n=e.shift();if(n.id=1,n.protoVersion){l.setVersion(n.protoVersion);var r=n.features||{},i=l.setFeatures(r);t=!!i.KEY_PARTICIPANT,c.setVersion(n.protoVersion,n.binVersion),Store.Stream.handle(["awake"])}if(n.initial){l.setPlatform(n.platform),o.setLogoutToken(n.browserToken),n.hasOwnProperty("is24h")&&d.setIs24Hour(n.is24h);var a=n.ref,p=n.serverToken,h=n.clientToken,g=n.connected;a&&g&&p&&o.setRefTokCookies(a,p),o.setLoginTokens({client:h,server:p}),n.secret&&c.setSharedSecret(n.secret),"true"!==n.isResponse&&u.save(),"iw"===n.lg&&(n.lg="he"),n.wid&&(this.me=n.wid,Store.Contact.gadd(n.wid))}else this.connected&&t&&(s.log("models:Conn:participantChange:to:"+l.supportsFeature("KEY_PARTICIPANT"))(),f.hardRefresh());this.set(n)}}),g=new h({id:1});g.PLATFORMS=p,e.exports=g},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=[],n=!1,r=0;_.each(e,function(e,i){function a(e){return e.hasOwnProperty(i)&&s(e[i])}if(e===_)return void(n=!0);r++;var s=o(e);t.push(a)});var i=_.reduceRight(t,function(e,t){return e?function(n){return t(n)&&e(n)}:t});return function(e){if("object"!==("undefined"==typeof e?"undefined":(0,u["default"])(e)))return!1;var t=_.keys(e).length;return r>t?!1:!n&&t>r?!1:i(e)}}function o(e){switch("undefined"==typeof e?"undefined":(0,u["default"])(e)){case"object":return i(e);case"function":return e;case"boolean":case"null":case"undefined":case"number":case"string":return function(t){return t===e}}}function a(e){this.predicate=o(e)}var s=n(24),u=r(s);a.ANY=_.constant(!0),a.OBJECT=_.isObject,a.STRING=_.isString,a.BOOLEAN=_.isBoolean,a.prototype={test:function(e){return this.predicate(e)}},e.exports=a},function(e,t){"use strict";e.exports={setCookie:function(e,t){var n=["name","value","domain","path","secure","session","expirationDate"];e.session&&delete e.expirationDate;var r=[];_.forEach(n,function(t){var n=e[t];if(void 0!==n&&"value"!==t)switch(t){case"expirationDate":var i=new Date(e.expirationDate);r.push("expires="+i.toUTCString());break;case"secure":r.push("secure");break;case"name":var o=e.value||"";r.push(n+"="+o);break;default:r.push(t+"="+n)}}),document.cookie=r.join(";")}}},function(e,t,n){"use strict";function r(){c||(c=n(611))}function i(e){var t=void 0;return void 0===e?(t=new Uint8Array(32),window.crypto.getRandomValues(t)):t=new Uint8Array(e),t[0]&=248,t[31]&=127,t[31]|=64,u({pubKey:32,privKey:t,basepoint:l},function(e){var n=c._curve25519_donna(e.pubKey,e.privKey,e.basepoint);if(n)throw new Error("Curve25519:keyPair Error Code "+n);return{pubKey:s(e.pubKey,32),privKey:t.buffer}})}function o(e,t){return u({sharedKey:32,pubKey:e,privKey:t},function(e){var t=c._curve25519_donna(e.sharedKey,e.privKey,e.pubKey);if(t)throw new Error("Curve25519:sharedSecret Error Code "+t);return s(e.sharedKey,32)})}function a(e){if("number"==typeof e)return c._malloc(e);var t=new Uint8Array(e.buffer||e),n=c._malloc(t.length);return c.HEAPU8.set(t,n),n}function s(e,t){var n=new Uint8Array(t);return n.set(c.HEAPU8.subarray(e,e+t)),n.buffer}function u(e,t){r();var n={};try{for(var i in e)n[i]=a(e[i]);return t(n)}finally{for(var i in n)c._free(n[i])}}var c,l=new Uint8Array(32);l[0]=9,e.exports={keyPair:i,sharedSecret:o}},function(e,t,n){"use strict";function r(){var e=this.onTimeout;return e?(this.failGeneration++,void(e(this)&&this._run(!1))):(o.error("Watchdog timed-out without handler!")(),void a.upload("watchdog-no-handler"))}function i(e,t,n){return"number"==typeof n?function(r){switch(r.failGeneration){case 0:return Math.min(n,t);case 1:return Math.min(n,e+t);default:return Math.min(n,r.waitDuration+r.prevWaitDuration)}}:function(n){switch(n.failGeneration){case 0:return t;case 1:return e+t;default:return n.waitDuration+n.prevWaitDuration}}}var o=n(1),a=n(12),s=n(62),u=n(83),c=s.extend({session:{failGeneration:{type:"number",allowNull:!1,"default":0},ts:"number",waitDuration:{type:"number",allowNull:!1,"default":0},prevWaitDuration:{type:"number",allowNull:!1,"default":0},jitter:{type:"number","default":0},shiftTimer:"object",waitAlgorithm:{type:"function",required:!0,allowNull:!1},onActivated:"function",onDeactivated:"function",onFed:"function",onTimeout:"function"},initialize:function(){this.shiftTimer=new u(this,r)},activate:function(){this.shiftTimer.ts||(this._run(!0),this.onActivated&&this.onActivated(this))},deactivate:function(){this.shiftTimer.ts&&(this.shiftTimer.cancel(),this.onDeactivated&&this.onDeactivated(this))},feed:function(){this.shiftTimer.ts&&(this._run(!0),this.onFed&&this.onFed(this))},forceTimeout:function(e){this.shiftTimer.ts?e?this.ts=this.shiftTimer.before(e):this.shiftTimer.trigger():o.error("forced non-running watchdog!")()},poke:function(){this.forceTimeout.apply(this,arguments)},_run:function(e){e?this.failGeneration=0:this.failGeneration++;var t=this.waitAlgorithm(this),n=this.jitter*Math.random()*t;this.set({ts:this.shiftTimer.debounce(t+n),waitDuration:t,prevWaitDuration:this.waitDuration})}});c.FIBONACCI=i,e.exports=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){var n=-1,r=_.find(e,function(e){return n++,t(e)});return void 0===r?void 0:{index:n,value:r}}function o(e){var t,n;try{t=new w(e)}catch(r){return u.error("WatchedSocket error constructing: "+r)(r),g.reject(r)}return new g(t,function(e,t){u.log("WatchedSocket opening socket "+this.id)(),n=new p.WebcWsOpen;var r=new WebSocket(this.url);r.binaryType="arraybuffer",r.onopen=e,r.onclose=r.onerror=function(e){t(new f.SocketError(e))},this.socket=r}).cancellable()["catch"](function(e){if(u.error("WatchedSocket error on open of "+this.id+": "+e,e)(),this.socket){var t=this.socket;switch(t.readyState){case WebSocket.OPENING:t.onopen=null;case WebSocket.OPEN:t.onerror=null,t.onclose=null,t.close();break;case WebSocket.CLOSING:case WebSocket.CLOSED:t.onerror=null,t.onclose=null}}throw e}).then(function(e){u.log("WatchedSocket opened socket "+this.id)(),n.markWebcWsOpenT(),n.commit();var t=this.socket;return t.onmessage=this._onMessage.bind(this,!0),t.onerror=this._onCloseOrError.bind(this,!0),t.onclose=this._onCloseOrError.bind(this,!1),this._offlineListener=d.waitForOfflineNaive().then(this.close.bind(this,!1,"offline"))["catch"](s["default"].CancellationError,_.noop),this._feedPing(),this.state=y.OPEN,this})}var a=n(3),s=r(a),u=n(1),c=n(12),l=n(62),d=n(36),f=n(11),p=n(47),h=n(169),g=n(38),m=2e4,v=8e3,b=16e3,y={OPEN:"open",CLOSED:"closed"},w=l.extend({extraProperties:"reject",session:{id:{type:"integer",required:!0,allowNull:!1},url:{type:"string",required:!0,allowNull:!1},onmessage:"function",onactivity:"function",timeSkew:"number",msgParser:"function",state:{type:"string",values:[y.OPEN,y.CLOSED]},error:"any",socket:"object",isQueueing:{type:"boolean","default":!0},maxQueueSize:"number",messageQueue:"array",_offlineListener:"object",_msgListeners:"array",_feedPing:"function",_feedKill:"function"},initialize:function(){this._msgListeners=[],this.messageQueue=[],this._killTimerID=null,this._feedPing=_.debounce(function(){this._ping(),this._feedPing()},v)},_ping:function(){this.send("?,,"),null===this._killTimerID&&(this._killTimerID=_.delay(this._killSocket,b,this))},_killSocket:function(e){u.error("Watchdog Socket "+e.id+" Timeout!")(),e.close(!0,"stale")},_stopKillTimer:function(){this._killTimerID&&(clearTimeout(this._killTimerID),this._killTimerID=null)},detachCallbacks:function(){this.set({onactivity:void 0,onmessage:void 0})},send:function(e){if("open"!==this.state)throw new f.SocketNotOpen(this.state);try{this.socket.send(e)}catch(t){u.error("exception sending: "+t)(t),u.error(""+t.stack)(),c.upload("send-exception"),this.close(!0,t)}},cast:function(e){this.send(e)},partingSend:function(e,t,n){var r=this,i=this.socket;return new s["default"](function(o){function a(){o(void 0)}i.onclose=a,i.onerror=a,i.onmessage=function(e){var t=e.data;(!n||n(t))&&o(t)},r.send(t),r._onCloseOrError(!1,e)}).timeout(m,"paringSendTimeout")["catch"](_.noop)["finally"](function(){i.onclose=void 0,i.onerror=void 0,i.onmessage=void 0,i.readyState===WebSocket.OPEN&&i.close()})},close:function(e,t){var n,r=this.socket;if(this._onCloseOrError(!!e,t||"unspecified"),r&&(n=r.readyState,n===WebSocket.OPENING||n===WebSocket.OPEN))try{r.close()}catch(i){u.error("WatchedSocket:exception closing: "+i)(i),u.error(""+i.stack)()}},_onMessage:function(e,t){if(e){this._feedPing(),this._stopKillTimer();var n=t.data;if("string"==typeof n&&"!"===n.charAt(0)){var r=parseInt(t.data.slice(1),10);
return r===r&&(this.timeSkew=Date.now()-r),void(this.onactivity&&this.onactivity())}this.msgParser&&(t=this.msgParser(t)),this.onactivity&&this.onactivity(t)}var o=i(this._msgListeners,function(e){return!e.filter||e.filter(t)});o?(this._msgListeners.splice(o.index,1),o.value.removed=!0,o.value.promise.force(t)):this.isQueueing?(u.warn("watchedSocket:enqueued",t)(),this.messageQueue.push(t),void 0!==this.maxQueueSize&&this.messageQueue.length>this.maxQueueSize&&this.close(!0,"Queue Overflow")):this.onmessage?this.onmessage(t):u.error("watchedSocket:dropped!",t)()},_onCloseOrError:function(e,t){if("closed"!==this.state){this.socket&&(this.socket.onclose=void 0,this.socket.onerror=void 0,this.socket.onmessage=void 0),this._offlineListener&&this._offlineListener.cancel(),u.warn("Socket "+this.id+" closing: "+t)(),this._feedPing.cancel(),this._stopKillTimer(),this.set({state:"closed",error:e?t:void 0});var n=this._msgListeners,r=e?new f.SocketError(t):new f.SocketClosed(t);this._msgListeners=[],_.forEach(n,function(e){e.removed=!0,e.promise.cancel(r)})}},holdMessages:function(e){var t=this.isQueueing&&void 0!==e&&this.messageQueue>e;this.set({isQueueing:!0,messageQueue:this.messageQueue||[],maxQueueSize:e}),t&&this.close(!0,"Queue Overflow")},releaseMessages:function(e){if(!this.isQueueing)return void u.error("WatchedSocket:releaseMessages not queued!")();var t=this.messageQueue;this.set({isQueueing:!1,messageQueue:void 0}),e?t.length>0&&u.error("WatchedSocket:releaseMessages dropping "+t.length+" messages.")():_.forEach(t,function(e){this._onMessage(!1,e)},this)},nextMessage:function(e){if("open"!==this.state&&"opening"!==this.state)return g.reject(new f.SocketNotOpen).cancellable();if(e instanceof h&&(e=e.test.bind(e)),this.isQueueing){var t;if(e){var n=i(this.messageQueue,e);n&&(t=n.value,this.messageQueue.splice(n.index,1))}else this.messageQueue.length>0&&(t=this.messageQueue.shift());if(t)return g.resolve(t).cancellable()}var r=(new g).cancellable().forceable(),o={removed:!1,filter:e,promise:r};return this._msgListeners.push(o),r.bind(this)["catch"](function(){o.removed||(this._msgListeners=_.without(this._msgListeners,o))}),r}});w.STATE=y,w.open=o,e.exports=w},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(){if(M)return e.apply(void 0,arguments);D||(D=[],window.setTimeout(function(){y=n(17),w=n(7),E=n(12),S=n(8),C=n(1),k=n(47),T=n(83),$=n(15),O=new T(l);for(var e=0;e<D.length;e++)D[e]();D=null,M=!0},0));var t=Array.prototype.slice.call(arguments);D.push(e.apply.bind(e,void 0,t))}}function o(e){e.commitTime?C.error("wam:commit redundant commit! "+e.$className)():(C.log("wam:commit "+e.$className,e.all)(),e.commitTime=b(),s([!0,e]))}function a(e,t){C.log("wam:set "+e.name+" = "+t,t)(),s([!1,e,t])}function s(e){B.push(e),F&&O.before(Y)}function u(){C.log("wam pause processing")(),F=!1,O.cancel()}function c(){C.log("wam enable processing")(),F=!0,B.length>0&&O.before(Y)}function l(){u();var e=_.clone(k.Global.all);L["default"].resolve(B).then(function(e){return C.log("wam:executePending "+e.length+" jobs")(),A?e:(A=new d,A.load()["return"](e))}).then(function(t){for(var n=0;n<t.length;n++){var r=t[n];r[0]?A.write(r[1]):A.set(-r[1].id,r[2])}if(A.bufferLength>0&&(A.bufferLength>S.WAM_MAX_BUFFER_SIZE||b()>U+S.WAM_ROTATE_INTERVAL||!W)){var i=function(){var t=A.buffer.join(","),n=A;return A=new d,A.setAll(e),{v:L["default"].all([v(t),m()]).spread(function(e){e?(W=!0,U=b()):t.length>S.WAM_MAX_BUFFER_SIZE?C.error("wam abandoned buffer!")():(A=n,C.log("wam recovered buffer")())})}}();if("object"===("undefined"==typeof i?"undefined":(0,j["default"])(i)))return i.v}}).tap(function(){return A.save()})["catch"](function(e){return C.error("wam:executePending error "+e)(e),E.upload("wam-error"),A=null,m()}).then(c,c),B=[]}function d(){this.buffer=[],this.bufferLength=0,this.prevValues={},this.dirtyGlobals=null}function f(e){var t=new w(10+e.length,!0);t.writeString("WASTATS");for(var n=JSON.parse("["+e+"]"),r=0;r<n.length;r++){var i=n[r],o=i[0];o>0?p(t,o,i[1]):h(t,-o,i[1],G)}return t}function p(e,t,n){for(var r=0;r<n.length;r++){var i=n[r];h(e,i[0],i[1],H)}h(e,t,n.length,q)}function h(e,t,n,r){if(null===n&&r===G)g(e,t,r);else if(n===(0|n))0===n?g(e,t,16|r):1===n?g(e,t,32|r):n>=-128&&128>n?(g(e,t,48|r),e.writeInt8(n)):n>=-32768&&32768>n?(g(e,t,64|r),e.writeInt16(n)):(g(e,t,80|r),e.writeInt32(n));else if("number"==typeof n)g(e,t,112|r),e.writeFloat64(n);else if("string"==typeof n){var i=n.length;256>i?(g(e,t,128|r),e.writeUint8(i)):65536>i?(g(e,t,144|r),e.writeUint16(i)):(g(e,t,160|r),e.writeUint32(i)),e.writeString(n)}else null===n&&g(e,t,176|r)}function g(e,t,n){256>t?(e.writeUint8(n),e.writeUint8(t)):(e.writeUint8(4|n),e.writeUint16(t))}function m(){var e=n(23);return e.idb().then(function(e){return e.wam["delete"](1)})["catch"](_.noop)}function v(e){var t=n(107),r=$.getLoginTokens().server;if(!r)return C.log("wam:sendLogs unauthorized")(),L["default"].resolve(!1);var i=f(e).flip().toBase64();C.log("wam:sendLogs { strlen:"+e.length+", b64len:"+i.length+" }")();var o=S.VERSION_STR,a=new FormData;return a.append("t",""+b()),a.append("v",o),a.append("tok",r),a.append("buffer",i),t.post(S.WAM_URL,a).uncancellable().then(function(e){if(e.status>=500)throw e.status+" response";return e})["catch"](function(e){return C.error("wam:sendLogs retry on error: "+e)(e),t.post(S.WAM_URL,a)}).then(function(e){return 200===e.status?(C.log("wam:sendLogs success")(),!0):(C.error("wam:sendLogs failure code: "+e.status)(),!1)})["catch"](function(e){return C.error("wam:sendLogs failure error: "+e)(e),!1})}function b(){return Math.floor(Date.now()/1e3)}var y,w,E,S,C,k,T,$,O,A,R=n(22),I=r(R),N=n(24),j=r(N),P=n(3),L=r(P),D=null,M=!1,x=-47,U=0,B=[],F=!1,Y=1e4,W=!1;d.prototype={load:function(){C.log("wam:load")();var e=n(23);return e.idb().bind(this).then(function(e){return e.wam.get(1)})["catch"](function(e){C.warn("wam:load indexeddb failed to open "+e)(e)}).then(function(e){if(e){this.prevValues=e.prevValues||{},e.lastSend&&e.lastSend>U&&(U=e.lastSend),e.buffer&&(this.buffer=[e.buffer],this.bufferLength=this.buffer.length);for(var t in this.prevValues)0>t&&this.set(t,null)}var n=y.info(),r=Store.Conn.platformField,i={appVersion:S.VERSION_STR,platform:k.PLATFORM_TYPE.WEBCLIENT,browser:n.name||null,browserVersion:n.ua||null,deviceName:n.os||null,webcPhonePlatform:r||null,webcEnv:k.WEBC_ENV_CODE.PROD};this.setAll(i),k.Global.set(i),$.clearWamBuffer_old(),$.clearWamStatus_old(),$.clearWamLastRotate_old(),$.clearWamDimensionCache_old(),$.setWamBuffer(void 0),$.setWamInfo(void 0)})},save:function(){var e=this,t=this.buffer.join(",");t&&(this.buffer=[t]),this.bufferLength=t.length;var r=n(23);return r.idb().then(function(n){return n.wam.put({buffer:t,prevValues:e.prevValues,lastSend:U},1)})["catch"](function(e){C.warn("wam:save indexeddb failed to save "+e)(e)})},setAll:function(e){for(var t in e){var n=e[t];void 0!==n&&this.set(-k.METRICS[t].id,n)}},set:function(e,t){this.dirtyGlobals||(this.dirtyGlobals={}),this.dirtyGlobals[e]=t},flushGlobals:function(){if(this.dirtyGlobals){var e=this.dirtyGlobals,t=this.prevValues;for(var n in e){var r=0|n,i=e[r];if("boolean"==typeof i?i=i?1:0:void 0===i&&(i=null),i===t[r])return;t[r]=i,this.appendToBuffer((0,I["default"])([r,i]))}this.dirtyGlobals=null}},write:function(e){var t=this.prevValues;this.appendToBuffer((0,I["default"])([x,e.commitTime])),this.flushGlobals();var n=e.all,r=[];for(var i in n){var o=k.METRICS[i].id,a=n[i];null!==a&&void 0!==a&&("boolean"==typeof a&&(a=a?1:0),0!==a&&1!==a&&a===t[o]?r.push([o,null]):(t[o]=a,r.push([o,a])))}this.appendToBuffer((0,I["default"])([e.id,r]))},appendToBuffer:function(e){this.buffer.push(e),this.buffer.length>1?this.bufferLength+=1+e.length:this.bufferLength+=e.length}};var G=0,q=1,H=2;e.exports=_.mapValues({commit:o,set:a,resumeJobs:c},i)},function(e,t,n){var r=n(64),i=n(25)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=(t=Object(e))[i])?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var r=n(64);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var r=n(118),i=n(61),o=n(120),a=n(117),s=n(116),u=n(25)("iterator"),c=n(65),l=!([].keys&&"next"in[].keys()),d="@@iterator",f="keys",p="values",h=function(){return this};e.exports=function(e,t,g,m,_,v,b){n(414)(g,t,m);var y,w,E=function(e){switch(e){case f:return function(){return new g(this,e)};case p:return function(){return new g(this,e)}}return function(){return new g(this,e)}},S=t+" Iterator",C=e.prototype,k=C[u]||C[d]||_&&C[_],T=k||E(_);if(k){var $=n(16).getProto(T.call(new e));n(88)($,S,!0),!r&&s(C,d)&&a($,u,h)}if((!r||b)&&a(C,u,T),c[t]=T,c[S]=h,_)if(y={values:_==p?T:E(p),keys:v?T:E(f),entries:_!=p?T:E("entries")},b)for(w in y)w in C||o(C,w,y[w]);else i(i.P+i.F*l,t,y)}},function(e,t,n){e.exports=function(e,t){var r=n(61),i=(n(29).Object||{})[e]||Object[e],o={};o[e]=t(i),r(r.S+r.F*n(85)(function(){i(1)}),"Object",o)}},function(e,t,n){var r=n(31),i="__core-js_shared__",o=r[i]||(r[i]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},,,,,,,,function(e,t,n){e.exports=n.p+"img/23de3746eb94b2e205186a6486cca7f1.png"},function(e,t,n){e.exports=n.p+"img/0bd5ba67050237c0666d1fd1da70c56a.svg"},function(e,t){e.exports={action_try_again:"Try again.",action_profile_setting:"Setting profile photo",action_profile_set:"Profile photo set",action_profile_set_failed:"Couldn't set profile photo.",action_status_setting:"Changing status",action_status_set:"Status changed",action_status_set_failed:"Couldn't change status.",action_status_empty:"Status can't be empty",action_profile_removing:"Removing profile photo",action_profile_removed:"Profile photo removed",action_profile_remove_failed:"Couldn't remove profile photo.",action_chat_deleting:"Deleting chat",action_chat_deleted:"Chat deleted",action_chat_delete_failed:"Couldn't delete chat.",action_chat_archiving:"Archiving chat",action_chat_archived:"Chat archived",action_chat_archive_failed:"Couldn't archive chat.",action_chat_unarchiving:"Unarchiving chat",action_chat_unarchived:"Chat unarchived",action_chat_unarchive_failed:"Couldn't unarchive chat.",action_chat_marking_read:"Marking as read",action_chat_marked_read:"Marked as read",action_chat_mark_read_failed:"Couldn't mark chat as read.",action_chat_marking_unread:"Marking as unread",action_chat_marked_unread:"Marked as unread",action_chat_mark_unread_failed:"Couldn't mark chat as unread.",action_group_deleting:"Deleting group",action_group_deleted:"Group deleted",action_group_delete_failed:"Couldn't delete group.",action_broadcast_deleting:"Deleting broadcast list",action_broadcast_deleted:"Broadcast list deleted",action_broadcast_delete_failed:"Couldn't delete broadcast list.",action_participant_adding:"Adding __participant__",action_participant_added:"__participant__ added",action_participant_add_failed:"Couldn't add __participant__.",action_participant_removing:"Removing __participant__",action_participant_removed:"__participant__ removed",action_participant_remove_failed:"Couldn't remove __participant__.",action_participant_promoting:"Making __participant__ a group admin",action_participant_promoted:"__participant__ is now a group admin",action_participant_promote_failed:"Couldn't make __participant__ an admin.",action_blocking:"Blocking __participant__",action_blocked:"__participant__ blocked",action_block_failed:"Couldn't block __participant__",action_unblocking:"Unblocking __participant__",action_unblocked:"__participant__ unblocked",action_unblock_failed:"Couldn't unblock __participant__",action_participant_failed_already_added:"__participant__ is already a member.",action_participant_failed_401:"You're not an admin.",action_participant_failed_403:"You're not a participant.",action_participant_failed_404:"This group has ended.",action_group_creating:"Creating group",action_group_created:"Created group",action_group_create_failed:"Couldn't create group.",action_group_create_failed_406:"Please enter a shorter subject.",action_group_create_failed_participant:"Can't add more than __max__ participants",action_group_subject_empty:"Group subject can't be empty",action_group_icon_setting:"Setting group icon",action_group_icon_set:"Group icon set",action_group_icon_set_failed:"Couldn't set group icon.",action_group_icon_removing:"Removing group icon",action_group_icon_removed:"Group icon removed",action_group_icon_remove_failed:"Couldn't remove group icon.",action_group_exiting:"Exiting group",action_group_exited:"Exited group",action_group_exit_failed:"Couldn't exit group.",action_group_renaming:"Renaming group",action_group_renamed:"Group renamed to __subject__",action_group_rename_failed:"Couldn't rename group.",action_group_muting:"Muting group",action_group_muted:"Group muted",action_group_mute_failed:"Couldn't mute group.",action_group_unmuting:"Unmuting group",action_group_unmuted:"Group unmuted",action_group_unmute_failed:"Couldn't unmute group.",action_chat_muting:"Muting chat",action_chat_muted:"Chat muted",action_chat_mute_failed:"Couldn't mute chat.",action_chat_unmuting:"Unmuting chat",action_chat_unmuted:"Chat unmuted",action_chat_unmute_failed:"Couldn't unmute chat.",action_message_deleting:"Deleting message",action_message_deleting_plural:"Deleting messages",action_message_deleted:"Message deleted",action_message_deleted_plural:"__count__ messages deleted",action_message_delete_failed:"Couldn't delete message",action_message_delete_failed_plural:"Couldn't delete messages",delete_message:"Delete message",delete_message_plural:"Delete messages",msg_info_failed:"To view message info, update WhatsApp on your phone.",intro_title:"Keep your phone connected",intro_connection:"WhatsApp Web connects to your phone to sync messages. To reduce data usage, connect your phone to Wi-Fi.",add_contact_to_group:"Add to a group",enumeration_comma:", ",archive_chat:"Archive chat",unarchive_chat:"Unarchive chat",mark_unread_chat:"Mark as unread",mark_read_chat:"Mark as read",forward:"Forward",selected_count:"__count__ selected",forward_message:"Forward message",forward_message_plural:"Forward messages",forward_message_to:"Forward message to",forward_message_to_plural:"Forward messages to",confirm_forward_to_group:"Forward to __chat__?",confirm_forward_to_contact:"Forward to __chat__?",confirm_unblock_contact_and_forward:"Unblock __chat__ and forward messages?",confirm_unblock_contact_and_forward_text:"Blocked. Click to unblock and send.",message_author:"Message __author__",message:"Message",message_info:"Message info",hidden_group_message_text:"New Message",hidden_group_message_text_with_author:"Message from __author__",hidden_message_text:"__unreadCount__ New Message",hidden_message_text_plural:"__unreadCount__ New Messages",message_info_played_by:"Played by",message_info_played:"Played",message_info_read_by:"Read by",message_info_read:"Read",message_info_delivered_to:"Delivered to",message_info_delivered:"Delivered",message_info_remaining:"__count__ remaining",message_info_remaining_plural:"__count__ remaining",copy_text:"Copy text",web_archive_broadcast:"Archive broadcast list",web_unarchive_broadcast:"Unarchive broadcast list",conversation_archived:"Chat archived",broadcast_archived:"Broadcast list archived",group_archived:"Group archived",web_undo:"undo",web_menuitem_groupchat:"New group",web_menuitem_new:"New chat",menuitem_profile_status:"Profile & status",menuitem_send_logs:"Send logs",menuitem_help:"Help",menuitem_keep_me_signed_in:"Keep me signed in",menuitem_notification_sounds:"Notification sounds",menuitem_notifications:"Notifications",menuitem_blocked:"Blocked",menuitem_archived:"Archived",menuitem_logout:"Log out",menuitem_remove:"Remove",menuitem_make_group_admin:"Make group admin",menutitle_attach:"Attach",menutitle_menu:"Menu",web_settings_faq:"FAQ",if_unchecked_you_will_be_logged_out_afterawhile:"You'll be logged out after several minutes of inactivity",change_group_icon:"Change group icon",add_group_icon:"Add group icon",change_profile_photo:"Change profile photo",add_profile_photo:"Add profile photo",adjust_image:"Drag the image to adjust",done_adjusting:"Done",remove_profile_photo:"Remove your profile photo?",remove_group_icon:"Remove this group's icon?",delete_message_confirmation:"Delete message?",delete_message_confirmation_plural:"Delete messages?",confirm_remove_group_participant:"Remove __participant__ from __subject__ group?",confirm_add_group_participant:"Add __participant__ to __subject__ group?",confirm_promote_group_participant:"Make __participant__ an admin for __subject__ group?",remove:"Remove",conversation_unarchived:"Chat unarchived",conversation_archive_failed:"Couldn't archive chat.",conversation_unarchive_failed:"Couldn't unarchive chat.",web_status:"Status",web_delete:"Delete",web_exit:"Exit",subject:"Subject",group_subject:"Group Subject",web_contact_phone:"Phone",web_group_creation_time:"Created __when__",group_participant_hint:"Type contact name",participant_already_blocked:"Already blocked",chat_not_an_admin:"You are not an admin",new_chat_flow_title:"New chat",new_group_flow_title:"New group",add_group_participants_title:"Add group participants",add_group_participant:"Add participant",already_added_to_group:"Already added to group",web_contact_info:"Contact info",broadcast_list_info:"Broadcast list info",web_group_info:"Group info",web_groups_participation_you_and_name:"Your groups with __user__",web_participants_title:"Participants",web_recipients_title:"Recipients",web_participants_count:"__count__ of __max__",blocked_flow_title:"Blocked contacts",add_blocked_title:"Add blocked contact",add_blocked_hint:"Type contact name",blocked_description:"List of contacts that you have blocked",add_blocked_description:"Blocked contacts will no longer be able to call you or send you messages",add_blocked_instructions:"Click __icon__ button below to select a contact to block",blocked_empty:"No blocked contacts yet",unblock_button:"Unblock",unblock_confirmation:"Unblock __contact__?",archived_flow_title:"Archived chats",archived_empty:"No archived chats",cant_load_whatsapp:"Can't Load WhatsApp Web",computer_behind_proxy:"Your computer is connected to a network that prevents WhatsApp Web from working correctly",missing_photo_title:"Photo Unavailable",missing_photo_text:"Cant view this photo because it's no longer on your phone.",missing_photo_forward_text:"Cant forward this photo because it's no longer on your phone.",missing_video_title:"Video Unavailable",missing_video_text:"Cant play this video because it's no longer on your phone.",missing_video_forward_text:"Cant forward this video because it's no longer on your phone.",missing_audio_title:"Voice Message Unavailable",missing_audio_text:"Cant play this Voice Message because it's no longer on your phone.",missing_audio_forward_text:"Cant forward this Voice Message because it's no longer on your phone.",missing_media_title:"Media Message Unavailable",missing_media_forward_text:"Can't forward this media message because it's no longer on your phone",missing_media_forward_text_plural:"Can't forward some media messages because they are no longer on your phone",err_unsent_forward_title:"Cant Forward",err_unsent_forward_text:"Wait until your message finishes sending and displays a checkmark before forwarding.",err_unsent_forward_text_plural:"Wait until each of your messages finishes sending and displays a checkmark before forwarding.",confirm_forward_partial_messages_title:"Can't forward all messages",confirm_forward_partial_messages_text:"Some messages have not been sent, do you want to forward rest of the messages?",retry_upload_photo_title:"Couldnt Send Photo",retry_upload_photo_text:"Open WhatsApp on your phone and resend this photo",retry_upload_video_title:"Couldnt Send Video",retry_upload_video_text:"Open WhatsApp on your phone and resend this video",retry_upload_audio_title:"Couldnt Send Voice Message",retry_upload_audio_text:"Open WhatsApp on your phone and resend this Voice Message",guide_desktop_notifications_title:"Allow notifications",guide_desktop_notifications_description:"To get notifications for new messages, click Allow above.",guide_desktop_notifications_description_firefox:"To get notifications for new messages, select Always show notifications from the prompt below the URL bar.",guide_desktop_camera_title:"Allow camera",guide_desktop_camera_description:"To take photos, click Allow above to give WhatsApp Web access to your computer's camera.",guide_desktop_camera_description_firefox:"To take photos, WhatsApp Web needs access to your computers camera. Select Always share from the prompt below the URL bar.",guide_desktop_mic_title:"Allow microphone",guide_desktop_mic_description:"To record Voice Messages, click Allow above to give WhatsApp Web access to your computer's microphone.",guide_desktop_mic_description_firefox:"To record Voice Messages, WhatsApp Web needs access to your computers microphone. Select Always share from the prompt below the URL bar. Note: selecting Share selected device wont let you record Voice Messages.",guide_desktop_camera_fail_description:"To take photos, WhatsApp Web needs access to your computer's camera. Click __chrome_media_error__ in the URL bar and choose Always allow web.whatsapp.com to access your camera.",guide_desktop_camera_fail_description_firefox:"To take photos, WhatsApp Web needs access to your computers camera. Click __firefox_lock__ in the URL bar and set Use the Camera to Allow.",guide_desktop_camera_fail_description_opera:"To take photos, WhatsApp Web needs access to your computers camera. Click __opera_media__ in the URL bar and click Clear This Setting and Reload.",guide_desktop_mic_fail_description:"To record Voice Messages, WhatsApp Web needs access to your microphone. Click __chrome_media_error__ in the URL bar and choose Always allow web.whatsapp.com to access your microphone.",guide_desktop_mic_fail_description_firefox:"To record Voice Messages, WhatsApp Web needs access to your computers microphone. Click __firefox_lock__ in the URL bar and set Use the Microphone to Allow.",guide_desktop_mic_fail_description_opera:"To record Voice Messages, WhatsApp Web needs access to your computers microphone. Click __opera_media__ in the URL bar and click Clear This Setting and Reload.",guide_desktop_camera_missing_title:"Camera Not Found",guide_desktop_camera_missing_description:"You cant take a photo because it looks like your computer doesnt have a camera. Try connecting one or if you have one connected, try restarting your browser.",guide_desktop_mic_missing_title:"Microphone Not Found",guide_desktop_mic_missing_description:"You cant record a Voice Message because it looks like your computer doesnt have a microphone. Try connecting one or if you have one connected, try restarting your browser.",attach_media:"Photos & Videos",attach_capture:"Camera",attach_location:"Location",attach_vcard:"Contact",guide_help_title:"Help",guide_help_faq:"Click FAQ for help using WhatsApp Web.",guide_help_description_android:"To contact support, open WhatsApp on your phone and tap Menu  Settings  Help  Contact us.",guide_help_description_symbian:"To contact support, open WhatsApp on your phone and select Options  About  Contact support.",guide_help_description_bb:"To contact support, open WhatsApp on your phone and tap Settings  About  Contact support.",guide_help_description_bbx:"To contact support, open WhatsApp on your phone and swipe down from the top of the screen  Settings  Contact support.",guide_help_description_wp7:"To contact support, open WhatsApp on your phone and tap menu (three dots at the bottom of the screen)  Settings  About  Contact support.",guide_help_description_s40:"To contact support, open WhatsApp on your phone  swipe up from bottom  Settings  About  Options  Contact support.",guide_help_description_iphone:"To contact support, open WhatsApp on your phone and tap Settings  About  Contact Us.",turn_off_all_desktop_notifications_for:"Turn off all desktop notifications for:",learn_more:"Learn more",ok_got_it:"OK, got it",web_view:"View",web_preview_msg:"Preview",add_a_caption:"Add a caption",add_media:"Add media",drag_media_here:"Drag media here",view_photo:"View photo",take_photo:"Take photo",remove_photo:"Remove photo",upload_photo:"Upload photo",invalid_media_files:"WhatsApp Web doesn't support the type of image or video you tried adding. Try adding a different one.",image_too_big:"The image you tried adding is larger than the 16MB limit. Try adding a different one.",video_too_big:"The video you tried adding is larger than the 16MB limit. Try adding a different one.",option_select_mute:"Turn off alerts and sounds for",option_desktop_notifications:"Desktop Alerts",option_sounds:"Sounds",option_msg_previews:"Show Previews",option_msg_previews_hint_text:"Display message text in desktop alerts",web_menuitem_mute_off:"Cancel mute",web_menuitem_mute:"Mute",group_muted:"Group muted",web_mute_time:"Mute group for",web_mute_time_chat:"Mute chat for",web_list_info:"Broadcast list info",click_here_for_group_info:"click here for group info",click_here_for_user_info:"click here for contact info",web_delete_contact_dialog_title:"Delete chat with __name__?",web_delete_group_dialog_title:"Delete __groupName__ group?",web_exit_group_dialog_title:"Exit __groupName__ group?",delete_chat_dialog_title:"Delete chat with __name__?",delete_list_dialog_title:"Delete broadcast list?",are_you_sure:"Are you sure?",next_button:"Next",previous_button:"Previous",save_button:"Save",edit_button:"Edit",web_exit_group:"Exit group",web_delete_group:"Delete group",delete_chat:"Delete chat",web_delete_list:"Delete broadcast list",web_select_messages:"Select messages",conversation_deleted:"Chat deleted",broadcast_deleted:"Broadcast list deleted",group_deleted:"Group deleted",unread_message_count:"__count__ unread message",unread_message_count_plural:"__count__ unread messages",web_chats:"Chats",web_recent_chats:"Chats",web_groups:"Groups",web_contacts:"Contacts",web_messages:"Messages",web_starred_messages:"Starred Messages",web_conversation_is_composing:"typing",web_conversation_is_recording:"recording audio",web_conversation_contact_online:"online",web_conversation_name_is_composing:"__participant__ is typing",web_conversation_name_is_recording:"__participant__ is recording audio",web_conversations_most_recent_image:"Photo",web_conversations_most_recent_audio:"Audio",web_conversations_most_recent_voice:"Voice message",web_conversations_most_recent_video:"Video",web_conversations_most_recent_contact:"Contact",web_conversations_most_recent_location:"Location",web_conversations_most_recent_document:"(__count__ page)",web_conversations_most_recent_document_plural:"(__count__ pages)",search_no_chats_or_contacts:"No chats or contacts found",search_no_contacts:"No contacts found",search_no_groups:"No groups found",no_chats:"No chats",no_contacts:"No contacts",no_groups:"No groups",chat_archived:"Archived",all_chats_archived:"All chats are archived",web_group_admin:"Group Admin",contact_status_loading:"Loading status",retry_now:"Retry Now",retake:"Retake",web_cancel:"Cancel",web_ok:"OK",web_close:"Close",web_share:"Share",web_button_download:"Download",trying_to_reach_phone:"Trying to reach phone",connecting_to_whatsapp:"Connecting to WhatsApp",connecting_to_whatsapp_or_phone:"Connecting",connecting:"Connecting",updating_whatsapp_web_title:"Updating",updating_whatsapp_web:"WhatsApp Web is out of date. Updating now",retrying:"Retrying",retrying_in:"Retrying in __duration__",loading_messages:"loading messages",load_earlier_messages:"load earlier messages",resend_message:"Click to resend",click_to_save_esc_to_cancel:"Click to save, ESC to cancel",web_today_at:"today at __time__",web_yesterday_at:"yesterday at __time__",web_time_at:"__date__ at __time__",web_conversation_last_seen_today:"last seen today at __time__",web_conversation_last_seen_yesterday:"last seen yesterday at __time__",web_conversation_last_seen_date:"last seen __date__ at __time__",web_you:"You",web_today:"today",web_yesterday:"yesterday",retrying_in_some_seconds:"Retrying in __number__ second",retrying_in_some_seconds_plural:"Retrying in __number__ seconds",web_you_created_list_unnamed:"You created a broadcast list with __count__ recipient",web_you_created_list_unnamed_plural:"You created a broadcast list with __count__ recipients",web_list_recipient_added:"__name__ added to the list",web_list_recipient_removed:"__name__ removed from the list",web_group_subject_changed_by_you:"You changed the subject to __subject__",web_group_subject_changed_by_name:"__name__ changed the subject to __subject__",web_group_participant_added_name:"__name__ was added",web_group_participant_added_you:"You were added",web_group_participant_removed_name:"__name__ was removed",web_group_participant_removed_you:"You were removed",web_group_participant_left_name:"__name__ left",web_group_participant_left_you:"You left",web_group_participant_changed_number:"__name__ changed from __old_number__ to __new_number__",web_group_participant_changed_number_unknown_name:"__name__ changed to __new_number__",web_group_participants_name_added_names:"__name__ added __participants__",web_group_participants_you_added_names:"You added __participants__",web_group_participants_name_removed_names:"__name__ removed __participants__",web_group_participants_you_removed_names:"You removed __participants__",web_group_participants_name_added_you:"__name__ added you",web_group_participants_name_removed_you:"__name__ removed you",web_group_participant_promoted_names:"__participants__ is now an admin",web_group_participant_promoted_names_plural:"__participants__ are now admins",web_group_participant_demoted_names:"__participants__ is no longer an admin",web_group_participant_demoted_names_plural:"__participants__ are no longer admins",web_group_participant_promoted_you:"You're now an admin",web_group_participant_demoted_you:"You're no longer an admin",web_group_created_by_you:"You created group __subject__",web_group_created_by_name:"__name__ created group __subject__",web_group_created_by_you_no_subject:"You created this group",web_group_created_by_name_no_subject:"__name__ created this group",web_group_ended_you:"You ended this group",web_group_ended_name:"__name__ ended this group",web_photo_changed_by:"__name__ changed this group's icon",web_photo_removed_by:"__name__ deleted this group's icon",web_photo_changed_by_you:"You changed this group's icon",web_photo_removed_by_you:"You deleted this group's icon",web_mute_8hours:"8 Hours",web_mute_1week:"1 Week",web_mute_1year:"1 Year",mute_1hour:"1 Hour",mute_1day:"1 Day",mute_1week:"1 Week",global_muted:"Alerts and sounds off",global_muted_1hour:"Alerts and sounds off for 1 hour",global_muted_1day:"Alerts and sounds off for 1 day",global_muted_1week:"Alerts and sounds off for 1 week",global_notification_sounds_on:"Notification sounds on",global_notification_sounds_off:"Notification sounds off",global_unmuted:"Notifications enabled",global_unmute:"Alerts and sounds off. Click to restore.",web_cannot_send_not_a_group_participant:"You can't send messages to this group because you're no longer a participant.",web_cannot_send_to_blocked_contact_1:"Can't send a message to blocked contact __contact__.",type_a_message:"Type a message",whatsapp_web:"WhatsApp Web",default_group_message_notification_title:"WhatsApp group message",incoming_call_notification_title:"WhatsApp Call from __name__",incoming_call_notification_text:"Check your phone to answer",
default_contact_message_notification_title:"WhatsApp message",search_or_start_new_chat:"Search or start new chat",search_contacts:"Search contacts",search:"Search",search_groups:"Search groups",update_available:"Update Available",click_to_update_whatsapp_web:"Click to update WhatsApp Web",phone_battery_low:"Phone Battery Low",charge_phone_description:"Charge your phone to keep using WhatsApp Web",computer_not_connected:"Computer Not Connected",make_sure_computer_active_internet_connection:"Make sure your computer has an active Internet connection.",check_internet_connection:"No Internet connection",reconnect:"Reconnect",phone_not_connected:"Phone Not Connected",make_sure_phone_active_internet_connection:"Make sure your phone has an active Internet connection.",enable_desktop_notifications:"Turn on desktop notifications",get_notified_of_new_messages:"Get Notified of New Messages",phone_has_another_active_webclient_session:"WhatsApp Web is open on another computer or browser. Click Use Here to use WhatsApp Web in this window.",whatsapp_web_is_open_in_another_window:"WhatsApp Web is open in another window. Click Use Here to use WhatsApp Web in this window.",button_use_here:"Use Here",open_whatsapp:"Open WhatsApp",click_to_reload_qr_code:"Click to reload QR code",scan_code_with_phone_to_login:"Use WhatsApp on your phone to scan the code",reduce_data_usage_connect_phone_to_wifi:"To reduce mobile data usage, connect your phone to Wi-Fi",android:"Android",android_login_path:"Open WhatsApp  Menu  WhatsApp Web",blackberry:"BlackBerry",blackberry_login_path:"Open WhatsApp  Chats  Menu key  WhatsApp Web",windows_phone:"Windows Phone",windows_phone_login_path:"Open WhatsApp  Menu  WhatsApp Web",nokia_symbian_s60:"Nokia S60",nokia_symbian_s60_login_path:"Open WhatsApp  Menu  WhatsApp Web",nokia_s40:"Nokia S40",nokia_s40_login_path:"Open WhatsApp  Swipe up from bottom of screen  WhatsApp Web",bb10:"BlackBerry 10",bb10_login_path:"Open WhatsApp  Swipe down from top of screen  WhatsApp Web",iphone:"iPhone",iphone_login_path:"Open WhatsApp  Settings  WhatsApp Web",login_hint_version:"Requires the latest version of WhatsApp",message_too_large_title:"Message Too Long",message_too_large_text:"The message youre pasting is too long. Try shortening it or sending it in multiple parts.",video_playback_not_supported:"Your browser doesnt support video playback.",audio_playback_not_supported:"Your browser doesnt support audio playback.",whatsapp_web_meta_description:"Quickly send and receive WhatsApp messages right from your computer.",whatsapp_web_description:"Send and receive WhatsApp messages right from your computer.",whatsapp_web_requirements:"We recommend using WhatsApp Web with one of the following browsers:",whatsapp_web_supports:"WhatsApp Web also supports:",update_safari:"Update Safari",get_safari:"Safari (MacOS 10.8+ Only)",get_google_chrome:"Google Chrome",update_google_chrome:"Update Google Chrome",get_mozilla_firefox:"Mozilla Firefox",update_mozilla_firefox:"Update Mozilla Firefox",get_opera:"Opera",get_edge:"Microsoft Edge",whatsapp_edge_version:"WhatsApp Web works with Microsoft Edge 13+",whatsapp_edge_instructions:"To use WhatsApp Web, update Windows 10 to get Microsoft Edge 13+, or use __chrome_homepage__, __firefox_homepage__, or __opera_homepage__.",update_edge:"Download latest Windows 10",whatsapp_safari_version:"WhatsApp Web works with Safari 7.1+",whatsapp_safari_instructions:"To use WhatsApp Web, update Safari or use __chrome_homepage__, __firefox_homepage__, or __opera_homepage__.",whatsapp_safari_limited_title:"Using Safari",whatsapp_safari_limited:"To use all of WhatsApp Web's features like photo capturing and Voice Message recording, we recommend using __chrome_homepage__, __firefox_homepage__ or __opera_homepage__.",whatsapp_firefox_version:"WhatsApp Web works with Mozilla Firefox 30+",whatsapp_firefox_instructions:"To use WhatsApp Web, update Firefox or use __chrome_homepage__, __safari_homepage__, or __opera_homepage__.",whatsapp_chrome_version:"WhatsApp Web works with Google Chrome 36+",whatsapp_chrome_instructions:"To use WhatsApp Web, update Chrome or use __firefox_homepage__, __safari_homepage__, or __opera_homepage__.",filesize_byte:"B",filesize_kilobyte:"kB",filesize_megabyte:"MB",filesize_gigabyte:"GB",confirm_closing_webclient:"You are closing WhatsApp Web.",confirm_logout:"Log out?",some_of_your_messages_are_still_sending:"Some of your messages are still sending."}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){return _.filter(_.keys(y.BROWSER_CAPABILITY),function(e){return!y.BROWSER_CAPABILITY[e]})}function o(){return T.loopOnError(function(e){return c["default"].delay(j.expBackoff(e,12e4,1e3,.1)).then(function(){return n.e(0).then(function(e){s=n(690)}.bind(null,n))["catch"](function(e){n.oe(e)})})})}function a(){return _.isFunction(String.prototype.normalize)?c["default"].resolve():T.loopOnError(function(e){return c["default"].delay(j.expBackoff(e,12e4,1e3,.1)).then(function(){return n.e(5).then(function(e){n(769)}.bind(null,n))["catch"](function(e){n.oe(e)})})})}var s,u=n(3),c=r(u),l=n(6),d=n(1),f=n(381),p=n(383),h=n(379),g=n(380),m=n(372),v=n(384),b=n(52),y=n(8),w=n(9),E=n(378),S=n(373),C=n(14),k=n(106),T=n(36),$=n(79),O=n(103),A=n(104),R=n(15),I=n(351),N=n(23),j=n(81),P=n(160),L=n(108),D={INIT:"init",PING:"ping",PONG:"pong",TAKEOVER:"local-takeover"},M=6e5,x=l.createClass({displayName:"App",mixins:[$,O,A],statics:{hasPending:function(){return!!s&&s.hasPending()}},getInitialState:function(){return{mode:k.mode,updating:!1,anotherSession:!1,takingOver:!1,locale:_.first(l10n._locales)}},clearMutexTimer:function(){this.updateMutexTimerID&&P.clearTimeout(this.updateMutexTimerID)},updateMutex:function(){this.clearMutexTimer();var e=Date.now();R.setMutex(this.ourMutex=D.INIT+"_"+e),this.updateMutexTimerID=P.setTimeout(this.updateMutex,e+M)},unloadMutex:function(){var e=R.getMutex();e&&this.ourMutex&&e.indexOf(this.ourMutex)>-1&&R.removeMutex()},componentWillUpdate:function(e,t){this.props.anotherSesssion===!0&&e.anotherSession===!1?N.openDB():this.props.anotherSession===!1&&e.anotherSession===!0&&N.idb().then(function(e){return e.close()})["catch"](_.noop)},componentWillMount:function(){c["default"].join(o(),a()).then(function(){return w.mainLoaded()});var e=i();if(e.length>0){var t=y.CAPABILITY_URL+"?missing="+e.join(",");window.location.replace?window.location.replace(t):window.location.href=t}this.regNativeListener(window,"beforeunload",this.unloadMutex),this.regNativeListener(window,"unload",this.unloadMutex),this.regNativeListener(window,"storage",this.storagePong),this.addObserver(L,"change:mode",this.onUpdaterModeChange),this.addObserver(k,"change:mode",this.onStreamModeChange);var n=this;this.regCmd("locale_change",function(){d.log("App:componentWillMount:rerenderUI locale change")(),n.setState({locale:_.first(l10n._locales)})}),I.loadInitialAssets().then(function(){d.log("App:componentWillMount:loadInitialAssets")()}),this.registerYesterdayTimer(),d.log("App:componentWillMount:visibilityState: "+document.visibilityState)(),this.init(0)},registerYesterdayTimer:function(){var e=this;P.setTimeout(function(){d.log("App:registerYesterdayTimer:rerenderUI relative timestamps")(),w.midnight(),e.registerYesterdayTimer()},moment().endOf("day").valueOf())},onStreamModeChange:function(){this.setState({mode:k.mode})},onUpdaterModeChange:function(){L.mode!==L.Mode.PENDING_REFRESH&&L.mode!==L.Mode.REFRESHING||C.hasSynced||this.setState({updating:!0})},init:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],t=this;if(e+=1,e>3)return void this.setState({takingOver:!1,anotherSession:!0});var n=R.getNoTakeover();R.setNoTakeover(),C.preload(),this.pingForOtherLocalSession().then(function(r){r?(R.maybeMigrate(),t.updateMutex(),C.launch(!n),t.setState({takingOver:!1,anotherSession:!1})):n?t.setState({takingOver:!1,anotherSession:!0}):t.takeoverLocal(e)})},pingForOtherLocalSession:function(){var e=R.getMutex();if(e){e+="";var t=1e4;if(e.indexOf("_")>0&&(e=parseInt(_.last(e.split("_")),10),_.isFinite(e))){var n=Date.now()-1.5*M;n>e&&(d.log("app:pingForOtherLocalSession stale mutex")(),t=1e3)}var r=T.waitForEvent(window,"storage",R.mutexFilter).timeout(t,"waitForOtherLocalSessionTimeout")["return"](!1)["catch"](c["default"].TimeoutError,function(e){return!0});return R.setMutex(D.PING+Math.random()),r}return c["default"].resolve(!0)},storagePong:function(e){if(R.mutexFilter(e)){var t=R.parseMutex(e.newValue);t&&(t===D.TAKEOVER?(this.clearMutexTimer(),C.exitLoop(),R.localTakeoverSuccess(),this.setState({takingOver:!1,anotherSession:!0})):0===t.indexOf(D.PING)&&R.setMutex(D.PONG+Math.random()))}},takeoverLocal:function(e){if(R.compareVersion()<0)return d.log("app:takeoverLocal stale client: "+R._version()+" ls: "+R._getLSVersion())(),document.location.reload(!0);if(R.getMutex()){this.setState({takingOver:!0});var t=this;T.waitForEvent(window,"storage",R.takeoverFilter).timeout(3e4,"takeoverLocalTimeout").then(function(n){var r=R.parseTakeover(n.newValue);R.getRememberMe()||R._setAllKeyValues(r),R.removeMutex(),t.init(e)})["catch"](c["default"].TimeoutError,function(n){R.removeMutex(),t.init(e)}),R.setMutex(D.TAKEOVER)}else this.init(e)},onMouseDown:function(e){w.windowMouseDown(e)},onClick:function(e){w.windowClick(e)},render:function(){var e,t="app-wrapper";if(this.state.updating)e=l.createElement(b,{body:l10n.t("updating_whatsapp_web"),title:l10n.t("updating_whatsapp_web_title")});else if(this.state.anotherSession){var n,r;if(this.state.takingOver)n=_.noop,r=l10n.t("connecting");else{var i=this;n=function(){i.takeoverLocal(0)},r=l10n.t("button_use_here")}e=l.createElement(b,{body:l10n.t("whatsapp_web_is_open_in_another_window"),cancelLabel:l10n.t("web_close"),onCancel:window.open.bind(window,"http://www.whatsapp.com/","_self"),defaultLabel:r,onDefault:n})}else switch(this.state.mode){case k.MODE.QR:e=[l.createElement(E,{key:"modal-manager"}),l.createElement(f,{key:"qr-code"})];break;case k.MODE.SYNCING:e=l.createElement(p,null);break;case k.MODE.OFFLINE:e=l.createElement(h,null);break;case k.MODE.PROXYBLOCK:e=l.createElement(g,null);break;case k.MODE.CONFLICT:e=l.createElement(m,null);break;case k.MODE.TOS_BLOCK:e=l.createElement(v,null);break;case k.MODE.MAIN:e=[l.createElement(E,{key:"modal-manager"}),l.createElement(S,{type:"menu",key:"context-menu-manager"}),l.createElement(S,{type:"tooltip",key:"tooltip-manager"}),l.createElement(s,{key:"main",conn:Store.Conn})],t+=" app-wrapper-main";break;default:d.log("app:render Error invalid App state",this.state.mode)()}return l.createElement("div",{className:t,onMouseDownCapture:this.onMouseDown,onClickCapture:this.onClick,key:this.state.locale},e)}});e.exports=x},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(22),o=r(i),a=n(3),s=r(a),u=n(8),c=n(1),l=n(343),d=n(156),f=n(36),p=n(21),h=n(35),g=n(9),m=n(11),v=l.extend({model:d,comparator:d.Comparator,_sort:_.debounce(function(){return l.prototype.sort.call(this)},1e3),_silentSort:_.debounce(function(){return l.prototype.sort.call(this,{silent:!0})},1e3),sort:function(e){return e&&e.slient?this._silentSort():this._sort()},initialize:function(){l.prototype.initialize.call(this,{CachePolicy:{id:"contact_collection",policy:l.CACHE_POLICY.NONE}}),this.checksum=void 0,this.listenTo(g,"locale_change",this.sort),this.listenTo(this,"change:name",this.sort)},"delete":function(){l.prototype["delete"].call(this),delete this.checksum},isFilteredContact:function(e){return e.name&&!e.isMe&&e.isWAContact},getFilteredContacts:function(){return this.filter(function(e){return e.name&&!e.isMe&&e.isWAContact})},_find:function(e){var t=this.get(e);return t?s["default"].resolve(t):s["default"].resolve({id:e})},_findQuery:function(e){var t=this;return h.contactFindQuery(e.retry).then(function(e){return"preempted"===e?s["default"].reject("contacts preempted"):(t.trigger(u.COLLECTION_HAS_SYNCED),e.checksum&&(t.checksum=e.checksum,c.log("Store:Contact:query update checksum "+e.checksum)()),s["default"].resolve(e.data))})},handle:function(e){function t(e){var t=n.get(e.id);e.name?n.add(e,{merge:!0}):t&&t.unset("name")}var n=this,r=e.shift();if(_.isArray(r)){var i=e.shift();if(i&&"remove"===i.missing){var a={};r.forEach(function(e){a[e.id]=!0}),n.forEach(function(e){var t=e.get("id");p.isUser(t)&&!a[t]&&e.set("name")})}i&&i.checksum&&(n.checksum=i.checksum,c.log("Store:Contact:handle update checksum "+i.checksum)()),r.forEach(t)}else"preempt"===r.cmd?(this.add(r.response,{merge:!0}),r.checksum&&(n.checksum=r.checksum,c.log("Store:Contact:handle update checksum "+r.checksum)()),this.trigger(u.COLLECTION_HAS_SYNCED)):c.error("Store:Contact:handle unknown: "+(0,o["default"])(r))()},sync:function(){return this.findQuery({})["catch"](m.WapDrop,_.noop),f.waitForBBEvent(this,u.COLLECTION_HAS_SYNCED)},resyncContacts:function(e){"undefined"!=typeof this.checksum&&"undefined"!=typeof e&&(this.checksum!==e?this.findQuery({retry:!0}).then(function(e){if(_.isArray(e)){c.log("Store:Contact:resync success")();var t,n,r={};for(n=0;n<e.length;n++)t=e[n],r[t.id]=t;for(n=0;n<this.length;n++)t=this.at(n),r[t.id]||t.unset("name")}else c.error("Store.Contact.resync error "+(0,o["default"])(e),e)()})["catch"](m.WapDrop,_.noop):c.log("Store:Contact:resync checksum match")())}});e.exports=new v},function(e,t,n){"use strict";function r(e){i.log("Application Cache "+e.type+" event")(e)}var i=n(1);applicationCache.addEventListener("cached",r),applicationCache.addEventListener("checking",r),applicationCache.addEventListener("downloading",r),applicationCache.addEventListener("error",r),applicationCache.addEventListener("noupdate",r),applicationCache.addEventListener("obsolete",r),applicationCache.addEventListener("progress",r),applicationCache.addEventListener("updateready",r)},function(e,t){"use strict";!function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),r=n&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),i=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,a=(n||i)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,a,s,u,c,l,d,f,p;if(t=e.match(o),!t)throw new Error("invalid data URI");for(a=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),s=!!t[4],u=e.slice(t[0].length),c=s?atob(u):decodeURIComponent(u),l=new ArrayBuffer(c.length),d=new Uint8Array(l),f=0;f<c.length;f+=1)d[f]=c.charCodeAt(f);return n?new Blob([r?d:l],{type:a}):(p=new i,p.append(l),p.getBlob(a))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,n,r){e(r&&t.toDataURL&&a?a(this.toDataURL(n,r)):this.mozGetAsFile("blob",n))}:t.toDataURL&&a&&(t.toBlob=function(e,t,n){e(a(this.toDataURL(t,n)))})),e.dataURLtoBlob=a}(window)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return R[parseInt(e,10)]}function o(){var e=b||window.location.href||"",t=e.split("/%F0%9F%8C%90/");return t.length>1?_.first(t[1].split("/")):void 0}var a=n(3),s=r(a),u=n(1),c=n(45),l=n(156),d=n(475),f=n(387),p=n(9),h=n(162),g=n(36),m=n(482),v=n(81),b=window.location.href,y=window.history&&window.history.pushState&&window.location;y&&b&&b.indexOf("/%F0%9F%8C%90/")>-1&&window.history.replaceState({},"","/");var w="en",E="en-GB",S=document.documentElement.getAttribute("dir"),C=document.getElementById("style").getAttribute("href"),k={en:n(190)},T={LTR:"ltr",RTL:"rtl"},$=n(480),O=["ar","fa","ur","he","dv","ku"],A=["ar","fa"],R="".split("");l.setCollator(w),e.exports={_locales:[w],init:function(e){this.initPromise&&this.initPromise.cancel();var t=[];if(this._addLocale(e,t),this._addLocale(o(),t),navigator.languages){var r=this;_.forEach(navigator.languages,function(e){r._addLocale(e,t)})}this._addLocale(navigator.language,t),this._addLocale(w,t);var i=t.filter(function(e){return!k[e]}),a=i.map(function(e){return e=$[e],e?g.loopOnError(function(t){return s["default"].delay(v.expBackoff(t,12e4,1e3,.1)).then(function(){return n(358)("./"+e+"/translation.json")()})}).cancellable()["catch"](s["default"].CancellationError,_.noop):s["default"].reject("Non-existent language requested.")}),c=this.curDir();return this.initPromise=s["default"].all(a).bind(this).cancellable()["finally"](function(){return _.forEach(a,function(e){return e.cancel()})}).then(function(e){i.forEach(function(t,n){k[t]=e[n]}),this._locales=t;var n=_.first(this._locales).replace("_","-").toLowerCase();l.setCollator(n),moment.locale([_.first(this._locales),E]),this.customizeMomentLocale(moment.locale());var r=O.indexOf(_.first(this._locales))>-1?T.RTL:T.LTR;if(r!==S){if(this._loadedStyle&&c===S)return this._switchStyleDir(c,r),p.localeChange(),u.log("i10n:init Locale Updated: "+this._locales.join(":"))(),this._locales;var o=window.performance.now();return this._loadStyle().bind(this).then(function(e){this._loadedStyle=e;var t=window.performance.now();this._switchStyleDir(c,r);var n=window.performance.now();return u.log("i10n:init style fetching:"+(t-o)+"ms")(),u.log("i10n:init style executing:"+(n-t)+"ms")(),p.localeChange(),u.log("i10n:init Locale Updated: "+this._locales.join(":"))(),this._locales})}return this._switchStyleDir(c,r),p.localeChange(),u.log("i10n:init Locale Updated: "+this._locales.join(":"))(),this._locales})["catch"](s["default"].CancellationError,_.noop)["catch"](function(){return this._locales=[w],l.setCollator(w),moment.locale([_.first(this._locales),E]),this.customizeMomentLocale(moment.locale()),this._switchStyleDir(c,T.LTR),p.localeChange(),u.error("i10n:init Failed to fetch locales",t)(),this._locales})},_switchStyleDir:function(e,t){if(e!==t){var n=document.getElementById("style");t===S?(e!==S&&this._loadedStyle&&(this._loadedStyle.unuse(),c.isGecko&&n.setAttribute("href",C)),n.removeAttribute("disabled"),document.documentElement.setAttribute("dir",t)):(c.isGecko&&n.setAttribute("href",""),n.setAttribute("disabled","true"),document.documentElement.setAttribute("dir",t),this._loadedStyle.use())}},_loadRTL:function(){return g.loopOnError(function(e){return s["default"].delay(v.expBackoff(e,12e4,1e3,.1)).then(function(){return n.e(1).then(function(e){return n(694)}.bind(null,n))["catch"](function(e){n.oe(e)})})})},_loadLTR:function(){return g.loopOnError(function(e){return s["default"].delay(v.expBackoff(e,12e4,1e3,.1)).then(function(){return n.e(2).then(function(e){return n(693)}.bind(null,n))["catch"](function(e){n.oe(e)})})})},_loadStyle:function(){return S===T.RTL?this._loadLTR():this._loadRTL()},_addLocale:function(e,t){if(e){var n=e.replace("-","_").toLowerCase();$[n]&&(n=$[n],n=n.replace("-","_").toLowerCase());var r=t.indexOf(n);0>r&&this.isLocaleSupported(e)&&t.push(n);var i=n.split("_");if(!(i.length<0)){var o=_.first(i),a=t.indexOf(o);0>a&&this.isLocaleSupported(o)&&t.push(o)}}},isLocaleSupported:function(e){try{return!!e&&(!window.Intl||_.isArray(window.Intl.Collator.supportedLocalesOf([e])))&&!!$[e.replace("-","_").toLowerCase()]}catch(t){return!1}},lng:function(){var e=_.first(this._locales);return $[e]||e},isRTL:function(){return O.indexOf(_.first(this._locales))>=0},LR:function(e,t){return this.isRTL()?t:e},curDir:function(){return document.documentElement.getAttribute("dir")===T.RTL?T.RTL:T.LTR},embedDir:function(e){var t=arguments.length<=1||void 0===arguments[1]?this.isRTL():arguments[1];return t?this.embedRTL(e):this.embedLTR(e)},forceDir:function(e){var t=arguments.length<=1||void 0===arguments[1]?this.isRTL():arguments[1];return t?this.forceRTL(e):this.forceLTR(e)},embedLTR:function(e){return""+e+""},embedRTL:function(e){return""+e+""},forceLTR:function(e){return""+e},forceRTL:function(e){return""+e},hasT:function(e,t){for(var n,r,i=t&&t._plural?t._plural:void 0,o=0;o<this._locales.length;o++)if(n=e+this.getPluralExt(this._locales[o],i),r=k[this._locales[o]],r[n])return!0;return!1},t:function(e,t){for(var n,r,i="",o=t&&t._plural?t._plural:void 0,a=0;a<this._locales.length&&(n=e+this.getPluralExt(r=this._locales[a],o),!(i=k[r][n]));a++);for(n in t){if(!t.hasOwnProperty(n))return;i=i.replace("__"+n+"__",this.n(t[n],r))}return i},isHindiNumerals:function(e){return A.indexOf(e||this._locales[0])>-1},n:function(e,t){return this.isHindiNumerals(t)?e.toString().replace(/[0-9]/g,i):e},numAndPunc:function(e){return this.isHindiNumerals()?this.embedLTR(this.n(e).replace(/./g,this.forceLTR)):e},filesize:function(e){return this.n(d(e,{round:0,suffixes:{B:this.t("filesize_byte"),kB:this.t("filesize_kilobyte"),MB:this.t("filesize_megabyte"),GB:this.t("filesize_gigabyte")}}))},getPluralExt:function(e,t){if(!t)return"";var n=f[e];if(!n)return"";var r=n.plurals(t),i=n.numbers[r];return 1===i?"":2===n.numbers.length&&2===i?"_plural":"_plural_"+i},removeAccents:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return m(e.normalize("NFKD").replace(h.mark,""))},accentFold:function(e){return this.removeAccents(e).toLowerCase()},customizeMomentLocale:function(){var e={"zh-tw":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYYMMMD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"}},"zh-cn":{longDateFormat:{LT:"Ah:mm",LTS:"Ah:m:s",L:"YYYY-MM-DD",LL:"YYYYMMMD",LLL:"YYYYMMMDLT",LLLL:"YYYYMMMDddddLT",l:"YYYYMMMD",ll:"YYYYMMMD",lll:"YYYYMMMDLT",llll:"YYYYMMMDddddLT"}},ar:{longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"}}};return function(t){var n=e[t];n&&moment.locale(t,n)}}()}},function(e,t){"use strict";_.mixin({forceArray:function(e){return _.isArray(e)?e:[e]}})},function(e,t){"use strict";!function(){if("performance"in window==!1&&(window.performance={}),!("now"in window.performance)){var e=window.performance,t=e.timing&&e.timing.navigationStart?e.timing.navigationStart:Date.now();e.now=function(){return Date.now()-t}}}()},function(e,t,n){(function(t,n,r){/* @preserve
	 * The MIT License (MIT)
	 * 
	 * Copyright (c) 2014 Petka Antonov
	 * 
	 * Permission is hereby granted, free of charge, to any person obtaining a copy
	 * of this software and associated documentation files (the "Software"), to deal
	 * in the Software without restriction, including without limitation the rights
	 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	 * copies of the Software, and to permit persons to whom the Software is
	 * furnished to do so, subject to the following conditions:
	 * 
	 * The above copyright notice and this permission notice shall be included in
	 * all copies or substantial portions of the Software.
	 * 
	 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
	 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
	 * THE SOFTWARE.
	 * 
	 */
!function(t){e.exports=t()}(function(){var e,i,o;return function a(e,t,n){function r(o,s){if(!t[o]){if(!e[o]){var u="function"==typeof _dereq_&&_dereq_;if(!s&&u)return u(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return r(n?n:t)},l,l.exports,a,e,t,n)}return t[o].exports}for(var i="function"==typeof _dereq_&&_dereq_,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){"use strict";t.exports=function(e){function t(e){var t=new n(e),r=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),r}var n=e._SomePromiseArray;e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}},{}],2:[function(e,t,n){"use strict";function r(){this._isTickUsed=!1,this._lateQueue=new l(16),this._normalQueue=new l(16),this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=c.isStatic?c(this.drainQueues):c}function i(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function o(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function a(e){this._normalQueue._pushOne(e),this._queueTick()}var s;try{throw new Error}catch(u){s=u}var c=e("./schedule.js"),l=e("./queue.js"),d=e("./util.js");r.prototype.disableTrampolineIfNecessary=function(){d.hasDevTools&&(this._trampolineEnabled=!1)},r.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(e){setTimeout(e,0)})},r.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},r.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},d.hasDevTools?(c.isStatic&&(c=function(e){setTimeout(e,0)}),r.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?i.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},r.prototype.invoke=function(e,t,n){this._trampolineEnabled?o.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},r.prototype.settlePromises=function(e){this._trampolineEnabled?a.call(this,e):this._schedule(function(){e._settlePromises()})}):(r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=a),r.prototype.invokeFirst=function(e,t,n){this._normalQueue.unshift(e,t,n),this._queueTick()},r.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),r=e.shift();t.call(n,r)}else t._settlePromises()}},r.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},t.exports=new r,t.exports.firstLineError=s},{"./queue.js":28,"./schedule.js":31,"./util.js":38}],3:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=function(e,t){this._reject(t)},i=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(r,r,null,this,e)},o=function(e,t){this._isPending()&&this._resolveCallback(t.target)},a=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(r){var s=n(r),u=new e(t);u._propagateFrom(this,1);var c=this._target();if(u._setBoundTo(s),s instanceof e){var l={promiseRejectionQueued:!1,promise:u,target:c,bindingPromise:s};c._then(t,i,u._progress,u,l),s._then(o,a,u._progress,u,l)}else u._resolveCallback(c);return u},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=131072|this._bitField,this._boundTo=e):this._bitField=-131073&this._bitField},e.prototype._isBound=function(){return 131072===(131072&this._bitField)},e.bind=function(r,i){var o=n(r),a=new e(t);return a._setBoundTo(o),o instanceof e?o._then(function(){a._resolveCallback(i)},a._reject,a._progress,a,null):a._resolveCallback(i),a}}},{}],4:[function(e,t,n){"use strict";function r(){try{Promise===o&&(Promise=i)}catch(e){}return o}var i;"undefined"!=typeof Promise&&(i=Promise);var o=e("./promise.js")();o.noConflict=r,t.exports=o},{"./promise.js":23}],5:[function(e,t,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}t.exports=function(t){function n(e,n){var r;if(null!=e&&(r=e[n]),"function"!=typeof r){var i="Object "+s.classString(e)+" has no method '"+s.toString(n)+"'";throw new t.TypeError(i)}return r}function r(e){var t=this.pop(),r=n(e,t);return r.apply(e,this)}function i(e){return e[this]}function o(e){var t=+this;return 0>t&&(t=Math.max(0,t+e.length)),e[t]}var a,s=e("./util.js"),u=s.canEvaluate;s.isIdentifier;t.prototype.call=function(e){for(var t=arguments.length,n=new Array(t-1),i=1;t>i;++i)n[i-1]=arguments[i];return n.push(e),this._then(r,void 0,void 0,n,void 0)},t.prototype.get=function(e){var t,n="number"==typeof e;if(n)t=o;else if(u){var r=a(e);t=null!==r?r:i}else t=i;return this._then(t,void 0,void 0,e,void 0)}}},{"./util.js":38}],6:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./errors.js"),r=e("./async.js"),i=n.CancellationError;t.prototype._cancel=function(e){if(!this.isCancellable())return this;for(var t,n=this;void 0!==(t=n._cancellationParent)&&t.isCancellable();)n=t;this._unsetCancellable(),n._target()._rejectCallback(e,!1,!0)},t.prototype.cancel=function(e){return this.isCancellable()?(void 0===e&&(e=new i),r.invokeLater(this._cancel,this,e),this):this},t.prototype.cancellable=function(){return this._cancellable()?this:(r.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0,this)},t.prototype.uncancellable=function(){var e=this.then();return e._unsetCancellable(),e},t.prototype.fork=function(e,t,n){var r=this._then(e,t,n,void 0,void 0);return r._setCancellable(),r._cancellationParent=void 0,r}}},{"./async.js":2,"./errors.js":13}],7:[function(e,n,r){"use strict";n.exports=function(){function n(e){this._parent=e;var t=this._length=1+(void 0===e?0:e._length);w(this,n),t>32&&this.uncycle()}function r(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function i(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function o(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],i=t.length-1,o=t[i],a=-1,s=r.length-1;s>=0;--s)if(r[s]===o){a=s;break}for(var s=a;s>=0;--s){var u=r[s];if(t[i]!==u)break;t.pop(),i--}t=r}}function a(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],i=g.test(r)||"    (No stack trace)"===r,o=i&&v(r);i&&!o&&(_&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function s(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||g.test(r))break}return n>0&&(t=t.slice(n)),t}function u(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e.toString();var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(t))try{var r=JSON.stringify(e);t=r}catch(i){}0===t.length&&(t="(empty array)")}return"(<"+c(t)+">, no stack trace)"}function c(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function l(e){var t=e.match(b);return t?{fileName:t[1],line:parseInt(t[2],10)}:void 0}var d,f=e("./async.js"),p=e("./util.js"),h=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,g=null,m=null,_=!1;p.inherits(n,Error),n.prototype.uncycle=function(){var e=this._length;if(!(2>e)){for(var t=[],n={},r=0,i=this;void 0!==i;++r)t.push(i),i=i._parent;e=this._length=r;for(var r=e-1;r>=0;--r){var o=t[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;e>r;++r){var a=t[r].stack,s=n[a];if(void 0!==s&&s!==r){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var u=r>0?t[r-1]:this;e-1>s?(u._parent=t[s+1],u._parent.uncycle(),u._length=u._parent._length+1):(u._parent=void 0,u._length=1);for(var c=u._length+1,l=r-2;l>=0;--l)t[l]._length=c,c++;return}}}},n.prototype.parent=function(){return this._parent},n.prototype.hasParent=function(){return void 0!==this._parent},n.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=n.parseStackAndMessage(e),s=t.message,u=[t.stack],c=this;void 0!==c;)u.push(a(c.stack.split("\n"))),c=c._parent;o(u),i(u),p.notEnumerableProp(e,"stack",r(s,u)),p.notEnumerableProp(e,"__stackCleaned__",!0)}},n.parseStackAndMessage=function(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?s(e):["    (No stack trace)"],{message:n,stack:a(t)}},n.formatAndLogError=function(e,t){if("undefined"!=typeof console){var n;if("object"==typeof e||"function"==typeof e){var r=e.stack;n=t+m(r,e)}else n=t+String(e);"function"==typeof d?d(n):("function"==typeof console.log||"object"==typeof console.log)&&console.log(n)}},n.unhandledRejection=function(e){n.formatAndLogError(e,"^--- With additional stack trace: ")},n.isSupported=function(){return"function"==typeof w},n.fireRejectionEvent=function(e,t,r,i){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(i):t(r,i))}catch(a){f.throwLater(a)}var s=!1;try{s=E(e,r,i)}catch(a){s=!0,f.throwLater(a)}var u=!1;if(y)try{u=y(e.toLowerCase(),{reason:r,promise:i})}catch(a){u=!0,f.throwLater(a)}s||o||u||"unhandledRejection"!==e||n.formatAndLogError(r,"Unhandled rejection ")};var v=function(){return!1},b=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;n.setBounds=function(e,t){if(n.isSupported()){for(var r,i,o=e.stack.split("\n"),a=t.stack.split("\n"),s=-1,u=-1,c=0;c<o.length;++c){var d=l(o[c]);if(d){r=d.fileName,s=d.line;break}}for(var c=0;c<a.length;++c){var d=l(a[c]);if(d){i=d.fileName,u=d.line;break}}0>s||0>u||!r||!i||r!==i||s>=u||(v=function(e){if(h.test(e))return!0;var t=l(e);return t&&t.fileName===r&&s<=t.line&&t.line<=u?!0:!1})}};var y,w=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():u(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,g=e,m=t;var n=Error.captureStackTrace;return v=function(e){return h.test(e)},function(e,t){Error.stackTraceLimit=Error.stackTraceLimit+6,n(e,t),Error.stackTraceLimit=Error.stackTraceLimit-6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return g=/@/,m=t,_=!0,function(e){e.stack=(new Error).stack};var i;try{throw new Error}catch(o){i="stack"in o}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(m=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?u(t):t.toString()},null):(g=e,m=t,function(e){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit=Error.stackTraceLimit-6})}([]),E=function(){if(p.isNode)return function(e,n,r){return"rejectionHandled"===e?t.emit(e,r):t.emit(e,n,r)};var e=!1,n=!0;try{var r=new self.CustomEvent("test");e=r instanceof CustomEvent}catch(i){}if(!e)try{var o=document.createEvent("CustomEvent");o.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(o)}catch(i){n=!1}n&&(y=function(t,n){var r;return e?r=new self.CustomEvent(t,{detail:n,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!1,!0,n)),r?!self.dispatchEvent(r):!1});var a={};return a.unhandledRejection="onunhandledRejection".toLowerCase(),a.rejectionHandled="onrejectionHandled".toLowerCase(),function(e,t,n){var r=a[e],i=self[r];return i?("rejectionHandled"===e?i.call(self,n):i.call(self,t,n),!0):!1}}();return"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(d=function(e){console.warn(e)},p.isNode&&t.stderr.isTTY?d=function(e){t.stderr.write("[31m"+e+"[39m\n")}:p.isNode||"string"!=typeof(new Error).stack||(d=function(e){console.warn("%c"+e,"color: red")})),n}},{"./async.js":2,"./util.js":38}],8:[function(e,t,n){"use strict";t.exports=function(t){function n(e,t,n){this._instances=e,this._callback=t,this._promise=n}function r(e,t){var n={},r=a(e).call(n,t);if(r===s)return r;var i=u(n);return i.length?(s.e=new c("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),s):r}var i=e("./util.js"),o=e("./errors.js"),a=i.tryCatch,s=i.errorObj,u=e("./es5.js").keys,c=o.TypeError;return n.prototype.doFilter=function(e){for(var n=this._callback,i=this._promise,o=i._boundValue(),u=0,c=this._instances.length;c>u;++u){var l=this._instances[u],d=l===Error||null!=l&&l.prototype instanceof Error;if(d&&e instanceof l){var f=a(n).call(o,e);return f===s?(t.e=f.e,t):f}if("function"==typeof l&&!d){var p=r(l,e);if(p===s){e=s.e;break}if(p){var f=a(n).call(o,e);return f===s?(t.e=f.e,t):f}}}return t.e=e,t},n}},{"./errors.js":13,"./es5.js":14,"./util.js":38}],9:[function(e,t,n){"use strict";t.exports=function(e,t,n){function r(){this._trace=new t(o())}function i(){return n()?new r:void 0}function o(){var e=a.length-1;return e>=0?a[e]:void 0}var a=[];return r.prototype._pushContext=function(){n()&&void 0!==this._trace&&a.push(this._trace)},r.prototype._popContext=function(){n()&&void 0!==this._trace&&a.pop()},e.prototype._peekContext=o,e.prototype._pushContext=r.prototype._pushContext,e.prototype._popContext=r.prototype._popContext,i}},{}],10:[function(e,t,n){"use strict";t.exports=function(t,n){var r,i,o=t._getDomain,a=e("./async.js"),s=e("./errors.js").Warning,u=e("./util.js"),c=u.canAttachTrace,l=u.isNode&&(!!{NODE_ENV:"production"}.BLUEBIRD_DEBUG||"development"==={NODE_ENV:"production"}.NODE_ENV);return l&&a.disableTrampolineIfNecessary(),t.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},t.prototype._ensurePossibleRejectionHandled=function(){0===(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),a.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){n.fireRejectionEvent("rejectionHandled",r,void 0,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),n.fireRejectionEvent("unhandledRejection",i,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},t.prototype._setCarriedStackTrace=function(e){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=e},t.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},t.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},t.prototype._captureStackTrace=function(){return l&&(this._trace=new n(this._peekContext())),this},t.prototype._attachExtraTrace=function(e,t){if(l&&c(e)){var r=this._trace;if(void 0!==r&&t&&(r=r._parent),void 0!==r)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var i=n.parseStackAndMessage(e);u.notEnumerableProp(e,"stack",i.message+"\n"+i.stack.join("\n")),u.notEnumerableProp(e,"__stackCleaned__",!0)}}},t.prototype._warn=function(e){var t=new s(e),r=this._peekContext();if(r)r.attachExtraTrace(t);else{var i=n.parseStackAndMessage(t);t.stack=i.message+"\n"+i.stack.join("\n")}n.formatAndLogError(t,"")},t.onPossiblyUnhandledRejection=function(e){var t=o();i="function"==typeof e?null===t?e:t.bind(e):void 0},t.onUnhandledRejectionHandled=function(e){var t=o();r="function"==typeof e?null===t?e:t.bind(e):void 0},t.longStackTraces=function(){if(a.haveItemsQueued()&&l===!1)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");l=n.isSupported(),l&&a.disableTrampolineIfNecessary()},t.hasLongStackTraces=function(){return l&&n.isSupported()},n.isSupported()||(t.longStackTraces=function(){},l=!1),function(){return l}}},{"./async.js":2,"./errors.js":13,"./util.js":38}],11:[function(e,t,n){"use strict";var r=e("./util.js"),i=r.isPrimitive;t.exports=function(e){var t=function(){return this},n=function(){throw this},r=function(){},o=function(){throw void 0},a=function(e,t){return 1===t?function(){throw e}:2===t?function(){return e}:void 0};e.prototype["return"]=e.prototype.thenReturn=function(e){return void 0===e?this.then(r):i(e)?this._then(a(e,2),void 0,void 0,void 0,void 0):this._then(t,void 0,void 0,e,void 0)},e.prototype["throw"]=e.prototype.thenThrow=function(e){return void 0===e?this.then(o):i(e)?this._then(a(e,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,e,void 0)}}},{"./util.js":38}],12:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.reduce;e.prototype.each=function(e){return n(this,e,null,t)},e.each=function(e,r){return n(e,r,null,t)}}},{}],13:[function(e,t,n){"use strict";function r(e,t){function n(r){return this instanceof n?(d(this,"message","string"==typeof r?r:t),d(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return l(n,Error),n}function i(e){return this instanceof i?(d(this,"name","OperationalError"),d(this,"message",e),this.cause=e,this.isOperational=!0,void(e instanceof Error?(d(this,"message",e.message),d(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(e)}var o,a,s=e("./es5.js"),u=s.freeze,c=e("./util.js"),l=c.inherits,d=c.notEnumerableProp,f=r("Warning","warning"),p=r("CancellationError","cancellation error"),h=r("TimeoutError","timeout error"),g=r("AggregateError","aggregate error");try{o=TypeError,a=RangeError}catch(m){o=r("TypeError","type error"),a=r("RangeError","range error")}for(var _="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),v=0;v<_.length;++v)"function"==typeof Array.prototype[_[v]]&&(g.prototype[_[v]]=Array.prototype[_[v]]);s.defineProperty(g.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),g.prototype.isOperational=!0;var b=0;g.prototype.toString=function(){var e=Array(4*b+1).join(" "),t="\n"+e+"AggregateError of:\n";b++,e=Array(4*b+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=e+i[o];r=i.join("\n"),t+=r+"\n"}return b--,t},l(i,Error);var y=Error.__BluebirdErrorTypes__;y||(y=u({CancellationError:p,TimeoutError:h,OperationalError:i,RejectionError:i,AggregateError:g}),d(Error,"__BluebirdErrorTypes__",y)),t.exports={Error:Error,TypeError:o,RangeError:a,CancellationError:y.CancellationError,OperationalError:y.OperationalError,TimeoutError:y.TimeoutError,AggregateError:y.AggregateError,Warning:f}},{"./es5.js":14,"./util.js":38}],14:[function(e,t,n){var r=function(){"use strict";return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},u=function(e,t){return{value:e[t]}},c=function(e,t,n){return e[t]=n.value,e},l=function(e){return e},d=function(e){try{return Object(e).constructor.prototype}catch(t){return a}},f=function(e){try{return"[object Array]"===o.call(e)}catch(t){return!1}};t.exports={isArray:f,keys:s,names:s,defineProperty:c,getDescriptor:u,freeze:l,getPrototypeOf:d,isES5:r,propertyIsWritable:function(){return!0}}}},{}],15:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,r){return n(this,e,r,t)},e.filter=function(e,r,i){return n(e,r,i,t)}}},{}],16:[function(e,t,n){"use strict";t.exports=function(t,n,r){function i(){return this}function o(){throw this}function a(e){return function(){return e}}function s(e){return function(){throw e}}function u(e,t,n){var r;return r=f(t)?n?a(t):s(t):n?i:o,e._then(r,p,void 0,t,void 0)}function c(e){var i=this.promise,o=this.handler,a=i._isBound()?o.call(i._boundValue()):o();if(void 0!==a){var s=r(a,i);if(s instanceof t)return s=s._target(),u(s,e,i.isFulfilled())}return i.isRejected()?(n.e=e,n):e}function l(e){var n=this.promise,i=this.handler,o=n._isBound()?i.call(n._boundValue(),e):i(e);if(void 0!==o){var a=r(o,n);if(a instanceof t)return a=a._target(),u(a,e,!0)}return e}var d=e("./util.js"),f=d.isPrimitive,p=d.thrower;t.prototype._passThroughHandler=function(e,t){if("function"!=typeof e)return this.then();var n={promise:this,handler:e};return this._then(t?c:l,t?c:void 0,void 0,n,void 0)},t.prototype.lastly=t.prototype["finally"]=function(e){return this._passThroughHandler(e,!0)},t.prototype.tap=function(e){return this._passThroughHandler(e,!1)}}},{"./util.js":38}],17:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function o(e,n,r){for(var o=0;o<n.length;++o){r._pushContext();var a=d(n[o])(e);if(r._popContext(),a===l){r._pushContext();var s=t.reject(l.e);return r._popContext(),s}var u=i(a,r);if(u instanceof t)return u}return null}function a(e,n,i,o){var a=this._promise=new t(r);a._captureStackTrace(),this._stack=o,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(f):f}var s=e("./errors.js"),u=s.TypeError,c=e("./util.js"),l=c.errorObj,d=c.tryCatch,f=[];a.prototype.promise=function(){return this._promise},a.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},a.prototype._continue=function(e){if(e===l)return this._promise._rejectCallback(e.e,!1,!0);var n=e.value;if(e.done===!0)this._promise._resolveCallback(n);else{var r=i(n,this._promise);if(!(r instanceof t)&&(r=o(r,this._yieldHandlers,this._promise),null===r))return void this._throw(new u("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",n)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));r._then(this._next,this._throw,void 0,this,null)}},a.prototype._throw=function(e){this._promise._attachExtraTrace(e),this._promise._pushContext();var t=d(this._generator["throw"]).call(this._generator,e);this._promise._popContext(),this._continue(t)},a.prototype._next=function(e){this._promise._pushContext();var t=d(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},t.coroutine=function(e,t){if("function"!=typeof e)throw new u("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var n=Object(t).yieldHandler,r=a,i=(new Error).stack;return function(){var t=e.apply(this,arguments),o=new r(void 0,void 0,n,i);return o._generator=t,o._next(void 0),o.promise()}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new u("fn must be a function\n\n    See http://goo.gl/916lJJ\n");f.push(e)},t.spawn=function(e){if("function"!=typeof e)return n("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var r=new a(e,this),i=r.promise();return r._run(t.spawn),i}}},{"./errors.js":13,"./util.js":38}],18:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){var o=e("./util.js");o.canEvaluate,o.tryCatch,o.errorObj;t.join=function(){var e,t=arguments.length-1;if(t>0&&"function"==typeof arguments[t]){e=arguments[t];var r}for(var i=arguments.length,o=new Array(i),a=0;i>a;++a)o[a]=arguments[a];e&&o.pop();var r=new n(o).promise();return void 0!==e?r.spread(e):r}}},{"./util.js":38}],19:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o){function a(e,t,n,r){this.constructor$(e),this._promise._captureStackTrace();var i=c();this._callback=null===i?t:i.bind(t),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=n>=1?[]:g,l.invoke(s,this,void 0)}function s(){this._init$(void 0,-2)}function u(e,t,n,r){var i="object"==typeof n&&null!==n?n.concurrency:0;return i="number"==typeof i&&isFinite(i)&&i>=1?i:0,new a(e,t,i,r)}var c=t._getDomain,l=e("./async.js"),d=e("./util.js"),f=d.tryCatch,p=d.errorObj,h={},g=[];d.inherits(a,n),a.prototype._init=function(){},a.prototype._promiseFulfilled=function(e,n){var r=this._values,o=this.length(),a=this._preservedValues,s=this._limit;if(r[n]===h){if(r[n]=e,s>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(s>=1&&this._inFlight>=s)return r[n]=e,void this._queue.push(n);null!==a&&(a[n]=e);var u=this._callback,c=this._promise._boundValue();this._promise._pushContext();var l=f(u).call(c,e,n,o);if(this._promise._popContext(),l===p)return this._reject(l.e);var d=i(l,this._promise);if(d instanceof t){if(d=d._target(),d._isPending())return s>=1&&this._inFlight++,r[n]=h,d._proxyPromiseArray(this,n);if(!d._isFulfilled())return this._reject(d._reason());l=d._value()}r[n]=l}var g=++this._totalResolved;g>=o&&(null!==a?this._filter(r,a):this._resolve(r))},a.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(n[r],r)}},a.prototype._filter=function(e,t){for(var n=t.length,r=new Array(n),i=0,o=0;n>o;++o)e[o]&&(r[i++]=t[o]);r.length=i,this._resolve(r)},a.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return"function"!=typeof e?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):u(this,e,t,null).promise()},t.map=function(e,t,n,i){return"function"!=typeof t?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):u(e,t,n,i).promise()}}},{"./async.js":2,"./util.js":38}],20:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){var o=e("./util.js"),a=o.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var r=new t(n);r._captureStackTrace(),r._pushContext();var i=a(e).apply(this,arguments);return r._popContext(),r._resolveFromSyncValue(i),r}},t.attempt=t["try"]=function(e,r,s){if("function"!=typeof e)return i("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var u=new t(n);u._captureStackTrace(),u._pushContext();var c=o.isArray(r)?a(e).apply(s,r):a(e).call(s,r);return u._popContext(),u._resolveFromSyncValue(c),u},t.prototype._resolveFromSyncValue=function(e){e===o.errorObj?this._rejectCallback(e.e,!1,!0):this._resolveCallback(e,!0)}}},{"./util.js":38}],21:[function(e,t,n){"use strict";t.exports=function(t){function n(e,t){var n=this;if(!o.isArray(e))return r.call(n,e,t);var i=s(t).apply(n._boundValue(),[null].concat(e));i===u&&a.throwLater(i.e)}function r(e,t){var n=this,r=n._boundValue(),i=void 0===e?s(t).call(r,null):s(t).call(r,null,e);i===u&&a.throwLater(i.e)}function i(e,t){var n=this;if(!e){var r=n._target(),i=r._getCarriedStackTrace();i.cause=e,e=i}var o=s(t).call(n._boundValue(),e);o===u&&a.throwLater(o.e)}var o=e("./util.js"),a=e("./async.js"),s=o.tryCatch,u=o.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var o=r;void 0!==t&&Object(t).spread&&(o=n),this._then(o,i,void 0,this,e)}return this}}},{"./async.js":2,"./util.js":38}],22:[function(e,t,n){"use strict";t.exports=function(t,n){var r=e("./util.js"),i=e("./async.js"),o=r.tryCatch,a=r.errorObj;t.prototype.progressed=function(e){return this._then(void 0,void 0,e,void 0,void 0)},t.prototype._progress=function(e){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(e)},t.prototype._progressHandlerAt=function(e){return 0===e?this._progressHandler0:this[(e<<2)+e-5+2]},t.prototype._doProgressWith=function(e){var n=e.value,i=e.handler,s=e.promise,u=e.receiver,c=o(i).call(u,n);if(c===a){if(null!=c.e&&"StopProgressPropagation"!==c.e.name){var l=r.canAttachTrace(c.e)?c.e:new Error(r.toString(c.e));s._attachExtraTrace(l),s._progress(c.e)}}else c instanceof t?c._then(s._progress,null,null,s,void 0):s._progress(c)},t.prototype._progressUnchecked=function(e){for(var r=this._length(),o=this._progress,a=0;r>a;a++){var s=this._progressHandlerAt(a),u=this._promiseAt(a);if(u instanceof t)"function"==typeof s?i.invoke(this._doProgressWith,this,{handler:s,promise:u,receiver:this._receiverAt(a),value:e}):i.invoke(o,u,e);else{var c=this._receiverAt(a);"function"==typeof s?s.call(c,e,u):c instanceof n&&!c._isResolved()&&c._promiseProgressed(e,u)}}}}},{"./async.js":2,"./util.js":38}],23:[function(e,n,r){"use strict";n.exports=function(){function n(e){if("function"!=typeof e)throw new d("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==n)throw new d("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,e!==f&&this._resolveFromResolver(e)}function r(e){var t=new n(f);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._progressHandler0=e,t._promise0=e,t._receiver0=e,t._settledValue=e}var i,o=function(){return new d("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},a=function(){return new n.PromiseInspection(this._target())},s=function(e){return n.reject(new d(e))},u=e("./util.js");i=u.isNode?function(){var e=t.domain;return void 0===e&&(e=null),e}:function(){return null},u.notEnumerableProp(n,"_getDomain",i);var c=e("./async.js"),l=e("./errors.js"),d=n.TypeError=l.TypeError;n.RangeError=l.RangeError,n.CancellationError=l.CancellationError,n.TimeoutError=l.TimeoutError,n.OperationalError=l.OperationalError,n.RejectionError=l.OperationalError,n.AggregateError=l.AggregateError;var f=function(){},p={},h={e:null},g=e("./thenables.js")(n,f),m=e("./promise_array.js")(n,f,g,s),_=e("./captured_trace.js")(),v=e("./debuggability.js")(n,_),b=e("./context.js")(n,_,v),y=e("./catch_filter.js")(h),w=e("./promise_resolver.js"),E=w._nodebackForPromise,S=u.errorObj,C=u.tryCatch;return n.prototype.toString=function(){return"[object Promise]"},n.prototype.caught=n.prototype["catch"]=function(e){var t=arguments.length;if(t>1){var r,i=new Array(t-1),o=0;for(r=0;t-1>r;++r){var a=arguments[r];if("function"!=typeof a)return n.reject(new d("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));i[o++]=a}i.length=o,e=arguments[r];var s=new y(i,e,this);return this._then(void 0,s.doFilter,void 0,s,void 0)}return this._then(void 0,e,void 0,void 0,void 0)},n.prototype.reflect=function(){return this._then(a,a,void 0,this,void 0)},n.prototype.then=function(e,t,n){if(v()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var r=".then() only accepts functions but was passed: "+u.classString(e);arguments.length>1&&(r+=", "+u.classString(t)),this._warn(r)}return this._then(e,t,n,void 0,void 0)},n.prototype.done=function(e,t,n){var r=this._then(e,t,n,void 0,void 0);r._setIsFinal()},n.prototype.spread=function(e,t){return this.all()._then(e,t,void 0,p,void 0)},n.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},n.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,
rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},n.prototype.all=function(){return new m(this).promise()},n.prototype.error=function(e){return this.caught(u.originatesFromRejection,e)},n.is=function(e){return e instanceof n},n.fromNode=function(e){var t=new n(f),r=C(e)(E(t));return r===S&&t._rejectCallback(r.e,!0,!0),t},n.all=function(e){return new m(e).promise()},n.defer=n.pending=function(){var e=new n(f);return new w(e)},n.cast=function(e){var t=g(e);if(!(t instanceof n)){var r=t;t=new n(f),t._fulfillUnchecked(r)}return t},n.resolve=n.fulfilled=n.cast,n.reject=n.rejected=function(e){var t=new n(f);return t._captureStackTrace(),t._rejectCallback(e,!0),t},n.setScheduler=function(e){if("function"!=typeof e)throw new d("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var t=c._schedule;return c._schedule=e,t},n.prototype._then=function(e,t,r,o,a){var s=void 0!==a,u=s?a:new n(f);s||(u._propagateFrom(this,5),u._captureStackTrace());var l=this._target();l!==this&&(void 0===o&&(o=this._boundTo),s||u._setIsMigrated());var d=l._addCallbacks(e,t,r,u,o,i());return l._isResolved()&&!l._isSettlePromisesQueued()&&c.invoke(l._settlePromiseAtPostResolution,l,d),u},n.prototype._settlePromiseAtPostResolution=function(e){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(e)},n.prototype._length=function(){return 131071&this._bitField},n.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},n.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},n.prototype._setLength=function(e){this._bitField=-131072&this._bitField|131071&e},n.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},n.prototype._setRejected=function(){this._bitField=134217728|this._bitField},n.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},n.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},n.prototype._isFinal=function(){return(33554432&this._bitField)>0},n.prototype._cancellable=function(){return(67108864&this._bitField)>0},n.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},n.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},n.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},n.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},n.prototype._isMigrated=function(){return(4194304&this._bitField)>0},n.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[5*e-5+4];return void 0===t&&this._isBound()?this._boundValue():t},n.prototype._promiseAt=function(e){return 0===e?this._promise0:this[5*e-5+3]},n.prototype._fulfillmentHandlerAt=function(e){return 0===e?this._fulfillmentHandler0:this[5*e-5+0]},n.prototype._rejectionHandlerAt=function(e){return 0===e?this._rejectionHandler0:this[5*e-5+1]},n.prototype._boundValue=function(){var e=this._boundTo;return void 0!==e&&e instanceof n?e.isFulfilled()?e.value():void 0:e},n.prototype._migrateCallbacks=function(e,t){var r=e._fulfillmentHandlerAt(t),i=e._rejectionHandlerAt(t),o=e._progressHandlerAt(t),a=e._promiseAt(t),s=e._receiverAt(t);a instanceof n&&a._setIsMigrated(),this._addCallbacks(r,i,o,a,s,null)},n.prototype._addCallbacks=function(e,t,n,r,i,o){var a=this._length();if(a>=131066&&(a=0,this._setLength(0)),0===a)this._promise0=r,void 0!==i&&(this._receiver0=i),"function"!=typeof e||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===o?e:o.bind(e)),"function"==typeof t&&(this._rejectionHandler0=null===o?t:o.bind(t)),"function"==typeof n&&(this._progressHandler0=null===o?n:o.bind(n));else{var s=5*a-5;this[s+3]=r,this[s+4]=i,"function"==typeof e&&(this[s+0]=null===o?e:o.bind(e)),"function"==typeof t&&(this[s+1]=null===o?t:o.bind(t)),"function"==typeof n&&(this[s+2]=null===o?n:o.bind(n))}return this._setLength(a+1),a},n.prototype._setProxyHandlers=function(e,t){var n=this._length();if(n>=131066&&(n=0,this._setLength(0)),0===n)this._promise0=t,this._receiver0=e;else{var r=5*n-5;this[r+3]=t,this[r+4]=e}this._setLength(n+1)},n.prototype._proxyPromiseArray=function(e,t){this._setProxyHandlers(e,t)},n.prototype._resolveCallback=function(e,t){if(!this._isFollowingOrFulfilledOrRejected()){if(e===this)return this._rejectCallback(o(),!1,!0);var r=g(e,this);if(!(r instanceof n))return this._fulfill(e);var i=1|(t?4:0);this._propagateFrom(r,i);var a=r._target();if(a._isPending()){for(var s=this._length(),u=0;s>u;++u)a._migrateCallbacks(this,u);this._setFollowing(),this._setLength(0),this._setFollowee(a)}else a._isFulfilled()?this._fulfillUnchecked(a._value()):this._rejectUnchecked(a._reason(),a._getCarriedStackTrace())}},n.prototype._rejectCallback=function(e,t,n){n||u.markAsOriginatingFromRejection(e);var r=u.ensureErrorObject(e),i=r===e;this._attachExtraTrace(r,t?i:!1),this._reject(e,i?void 0:r)},n.prototype._resolveFromResolver=function(e){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=C(e)(function(e){null!==t&&(t._resolveCallback(e),t=null)},function(e){null!==t&&(t._rejectCallback(e,n),t=null)});n=!1,this._popContext(),void 0!==r&&r===S&&null!==t&&(t._rejectCallback(r.e,!0,!0),t=null)},n.prototype._settlePromiseFromHandler=function(e,t,n,r){if(!r._isRejected()){r._pushContext();var i;if(i=t!==p||this._isRejected()?C(e).call(t,n):C(e).apply(this._boundValue(),n),r._popContext(),i===S||i===r||i===h){var a=i===r?o():i.e;r._rejectCallback(a,!1,!0)}else r._resolveCallback(i)}},n.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},n.prototype._followee=function(){return this._rejectionHandler0},n.prototype._setFollowee=function(e){this._rejectionHandler0=e},n.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},n.prototype._propagateFrom=function(e,t){(1&t)>0&&e._cancellable()&&(this._setCancellable(),this._cancellationParent=e),(4&t)>0&&e._isBound()&&this._setBoundTo(e._boundTo)},n.prototype._fulfill=function(e){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(e)},n.prototype._reject=function(e,t){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(e,t)},n.prototype._settlePromiseAt=function(e){var t=this._promiseAt(e),r=t instanceof n;if(r&&t._isMigrated())return t._unsetIsMigrated(),c.invoke(this._settlePromiseAt,this,e);var i=this._isFulfilled()?this._fulfillmentHandlerAt(e):this._rejectionHandlerAt(e),o=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,a=this._settledValue,s=this._receiverAt(e);this._clearCallbackDataAtIndex(e),"function"==typeof i?r?this._settlePromiseFromHandler(i,s,a,t):i.call(s,a,t):s instanceof m?s._isResolved()||(this._isFulfilled()?s._promiseFulfilled(a,t):s._promiseRejected(a,t)):r&&(this._isFulfilled()?t._fulfill(a):t._reject(a,o)),e>=4&&4===(31&e)&&c.invokeLater(this._setLength,this,0)},n.prototype._clearCallbackDataAtIndex=function(e){if(0===e)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var t=5*e-5;this[t+3]=this[t+4]=this[t+0]=this[t+1]=this[t+2]=void 0}},n.prototype._isSettlePromisesQueued=function(){return-1073741824===(-1073741824&this._bitField)},n.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},n.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},n.prototype._queueSettlePromises=function(){c.settlePromises(this),this._setSettlePromisesQueued()},n.prototype._fulfillUnchecked=function(e){if(e===this){var t=o();return this._attachExtraTrace(t),this._rejectUnchecked(t,void 0)}this._setFulfilled(),this._settledValue=e,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},n.prototype._rejectUncheckedCheckError=function(e){var t=u.ensureErrorObject(e);this._rejectUnchecked(e,t===e?void 0:t)},n.prototype._rejectUnchecked=function(e,t){if(e===this){var n=o();return this._attachExtraTrace(n),this._rejectUnchecked(n)}return this._setRejected(),this._settledValue=e,this._cleanValues(),this._isFinal()?void c.throwLater(function(e){throw"stack"in e&&c.invokeFirst(_.unhandledRejection,void 0,e),e},void 0===t?e:t):(void 0!==t&&t!==e&&this._setCarriedStackTrace(t),void(this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled()))},n.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var e=this._length(),t=0;e>t;t++)this._settlePromiseAt(t)},u.notEnumerableProp(n,"_makeSelfResolutionError",o),e("./progress.js")(n,m),e("./method.js")(n,f,g,s),e("./bind.js")(n,f,g),e("./finally.js")(n,h,g),e("./direct_resolve.js")(n),e("./synchronous_inspection.js")(n),e("./join.js")(n,m,g,f),n.Promise=n,e("./map.js")(n,m,s,g,f),e("./cancel.js")(n),e("./using.js")(n,s,g,b),e("./generators.js")(n,s,f,g),e("./nodeify.js")(n),e("./call_get.js")(n),e("./props.js")(n,m,g,s),e("./race.js")(n,f,g,s),e("./reduce.js")(n,m,s,g,f),e("./settle.js")(n,m),e("./some.js")(n,m,s),e("./promisify.js")(n,f),e("./any.js")(n),e("./each.js")(n,f),e("./timers.js")(n,f),e("./filter.js")(n,f),u.toFastProperties(n),u.toFastProperties(n.prototype),r({a:1}),r({b:2}),r({c:3}),r(1),r(function(){}),r(void 0),r(!1),r(new n(f)),_.setBounds(c.firstLineError,u.lastLineError),n}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./context.js":9,"./debuggability.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./method.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38}],24:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function o(e){switch(e){case-2:return[];case-3:return{}}}function a(e){var r,i=this._promise=new t(n);e instanceof t&&(r=e,i._propagateFrom(r,5)),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var s=e("./util.js"),u=s.isArray;return a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function c(e,n){var a=r(this._values,this._promise);if(a instanceof t){if(a=a._target(),this._values=a,!a._isFulfilled())return a._isPending()?void a._then(c,this._reject,void 0,this,n):void this._reject(a._reason());if(a=a._value(),!u(a)){var s=new t.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(s)}}else if(!u(a))return void this._promise._reject(i("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0===a.length)return void(-5===n?this._resolveEmptyArray():this._resolve(o(n)));var l=this.getActualLength(a.length);this._length=l,this._values=this.shouldCopyValues()?new Array(l):this._values;for(var d=this._promise,f=0;l>f;++f){var p=this._isResolved(),h=r(a[f],d);h instanceof t?(h=h._target(),p?h._ignoreRejections():h._isPending()?h._proxyPromiseArray(this,f):h._isFulfilled()?this._promiseFulfilled(h._value(),f):this._promiseRejected(h._reason(),f)):p||this._promiseFulfilled(h,f)}},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype.__hardReject__=a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1,!0)},a.prototype._promiseProgressed=function(e,t){this._promise._progress({index:t,value:e})},a.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},a.prototype._promiseRejected=function(e,t){this._totalResolved++,this._reject(e)},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},{"./util.js":38}],25:[function(e,t,n){"use strict";function r(e){return e instanceof Error&&p.getPrototypeOf(e)===Error.prototype}function i(e){var t;if(r(e)){t=new d(e),t.name=e.name,t.message=e.message,t.stack=e.stack;for(var n=p.keys(e),i=0;i<n.length;++i){var o=n[i];h.test(o)||(t[o]=e[o])}return t}return s.markAsOriginatingFromRejection(e),e}function o(e){return function(t,n){if(null!==e){if(t){var r=i(u(t));e._attachExtraTrace(r),e._reject(r)}else if(arguments.length>2){for(var o=arguments.length,a=new Array(o-1),s=1;o>s;++s)a[s-1]=arguments[s];e._fulfill(a)}else e._fulfill(n);e=null}}}var a,s=e("./util.js"),u=s.maybeWrapAsError,c=e("./errors.js"),l=c.TimeoutError,d=c.OperationalError,f=s.haveGetters,p=e("./es5.js"),h=/^(?:name|message|stack|cause)$/;if(a=f?function(e){this.promise=e}:function(e){this.promise=e,this.asCallback=o(e),this.callback=this.asCallback},f){var g={get:function(){return o(this.promise)}};p.defineProperty(a.prototype,"asCallback",g),p.defineProperty(a.prototype,"callback",g)}a._nodebackForPromise=o,a.prototype.toString=function(){return"[object PromiseResolver]"},a.prototype.resolve=a.prototype.fulfill=function(e){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(e)},a.prototype.reject=function(e){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(e)},a.prototype.progress=function(e){if(!(this instanceof a))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(e)},a.prototype.cancel=function(e){this.promise.cancel(e)},a.prototype.timeout=function(){this.reject(new l("timeout"))},a.prototype.isResolved=function(){return this.promise.isResolved()},a.prototype.toJSON=function(){return this.promise.toJSON()},t.exports=a},{"./errors.js":13,"./es5.js":14,"./util.js":38}],26:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e){return!E.test(e)}function i(e){try{return e.__isPromisified__===!0}catch(t){return!1}}function o(e,t,n){var r=p.getDataPropertyOrDefault(e,t+n,y);return r?i(r):!1}function a(e,t,n){for(var r=0;r<e.length;r+=2){var i=e[r];if(n.test(i))for(var o=i.replace(n,""),a=0;a<e.length;a+=2)if(e[a]===o)throw new v("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",t))}}function s(e,t,n,r){for(var s=p.inheritedDataKeys(e),u=[],c=0;c<s.length;++c){var l=s[c],d=e[l],f=r===S?!0:S(l,d,e);"function"!=typeof d||i(d)||o(e,l,t)||!r(l,d,e,f)||u.push(l,d)}return a(u,t,n),u}function u(e,r,i,o){function a(){var i=r;r===f&&(i=this);var o=new t(n);o._captureStackTrace();var a="string"==typeof u&&this!==s?this[u]:e,c=h(o);try{a.apply(i,g(arguments,c))}catch(l){o._rejectCallback(m(l),!0,!0)}return o}var s=function(){return this}(),u=e;return"string"==typeof u&&(e=o),p.notEnumerableProp(a,"__isPromisified__",!0),a}function c(e,t,n,r){for(var i=new RegExp(C(t)+"$"),o=s(e,t,i,n),a=0,u=o.length;u>a;a+=2){var c=o[a],l=o[a+1],d=c+t;e[d]=r===k?k(c,f,c,l,t):r(l,function(){return k(c,f,c,l,t)})}return p.toFastProperties(e),e}function l(e,t){return k(e,t,void 0,e)}var d,f={},p=e("./util.js"),h=e("./promise_resolver.js")._nodebackForPromise,g=p.withAppended,m=p.maybeWrapAsError,_=p.canEvaluate,v=e("./errors").TypeError,b="Async",y={__isPromisified__:!0},w=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],E=new RegExp("^(?:"+w.join("|")+")$"),S=function(e){return p.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e},C=function(e){return e.replace(/([$])/,"\\$")},k=_?d:u;t.promisify=function(e,t){if("function"!=typeof e)throw new v("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(i(e))return e;var n=l(e,arguments.length<2?f:t);return p.copyDescriptors(e,n,r),n},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new v("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");t=Object(t);var n=t.suffix;"string"!=typeof n&&(n=b);var r=t.filter;"function"!=typeof r&&(r=S);var i=t.promisifier;if("function"!=typeof i&&(i=k),!p.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var o=p.inheritedDataKeys(e),a=0;a<o.length;++a){var s=e[o[a]];"constructor"!==o[a]&&p.isClass(s)&&(c(s.prototype,n,r,i),c(s,n,r,i))}return c(e,n,r,i)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function o(e){for(var t=c.keys(e),n=t.length,r=new Array(2*n),i=0;n>i;++i){var o=t[i];r[i]=e[o],r[i+n]=o}this.constructor$(r)}function a(e){var n,a=r(e);return u(a)?(n=a instanceof t?a._then(t.props,void 0,void 0,void 0,void 0):new o(a).promise(),a instanceof t&&n._propagateFrom(a,4),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}var s=e("./util.js"),u=s.isObject,c=e("./es5.js");s.inherits(o,n),o.prototype._init=function(){this._init$(void 0,-3)},o.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;if(n>=this._length){for(var r={},i=this.length(),o=0,a=this.length();a>o;++o)r[this._values[o+i]]=this._values[o];this._resolve(r)}},o.prototype._promiseProgressed=function(e,t){this._promise._progress({key:this._values[t+this.length()],value:e})},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return a(this)},t.props=function(e){return a(e)}}},{"./es5.js":14,"./util.js":38}],28:[function(e,t,n){"use strict";function r(e,t,n,r,i){for(var o=0;i>o;++o)n[o+r]=e[o+t],e[o+t]=void 0}function i(e){this._capacity=e,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(e){return this._capacity<e},i.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var n=this._front+t&this._capacity-1;this[n]=e,this._length=t+1},i.prototype._unshiftOne=function(e){var t=this._capacity;this._checkCapacity(this.length()+1);var n=this._front,r=(n-1&t-1^t)-t;this[r]=e,this._front=r,this._length=this.length()+1},i.prototype.unshift=function(e,t,n){this._unshiftOne(n),this._unshiftOne(t),this._unshiftOne(e)},i.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=e,this[i+1&o]=t,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,i=this._length,o=n+i&t-1;r(this,0,this,t,o)},t.exports=i},{}],29:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function o(e,o){var u=r(e);if(u instanceof t)return s(u);if(!a(e))return i("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var c=new t(n);void 0!==o&&c._propagateFrom(o,5);for(var l=c._fulfill,d=c._reject,f=0,p=e.length;p>f;++f){var h=e[f];(void 0!==h||f in e)&&t.cast(h)._then(l,d,void 0,c,null)}return c}var a=e("./util.js").isArray,s=function(e){return e.then(function(t){return o(t,e)})};t.race=function(e){return o(e,void 0)},t.prototype.race=function(){return o(this,void 0)}}},{"./util.js":38}],30:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,o){function a(e,n,r,a){this.constructor$(e),this._promise._captureStackTrace(),this._preservedValues=a===o?[]:null,this._zerothIsAccum=void 0===r,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var u=i(r,this._promise),d=!1,f=u instanceof t;f&&(u=u._target(),u._isPending()?u._proxyPromiseArray(this,-1):u._isFulfilled()?(r=u._value(),this._gotAccum=!0):(this._reject(u._reason()),d=!0)),f||this._zerothIsAccum||(this._gotAccum=!0);var p=c();this._callback=null===p?n:p.bind(n),this._accum=r,d||l.invoke(s,this,void 0)}function s(){this._init$(void 0,-5)}function u(e,t,n,i){if("function"!=typeof t)return r("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var o=new a(e,t,n,i);return o.promise()}var c=t._getDomain,l=e("./async.js"),d=e("./util.js"),f=d.tryCatch,p=d.errorObj;d.inherits(a,n),a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},a.prototype._promiseFulfilled=function(e,n){var r=this._values;r[n]=e;var o,a=this.length(),s=this._preservedValues,u=null!==s,c=this._gotAccum,l=this._valuesPhase;if(!l)for(l=this._valuesPhase=new Array(a),o=0;a>o;++o)l[o]=0;if(o=l[n],0===n&&this._zerothIsAccum?(this._accum=e,this._gotAccum=c=!0,l[n]=0===o?1:2):-1===n?(this._accum=e,this._gotAccum=c=!0):0===o?l[n]=1:(l[n]=2,this._accum=e),c){for(var d,h=this._callback,g=this._promise._boundValue(),m=this._reducingIndex;a>m;++m)if(o=l[m],2!==o){if(1!==o)return;if(e=r[m],this._promise._pushContext(),u?(s.push(e),d=f(h).call(g,e,m,a)):d=f(h).call(g,this._accum,e,m,a),this._promise._popContext(),d===p)return this._reject(d.e);var _=i(d,this._promise);if(_ instanceof t){if(_=_._target(),_._isPending())return l[m]=4,_._proxyPromiseArray(this,m);if(!_._isFulfilled())return this._reject(_._reason());d=_._value()}this._reducingIndex=m+1,this._accum=d}else this._reducingIndex=m+1;this._resolve(u?s:this._accum)}},t.prototype.reduce=function(e,t){return u(this,e,t,null)},t.reduce=function(e,t,n,r){return u(e,t,n,r)}}},{"./async.js":2,"./util.js":38}],31:[function(e,i,o){"use strict";var a,s=e("./util"),u=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")};if(s.isNode&&"undefined"==typeof MutationObserver){var c=n.setImmediate,l=t.nextTick;a=s.isRecentNode?function(e){c.call(n,e)}:function(e){l.call(t,e)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?a="undefined"!=typeof r?function(e){r(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:u:(a=function(e){var t=document.createElement("div"),n=new MutationObserver(e);return n.observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}},a.isStatic=!0);i.exports=a},{"./util":38}],32:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e){this.constructor$(e)}var i=t.PromiseInspection,o=e("./util.js");o.inherits(r,n),r.prototype._promiseResolved=function(e,t){this._values[e]=t;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},r.prototype._promiseFulfilled=function(e,t){var n=new i;n._bitField=268435456,n._settledValue=e,this._promiseResolved(t,n)},r.prototype._promiseRejected=function(e,t){var n=new i;n._bitField=134217728,n._settledValue=e,this._promiseResolved(t,n)},t.settle=function(e){return new r(e).promise()},t.prototype.settle=function(){return new r(this).promise()}}},{"./util.js":38}],33:[function(e,t,n){"use strict";t.exports=function(t,n,r){function i(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(e,t){if((0|t)!==t||0>t)return r("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var n=new i(e),o=n.promise();return n.setHowMany(t),n.init(),o}var a=e("./util.js"),s=e("./errors.js").RangeError,u=e("./errors.js").AggregateError,c=a.isArray;a.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var e=c(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(e){this._howMany=e},i.prototype._promiseFulfilled=function(e){this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},i.prototype._promiseRejected=function(e){if(this._addRejected(e),this.howMany()>this._canPossiblyFulfill()){for(var t=new u,n=this.length();n<this._values.length;++n)t.push(this._values[n]);this._reject(t)}},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(e){this._values.push(e)},i.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return o(e,t)},t.prototype.some=function(e){return o(this,e)},t._SomePromiseArray=i}},{"./errors.js":13,"./util.js":38}],34:[function(e,t,n){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValue=e._settledValue):(this._bitField=0,this._settledValue=void 0)}t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},t.prototype.isFulfilled=e.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},t.prototype.isRejected=e.prototype._isRejected=function(){return(134217728&this._bitField)>0},t.prototype.isPending=e.prototype._isPending=function(){return 0===(402653184&this._bitField)},t.prototype.isResolved=e.prototype._isResolved=function(){return(402653184&this._bitField)>0},e.prototype.isPending=function(){return this._target()._isPending()},e.prototype.isRejected=function(){return this._target()._isRejected()},e.prototype.isFulfilled=function(){return this._target()._isFulfilled()},e.prototype.isResolved=function(){return this._target()._isResolved()},e.prototype._value=function(){return this._settledValue},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},e.prototype.value=function(){var e=this._target();if(!e.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return e._settledValue},e.prototype.reason=function(){var e=this._target();if(!e.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return e._unsetRejectionIsUnhandled(),e._settledValue},e.PromiseInspection=t}},{}],35:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e,r){if(c(e)){if(e instanceof t)return e;if(o(e)){var l=new t(n);return e._then(l._fulfillUnchecked,l._rejectUncheckedCheckError,l._progressUnchecked,l,null),l}var d=s.tryCatch(i)(e);if(d===u){r&&r._pushContext();var l=t.reject(d.e);return r&&r._popContext(),l}if("function"==typeof d)return a(e,d,r)}return e}function i(e){return e.then}function o(e){return l.call(e,"_promise0")}function a(e,r,i){function o(e){l&&(l._resolveCallback(e),l=null)}function a(e){l&&(l._rejectCallback(e,f,!0),l=null)}function c(e){l&&"function"==typeof l._progress&&l._progress(e)}var l=new t(n),d=l;i&&i._pushContext(),l._captureStackTrace(),i&&i._popContext();var f=!0,p=s.tryCatch(r).call(e,o,a,c);return f=!1,l&&p===u&&(l._rejectCallback(p.e,!0,!0),l=null),d}var s=e("./util.js"),u=s.errorObj,c=s.isObject,l={}.hasOwnProperty;return r}},{"./util.js":38}],36:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e){var t=this;return t instanceof Number&&(t=+t),clearTimeout(t),e}function i(e){var t=this;throw t instanceof Number&&(t=+t),clearTimeout(t),e}var o=e("./util.js"),a=t.TimeoutError,s=function(e,t){if(e.isPending()){"string"!=typeof t&&(t="operation timed out");var n=new a(t);o.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._cancel(n)}},u=function(e){return c(+this).thenReturn(e)},c=t.delay=function(e,r){if(void 0===r){r=e,e=void 0;var i=new t(n);return setTimeout(function(){i._fulfill()},r),i}return r=+r,t.resolve(e)._then(u,null,null,r,void 0)};t.prototype.delay=function(e){return c(this,e)},t.prototype.timeout=function(e,t){e=+e;var n=this.then().cancellable();n._cancellationParent=this;var o=setTimeout(function(){s(n,t)},e);return n._then(r,i,void 0,o,void 0)}}},{"./util.js":38}],37:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function o(e){for(var n=e.length,r=0;n>r;++r){var i=e[r];if(i.isRejected())return t.reject(i.error());e[r]=i._settledValue}return e}function a(e){setTimeout(function(){throw e},0)}function s(e){var t=r(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function u(e,n){function i(){if(o>=u)return c.resolve();var l=s(e[o++]);if(l instanceof t&&l._isDisposable()){try{l=r(l._getDisposer().tryDispose(n),e.promise)}catch(d){return a(d)}if(l instanceof t)return l._then(i,a,null,null,null)}i()}var o=0,u=e.length,c=t.defer();return i(),c.promise}function c(e){var t=new m;return t._settledValue=e,t._bitField=268435456,u(this,t).thenReturn(e)}function l(e){var t=new m;return t._settledValue=e,t._bitField=134217728,u(this,t).thenThrow(e)}function d(e,t,n){this._data=e,this._promise=t,this._context=n}function f(e,t,n){this.constructor$(e,t,n)}function p(e){return d.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}var h=e("./errors.js").TypeError,g=e("./util.js").inherits,m=t.PromiseInspection;d.prototype.data=function(){return this._data},d.prototype.promise=function(){return this._promise},d.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},d.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=null!==t?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},d.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},g(f,d),f.prototype.doDispose=function(e,t){var n=this.data();return n.call(e,e,t)},t.using=function(){var e=arguments.length;if(2>e)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[e-1];if("function"!=typeof i)return n("fn must be a function\n\n    See http://goo.gl/916lJJ\n");e--;for(var a=new Array(e),s=0;e>s;++s){var u=arguments[s];if(d.isDisposer(u)){var f=u;u=u.promise(),u._setDisposable(f)}else{var h=r(u);h instanceof t&&(u=h._then(p,null,null,{resources:a,index:s},void 0))}a[s]=u}var g=t.settle(a).then(o).then(function(e){g._pushContext();var t;try{t=i.apply(void 0,e)}finally{g._popContext()}return t})._then(c,l,void 0,a,void 0);return a.promise=g,g},t.prototype._setDisposable=function(e){this._bitField=262144|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(262144&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer;
},t.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new f(e,this,i());throw new h}}},{"./errors.js":13,"./util.js":38}],38:[function(e,n,r){"use strict";function i(){try{var e=$;return $=null,e.apply(this,arguments)}catch(t){return T.e=t,T}}function o(e){return $=e,i}function a(e){return null==e||e===!0||e===!1||"string"==typeof e||"number"==typeof e}function s(e){return!a(e)}function u(e){return a(e)?new Error(_(e)):e}function c(e,t){var n,r=e.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=e[n];return i[n]=t,i}function l(e,t,n){if(!S.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function d(e,t,n){if(a(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return S.defineProperty(e,t,r),e}function f(e){throw e}function p(e){try{if("function"==typeof e){var t=S.names(e.prototype),n=S.isES5&&t.length>1,r=t.length>0&&!(1===t.length&&"constructor"===t[0]),i=R.test(e+"")&&S.names(e).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}}function h(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e}function g(e){return I.test(e)}function m(e,t,n){for(var r=new Array(e),i=0;e>i;++i)r[i]=t+i+n;return r}function _(e){try{return e+""}catch(t){return"[no string representation]"}}function v(e){try{d(e,"isOperational",!0)}catch(t){}}function b(e){return null==e?!1:e instanceof Error.__BluebirdErrorTypes__.OperationalError||e.isOperational===!0}function y(e){return e instanceof Error&&S.propertyIsWritable(e,"stack")}function w(e){return{}.toString.call(e)}function E(e,t,n){for(var r=S.names(e),i=0;i<r.length;++i){var o=r[i];if(n(o))try{S.defineProperty(t,o,S.getDescriptor(e,o))}catch(a){}}}var S=e("./es5.js"),C="undefined"==typeof navigator,k=function(){try{var e={};return S.defineProperty(e,"f",{get:function(){return 3}}),3===e.f}catch(t){return!1}}(),T={e:{}},$,O=function(e,t){function n(){this.constructor=e,this.constructor$=t;for(var n in t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}var r={}.hasOwnProperty;return n.prototype=t.prototype,e.prototype=new n,e.prototype},A=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(S.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var r=[],i=Object.create(null);null!=e&&!t(e);){var o;try{o=n(e)}catch(a){return r}for(var s=0;s<o.length;++s){var u=o[s];if(!i[u]){i[u]=!0;var c=Object.getOwnPropertyDescriptor(e,u);null!=c&&null==c.get&&null==c.set&&r.push(u)}}e=S.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var i=[];e:for(var o in n)if(r.call(n,o))i.push(o);else{for(var a=0;a<e.length;++a)if(r.call(e[a],o))continue e;i.push(o)}return i}}(),R=/this\s*\.\s*\S+\s*=/,I=/^[a-z$_][a-z$_0-9]*$/i,N=function(){return"stack"in new Error?function(e){return y(e)?e:new Error(_(e))}:function(e){if(y(e))return e;try{throw new Error(_(e))}catch(t){return t}}}(),j={isClass:p,isIdentifier:g,inheritedDataKeys:A,getDataPropertyOrDefault:l,thrower:f,isArray:S.isArray,haveGetters:k,notEnumerableProp:d,isPrimitive:a,isObject:s,canEvaluate:C,errorObj:T,tryCatch:o,inherits:O,withAppended:c,maybeWrapAsError:u,toFastProperties:h,filledRange:m,toString:_,canAttachTrace:y,ensureErrorObject:N,originatesFromRejection:b,markAsOriginatingFromRejection:v,classString:w,copyDescriptors:E,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:"undefined"!=typeof t&&"[object process]"===w(t).toLowerCase()};j.isRecentNode=j.isNode&&function(){var e=t.versions.node.split(".").map(Number);return 0===e[0]&&e[1]>10||e[0]>0}(),j.isNode&&j.toFastProperties(t);try{throw new Error}catch(P){j.lastLineError=P}n.exports=j},{"./es5.js":14}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(t,n(544),function(){return this}(),n(100).setImmediate)},,,,,,,,,,function(e,t,n){"use strict";var r=n(6),i=n(345),o=n(104),a=r.createClass({displayName:"ConfirmPopup",mixins:[o],propTypes:{classes:r.PropTypes.string,onCancel:r.PropTypes.func,cancelText:r.PropTypes.string,onOK:r.PropTypes.func,okText:r.PropTypes.string,children:r.PropTypes.node.isRequired,title:r.PropTypes.node,a8n:r.PropTypes.string},getDefaultProps:function(){return{classes:"",cancelText:l10n.t("web_cancel"),okText:l10n.t("web_ok")}},onOK:function(e){this.actionTriggered||(this.props.onOK(e),this.actionTriggered=!0)},onCancel:function(e){this.actionTriggered||(this.props.onCancel(e),this.actionTriggered=!0)},componentDidMount:function(){if(this.props.onOK){var e=this;this.regNativeListener(window,"keydown",function(t){13===t.keyCode&&(t.stopPropagation(),t.preventDefault(),e.props.onOK())})}},render:function(){var e=this.props.onOK?r.createElement("button",{"data-a8n":i.key("popup-controls-ok"),className:"btn-plain btn-default popup-controls-item",onClick:this.onOK},this.props.okText):null,t=this.props.onCancel?r.createElement("button",{className:"btn-plain popup-controls-item",onClick:this.onCancel},this.props.cancelText):null,n=this.props.title?r.createElement("div",{"data-a8n":i.key("popup-title"),className:"popup-title"},this.props.title):null;return r.createElement("div",{className:"backdrop"},r.createElement("div",{className:"popup-container"},r.createElement("div",{className:"popup "+this.props.classes},r.createElement("div",{className:"popup-body"},n,r.createElement("div",{"data-a8n":i.key("popup-contents"),className:"popup-contents"},this.props.children)),r.createElement("div",{className:"popup-controls"},t,e))))}});e.exports=a},,function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(3),o=r(i),a=n(22),s=r(a),u=n(1),c=n(12),l=n(348),d=n(82),f=n(347),p=n(14),h=n(11),g=n(15),m={QUERY:"QUERY",FIND:"FIND",UPDATE:"UPDATE"},v={NONE:"NONE",LOAD:"LOAD"},b=f.extend(l,d,{listenTo:function(e,t,n){if(!_.isObject(e)||_.isEmpty(t)||!_.isFunction(n)){var r=[];throw _.isObject(e)||r.push("obj parameter is not an object"),_.isEmpty(t)&&r.push("event is empty string"),_.isFunction(n)||r.push("callback is not a function"),new Error(r.join(", "))}f.prototype.listenTo.apply(this,arguments)},initialize:function(e){this._config=_.extend({CachePolicy:{id:void 0,policy:v.NONE,delay:0},staleCollection:!1},e),this._inflight={},this.listenTo(this,"add remove reset sort",function(){var e=this._last,t=this.last();(!e&&t||e!==t)&&(this._last=t,this.trigger("change:last",t));var n=this._first,r=this.first();(!n&&r||n!==r)&&(this._first=r,this.trigger("change:first",r))}),this._initializeFromCache(),this._config.staleCollection&&this._initializeStaleCollection()},_initializeFromCache:function(e){var t=this._config.CachePolicy,n=t.id,r=t.policy,i=t.delay,o=t.trigger||"all";this.listenTo(p,"change:stream",function(){if(p.stream===p.STREAM.SYNCING){if(r===v.NONE)return void(_.isUndefined(n)||g.setCollection(n));if(u.log("baseCollection:initFromCache load: "+n)(),this.add(g.getCollection(n)),!_.isNumber(i))return;this._saveToCache=_.debounce(this.saveToCache,i),this.listenTo(this,o,this._saveToCache),this.initializeFromCache()}})},initializeFromCache:function(){},saveToCache:function(){if(Store.Conn.me){var e=this._config.CachePolicy.id;u.log("baseCollection:saveToCache save: "+e)(),g.setCollection(e,this.toJSON())}},_initializeStaleCollection:function(){var e=this;this.listenTo(p,"change:stream",function(){switch(p.stream){case p.STREAM.DISCONNECTED:e.invoke("set","stale",!0);break;case p.STREAM.RESUMING:case p.STREAM.SYNCING:break;case p.STREAM.CONNECTED:p.previousAttributes().stream===p.STREAM.RESUMING&&_.isFunction(e.onResume)&&e.onResume()}})},_query:function(e,t){var n=_.isString(t)?t:(0,s["default"])(t),r=e===m.QUERY?void 0:this.get(t),i="force-"+n;return(this._inflight[i]&&e===m.FIND||e===m.UPDATE)&&(n=i),this._inflight[n]?r&&e===m.FIND?o["default"].resolve(r):this._inflight[n]:!r||r&&r.stale||e===m.UPDATE?this._inflight[n]=o["default"].bind(this).then(function(){return this._serverQuery(e,t)})["finally"](function(){delete this._inflight[n]})["catch"](h.WapDrop,function(e){throw u.warn(e.toString())(),e})["catch"](_.isString,function(e){u.log("baseCollection:query query promise rejected: "+e)()}):o["default"].resolve(r)},_serverQuery:function(e,t){var n;n=e===m.UPDATE?this._update(t):e===m.FIND?this._find(t):this._findQuery(t);var r=this;return n.then(function(e){return r._config.staleCollection&&_.each(_.compact(_.forceArray(e)),function(e){"undefined"==typeof e.stale&&(e.stale=!1)}),r.add(e,{merge:!0})})},findQuery:function(e){return this._query(m.QUERY,e)},find:function(e){return e?this._query(m.FIND,e):(c.upload(u.trace("Called find without an id")),o["default"].resolve())},update:function(e){return e?this._query(m.UPDATE,e):(c.upload(u.trace("Called update without an id")),o["default"].resolve())},_update:function(e){return this._find(e)},handle:function(e){var t=this._handle(e.shift());this._config.staleCollection&&_.each(_.compact(_.forceArray(t)),function(e){e.stale=!1}),this.add(t,{merge:!0})},gadd:function(e){if(_.isString(e)||_.isNumber(e)){var t={};return t[this.mainIndex]=e,this.get(e)||this.add(t,{merge:!0})}if(e&&e[this.mainIndex])return this.add(e,{merge:!0});var n=_.findKey(Store,this)||"unknown";throw new Error(n+".gadd called without an id attr ("+this.mainIndex+")")},"delete":function(){this.stopListening(this,"all",this._saveToCache),_.invoke(this.models,"stopListening"),_.invoke(this.models,"cancelPendingPromises"),this._inflight={},this.reset()},isStateStale:function(e){var t=this.get(e);return t&&t.stale}});b.CACHE_POLICY=v,e.exports=b},,function(e,t){"use strict";e.exports={key:function(e){var t=!1;return t?e:void 0}}},function(e,t,n){"use strict";var r=n(6),i=n(30),o=n(161),a=n(354),s=n(104),u=n(77),c=n(78),l=n(342),d=l.HotKeys,f={X:{LEFT:"left",RIGHT:"right"},Y:{TOP:"top",BOTTOM:"bottom"}},p={DROPDOWN:"dropdown",DROPDOWN_MENU:"dropdown_menu",MENU:"menu",PICKER:"picker",EMOJI_PICKER:"emoji_picker"},h=r.createClass({displayName:"Menu",mixins:[s],propTypes:{children:r.PropTypes.node.isRequired,origin:r.PropTypes.shape({x:r.PropTypes.number,y:r.PropTypes.number}),type:r.PropTypes.oneOf(_.values(p)).isRequired,direction:r.PropTypes.shape({x:r.PropTypes.oneOf(_.values(f.X)),y:r.PropTypes.oneOf(_.values(f.Y))}).isRequired,flipOnRTL:r.PropTypes.bool,classes:r.PropTypes.string,onDefault:r.PropTypes.func},statics:{Direction:f,Type:p},getDefaultProps:function(){return{type:p.DROPDOWN,direction:{x:f.X.RIGHT,y:f.Y.BOTTOM}}},getInitialState:function(){return{hasKeyboard:!_.contains([p.MENU,p.EMOJI_PICKER],this.props.type),showShortcuts:!1,keyboard:!1,selected:void 0}},componentDidMount:function(){this.state.hasKeyboard&&i.findDOMNode(this).focus()},onMouseMove:function(e){i.findDOMNode(this).focus(),this.setState({keyboard:!1})},getStyle:function(){var e=this.props,t={},n=e.direction.x,r=e.direction.y;this.props.flipOnRTL&&l10n.isRTL()&&(n=n===f.X.LEFT?f.X.RIGHT:f.X.LEFT);var i=n===f.X.RIGHT?f.X.LEFT:f.X.RIGHT,a=r===f.Y.TOP?f.Y.BOTTOM:f.Y.TOP;return t[o.prefix("transformOrigin")]=a+" "+i,e.origin?(n===f.X.RIGHT?t.left=e.origin.x:t.right=window.innerWidth-e.origin.x,r===f.Y.BOTTOM?t.top=e.origin.y:t.bottom=window.innerHeight-e.origin.y,_.merge(t,e.style)):_.merge(t,e.style)},onKeyDown:function(e){e.metaKey&&this.setState({showShortcuts:!0})},onKeyUp:function(e){this.state.showShortcuts&&!e.metaKey&&this.setState({showShortcuts:!1})},up:function(e){e.preventDefault(),e.stopPropagation();var t=_.toArray(this.props.children),n=a.ring(_.indexOf(t,this.state.selected)-1,t),r=t[n];i.findDOMNode(this.refs.list).children[n].focus(),this.setState({keyboard:!0,selected:r})},down:function(e){e.preventDefault(),e.stopPropagation();var t=_.toArray(this.props.children),n=a.ring(_.indexOf(t,this.state.selected)+1,t),r=t[n];i.findDOMNode(this.refs.list).children[n].focus(),this.setState({keyboard:!0,selected:r})},close:function(e){e.preventDefault(),c.pop()},"default":function(e){this.props.onDefault&&(d.flashFocus=Date.now(),c.pop(c.MENU),this.props.onDefault(e))},render:function(){var e=this.props,t=u(e.classes,{dropdown:e.type===p.DROPDOWN,"dropdown dropdown-right":e.type===p.DROPDOWN_MENU,"menu menu-icons":e.type===p.MENU,"dropdown-picker k context-menu":e.type===p.PICKER,"dropdown dropdown-emoji":e.type===p.EMOJI_PICKER,inverse:(e.type===p.PICKER||e.type===p.EMOJI_PICKER)&&e.direction.x===f.X.LEFT,"inverse-vertical":e.type===p.EMOJI_PICKER&&e.direction.y===f.Y.TOP,"shortcut-active":this.state.showShortcuts}),n=this.state.hasKeyboard?r.createElement("ul",{ref:"list"},e.children):e.children,i=_.contains([p.PICKER,p.EMOJI_PICKER],e.type)?r.createElement("div",{className:"nib"}):null;if(this.state.hasKeyboard){var o={up:this.up,down:this.down,enter:this["default"]};return o[l10n.LR("left","right")]=this.close,o[l10n.LR("right","left")]=this["default"],o={},r.createElement(d,{handlers:o,className:t,style:this.getStyle(),onMouseMove:this.state.keyboard?this.onMouseMove:null},n,i)}return r.createElement("div",{className:t,style:this.getStyle()},n,i)}});e.exports=h},,function(e,t){"use strict";var n=[].slice,r={},i=["first","last","partition","contains","toArray","invoke","pluck","filter","any"];_.each(i,function(e){if(!_[e])throw new Error("attempt to reference non-existant _ method: "+e);r[e]=function(){var t=n.call(arguments);return t.unshift(this.models),_[e].apply(_,t)}});var o=["groupBy","countBy","sortBy","indexBy"];_.each(o,function(e){if(!_[e])throw new Error("attempt to reference non-existant _ method: "+e);r[e]=function(t,n){var r=_.isFunction(t)?t:function(e){return e.get?e.get(t):e[t]};return _[e](this.models,r,n)}}),r.where=function(e,t){return _.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){var n;for(var r in e)if(n=t.get?t.get(r):t[r],e[r]!==n)return!1;return!0})},r.findWhere=function(e){return this.where(e,!0)},e.exports=r},function(e,t,n){"use strict";var r=n(59),i=r.extend({Collection:"Status",props:{id:"string",status:"string"},session:{stale:["boolean",!1,!0]}});e.exports=i},function(e,t){"use strict";e.exports=_.memoize(function(e){return CryptoJS.MD5(e).toString(CryptoJS.enc.Base64)})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=this;this.assetStyle=new f("asset-style"),this.assets={},window.addEventListener("dpichange",function(){return e.loadAssets(e.assets)})}var o=n(3),a=r(o),s=n(1),u=n(36),c=n(11),l=n(106),d=n(23),f=n(386),p=n(385),h={DEFAULT:"default",WEBP:"webp"},g={sprite:{"class":".icon, .icon-s, .icon-l, .icon-xl",low:{"default":n(189)},high:{"default":n(189)}},"bg-chat":{"class":".pane-chat-tile",low:{"default":n(188)},high:{"default":n(188)}},"emoji-small":{"class":".emoji",low:{"default":n(464),webp:n(465)},high:{"default":n(467),webp:n(468)}},"emoji-large":{"class":".emojik",low:{"default":n(466)},high:{"default":n(469),webp:n(470)}},"intro-connection":{"class":".intro-image",low:{"default":n(474)},high:{"default":n(473)}}};i.prototype.loadInitialAssets=function(e){return this.loadAssets(g)},i.prototype.loadAssets=function(e){return a["default"].all(_.map(e,this.loadAsset.bind(this)))},i.prototype._supportsWebp=function(){return new a["default"](function(e,t){Modernizr.on("webp",function(t){e(t)})})},i.prototype.loadAsset=function(e,t){var n,r,i=this,o=p.currentRes,u=t+"-"+o,c=this._supportsWebp().then(function(t){return t&&t.valueOf()&&e[o][h.WEBP]?h.WEBP:h.DEFAULT}).timeout(500)["catch"](a["default"].TimeoutError,function(e){return h.DEFAULT});return n=window.performance.now(),this.unloadAsset(t),this.assets[t]=e,this.assets[t].promise=c.then(function(t){return d.idb().then(function(e){return e.assets.get(u)})["catch"](function(e){s.warn('Failed to "get" asset: '+u)(e)}).then(function(n){var r=_.last(e[o][t].split("/"));if(n&&n.hash===r)return i.loadBlob(URL.createObjectURL(n.data));throw new Error("No result")})["catch"](function(){return i.loadAndCacheData(e[o][t],u).then(function(e){return URL.createObjectURL(e)})}).then(function(t){return e["class"]&&i.assetStyle.setRule(""+e["class"],{"background-image":"url('"+t+"')"}),r=window.performance.now(),s.log("Asset: "+u+" loaded: "+(r-n).toFixed(2)+"ms")(),e.onSet&&e.onSet(t),t})})},i.prototype.unloadAsset=function(e){var t=this.assets[e];t&&t.promise&&t.promise.isFulfilled()&&URL.revokeObjectURL(t.promise.value()),delete this.assets[e]},i.prototype.loadAndCacheData=function(e,t){var n,r=_.last(e.split("/"));return this.loadData(e).then(function(e){return n=e,d.idb().then(function(n){return n.assets.put({key:t,hash:r,data:e})})})["catch"](function(e){s.warn('Failed to "put" asset: '+t)(e)}).then(function(e){return n})},i.prototype.loadBlob=function(e){return new a["default"](function(t,n){var r=new XMLHttpRequest;r.onload=function(){200===r.status?t(e):(s.warn("Blob: "+e+" failed. Refetching asset")(),n(e))},r.onerror=function(){return n(e)},r.open("GET",e,!0),r.send()})},i.prototype.loadData=function(e){return u.loopOnError(c.ShouldLoop,function(t){var n;return n=l.info===l.INFO.OFFLINE?u.waitForBBEvent(l,"change:info",function(e){return e.info!==l.INFO.OFFLINE}):a["default"].delay(5e3*(t>0?1:0)),n.then(function(){return new a["default"](function(t,n){var r=new XMLHttpRequest;r.onload=function(i){200===r.status?t(r.response):(s.warn("Asset: "+_.last(e.split("/"))+" failed. Retrying...")(i),n(new c.ShouldLoop("Asset failed to load. Retrying...")))},r.onerror=function(t){s.warn("Asset: "+_.last(e.split("/"))+" failed. Retrying...")(t),n(new c.ShouldLoop("Asset failed to load. Retrying..."))},r.open("GET",e,!0),r.responseType="blob",r.send()})})})},i.prototype.loadImage=function(e){return u.loopOnError(c.ShouldLoop,function(t){var n;return n=l.info===l.INFO.OFFLINE?u.waitForBBEvent(l,"change:info",function(e){return e.info!==l.INFO.OFFLINE}):a["default"].delay(5e3*(t>0?1:0)),n.bind(this).then(function(){return new a["default"](function(t,n){var r=new Image;r.onload=function(){t(e)},r.onerror=function(){s.warn("Asset: "+_.last(e.split("/"))+" failed. Retrying...")(),n(new c.ShouldLoop("Asset failed to load. Retrying..."))},r.src=e})})})},e.exports=new i},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(3),o=r(i),a=n(6),s=n(8),u=n(1),c=n(35),l=n(59),d=n(80),f=n(11),p=n(41),h=n(21),g=n(159),m=n(9),_=l.extend({Collection:"ProfilePicThumb",props:{id:"string",tag:"string",raw:"string"},session:{stale:["boolean",!1,!0]},derived:{img:{deps:["tag","raw","stale"],fn:function(){if(this.raw)return"data:image/jpeg;base64,"+this.raw;if(!this.tag&&this.stale)return null;if(this.tag)return p.build(s.PP_URL,{t:"s",u:this.id,i:this.tag})}},imgFull:{deps:["tag","raw","stale"],fn:function(){if((this.raw||!this.tag)&&this.stale)return null;if(!this.raw&&this.tag)return p.build(s.PP_URL,{t:"l",u:this.id,i:this.tag})}}},canSet:function(){return h.isGroup(this.id)&&d.supportsFeature(d.F.GROUP_SET_PIC)?!0:h.isUser(this.id)&&this.id===Store.Conn.me&&d.supportsFeature(d.F.SET_PROFILE_PIC)?!0:!1},setPicture:function(e,t){if(!this.canSet())return o["default"].reject(new f.ActionError);var n=c.sendSetPicture(this.id,e,t),r=this.id===Store.Conn.me?l10n.t("action_profile_setting"):l10n.t("action_group_icon_setting"),i=n.bind(this)["catch"](function(e){throw u.error("models:ProfilePicThumb:setPicture dropped")(e),this.id===Store.Conn.me?l10n.t("action_profile_set_failed"):l10n.t("action_group_icon_set_failed")}).then(function(e){if(200===e.status)return this.id===Store.Conn.me?l10n.t("action_profile_set"):l10n.t("action_group_icon_set");if(e.status>=400)throw this.id===Store.Conn.me?l10n.t("action_profile_set_failed"):l10n.t("action_group_icon_set_failed")});return m.openToast(a.createElement(g,{id:g.genId(),pendingText:r,actionText:i,retry:this.setPicture.bind(this,e,t)})),n.bind(this).then(function(e){200!==e.status||e._duplicate||(this.tag=e.tag)})},canDelete:function(){return h.isGroup(this.id)&&d.supportsFeature(d.F.GROUP_SET_PIC)&&this.tag?!0:h.isUser(this.id)&&this.id===Store.Conn.me&&d.supportsFeature(d.F.SET_PROFILE_PIC)&&this.tag?!0:!1},deletePicture:function(){if(!this.canDelete())return o["default"].reject(new f.ActionError);var e=c.deletePicture(this.id),t=this.id===Store.Conn.me?l10n.t("action_profile_removing"):l10n.t("action_group_icon_removing"),n=e.bind(this)["catch"](function(e){throw u.error("models:ProfilePicThumb:deletePicture dropped")(e),this.id===Store.Conn.me?l10n.t("action_profile_remove_failed"):l10n.t("action_group_icon_remove_failed")}).then(function(e){if(200===e.status)return this.id===Store.Conn.me?l10n.t("action_profile_removed"):l10n.t("action_group_icon_removed");if(e.status>=400)throw this.id===Store.Conn.me?l10n.t("action_profile_remove_failed"):l10n.t("action_group_icon_remove_failed")});return m.openToast(a.createElement(g,{id:g.genId(),pendingText:t,actionText:n,retry:this.deletePicture.bind(this)})),e.bind(this).then(function(e){200!==e.status||e._duplicate||(this.tag=void 0)})}});e.exports=_},function(e,t,n){"use strict";function r(e){return"string"==typeof e?e:CryptoJS.lib.WordArray.create(new Uint8Array(e))}function i(e,t){return u.decode(e.toString(CryptoJS.enc.Base64),!!t)}function o(e){var t=arguments.length<=1||void 0===arguments[1]?new Uint8Array(c):arguments[1],n=arguments[2];return i(CryptoJS.HmacSHA256(r(e),r(t)),n)}function a(e,t,n,o){if(0>n||n>255*c)return null;var a=r(e),s=r(t),u=Math.ceil(n/c),l=new Array(u+1);l[0]="";for(var d=new Uint8Array(1),f=0;u>f;f++){d[0]=f+1;var p=CryptoJS.algo.HMAC.create(CryptoJS.algo.SHA256,a);p.update(l[f]),p.update(s),p.update(r(d)),l[f+1]=p.finalize()}for(var h=new Uint8Array(n),f=0,g=0;u>f;f++)for(var m=i(l[f+1]),_=0;c>_&&n>g;_++,g++)h[g]=m[_];return o?Array.prototype.slice.call(h):h}function s(e,t,n,r,i){return a(o(e,t),n,r,i)}var u=n(163),c=32;e.exports={extract:o,expand:a,extractAndExpand:s}},function(e,t){"use strict";e.exports={ring:function(e,t){return e>t.length-1?0:0>e?t.length-1:e}}},,,function(e,t,n){var r,i;(function(e){/**
	 * @license Long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
	 * Released under the Apache License, Version 2.0
	 * Derived from goog.math.Long from the Closure Library
	 * see: https://github.com/dcodeIO/Long.js for details
	 */
!function(o){"use strict";var a=function(e,t,n){e&&"object"==typeof e&&(t=e.high,n=e.unsigned,e=e.low),this.low=0|e,this.high=0|t,this.unsigned=!!n},s={},u={};a.fromInt=function(e,t){var n,r;return t?(e>>>=0,e>=0&&256>e&&(r=u[e])?r:(n=new a(e,0>(0|e)?-1:0,!0),e>=0&&256>e&&(u[e]=n),n)):(e=0|e,e>=-128&&128>e&&(r=s[e])?r:(n=new a(e,0>e?-1:0,!1),e>=-128&&128>e&&(s[e]=n),n))},a.fromNumber=function(e,t){return t=!!t,isNaN(e)||!isFinite(e)?a.ZERO:!t&&-f>=e?a.MIN_SIGNED_VALUE:t&&0>=e?a.MIN_UNSIGNED_VALUE:!t&&e+1>=f?a.MAX_SIGNED_VALUE:t&&e>=d?a.MAX_UNSIGNED_VALUE:0>e?a.fromNumber(-e,!1).negate():new a(e%l|0,e/l|0,t)},a.fromBits=function(e,t,n){return new a(e,t,n)},a.from28Bits=function(e,t,n,r){return a.fromBits(e|t<<28,t>>>4|n<<24,r)},a.fromString=function(e,t,n){if(0==e.length)throw new Error("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return a.ZERO;if("number"==typeof t&&(n=t,t=!1),n=n||10,2>n||n>36)throw new Error("radix out of range: "+n);if("-"==e.charAt(0))return a.fromString(e.substring(1),t,n).negate();if(e.indexOf("-")>=0)throw new Error('number format error: interior "-" character: '+e);for(var r=a.fromNumber(Math.pow(n,8)),i=a.ZERO,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),u=parseInt(e.substring(o,o+s),n);if(8>s){var c=a.fromNumber(Math.pow(n,s));i=i.multiply(c).add(a.fromNumber(u))}else i=i.multiply(r),i=i.add(a.fromNumber(u))}return i.unsigned=t,i};var c=65536,l=c*c,d=l*l,f=d/2,p=a.fromInt(1<<24);a.ZERO=a.fromInt(0),a.UZERO=a.fromInt(0,!0),a.ONE=a.fromInt(1),a.UONE=a.fromInt(1,!0),a.NEG_ONE=a.fromInt(-1),a.MAX_SIGNED_VALUE=a.fromBits(-1,2147483647,!1),a.MAX_UNSIGNED_VALUE=a.fromBits(-1,-1,!0),a.MAX_VALUE=a.MAX_SIGNED_VALUE,a.MIN_SIGNED_VALUE=a.fromBits(0,-2147483648,!1),a.MIN_UNSIGNED_VALUE=a.fromBits(0,0,!0),a.MIN_VALUE=a.MIN_SIGNED_VALUE,a.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},a.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},a.prototype.toString=function(e){if(e=e||10,2>e||e>36)throw new Error("radix out of range: "+e);if(this.isZero())return"0";var t;if(this.isNegative()){if(this.equals(a.MIN_SIGNED_VALUE)){var n=a.fromNumber(e),r=this.div(n);return t=r.multiply(n).subtract(this),r.toString(e)+t.toInt().toString(e)}return"-"+this.negate().toString(e)}var i=a.fromNumber(Math.pow(e,6));t=this;for(var o="";;){var s=t.div(i),u=t.subtract(s.multiply(i)).toInt(),c=u.toString(e);if(t=s,t.isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}},a.prototype.getHighBits=function(){return this.high},a.prototype.getHighBitsUnsigned=function(){return this.high>>>0},a.prototype.getLowBits=function(){return this.low},a.prototype.getLowBitsUnsigned=function(){return this.low>>>0},a.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(a.MIN_SIGNED_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},a.prototype.isZero=function(){return 0==this.high&&0==this.low},a.prototype.isNegative=function(){return!this.unsigned&&this.high<0},a.prototype.isOdd=function(){return 1==(1&this.low)},a.prototype.isEven=function(){return 0==(1&this.low)},a.prototype.equals=function(e){return this.unsigned!=e.unsigned&&this.high>>>31!=e.high>>>31?!1:this.high==e.high&&this.low==e.low},a.prototype.notEquals=function(e){return!this.equals(e)},a.prototype.lessThan=function(e){return this.compare(e)<0},a.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},a.prototype.greaterThan=function(e){return this.compare(e)>0},a.prototype.greaterThanOrEqual=function(e){return this.compare(e)>=0},a.prototype.compare=function(e){if(this.equals(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high==this.high&&e.low>>>0>this.low>>>0?-1:1:this.subtract(e).isNegative()?-1:1},a.prototype.negate=function(){return!this.unsigned&&this.equals(a.MIN_SIGNED_VALUE)?a.MIN_SIGNED_VALUE:this.not().add(a.ONE)},a.prototype.add=function(e){var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,u=e.low>>>16,c=65535&e.low,l=0,d=0,f=0,p=0;return p+=i+c,f+=p>>>16,p&=65535,f+=r+u,d+=f>>>16,f&=65535,d+=n+s,l+=d>>>16,d&=65535,l+=t+o,l&=65535,a.fromBits(f<<16|p,l<<16|d,this.unsigned)},a.prototype.subtract=function(e){return this.add(e.negate())},a.prototype.multiply=function(e){if(this.isZero())return a.ZERO;if(e.isZero())return a.ZERO;if(this.equals(a.MIN_VALUE))return e.isOdd()?a.MIN_VALUE:a.ZERO;if(e.equals(a.MIN_VALUE))return this.isOdd()?a.MIN_VALUE:a.ZERO;if(this.isNegative())return e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate();if(e.isNegative())return this.multiply(e.negate()).negate();if(this.lessThan(p)&&e.lessThan(p))return a.fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,u=e.low>>>16,c=65535&e.low,l=0,d=0,f=0,h=0;return h+=i*c,f+=h>>>16,h&=65535,f+=r*c,d+=f>>>16,f&=65535,f+=i*u,d+=f>>>16,f&=65535,d+=n*c,l+=d>>>16,d&=65535,d+=r*u,l+=d>>>16,d&=65535,d+=i*s,l+=d>>>16,d&=65535,l+=t*c+n*u+r*s+i*o,l&=65535,a.fromBits(f<<16|h,l<<16|d,this.unsigned)},a.prototype.div=function(e){if(e.isZero())throw new Error("division by zero");if(this.isZero())return this.unsigned?a.UZERO:a.ZERO;var t,n,r;if(this.equals(a.MIN_SIGNED_VALUE)){if(e.equals(a.ONE)||e.equals(a.NEG_ONE))return a.MIN_SIGNED_VALUE;if(e.equals(a.MIN_SIGNED_VALUE))return a.ONE;var i=this.shiftRight(1);return t=i.div(e).shiftLeft(1),t.equals(a.ZERO)?e.isNegative()?a.ONE:a.NEG_ONE:(n=this.subtract(e.multiply(t)),r=t.add(n.div(e)))}if(e.equals(a.MIN_SIGNED_VALUE))return this.unsigned?a.UZERO:a.ZERO;if(this.isNegative())return e.isNegative()?this.negate().div(e.negate()):this.negate().div(e).negate();if(e.isNegative())return this.div(e.negate()).negate();for(r=a.ZERO,n=this;n.greaterThanOrEqual(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(t)/Math.LN2),s=48>=o?1:Math.pow(2,o-48),u=a.fromNumber(t,this.unsigned),c=u.multiply(e);c.isNegative()||c.greaterThan(n);)t-=s,u=a.fromNumber(t,this.unsigned),c=u.multiply(e);u.isZero()&&(u=a.ONE),r=r.add(u),n=n.subtract(c)}return r},a.prototype.modulo=function(e){return this.subtract(this.div(e).multiply(e))},a.prototype.not=function(){return a.fromBits(~this.low,~this.high,this.unsigned)},a.prototype.and=function(e){return a.fromBits(this.low&e.low,this.high&e.high,this.unsigned)},a.prototype.or=function(e){return a.fromBits(this.low|e.low,this.high|e.high,this.unsigned)},a.prototype.xor=function(e){return a.fromBits(this.low^e.low,this.high^e.high,this.unsigned)},a.prototype.shiftLeft=function(e){if(e&=63,0==e)return this;var t=this.low;if(32>e){var n=this.high;return a.fromBits(t<<e,n<<e|t>>>32-e,this.unsigned)}return a.fromBits(0,t<<e-32,this.unsigned)},a.prototype.shiftRight=function(e){if(e&=63,0==e)return this;var t=this.high;if(32>e){var n=this.low;return a.fromBits(n>>>e|t<<32-e,t>>e,this.unsigned)}return a.fromBits(t>>e-32,t>=0?0:-1,this.unsigned)},a.prototype.shiftRightUnsigned=function(e){if(e&=63,0==e)return this;var t=this.high;if(32>e){var n=this.low;return a.fromBits(n>>>e|t<<32-e,t>>>e,this.unsigned)}return 32==e?a.fromBits(t,0,this.unsigned):a.fromBits(t>>>e-32,0,this.unsigned)},a.prototype.toSigned=function(){var e=this.clone();return e.unsigned=!1,e},a.prototype.toUnsigned=function(){var e=this.clone();return e.unsigned=!0,e},a.prototype.clone=function(){return new a(this.low,this.high,this.unsigned)},"undefined"!=typeof e&&e.exports?e.exports=a:n(609).amd?(r=[],i=function(){return a}.apply(t,r),!(void 0!==i&&(e.exports=i))):(o.dcodeIO||(o.dcodeIO={}),o.dcodeIO.Long=a)}(this)}).call(t,n(76)(e))},function(e,t,n){function r(e){return n(i(e))}function i(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./af/translation.json":612,"./ar/translation.json":613,"./az/translation.json":614,"./be/translation.json":615,"./bg/translation.json":616,"./bn/translation.json":617,"./bs/translation.json":618,"./ca/translation.json":619,"./cs/translation.json":620,"./da/translation.json":621,"./de/translation.json":622,"./el/translation.json":623,"./en/translation.json":624,"./es/translation.json":625,"./et/translation.json":626,"./eu/translation.json":627,"./fa/translation.json":628,"./fi/translation.json":629,"./fil/translation.json":630,"./fr/translation.json":631,"./gl/translation.json":632,"./gu/translation.json":633,"./he/translation.json":634,"./hi/translation.json":635,"./hr/translation.json":636,"./hu/translation.json":637,"./id/translation.json":638,"./is/translation.json":639,"./it/translation.json":640,"./ja/translation.json":641,"./ka/translation.json":642,"./kk/translation.json":643,"./km/translation.json":644,"./kn/translation.json":645,"./ko/translation.json":646,"./ky/translation.json":647,"./lo/translation.json":648,"./lt/translation.json":649,"./lv/translation.json":650,"./mk/translation.json":651,"./ml/translation.json":652,"./mr/translation.json":653,"./ms/translation.json":654,"./my/translation.json":655,"./nb/translation.json":656,"./ne/translation.json":657,"./nl/translation.json":658,"./nn/translation.json":659,"./pa/translation.json":660,"./pl/translation.json":661,"./ps/translation.json":662,"./pt-BR/translation.json":663,"./pt-ZZ/translation.json":664,"./pt/translation.json":665,"./ro/translation.json":666,"./ru/translation.json":667,"./si/translation.json":668,"./sk/translation.json":669,"./sl/translation.json":670,"./sq/translation.json":671,"./sr/translation.json":672,"./sv/translation.json":673,"./sw/translation.json":674,"./ta/translation.json":675,"./te/translation.json":676,"./th/translation.json":677,"./tr/translation.json":678,"./uk/translation.json":679,"./ur/translation.json":680,"./uz/translation.json":681,"./vi/translation.json":682,"./zh-CN/translation.json":683,"./zh-TW/translation.json":684,"./zu/translation.json":685};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=358},,,function(e,t,n){"use strict";var r=n(1),i=n(53),o=n(7),a={getKeys:function(){var e=i.get().encKey.toString(CryptoJS.enc.Base64),t=i.get().macKey.toString(CryptoJS.enc.Base64);return{enc:CryptoJS.enc.Base64.parse(e),mac:CryptoJS.enc.Base64.parse(t)}},encrypt:function(e){var t=CryptoJS.lib.WordArray.create(e),n=new Uint32Array(4),r=this.getKeys();window.crypto.getRandomValues(n);var i=CryptoJS.AES.encrypt(t,r.enc,{iv:CryptoJS.lib.WordArray.create(n),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}),a=i.iv.concat(i.ciphertext),s=CryptoJS.HmacSHA256(a,r.mac),u=s.concat(a);return o.fromBase64(u.toString(CryptoJS.enc.Base64)).toBuffer()},decrypt:function(e){var t=o.wrap(e),n=t.slice(t.offset,t.offset+32).toBase64(),i=t.slice(t.offset+32).toBuffer(),a=this.getKeys(),s=CryptoJS.lib.WordArray.create(i),u=CryptoJS.HmacSHA256(s,a.mac).toString(CryptoJS.enc.Base64);if(n!==u)throw r.error("bp:01:decrypt hmac dont match "+n+" "+u)(),new Error("hmac mismatch");var c=t.slice(t.offset+32,t.offset+48).toBuffer(),l=t.slice(t.offset+48).toBuffer(),d=CryptoJS.AES.decrypt({ciphertext:CryptoJS.lib.WordArray.create(l),salt:void 0},a.enc,{iv:CryptoJS.lib.WordArray.create(c),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return o.fromBase64(d.toString(CryptoJS.enc.Base64)).toBuffer()}};e.exports=a},function(e,t){"use strict";var n={singleByte:[void 0,void 0,void 0,"200","400","404","500","501","502","action","add","after","archive","author","available","battery","before","body","broadcast","chat","clear","code","composing","contacts","count","create","debug","delete","demote","duplicate","encoding","error","false","filehash","from","g.us","group","groups_v2","height","id","image","in","index","invis","item","jid","kind","last","leave","live","log","media","message","mimetype","missing","modify","name","notification","notify","out","owner","participant","paused","picture","played","presence","preview","promote","query","raw","read","receipt","received","recipient","recording","relay","remove","response","resume","retry","s.whatsapp.net","seconds","set","size","status","subject","subscribe","t","text","to","true","type","unarchive","unavailable","url","user","value","web","width","mute","read_only","admin","creator","short","update","powersave"],doubleByte:[]};e.exports=n},function(e,t,n){"use strict";function r(e){var t=!1,n=i.wrap(e,void 0,t);this.readByte=function(){return n.readUint8()},this.readInt16=function(){return n.readUint16()},this.readInt20=function(){var e=15&n.readUint8(),t=n.readUint8(),r=n.readUint8();return(e<<16)+(t<<8)+r},this.readString=function(e){return n.readString(e,i.METRICS_BYTES)},this.readBytes=function(e){var t=n.copy(n.offset,n.offset+e);return n.offset+=e,t},this.debugInfo=function(){return"offset: "+n.offset+" byte: "+n.readUint8(n.offset)}}var i=n(7);e.exports=r},function(e,t,n){"use strict";function r(e,t){if(!e)return"undefined";var n=i(e[1],t),r=o(e[2],t);return"<"+e[0]+n+(r?">\n"+r+"\n</"+e[0]+">":"/>")}function i(e,t){if(e){var n="";for(var r in e){var i="string"==typeof e[r]?t?"...":'"'+e[r]+'"':e[r];n+=" "+r+"="+i}return n}return""}function o(e,t){return a.isByteBuffer(e)?"<<bin:"+e.limit+">>":"string"==typeof e?t?"<<string:"+e.length+">>":e:_.isArray(e)?e.map(_.partial(r,_,t)).join("\n"):void 0}var a=n(7),s={tag:function(e){return e&&e[0]},attr:function(e,t){return t&&t[1]?t[1][e]:void 0},attrs:function(e){return e[1]},child:function u(e,t){var n=t[2];if(_.isArray(n))for(var r=n.length,i=0;r>i;i++){var u=n[i];if(_.isArray(u)&&u[0]===e)return u}},children:function(e){return e&&e[2]},dataStr:function(e){if(!e)return"";var t=e[2];return"string"==typeof t?t:a.isByteBuffer(t)?t.readString(t.limit,a.METRICS_BYTES,0).string:void 0},toString:r};e.exports=s},function(e,t,n){"use strict";function r(){function e(e){n++,r.push(e)}var t=!1,n=0,r=[];this.pushInt16=function(t){if("number"!=typeof t)throw new Error("invalid int16");e((65280&t)>>8),e((255&t)>>0)},this.pushInt20=function(t){if("number"!=typeof t)throw new Error("invalid int20");e((983040&t)>>16),e((65280&t)>>8),e((255&t)>>0)},this.pushByte=function(t){if("number"!=typeof t||0>t||t>255)throw new Error("invalid byte value: "+t);e(t)},this.pushBytes=function(e){if(!i.isByteBuffer(e))throw new Error("invalid byte buffer");n+=e.limit,r.push(e)},this.pushString=function(e){if("string"!=typeof e)throw new Error("invalid string");n+=i.calculateUTF8Bytes(e),r.push(e)},this.toBuffer=function(){for(var e=new i(n,t),o=r.length,a=0;o>a;a++){var s=r[a];"string"==typeof s?e.writeString(s):i.isByteBuffer(s)?(s.reset(),e.append(s)):e.writeByte(s)}return e.reset(),e.toBuffer(!0)}}var i=n(7);e.exports=r},function(e,t,n){"use strict";function r(e){var t=e.singleByte,n=e.doubleByte;this.readNode=function(e){var t=e.readByte(),n=this.readListSize(e,t);if(t=e.readByte(),t===i.STREAM_END)throw new Error("unexpected stream end "+e.debugInfo());var r=this.readString(e,t);if(0===n||!r)throw new Error("invalid node. 0 list or empty tag"+e.debugInfo());var o=n-2+n%2>>1,a=this.readAttributes(e,o);if(n%2===1)return[r,a,void 0];var s;if(t=e.readByte(),this.isListTag(t))s=this.readList(e,t);else if(t===i.BINARY_8){var u=e.readByte();s=e.readBytes(u)}else if(t===i.BINARY_20){var c=e.readInt20();s=e.readBytes(c)}else s=this.readString(t);return[r,a,s]},this.isListTag=function(e){return e===i.LIST_EMPTY||e===i.LIST_8||e===i.LIST_16},this.readListSize=function(e,t){if(t===i.LIST_EMPTY)return 0;if(t===i.LIST_8)return e.readByte();if(t===i.LIST_16)return e.readInt16();throw new Error("invalid list size "+e.debugInfo())},this.readString=function(e,t){if(-1===t)throw new Error("invalid start token readString"+e.debugInfo());if(t>2&&236>t){var n=this.getToken(t);return"s.whatsapp.net"===n&&(n="c.us"),n}switch(t){case i.DICTIONARY_0:case i.DICTIONARY_1:case i.DICTIONARY_2:case i.DICTIONARY_3:var r=e.readByte();return this.getTokenDouble(t-i.DICTIONARY_0,r);case i.LIST_EMPTY:return;case i.BINARY_8:var o=e.readByte();return e.readString(o);case i.BINARY_20:var a=e.readInt20();return e.readString(a);case i.JID_PAIR:var s=this.readString(e,e.readByte()),u=this.readString(e,e.readByte());if("undefined"!=typeof s&&"undefined"!=typeof u)return s+"@"+u;if("undefined"!=typeof u)return u;throw new Error("invalid jid "+s+","+u+" "+e.debugInfo());default:throw new Error("invalid string "+e.debugInfo())}},this.getToken=function(e){var n;if(e>=0&&e<t.length&&(n=t[e]),"undefined"==typeof n)throw new Error("invalid token "+e);return n},this.getTokenDouble=function(e,t){var r,i=256*e+t;if(i>=0&&i<n.length&&(r=n[i]),"undefined"==typeof r)throw new Error("invalid double byte token "+e+" "+t);return r},this.readAttributes=function(e,t){for(var n,r,i=t?{}:void 0,o=0;t>o;o++)n=this.readString(e,e.readByte()),r=this.readString(e,e.readByte()),i[n]=r;return i},this.readList=function(e,t){for(var n=[],r=this.readListSize(e,t),i=0;r>i;i++)n.push(this.readNode(e));return n}}var i=n(164);e.exports=r},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t,n={};for(t=0;t<e.singleByte.length;t++)e.singleByte[t]&&(n[e.singleByte[t]]=t);for(t=0;t<e.doubleByte.length;t++)e.doubleByte[t]&&(n[e.doubleByte[t]]=t+u.SINGLE_BYTE_MAX);this.writeNode=function(e,t){if(t){if(3!==t.length)throw new Error("invalid node");var n=t[1]?2*(0,a["default"])(t[1]).filter(function(e){return!!t[1][e]}).length:0;this.writeListStart(e,1+n+(t[2]?1:0)),this.writeString(e,t[0]),this.writeAttributes(e,t[1]),this.writeChildren(e,t[2])}},this.writeString=function(e,t){if("string"!=typeof t)throw new Error("invalid string");var r,i,o=n[t];if("undefined"==typeof o){var a=t.indexOf("@");if(1>a)this.writeStringRaw(e,t);else{var s=t.substring(0,a),c=t.substring(a+1);this.writeJid(e,s,c)}}else{if(o<u.SINGLE_BYTE_MAX)this.writeToken(e,o);else{var l=o-u.SINGLE_BYTE_MAX,d=l>>8;switch(i=l%256,d){case 0:r=u.DICTIONARY_0;break;case 1:r=u.DICTIONARY_1;break;case 2:r=u.DICTIONARY_2;break;case 3:r=u.DICTIONARY_3;break;default:throw new Error("double byte dictionary token out of range: "+t+" "+o)}}this.writeToken(e,r),this.writeToken(e,i)}},this.writeStringRaw=function(e,t){var n=s.calculateUTF8Bytes(t);n>=256?(e.pushByte(u.BINARY_20),e.pushInt20(n)):(e.pushByte(u.BINARY_8),e.pushByte(n)),e.pushString(t)},this.writeJid=function(e,t,n){e.pushByte(u.JID_PAIR),t?this.writeString(e,t):this.writeToken(e,u.LIST_EMPTY),"c.us"===n&&(n="s.whatsapp.net"),this.writeString(e,n)},this.writeToken=function(e,t){if(245>t)e.pushByte(t);else if(500>=t)throw new Error("invalid token")},this.writeAttributes=function(e,t){if(t)for(var n in t)t[n]&&(this.writeString(e,n),this.writeString(e,t[n]))},this.writeChildren=function(e,t){var n;if(t)if("string"==typeof t)this.writeString(e,t);else if(s.isByteBuffer(t))n=t.limit,n>=256?(e.pushByte(u.BINARY_20),e.pushInt20(n)):(e.pushByte(u.BINARY_8),e.pushByte(n)),e.pushBytes(t);else{if(!_.isArray(t))throw new Error("invalid children");n=t.length,this.writeListStart(e,n);for(var r=0;n>r;r++)this.writeNode(e,t[r])}},this.writeListStart=function(e,t){0===t?e.pushByte(u.LIST_EMPTY):256>t?(e.pushByte(u.LIST_8),e.pushByte(t)):(e.pushByte(u.LIST_16),e.pushInt16(t))}}var o=n(37),a=r(o),s=n(7),u=n(164);e.exports=i},function(e,t){"use strict";var n={singleByte:[void 0,void 0,void 0,"200","400","404","500","501","502","action","add","after","archive","author","available","battery","before","body","broadcast","chat","clear","code","composing","contacts","count","create","debug","delete","demote","duplicate","encoding","error","false","filehash","from","g.us","group","groups_v2","height","id","image","in","index","invis","item","jid","kind","last","leave","live","log","media","message","mimetype","missing","modify","name","notification","notify","out","owner","participant","paused","picture","played","presence","preview","promote","query","raw","read","receipt","received","recipient","recording","relay","remove","response","resume","retry","s.whatsapp.net","seconds","set","size","status","subject","subscribe","t","text","to","true","type","unarchive","unavailable","url","user","value","web","width","mute","read_only","admin","creator","short","update","powersave"],doubleByte:[],nibbleEncode:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,"-":10,".":11,"\x00":15},nibbleDecode:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"-",11:".",15:String.fromCharCode("\x00")}};e.exports=n},function(e,t){"use strict";var n={singleByte:[void 0,void 0,void 0,"200","400","404","500","501","502","action","add","after","archive","author","available","battery","before","body","broadcast","chat","clear","code","composing","contacts","count","create","debug","delete","demote","duplicate","encoding","error","false","filehash","from","g.us","group","groups_v2","height","id","image","in","index","invis","item","jid","kind","last","leave","live","log","media","message","mimetype","missing","modify","name","notification","notify","out","owner","participant","paused","picture","played","presence","preview","promote","query","raw","read","receipt","received","recipient","recording","relay","remove","response","resume","retry","s.whatsapp.net","seconds","set","size","status","subject","subscribe","t","text","to","true","type","unarchive","unavailable","url","user","value","web","width","mute","read_only","admin","creator","short","update","powersave","checksum","epoch","block","previous","409","replaced","reason","spam","modify_tag"],doubleByte:[],nibbleEncode:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,"-":10,".":11,"\x00":15},nibbleDecode:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"-",11:".",15:String.fromCharCode("\x00")}};e.exports=n},function(e,t){"use strict";var n={singleByte:[void 0,void 0,void 0,"200","400","404","500","501","502","action","add","after","archive","author","available","battery","before","body","broadcast","chat","clear","code","composing","contacts","count","create","debug","delete","demote","duplicate","encoding","error","false","filehash","from","g.us","group","groups_v2","height","id","image","in","index","invis","item","jid","kind","last","leave","live","log","media","message","mimetype","missing","modify","name","notification","notify","out","owner","participant","paused","picture","played","presence","preview","promote","query","raw","read","receipt","received","recipient","recording","relay","remove","response","resume","retry","s.whatsapp.net","seconds","set","size","status","subject","subscribe","t","text","to","true","type","unarchive","unavailable","url","user","value","web","width","mute","read_only","admin","creator","short","update","powersave","checksum","epoch","block","previous","409","replaced","reason","spam","modify_tag","message_info","delivery","emoji","title","description","canonical-url","matched-text","star","unstar"],doubleByte:[],nibbleEncode:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,"-":10,".":11,"\x00":15},nibbleDecode:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"-",11:".",15:String.fromCharCode("\x00")}};e.exports=n},function(e,t){"use strict";var n={singleByte:[void 0,void 0,void 0,"200","400","404","500","501","502","action","add","after","archive","author","available","battery","before","body","broadcast","chat","clear","code","composing","contacts","count","create","debug","delete","demote","duplicate","encoding","error","false","filehash","from","g.us","group","groups_v2","height","id","image","in","index","invis","item","jid","kind","last","leave","live","log","media","message","mimetype","missing","modify","name","notification","notify","out","owner","participant","paused","picture","played","presence","preview","promote","query","raw","read","receipt","received","recipient","recording","relay","remove","response","resume","retry","s.whatsapp.net","seconds","set","size","status","subject","subscribe","t","text","to","true","type","unarchive","unavailable","url","user","value","web","width","mute","read_only","admin","creator","short","update","powersave","checksum","epoch","block","previous","409","replaced","reason","spam","modify_tag","message_info","delivery","emoji","title","description","canonical-url","matched-text","star","unstar","media_key","ref_key"],doubleByte:[],nibbleEncode:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,"-":10,".":11,"\x00":15},nibbleDecode:{0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"-",11:".",15:String.fromCharCode("\x00")}};e.exports=n},function(e,t,n){"use strict";var r=n(6),i=n(14),o=n(52),a=r.createClass({displayName:"Conflict",render:function(){return r.createElement(o,{body:l10n.t("phone_has_another_active_webclient_session"),cancelLabel:l10n.t("menuitem_logout"),onCancel:i.logout.bind(i),defaultLabel:l10n.t("button_use_here"),onDefault:i.takeover.bind(i)})}});e.exports=a},function(e,t,n){"use strict";var r=n(6),i=n(30),o=n(79),a=n(78),s=n(157),u=n(346),c=n(105),l={menu:null,origin:{x:0,y:0},anchor:null,event:null,menuDirection:{x:u.Direction.X.RIGHT,y:u.Direction.Y.BOTTOM},originPosition:{x:u.Direction.X.LEFT,y:u.Direction.Y.BOTTOM},originOffset:{x:0,y:0},onOpen:_.noop,onClose:_.noop,onDefault:_.noop,classes:null},d={MENU:"menu",TOOLTIP:"tooltip"},f=r.createClass({displayName:"ContextMenuManager",mixins:[o,s],propTypes:{type:r.PropTypes.oneOf(_.values(d)).isRequired},getDefaultProps:function(){return{type:d.MENU}},getInitialState:function(){return l},componentWillMount:function(){var e=this.props.type===d.MENU?"open_context_menu":"open_tooltip";this.regCmd(e,this.open)},open:function(e,t){this.state.menu&&a.pop(this.props.type),t=_.merge(_.clone(l,!0),t),t.event&&(t.origin={x:t.event.clientX,y:t.event.clientY},t.originOffset={x:10,y:10},t.event.stopPropagation()),t.key=Math.random(),t.menu=e,this.replaceState(t,function(){this.setDirection()}),this.uimPush(this,this.props.type,{popable:!0,parent:t.parent})},uimClose:function(){_.isFunction(this.state.onClose)&&this.state.onClose(),this.setState(l)},setDirection:function(){var e=i.findDOMNode(this.refs.menu);if(!e)return null;var t=e.clientWidth,n=e.clientHeight,r=window.innerWidth,o=window.innerHeight,a=_.clone(this.state.menuDirection),s=_.clone(this.state.origin),c=s.x,l=s.x,d=s.y,f=s.y;if(this.state.anchor){var p=this.state.anchor,h=p.getBoundingClientRect();c=h.left,l=h.right,d=h.top,f=h.bottom}var g=a.x;g===u.Direction.X.RIGHT&&c+t>r&&l-t>0?g=u.Direction.X.LEFT:g===u.Direction.X.LEFT&&0>l-t&&r>c+t&&(g=u.Direction.X.RIGHT);var m=a.y;m===u.Direction.Y.BOTTOM&&f+n>o&&d-n>0?m=u.Direction.Y.TOP:m===u.Direction.Y.TOP&&0>d-n&&o>f+n&&(m=u.Direction.Y.BOTTOM);var v=g===u.Direction.X.RIGHT?c:l,b=m===u.Direction.Y.TOP?d:f;this.setState({menuDirection:{x:g,y:m},origin:{x:v,y:b}})},render:function(){var e;if(this.state.menu){var t={x:this.state.origin.x+this.state.originOffset.x,y:this.state.origin.y+this.state.originOffset.y};e=r.createElement(u,{origin:t,ref:"menu",onDefault:this.state.onDefault,classes:this.state.classes,type:this.state.type,key:"key-"+this.state.key,direction:this.state.menuDirection},this.state.menu)}var n=this.state.type===u.Type.PICKER?"dropdown-picker":"dropdown";return r.createElement(c,{transitionName:n},e)}});e.exports=f},function(e,t,n){"use strict";function r(e){this.regex=new RegExp("^"+e[0]+"$"),this.formatString=e[1],this.leadins=_.map(e[2],function(e){return new RegExp("^(?:"+e+")")})}function i(e){var t=s[e];return t?c[e]={lengths:t[0],formats:t[1].map(function(e){return new r(e)})}:null}function o(e){var t=e.match(u);return t?t[0]:e.length>=3?e.substring(0,3):e}function a(e){var t=o(e);if(!t)return e;var n=e.substring(t.length),r=c[t]||i(t);if(!r)return"+"+t+" "+n;for(var a=r.formats,s=0;s<a.length;s++){var u=a[s].testAndFormat(n);if(u)return"+"+t+" "+u}return"+"+t+" "+n}var s=n(479),u=/^(1|2[07]|3[0-469]|4[013-9]|5[1-8]|6[0-6]|7|8[1246]|9[0-58])/,c={};r.prototype={testAndFormat:function(e){return this.regex.test(e)&&this.checkLeadins(e)&&e.replace(this.regex,this.formatString)},checkLeadins:function(e){return 0===this.leadins.length||_.any(this.leadins,function(t){return t.test(e)})}},e.exports={findCC:o,format:a}},function(e,t){"use strict";var n={CAPABILITY_URL:"https://web.whatsapp.com/browsers.html",PP_URL:"https://dyn.web.whatsapp.com/pp",LOGOUT_URL:"https://dyn.web.whatsapp.com/logout",WS_FAIL_URL:"https://web.whatsapp.com/health_check.json",WAM_URL:"https://dyn.web.whatsapp.com/wam",COOKIE_DOMAIN:".web.whatsapp.com",PP_TOK:"/pp",PP_REF:"/pp",UPLOAD_TO_CLB:1,DIAGNOSTIC_DELAY:18e3,FLAVOR_TAGS:!1,WAM_ROTATE_INTERVAL:3600,SOCKETS:["wss://w1.web.whatsapp.com/ws","wss://w2.web.whatsapp.com/ws","wss://w3.web.whatsapp.com/ws","wss://w4.web.whatsapp.com/ws","wss://w5.web.whatsapp.com/ws","wss://w6.web.whatsapp.com/ws","wss://w7.web.whatsapp.com/ws","wss://w8.web.whatsapp.com/ws"]};e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(3),o=r(i),a=n(101),s=r(a),u=function(){window.Promise=n(3)["default"]=n(331),n(323),window.moment=n(0),window._=n(337),window.Velocity=n(338),n(339),window.WebFont=n(340),window.CryptoJS=n(20),n(334),n(152),n(333),n(332),n(330);var e=window.performance.now();n(327),n(326),n(329),["getSelection","open","focus"].forEach(function(e){var t=(0,s["default"])(window)[e];_.isFunction(t)&&window[e]!==t&&(window[e]=t)}),window.Store={Conn:n(168),Contact:n(325),Wap:n(35)};var t=n(45),r=n(12);window.Debug||(window.Debug={}),window.Debug.uploadLogs=r.upload.bind(r),t.isGecko||WebFont.load({google:{families:["Open Sans:400,600","Roboto:300,400,500"]}}),window.l10n=n(328),l10n.init(n(15).getLangPref());var i=n(1);window.onerror=function(e,t,n,o,a){return i.error("exe:onerror ("+t+") "+e)(),"Script error."!==e||a?(a instanceof Error&&a.stack?(i.errorVerbose("exe:unhandled error: "+a.stack)(),r.upload(null)):(i.error("exe:unhandled error: "+(a||"Error: ? "+e))(),r.upload("window-error")),!1):(t&&r.upload("script-error"),!1)},o["default"].onPossiblyUnhandledRejection(function(e,t){i.error("exe:unhandled rejection: "+e)(),e instanceof Error&&e.stack?(i.errorVerbose(e.stack)(),r.upload(null)):r.upload("unhandled-rejection")});var a=n(324),u=n(8),c=n(17);window.onbeforeunload=function(e){return c.isDownloading()?void c.clearDownloading():(i.log("webclient close/reload triggered")(),i.log("latest hash: "+u.LATEST_HASH)(),i.log("version: "+u.VERSION_STR)(),c.promptUnloadGuards>0?void 0:a.hasPending()?l10n.t("confirm_closing_webclient"):void 0)},window.addEventListener("dragover",function(e){e.preventDefault()}),window.addEventListener("drop",function(e){e.preventDefault()});var l=n(30),d=n(6);l.render(d.createElement(a,null),document.getElementById("app"));try{n(151).PageLoad.set({webcExeStart:0|e,webcExeDone:0|window.performance.now()})}catch(f){}};window.Exe=u,n(102)},,function(e,t,n){"use strict";var r=n(6),i=n(30),o=n(79),a=n(78),s=n(157),u=n(105),c=r.createClass({displayName:"ModalManager",mixins:[o,s],statics:{DEFAULT_TRANSITION:"modal"},getInitialState:function(){return{flow:null}},componentWillMount:function(){this.regCmd("open_modal",this.openFlow),this.regCmd("close_modal",this.closeFlow)},openFlow:function(e,t,n){this.uimPush(this,a.MODAL,{escapable:!0,parent:n}),this.setState({flow:e,transition:t},this.focus)},focus:function(){var e=i.findDOMNode(this);e.contains(document.activeElement)||e.focus()},closeFlow:function(){this.uimPop(a.MODAL)},uimClose:function(){this.setState({flow:null,transition:this.state.transition})},render:function(){var e,t,n=this.state.transition;return n=_.isBoolean(n)&&!n?void 0:n||c.DEFAULT_TRANSITION,this.state.flow&&(n?t=this.state.flow:e=this.state.flow),r.createElement("div",{tabIndex:"-1"},e,r.createElement(u,{transitionName:n},t))}});e.exports=c},function(e,t,n){"use strict";var r=n(6),i=n(52),o=r.createClass({displayName:"Offline",render:function(){return r.createElement(i,{title:l10n.t("computer_not_connected"),
body:l10n.t("make_sure_computer_active_internet_connection")})}});e.exports=o},function(e,t,n){"use strict";function r(){window.open("https://www.whatsapp.com/faq/web/28080002#proxies","_blank")}var i=n(6),o=n(52),a=i.createClass({displayName:"Proxied",render:function(){return i.createElement(o,{title:l10n.t("cant_load_whatsapp"),body:l10n.t("computer_behind_proxy"),defaultLabel:l10n.t("learn_more"),onDefault:r})}});e.exports=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(3),o=r(i),a=n(6),s=n(30),u=n(14),c=n(15),l=n(103),d=n(35),f=n(155),p=n(8),h=n(9),g=n(341),m=n(38),v=n(53),b=n(17),y=n(77),w=n(105),E=n(356),S=a.createClass({displayName:"QRCode",mixins:[l],getInitialState:function(){return{rememberMe:c.getRememberMe(),expired:u.state===u.STATE.UNPAIRED_IDLE,offline:!u.online,refValid:u.state===u.STATE.UNPAIRED}},componentDidMount:function(){this.addObserver(u,"change:state change:online",this.onStateChange)},onStateChange:function(){this.setState({offline:!u.online,expired:u.state===u.STATE.UNPAIRED_IDLE,refValid:u.state===u.STATE.UNPAIRED})},onQRExpiry:function(){this.setState({ref:void 0}),u.poke()},onRememberMeChange:function(e){u.isIncognito||d.setRememberMe(e.target.checked)["catch"](_.noop),c.setRememberMe(e.target.checked),this.setState({rememberMe:c.getRememberMe()})},render:function(){var e=void 0;e=this.state.offline?a.createElement(C,null,a.createElement("button",{className:"qr-button",key:"expiry"},a.createElement("div",{className:"icon icon-connection-l-light"}),l10n.t("check_internet_connection"))):this.state.expired?a.createElement(C,null,a.createElement("button",{className:"qr-button",key:"expiry",onClick:this.onQRExpiry},a.createElement("div",{className:"qr-container"},a.createElement("div",{className:"icon icon-refresh-l-light"}),l10n.t("click_to_reload_qr_code")))):this.state.refValid?a.createElement(C,null):a.createElement("div",{className:"qrcode"},a.createElement(f,null));var t=this.state.rememberMe?null:a.createElement("div",{className:"remember-me-tip"},l10n.t("if_unchecked_you_will_be_logged_out_afterawhile"));return a.createElement("div",{id:"wrapper"},a.createElement("div",{id:"window"},a.createElement("div",{className:"entry-main"},e,a.createElement("div",{className:"entry-text"},a.createElement("div",{className:"entry-title"},l10n.t("whatsapp_web")),a.createElement("div",{className:"entry-subtitle"},l10n.t("scan_code_with_phone_to_login")),a.createElement("div",{className:"entry-controls"},a.createElement("div",{className:"toggle"},a.createElement(w,{transitionName:"fade_sifo"},t),a.createElement("label",null,a.createElement("input",{type:"checkbox",name:"rememberMe",checked:this.state.rememberMe,onChange:this.onRememberMeChange}),l10n.t("menuitem_keep_me_signed_in"))),a.createElement("div",{className:"hint"},l10n.t("reduce_data_usage_connect_phone_to_wifi"))))),a.createElement("div",{id:"platforms"},a.createElement("ul",{className:"list entry-platforms"},a.createElement(k,{platform:"android",path:l10n.t("android_login_path"),name:l10n.t("android")}),a.createElement(k,{platform:"iphone",path:l10n.t("iphone_login_path"),name:l10n.t("iphone")}),a.createElement(k,{platform:"wp",path:l10n.t("windows_phone_login_path"),name:l10n.t("windows_phone")}),a.createElement(k,{platform:"bb",path:l10n.t("blackberry_login_path"),name:l10n.t("blackberry")}),a.createElement(k,{platform:"bb10",path:l10n.t("bb10_login_path"),name:l10n.t("bb10")}),a.createElement(k,{platform:"s60",path:l10n.t("nokia_symbian_s60_login_path"),name:l10n.t("nokia_symbian_s60")}),a.createElement(k,{platform:"s40",path:l10n.t("nokia_s40_login_path"),name:l10n.t("nokia_s40")})),a.createElement("p",{className:"hint"},l10n.t("login_hint_version")))))}}),C=a.createClass({displayName:"QR",mixins:[l],propTypes:{children:a.PropTypes.element},getInitialState:function(){return{disableCursor:!1}},componentDidMount:function(){this.addObserverAndRun(Store.Conn,"change:ref",this.genQR)},genQR:function(){var e=this.getData();if(e){var t=s.findDOMNode(this);this.qr?this.qr.makeCode(e):this.qr=new E(t,{text:e,colorDark:"#122e31",width:p.QR_EDGE,height:p.QR_EDGE,correctLevel:E.CorrectLevel.L}),t.removeAttribute("title"),t.setAttribute("data-ref",e)}},getData:function(){if(!Store.Conn.connected){var e=Store.Conn.ref,t=v.getOrGenerate(),n=b.id();return e+","+t+","+n}},copy:function(){var e=window.getSelection();e.selectAllChildren(document.getElementById("qr-code-copy")),document.execCommand("copy"),h.closeModal()},onMouseMove:function(e){var t=this;this.state.disableCursor&&this.setState({disableCursor:!1}),this.disableCursorPromise&&this.disableCursorPromise.cancel(),this.disableCursorPromise=m.delay(1e3).cancellable().then(function(e){t.isMounted()&&t.setState({disableCursor:!0})})["finally"](function(){t.isMounted()&&(t.disableCursorPromise=void 0)})["catch"](o["default"].CancellationError,_.noop)},onMouseLeave:function(e){this.disableCursorPromise&&this.disableCursorPromise.cancel()},onContextMenu:function(e){e.stopPropagation(),e.preventDefault(),h.openModal(a.createElement(g,{onOK:this.copy,okText:"Copy to Clibboard"},a.createElement("span",{id:"qr-code-copy"},this.state.data)))},render:function(){var e=this.props.children,t=y("qrcode",{idle:!!e}),n={};this.state.disableCursor&&!e&&(n.cursor="none");var r=null;return a.createElement("div",{className:t,onContextMenu:r,style:n,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave},a.createElement(w,{transitionName:"scale"},e),a.createElement("span",{className:"icon icon-logo"}))}}),k=a.createClass({displayName:"LoginPlatform",propTypes:{platform:a.PropTypes.oneOf(["android","iphone","bb","wp","bb10","s60","s40"]).isRequired,name:a.PropTypes.string.isRequired,path:a.PropTypes.string.isRequired},render:function(){var e="icon icon-platform icon-platform-"+this.props.platform;return a.createElement("li",{className:"list-item entry-platform"},a.createElement("span",{className:e,title:this.props.name}),a.createElement("div",null,a.createElement("div",{className:"entry-platform-title"},this.props.name),a.createElement("div",{className:"entry-platform-text"},this.props.path)))}});e.exports=S},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return f["default"].any(t).cancellable().then(function(){e.forceTimeout()})["finally"](function(){t.forEach(function(e){e.cancel()})})["catch"](f["default"].CancellationError,_.noop)}function o(){return w.waitForEvent(window,"online").then(function(){return f["default"].delay(k)})}function a(e){var t,n,r=e.data;if(r instanceof ArrayBuffer){for(var i,o=[],a=g.wrap(r);44!==(i=a.readByte());)o.push(i);t=String.fromCharCode.apply(String,o),n=a}else{var s=r.indexOf(",");t=r.slice(0,s),n=r.slice(s+1),n=n?JSON.parse(n):n}return{tag:t,data:n}}var s,u,c=n(22),l=r(c),d=n(3),f=r(d),p=n(8),h=n(62),g=n(7),m=n(9),v=n(11),b=n(1),y=n(12),w=n(36),E=n(172),S=n(173),C=n(170),k=100,T=3e5,$=6e3,O=2,A=.2,R=E.FIBONACCI(8e3,4e3,3e5),I=h.extend({props:{active:{type:"boolean","default":!0},socket:"object",sockets:"object",attempts:{type:"number","default":0},startId:{type:"number","default":0},online:{type:"boolean","default":!0},controller:"object",retryTimestamp:"number",tsListener:"function",onerror:"function",_resolve:"function",_reject:"function"},initialize:function(){var e=this;"undefined"==typeof s&&(s=p.SOCKETS,u=Date.now()%s.length),this.sockets=[],new f["default"](function(t,n){e._resolve=t,e._reject=n}).then(function(t){b.log("SocketOpener set to socket "+t.id)(),e.set({active:!1,socket:t})})["finally"](function(){b.log("SocketOpener closing socket opener")(),e.active=!1,_.forEach(e.sockets,function(e){e.cancel()});var t=e.controller;t&&(t.deactivate(),e.controller=null)})["catch"](f["default"].CancellationError,_.noop)["catch"](function(t){return b.error("SocketOpener deadly error! "+t)(t),e.onerror?void e.onerror(t):f["default"].reject(t)}),this.tsListener=function(t){e.retryTimestamp=t.ts},this.listenTo(this,"change:online",this.onOnlineChange),this.onOnlineChange()},attemptOpen:function(){if(!this.active)return b.log("attemptOpen called while not active!")(),void y.upload("rogue-opener");var e=this.startId+this.attempts,t=S.open({id:e,url:s[(e+u)%s.length],msgParser:a});this.attempts=this.sockets.push(t);var n=_.once(this.checkOnline).bind(this),r=_.delay(n,6e3);t.then(this._resolve)["finally"](function(){return clearTimeout(r)})["catch"](f["default"].CancellationError,_.noop)["catch"](n)},checkOnline:function(){var e=this;b.log("SocketOpener:checkOnline checking")(),w.getResponseIfOnline(p.WS_FAIL_URL+"?t="+Date.now()).then(function(t){if(b.log("SocketOpener:checkOnline response "+!!t)(),e.active&&(e.online=!!t,e.online&&!(t.status>=500))){var n=void 0;try{n=t.responseText?JSON.parse(t.responseText):{type:"empty"}}catch(r){n={type:"bad-parse",data:r+"\n"+t.responseText}}switch(n.type){case"allocated":b.log("ws2:diagnostic allocated")(),n.token&&C.setCookie({name:"ws_failure_diagnostic",value:n.token,path:"/",domain:p.COOKIE_DOMAIN,expirationDate:Date.now()+1e3*(n.age||120),secure:!0});break;case"empty":b.error("SocketOpener:empty healthcheck!")();break;case"missing":b.error("SocketOpener:request missing!")(),_.forEach(e.sockets,function(e){e.cancel()}),e.poke(k);break;case"found":b.error("SocketOpener:request noncompliant!")();var i=(0,l["default"])(n.data,void 0,4);b.errorVerbose(i,n)(),y.upload("websocket-req-noncompliant"),console.log("Error in connecting websocket."),console.log(i),e._reject(new v.BlockedByProxy);break;case"bad-parse":b.error("SocketOpener:healthcheck not json!",t)(),b.error(n.data,n)(),y.upload("websocket-req-badparse"),e._reject(new v.BlockedByProxy);break;default:b.log("SocketOpener:received "+n.type)()}}})},poke:function(){this.controller&&this.controller.forceTimeout()},onOnlineChange:function(){var e=this.controller,t=this.online?this.onlineController():this.offlineController();e&&(e.off("change:ts",this.tsListener),e.deactivate()),t.on("change:ts",this.tsListener),t.activate(),this.controller=t},onlineController:function(){var e=this;return b.log("SocketOpener:online")(),new E({waitAlgorithm:R,jitter:A,onActivated:function(){e.attemptOpen()},onTimeout:function(){return e.attemptOpen(),!0}})},offlineController:function(){var e=this;b.log("SocketOpener:offline")();var t=0,n=void 0,r=function(e){return n&&n.cancel(),navigator.onLine?t++<O?(b.log("SocketOpener:offline... quick poll")(),n=null,$):(b.log("SocketOpener:offline... heuristic poll")(),n=i(e,[o(),w.waitForBBEvent(m,"js_halt_detected"),w.waitForBBEvent(Store.Stream,"change:available")]),T):(b.log("SocketOpener:offline... wait for navigator")(),t=0,n=i(e,[o()]),T)};return new E({waitAlgorithm:r,jitter:A,onActivated:function(){0==e.pendingAttempts()&&e.attemptOpen()},onDeactivated:function(){n&&n.cancel()},onTimeout:function(){return e.attemptOpen(),!0}})},deactivate:function(){this._reject(new f["default"].CancellationError)},pendingAttempts:function(){return _.sum(this.sockets,function(e){return e.isPending()?1:0})}});e.exports=I},function(e,t,n){"use strict";var r=n(6),i=n(155),o=n(14),a=n(106),s=n(154),u=n(103),c=n(79),l=n(52),d=80,f=5,p=(100-d)/f,h=r.createClass({displayName:"Startup",mixins:[s,u,c],getInitialState:function(){return{retriable:!1,progress:d}},componentWillMount:function(){var e=this;this.addObserver(a,"change:displayInfo"),this.addObserver(o,"change:retryTimestamp",this.retried),this.regCmd("increment_progress",function(){var t=e.state.progress+p;e.setState({progress:t})})},retried:function(){this.clearSafeTimeout(this.timeout),delete this.timeout,this.clearSafeInterval(this.interval),delete this.interval,this.setState({retriable:!1}),this.startTimeout()},componentDidMount:function(){this.startTimeout();var e=document.getElementById("initial_startup");e&&e.parentNode.removeChild(e)},startTimeout:function(){this.timeout=this.safeDelay(this.allowRetry,3e3)},allowRetry:function(){this.setState({retriable:!0}),this.interval=this.safeInterval(this.forceUpdate,1e3)},retry:function(e){o.poke(),this.retried()},logout:function(e){o.logout()},render:function(){var e,t,n,s,u,c,d=null;switch(a.displayInfo){case a.INFO.OPENING:e=l10n.t("connecting_to_whatsapp"),t=l10n.t("make_sure_computer_active_internet_connection"),u=this.logout;break;case a.INFO.PAIRING:case a.INFO.TIMEOUT:e=l10n.t("trying_to_reach_phone");var f=window.open.bind(window,"http://www.whatsapp.com/faq/web/28080002","_blank");t=r.createElement("span",null,l10n.t("make_sure_phone_active_internet_connection"),"",r.createElement("span",{className:"action",onClick:f},l10n.t("learn_more"))),u=this.logout;break;case a.INFO.SYNCING:case a.INFO.CONNECTING:return r.createElement("div",{id:"startup"},r.createElement(i,{size:50,stroke:4}),d);default:return null}if(c=this.state.retriable)if(n=o.retryTimestamp-Date.now(),1>n)s=l10n.t("retrying");else if(6e4>n){var p=Math.ceil(n/1e3);s=l10n.t("retrying_in_some_seconds",{number:p,_plural:p})}else s=l10n.t("retrying_in",{duration:moment.duration(n).humanize()});else s=l10n.t("retrying");return r.createElement(l,{title:e,body:s,tip:t,defaultLabel:l10n.t("retry_now"),onDefault:c?this.retry:_.noop,cancelLabel:u?l10n.t("menuitem_logout"):null,onCancel:u})}});e.exports=h},function(e,t,n){"use strict";var r=n(6),i=n(14),o=n(52),a=r.createClass({displayName:"TOS",render:function(){return r.createElement(o,{body:l10n.t("web_terms_of_service_2"),cancelLabel:l10n.t("menuitem_logout"),onCancel:i.logout.bind(i,!0),defaultLabel:l10n.t("ok_got_it"),onDefault:i.poke.bind(i)})}});e.exports=a},function(e,t){"use strict";var n={LOW:"low",HIGH:"high"},r=window.matchMedia("\n    only screen and (-webkit-min-device-pixel-ratio: 2),\n    only screen and (min-device-pixel-ratio: 2),\n    only screen and (min-resolution: 2dppx)\n"),i={RES:n,currentRes:r.matches?n.HIGH:n.LOW},o=function(e){var t=e.matches?n.HIGH:n.LOW;if(t!==i.currentRes){i.currentRes=t;var r=document.createEvent("Event");r.initEvent("dpichange",!0,!0),window.dispatchEvent(r)}};r.addListener(o),e.exports=i},function(e,t){"use strict";function n(e){this.styleSheet=this.createStyleSheet(e),this.rules={}}n.prototype.createStyleSheet=function(e){e=e||_.uniqueId("dynamic-style-");var t=document.createElement("style");return t.id=e,t.type="text/css",document.head.appendChild(t),t=t.sheet},n.prototype.addRule=function(e,t){var n=this.styleSheet.cssRules.length;return t=_.map(t,function(e,t){return t+": "+e+";"}).join(" "),this.styleSheet.insertRule(e+" { "+t+" }",n),this.rules[e]=this.styleSheet.cssRules[n],this.rules[e]},n.prototype.updateRule=function(e,t){var n=this.rules[e];return _.forEach(t,function(e,t){n.style[_.camelCase(t)]=e}),n},n.prototype.setRule=function(e,t){var n=this.rules[e];return n?this.updateRule(e,t):this.addRule(e,t)},e.exports=n},function(e,t){"use strict";e.exports={ach:{name:"Acholi",numbers:[1,2],plurals:function(e){return Number(e>1)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ak:{name:"Akan",numbers:[1,2],plurals:function(e){return Number(e>1)}},am:{name:"Amharic",numbers:[1,2],plurals:function(e){return Number(e>1)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&10>=e%100?3:e%100>=11?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ay:{name:"Aymar",numbers:[1],plurals:function(e){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(e){return Number(1!=e)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},bo:{name:"Tibetan",numbers:[1],plurals:function(e){return 0}},br:{name:"Breton",numbers:[1,2],plurals:function(e){return Number(e>1)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},cgg:{name:"Chiga",numbers:[1],plurals:function(e){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},de:{name:"German",numbers:[1,2],plurals:function(e){return Number(1!=e)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(e){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(e){return Number(1!=e)}},en:{name:"English",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es:{name:"Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},et:{name:"Estonian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},eu:{name:"Basque",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fa:{name:"Persian",numbers:[1],plurals:function(e){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(e){return Number(e>1)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fr:{name:"French",numbers:[1,2],plurals:function(e){return Number(e>1)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(e){return Number(1==e?0:2==e?1:7>e?2:11>e?3:4)}},gd:{name:"Scottish Gaelic",numbers:[1,2,3,20],plurals:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&20>e?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(e){return Number(1!=e)}},gun:{name:"Gun",numbers:[1,2],plurals:function(e){return Number(e>1)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(e){return Number(1!=e)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(e){return Number(1!=e)}},id:{name:"Indonesian",numbers:[1],plurals:function(e){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(e){return Number(e%10!=1||e%100==11)}},it:{name:"Italian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ja:{name:"Japanese",numbers:[1],plurals:function(e){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(e){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(e){return Number(0!==e)}},ka:{name:"Georgian",numbers:[1],plurals:function(e){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(e){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(e){return 0}},kn:{name:"Kannada",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ko:{name:"Korean",numbers:[1],plurals:function(e){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(e){return Number(1==e?0:2==e?1:3==e?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(e){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(e){return Number(e>1)}},lo:{name:"Lao",numbers:[1],plurals:function(e){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(10>e%100||e%100>=20)?1:2)}},lv:{name:"Latvian",numbers:[0,1,2],plurals:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(e){return Number(e>1)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(e){return Number(e>1)}},mi:{name:"Maori",numbers:[1,2],plurals:function(e){return Number(e>1)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(e){return Number(1==e||e%10==1?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(e){return Number(0===e?0:1==e?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ms:{name:"Malay",numbers:[1],plurals:function(e){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(e){return Number(1==e?0:0===e||e%100>1&&11>e%100?1:e%100>10&&20>e%100?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nl:{name:"Dutch",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(e){return Number(1!=e)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(e){return Number(1!=e)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(e){return Number(e>1)}},or:{name:"Oriya",numbers:[2,1],plurals:function(e){return Number(1!=e)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(e){return Number(1!=e)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(e){return Number(1==e?0:0===e||e%100>0&&20>e%100?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(e){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(e){return Number(1!=e)}},se:{name:"Northern Sami",numbers:[1,2],plurals:function(e){return Number(1!=e)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(e){return Number(1!=e)}},son:{name:"Songhay",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sq:{name:"Albanian",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(e){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(e){return Number(1!=e)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(e){return Number(1!=e)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(e){return Number(1!=e)}},te:{name:"Telugu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(e){return Number(e>1)}},th:{name:"Thai",numbers:[1],plurals:function(e){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(e){return Number(e>1)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(e){return Number(1!=e)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(e){return Number(e>1)}},tt:{name:"Tatar",numbers:[1],plurals:function(e){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(e){return 0}},uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(e){return Number(1!=e)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(e){return Number(e>1)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(e){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(e){return Number(e>1)}},wo:{name:"Wolof",numbers:[1],plurals:function(e){return 0}},yo:{name:"Yoruba",numbers:[1,2],plurals:function(e){return Number(1!=e)}},zh:{name:"Chinese",numbers:[1],plurals:function(e){return 0}}}},function(e,t){"use strict";var n=[.1,.82,.25,1],r=[.69,0,.79,.14],i=[.84,.07,.93,.46];Velocity.RegisterEffect("attach.Down",{defaultDuration:300,calls:[[{opacity:[1,0],translateY:["0%","-100%"],scaleX:[1,.3],scaleY:[1,.3]},1,{easing:[300,22]}]]}),Velocity.RegisterEffect("attach.Up",{defaultDuration:200,easing:r,calls:[[{opacity:[0,1],translateY:["-150%","0%"],scaleX:[.3,1],scaleY:[.3,1]},1,{easing:[.33,0,.39,.91]}]]}),Velocity.RegisterEffect("dropdown.Down",{defaultDuration:200,easing:n,calls:[[{opacity:[1,0],translateY:["0%","-15px"]},1,{easing:n}]]});var o={pop:{duration:200,easing:i,enter:{props:{scaleX:[1,.5],scaleY:[1,.5],opacity:[1,0]}},leave:{props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]}}},slide:{duration:200,eaing:n,enter:{props:"slideDown"},leave:{props:"slideUp"}},scaleY:{duration:200,easing:n,enter:{props:{scaleY:[1,0],transformOrigin:"center"}},leave:{props:{scaleY:[0,1],transformOrigin:"center"}}},scale:{duration:500,easing:n,enter:{props:{scaleX:[1,0],scaleY:[1,0]}},leave:{props:{scaleX:[0,1],scaleY:[0,1]}}},fade:{duration:200,easing:n,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"fade-fast":{easing:"ease",enter:{props:{opacity:[1,0]},duration:150},leave:{props:{opacity:[0,1]},duration:100}},fade_sifo:{enter:{props:{opacity:[1,0]},duration:250},leave:{props:{opacity:[0,1]},duration:100}},capture:{enter:{props:{opacity:[1,0]},duration:350},leave:[{selector:".snapshot",props:"transition.bounceDownOut",duration:700},{selector:".webcam",props:{opacity:[0,1]},duration:100,easing:"ease"}]},butterbar:{enter:{props:"slideDown",easing:n,duration:700},leave:{props:"slideUp",easing:r,duration:350}},modal:{enter:[{props:{opacity:[1,0]},duration:300,easing:"easeOut"},{selector:".popup",props:{scaleX:[1,0],scaleY:[1,0],opacity:[1,1]},easing:[.19,.73,.28,1],delay:180,duration:200},{selector:".popup",props:{opacity:[0,0]},duration:180}],leave:[{props:{opacity:[0,1]},duration:300,easing:r,delay:100},{selector:".popup",props:{scaleX:[0,1],scaleY:[0,1]},easing:r,duration:200}]},"modal-flow":{enter:[{selector:".backdrop",props:{opacity:[1,0]},duration:300,easing:"easeOut"},{selector:".popup",props:{scaleX:[1,0],scaleY:[1,0],opacity:[1,1]},easing:[.19,.73,.28,1],delay:180,duration:200},{selector:".popup",props:{opacity:[0,0]},duration:180}],leave:[{selector:".backdrop",props:{opacity:[0,1]},duration:300,easing:r,delay:100},{selector:".popup",props:{scaleX:[0,1],scaleY:[0,1]},easing:r,duration:200}]},"flow-transition-modal-push":{duration:300,easing:n,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"flow-transition-modal-pop":{duration:300,easing:n,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"flow-transition-drawer-push":{duration:300,easing:n,enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"flow-transition-drawer-pop":{duration:300,easing:n,enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["100%","0%"]}}},"drawer-left":{enter:[{props:{translateX:["0%","-100%"]},duration:300,easing:n},{selector:".drawer-title",props:{translateX:[0,-50],opacity:[1,0]},duration:500,easing:"easeOut"}],leave:[{props:{translateX:["-100%","0%"]},duration:300,easing:r}]},"drawer-left-rtl":{enter:[{props:{translateX:["0%","100%"]},duration:300,easing:n},{selector:".drawer-title",props:{translateX:[0,50],opacity:[1,0]},duration:500,easing:"easeOut"}],leave:[{props:{translateX:["100%","0%"]},duration:300,easing:r}]},dropdown:{duration:300,easing:n,enter:[{selector:".menu-item",props:"dropdown.Down",delay:50,duration:375,stagger:25,drag:!0},{props:{scale:[1,0]}},{props:{opacity:[1,0]},duration:100}],leave:{props:{scaleX:[0,1],scaleY:[0,1],opacity:[0,1]}}},"dropdown-picker":{duration:300,easing:n,enter:[{selector:".menu-item",props:{opacity:[1,0]},delay:50,duration:200},{selector:".nib",props:{opacity:[1,0],rotateZ:["45deg"],translateY:["0%","-100%"]}},{props:{scale:[1,0]}},{props:{opacity:[1,0]},duration:100}],leave:[{selector:".menu-item",props:{opacity:[1,0]},duration:100},{selector:".nib",props:{opacity:[1,0]},duration:150},{props:{scaleX:[0,1],scaleY:[0,1],opacity:[0,1]}}]},"profile-viewer":{duration:500,easing:[.1,1.03,.28,.99],leave:[{delay:400,props:{opacity:[0,1]}},{selector:".profile-viewer",props:{borderRadius:["50%","0%"]}}]},"media-viewer":{duration:300,easing:[.1,1.03,.28,.99],leave:{selector:".media-viewer",props:{opacity:[0,1]}}},menu:{enter:{selector:".menu-icons-item",props:"attach.Down",duration:700,stagger:30,drag:!0},leave:{selector:".menu-icons-item",props:"attach.Up",stagger:30}},emoji:{duration:300,easing:n,enter:{props:{height:[234,0]}},leave:{props:{height:[0,234]}}},ptt:{enter:[{selector:".btn-border",easing:"easeInOut",props:{scaleX:[1,.5],scaleY:[1,.5],opacity:[1,0]},duration:250,delay:100},{selector:".ptt-counter",easing:"easeInOut",props:{scaleX:[1,.8],scaleY:[1,.8],opacity:[1,0]},duration:250,delay:100},{props:{opacity:[1,0]},duration:150,easing:n}],leave:[{selector:".btn-border",easing:n,props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:250},{selector:".ptt-counter",easing:n,props:{scaleX:[.5,1],scaleY:[.5,1],opacity:[0,1]},duration:250},{props:{opacity:[0,1]},duration:300,easing:n}]},"slide-left":{duration:300,easing:n,enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["100%","0%"]}}},"slide-left-rtl":{duration:300,easing:n,enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"slide-forward":{duration:200,easing:[.19,.93,.18,.99],enter:{props:{translateX:["0%","100%"]}},leave:{props:{translateX:["-100%","0%"]}}},"slide-back":{duration:200,easing:[.19,.93,.18,.99],enter:{props:{translateX:["0%","-100%"]}},leave:{props:{translateX:["100%","0%"]}}},"media-slide-forward":{duration:200,easing:[.19,.93,.18,.99],enter:[{selector:".media-element-container",props:{translateX:["0%","100%"]}},{selector:".media-caption",props:{opacity:["1","0"],translateX:["0%","100%"]}}],leave:[{selector:".media-element-container",props:{translateX:["-100%","0%"]}},{selector:".media-caption",props:{opacity:["0","1"],translateX:["-100%","0%"]}}]},"media-slide-back":{duration:200,easing:[.19,.93,.18,.99],enter:[{selector:".media-element-container",props:{translateX:["0%","-100%"]}},{selector:".media-caption",props:{opacity:["1","0"],translateX:["0%","-100%"]}}],leave:[{selector:".media-element-container",props:{translateX:["100%","0%"]}},{selector:".media-caption",props:{opacity:["0","1"],translateX:["100%","0%"]}}]},"pop-fast":{duration:75,easing:[.14,.62,.33,.9],enter:{props:{width:["20px","5px"],opacity:[1,.5]}},leave:{props:{width:["5px","20px"],opacity:[0,1]}}},"toast-transition":{duration:300,easing:n,
cleanOnComplete:!0,enter:{props:{translateY:["0%","100%"],opacity:[1,0]}},leave:{props:{opacity:[0,1]}}},"slide-up-down":{duration:300,easing:n,enter:{props:{translateY:["0%","100%"]}},leave:{props:{translateY:["100%","0%"]}}},"slide-up":{duration:300,easing:n,enter:{props:{translateY:["0%","100%"]}},leave:{props:{translateY:["100%","0%"]}}},"slide-down":{duration:300,easing:n,enter:{props:{translateY:["0%","100%"]}},leave:{props:{translateY:["100%","0%"]}}},none:{},btn:{duration:300,easing:n,enter:{props:{scale:[1,0],opacity:[1,0]}},leave:{props:{scale:[0,1],opacity:[0,1]}}},pop_delay:{duration:300,enter:[{props:"transition.expandIn",delay:500,easing:n},{props:{opacity:[0,0]},duration:500}],leave:{props:"transition.expandOut",easing:r}},"delay-leave":{duration:1,enter:{props:{opacity:[1,1]}},leave:{props:{opacity:[1,1]},delay:300}},"media-caption":{enter:[{props:{opacity:[0,0],translateY:["100%","100%"]},duration:200},{props:{opacity:[1,0],translateY:["0%","100%"]},easing:n,delay:200,duration:300}],leave:{props:{opacity:[0,1]},easing:"ease",duration:300}},"media-scale":{enter:[{selector:".media-caption",props:{opacity:[0,0],translateY:["100%","100%"]},duration:200},{selector:".media-caption",props:{opacity:[1,0],translateY:["0%","100%"]},easing:n,delay:200,duration:300},{selector:".media-element-container",props:{opacity:[0,0]},duration:200},{selector:".media-element-container",props:{opacity:[1,0],scale:[1,.625],display:"flex"},delay:200,duration:300,easing:n}],leave:[{selector:".media-caption",props:{opacity:[0,1]},easing:"ease",duration:300},{selector:".media-element-container",props:{opacity:[0,1],scale:[.5,1],display:"flex"},delay:0,duration:200,easing:r}]},"thumb-scale":{duration:400,easing:n,enter:{props:"transition.expandIn"},leave:{props:"transition.expandOut"}},"default":{duration:300,enter:{props:{opacity:[1,0]}},leave:{props:{opacity:[0,1]}}}};e.exports=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return function(t){return"number"==typeof t.status&&t.status>=500?t:void e(t)}}function o(e,t){return function(n){if("object"===("undefined"==typeof n?"undefined":(0,j["default"])(n))&&"number"==typeof n.status){if(401===n.status)throw new L.E401;if(n.status>=500)return n;t(n)}else e(n)}}function a(e,t){return["action",{type:e},t]}function s(e,t){return["query",e,t]}function u(e,t){return e.reduce(function(e,t){return e||t},!1)?void 0:t}function c(e){var t={};if("action"!==H.tag(e))return t;var n=H.attr("add",e),r=H.attr("missing",e),i=H.attr("checksum",e);switch(n){case"after":case"before":case"last":case"relay":case"update":t.add=n}switch(r){case"remove":t.missing=r}return i&&(t.checksum=i),t}function l(e){var t={};if(!_.isArray(e))return t;var n,r,i=e.length;for(r=0;i>r;r++)switch(n=e[r],H.tag(n)){case"broadcast":switch(H.attr("type",n)){case"create":case"add":case"remove":t.msg||(t.msg=[]),t.msg.push(n);break;case"modify":t.bcUpdate||(t.bcUpdate=[]),t.bcUpdate.push(n)}break;case"message":case"groups_v2":case"notification":t.msg||(t.msg=[]),t.msg.push(n);break;case"read":case"log":t.cmd||(t.cmd=[]),t.cmd.push(n);break;case"received":t.ack||(t.ack=[]),t.ack.push(n);break;case"user":t.contact||(t.contact=[]),t.contact.push(n);break;case"chat":switch(H.attr("type",n)){case"mute":t.mute||(t.mute=[]),t.mute.push(n);break;default:t.chat||(t.chat=[]),t.chat.push(n)}break;case"battery":t.battery||(t.battery=[]),t.battery.push(n);break;default:P.errorVerbose("Wap:groupActionsByType unknown action: "+H.toString(n),n)()}return t}function d(e,t){var n=parseInt(H.attr(t,e),10);return _.isNaN(n)?void 0:n}function f(e){if("chat"===H.tag(e)){var t=H.attr("jid",e),n=parseInt(H.attr("t",e),10)||void 0,r=H.attr("type",e),i=parseInt(H.attr("mute",e),10)||void 0,o=parseInt(H.attr("before",e),10)||void 0,a="true"===H.attr("archive",e),s="true"===H.attr("read_only",e),c=parseInt(H.attr("modify_tag",e),10)||void 0,l=H.attr("name",e)||void 0,f=d(e,"count"),p="true"===H.attr("message",e);"ahead"===r&&(r="clear");var h,g=H.children(e);if(_.isArray(g)){h=[];var m,v,b=g.length;for(m=0;b>m;m++)if(v=g[m],"item"===H.tag(v)){var y=H.attr("index",v);y&&h.push([y,"true"===H.attr("owner",v)])}}var w={id:t,t:n,type:r,keys:h,before:o,archive:a,isReadOnly:s,unreadCount:f,muteExpiration:i,modifyTag:c,name:l,pendingMsgs:p},E=[r&&"delete"!==r&&"clear"!==r&&"archive"!==r&&"unarchive"!==r&&"mute"!==r,!r&&!t,a&&r&&"clear"!==r,"clear"!==r&&o&&o>0,"clear"!==r&&h&&h.length>0];return u(E,w)}}function p(e){if("user"===H.tag(e)){var t=H.attr("jid",e),n=H.attr("name",e),r=H.attr("short",e)||void 0,i=H.attr("type",e)||"in",o={id:t,name:n,type:i,shortName:r},a=[!t,"in"!==i&&"out"!==i&&!!i];return u(a,o)}}function h(e){if("read"===H.tag(e)){var t=H.attr("jid",e),n={type:"read",jid:t},r=[!t];return u(r,n)}}function g(e){if("received"===H.tag(e)){var t,n=H.attr("type",e),r=H.attr("id",e),i=H.attr("to",e);switch(n){case"message":t=2;break;case"read":t=3;break;case"played":t=4;break;case"error":t=-1;break;case"pending":default:t=0}var o={cmd:"ack",id:r,ack:t,from:Store.Conn.me,to:i},a=[!r,!i,"message"!==n&&"read"!==n&&"played"!==n&&"error"!==n&&"pending"!==n];return u(a,o)}}function m(e){if("broadcast"===H.tag(e)&&"modify"===H.attr("type",e)){var t=H.attr("jid",e),n=H.children(e),r=[];if(_.isArray(n)){var i,o,a,s=n.length;for(i=0;s>i;i++)o=n[i],a=H.attr("jid",o),"recipient"===H.tag(o)&&a&&2===a.split("@").length&&"c.us"===a.split("@")[1]&&r.push({id:a})}var c={id:t,participants:r},l=[!t,"broadcast"!==t.split("@")[1],0===r.length];return u(l,c)}}function v(e){if("battery"===H.tag(e)){var t=Math.min(parseInt(H.attr("value",e),10)||-1,100),n=H.attr("live",e),r={battery:0>t?void 0:t,plugged:n?"true"===n:void 0},i=[0>t&&!n];return u(i,r)}}function b(e){return e.from===Store.Conn.me?e.to:e.from}function y(e,t){switch(H.tag(e)){case"message":return w(e,t);case"groups_v2":return S(e);case"broadcast":return C(e);case"notification":return k(e);default:return}}function w(e,t){if("message"===H.tag(e)){var n;H.attr("from",e)!==Store.Conn.me||H.attr("to",e)?H.attr("to",e)!==Store.Conn.me||H.attr("from",e)||(n="out"):n="in";var r,i=H.attr("id",e),o=parseInt(H.attr("t",e),10)||0,a=H.attr("to",e)||Store.Conn.me,s=H.attr("from",e)||Store.Conn.me,c="broadcast"===s.split("@")[1],l=H.attr("participant",e),d=c?l:s,f=c?void 0:l,p=c?!1:H.child("broadcast",e)&&s===Store.Conn.me,h="invis"===H.attr("web",e),g=H.attr("notify",e)||"",m=parseInt(H.attr("status",e))||0,v=[],b=H.child("broadcast",e);if("broadcast"!==a){switch(t){case"fresh":r=1;break;default:r=m>=-1&&4>=m?m:1}if(_.isArray(b)){var y,w=b.length;for(y=0;w>y;y++){var S=b[y],C=H.attr("jid",S);"to"===H.tag(S)&&C&&v.push(C)}}var k,T=[];switch(H.attr("type",e)){case"text":var $=H.dataStr(H.child("body",e))||"";k={id:i,body:$,type:"chat",t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,broadcast:p,recipients:v},T=[!i,!o,!d,!a];break;case"media":var O,A,R,I,N,j=H.child("media",e),L=H.attr("type",j),D=H.attr("media_key",j);if("retry"===H.attr("reason",j))return;switch(L){case"image":case"video":var M=H.attr("caption",j);O=E(j),A=H.attr("url",j),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,R=H.attr("filehash",j),I=parseInt(H.attr("size",j),10)||0,N=H.attr("seconds",j),k={id:i,body:O,type:L,t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,clientUrl:A,duration:N,broadcast:p,recipients:v,filehash:R,size:I,caption:M,mediaKey:D},T=[!i,!o,!d,!a];break;case"location":var x=H.attr("latitude",j),U=H.attr("longitude",j),B=H.attr("name",j);O=E(j),A=H.attr("url",j),k={id:i,body:O,type:L,t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,clientUrl:A,loc:B,lat:x,lng:U,broadcast:p,recipients:v},T=[!i,!o,!d,!a,!x||!U];break;case"audio":var F="live"===H.attr("origin",j)?"ptt":L;A=H.attr("url",j),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,R=H.attr("filehash",j),I=parseInt(H.attr("size",j),10)||0,N=H.attr("seconds",j),k={id:i,type:F,t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,clientUrl:A,duration:N,broadcast:p,recipients:v,filehash:R,size:I},T=[!i,!o,!d,!a];break;case"vcard":var Y=H.child("vcard",j),W=H.dataStr(Y),G=H.attr("name",Y);k={id:i,body:W,type:L,subtype:G,t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,broadcast:p,recipients:v},T=[!i,!o,!d,!a,!W,!G];break;default:P.error("wap:parseMsgMessage: unknown media type: "+H.toString(e),e)()}break;default:P.error("wap:parseMsgMessage: unknown message type: "+H.toString(e),e)()}return u(T,k)}}}function E(e){return"raw"===H.attr("encoding",e)?M.isByteBuffer(H.children(e))?H.children(e).toBase64():"":H.dataStr(e)}function S(e){if("groups_v2"===H.tag(e)){var t,n=parseInt(H.attr("t",e),10)||0,r=H.attr("id",e),i=H.attr("jid",e),o="invis"===H.attr("web",e),a=H.attr("type",e),s=H.attr("author",e),c=H.children(e),l=[];switch(a){case"create":t=H.attr("subject",e);break;case"subject":t=H.attr("subject",e);break;case"picture":t=H.attr("picture",e)}if(_.isArray(c)){var d,f=c.length;for(d=0;f>d;d++){var p=c[d],h=H.attr("jid",p);"participant"===H.tag(p)&&h&&l.push(h)}}var g=_.isString(s)?s.indexOf("s.whatsapp.net"):-1;g>-1&&(s=s.slice(0,g)+"c.us");var m={t:n,id:r,to:i,from:i,author:s,body:t?t.toString():void 0,type:"gp2",subtype:a,invis:o,recipients:l},v=[!r,!n,"subject"!==a&&"add"!==a&&"remove"!==a&&"leave"!==a&&"picture"!==a&&"modify"!==a&&"create"!==a&&"delete"!==a&&"promote"!==a&&"demote"!==a,"subject"===a&&!t,("add"===a||"remove"===a||"leave"===a||"promote"===a||"demote"===a||"modify"===a)&&0===l.length,!i,"string"==typeof i&&"g.us"!==i.split("@")[1]];return u(v,m)}}function C(e){if("broadcast"===H.tag(e)){var t,n=H.attr("type",e),r=H.attr("id",e),i=parseInt(H.attr("t",e),10)||0,o=H.attr("jid",e);switch(n){case"create":t=parseInt(H.attr("count",e),10)||0;break;case"add":case"remove":t=H.attr("participant",e)}var a={id:r,t:i,type:"broadcast_notification",subtype:n,from:o,to:o,body:t?t.toString():void 0},s=[!r,!i,!o,"string"==typeof o&&"broadcast"!==o.split("@")[1],"create"!==n&&"add"!==n&&"remove"!==n,("add"===n||"remove"===n)&&2!==t.split("@").length];return u(s,a)}}function k(e){if("notification"===H.tag(e)){var t=H.attr("id",e),n=parseInt(H.attr("t",e),10)||0,r=H.attr("jid",e),i="invis"===H.attr("web",e),o=H.dataStr(e),a="true"===H.attr("owner",e)?Store.Conn.me:r,s="true"===H.attr("owner",e)?r:Store.Conn.me,c={id:t,type:"notification",t:n,invis:i,from:a,to:s,body:o},l=[!t,!n,!r,2!==r.split("@").length];return u(l,c)}}var T=n(22),$=r(T),O=n(3),A=r(O),R=n(37),I=r(R),N=n(24),j=r(N),P=n(1),L=n(11),D=n(14),M=n(7),x=n(38),U=n(21),B=n(41),F=n(63),Y=n(60),W=new F("01"),G=new F("03"),q=W,H=W.Node,K={DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16},V=0,Q={"delete":_.noop,error2412:_.noop,setSubProtocol:function(e){1===e?(q=W,H=W.Node):(q=G,H=G.Node)},handle:function(e,t,n){var r,i,o,a,s,u,d,w,E=q.read(e);switch(H.tag(E)){case"response":if(0===n.indexOf("preempt"))switch(H.attr("type",E)){case"chat":if(P.logColor("green","bin-recv: "+n+",response,chat",E)(),i=H.children(E)||[],_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)d=f(i[o]),d&&r.push(d);Store.Chat.handle([{cmd:"preempt",response:r}],t)}break;case"contacts":if(P.logColor("green","bin-recv: "+n+",response,contact",E)(),i=H.children(E),_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)s=p(i[o]),s&&r.push(s);Store.Contact.handle([{cmd:"preempt",checksum:H.attr("checksum",E),response:r}],t)}break;default:P.error("Wap:handle unknown response type: "+H.toString(E,!0),E)()}else P.error("Wap:handle non-preemptive response: "+H.toString(E,!0),E)();break;case"action":var S=c(E),C=l(H.children(E)),k=(0,I["default"])(C);if(_.isArray(k)){var T,$,O,A,R=k.length;if(0===R&&"last"===S.add)Store.Msg.handle([{recent:!0}],t);else for(o=0;R>o;o++){$=k[o],T=C[$];var N,j=T.length;switch($){case"msg":var L;switch(S.add){case"relay":case"update":L=y(T[0],"relay"),1!==j&&P.error("Wap:handle action msg relay length not 1",E)(),L?(P.logColor("green","bin-recv: "+[n,"action","msg",S.add,L.type,L.from,L.to,L.id].join(","),E)(),A=b(L),Store.Msg.handle([{meta:{add:S.add},chat:A,msg:L}],t)):P.error("Wap:handle action msg relay dropped",T[0])();break;case"last":for(P.logColor("green","bin-recv: "+[n,"action","msg","last",T.length].join(","),E)(),O=[],N=0;j>N;N++)L=y(T[N],"last"),L?O.push(L):P.error("Wap:handle action msg last dropped",T[N])();if(O.length>0){for(var D={recent:!0},M=0;M<O.length;M++)D[b(O[M])]=O[M];Store.Msg.handle([D],t)}else P.error("Wap:handle action msg last dropped to 0")();break;case"before":case"after":if(j>0){for(O=[],N=0;j>N;N++)L=y(T[N],S.add),L?O.push(L):P.error("Wap:handle action msg before/after dropped",T[N])();P.logColor("green","bin-recv: "+[n,"action","msg",S.add,O.length].join(","),E)(),O.length>0?(A=b(O[0]),Store.Msg.handle([{meta:{add:S.add},chat:A,msgs:O}],t)):P.error("Wap:handle action msg before/after droppped to 0")()}else P.error("Wap:handle action msg before/after 0 msgs")();break;default:P.error("Wap:handle action msg no meta.add",E)()}break;case"cmd":for(N=0;j>N;N++){var x=h(T[N]);if(x){var U=_.values(x).join(",");P.logColor("green","bin-recv: "+[n,"action","cmd",U].join(","),E)(),Store.Cmd.handle([x],t)}else P.error("Wap:handle action cmd invalid",E)()}break;case"bcUpdate":var B=[];for(N=0;j>N;N++){var F=m(T[N]);F?B.push(F):P.error("Wap:handle action bc update invalid",T[N])()}P.logColor("green","bin-recv: "+[n,"action","bcUpdate",B.length].join(","),E)(),B.length>0&&Store.GroupMetadata.handle(B,t);break;case"ack":for(N=0;j>N;N++){var Y=g(T[N]);Y?(P.logColor("green","bin-recv: "+[n,"action","ack",Y.to,Y.id,Y.ack].join(","),E)(),Store.Msg.handle([Y],t)):P.error("Wap:handle action ack invalid",E)()}break;case"contact":for(u=[],N=0;j>N;N++)s=p(T[N]),s?u.push(s):P.error("Wap:handle action contact dropped",T[N])();if(P.logColor("green","bin-recv: "+[n,"action","contact",u.length,S.missing].join(","),E)(),u.length>0){var W=[u];(S.missing||S.checksum)&&W.push(S),Store.Contact.handle(W,t)}break;case"chat":for(w=[],N=0;j>N;N++)d=f(T[N]),d?w.push(d):P.error("Wap:handle action chat dropped",T[N])();P.logColor("green","bin-recv: "+[n,"action","chat",w.length].join(","),E)(),w.length>0&&Store.Chat.handle([w],t);break;case"battery":var G=v(T[0]);G?(P.logColor("green","bin-recv: "+[n,"action","battery",G.battery,G.plugged].join(","),E)(),Store.Conn.handle([G],t)):P.error("Wap:handle action battery dropped",T[0])();break;case"mute":for(w=[],N=0;j>N;N++)d=f(T[N]),d?w.push(d):P.error("Wap:handle action mute dropped",T[N])();P.logColor("green","bin-recv: "+[n,"action","mute",w.length].join(","),E)(),w.length>0&&Store.Mute.handle(w,t);break;default:P.error("Wap:handle action unknown "+$,E)()}}}break;default:P.errorVerbose("TODO "+H.toString(E,!0),E)()}return!0},requestDeviceUploadLogs:function(){var e;return new A["default"](function(t,n){if(V)return void t();e=++V;var r=a("debug",[["log",void 0,void 0]]),i=t;i.drop=!0,D.send({data:q.write(r),onSend:i,onDrop:n,binaryOpts:{debugString:"debug,log",debugObj:r,metric:K.DEBUG_LOG,ackRequest:!0}})})["finally"](function(){e===V&&(V=0)})},resyncMessages:function(e){return new x(function(t,n){var r=function(e){var n=[],r=q.read(e),i=H.children(r);if(P.logColor("green","bin-recv: response,resume",r)(),"response"===H.tag(r)&&"resume"===H.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=f(i[o]);s&&n.push(s)}}t({checksum:H.attr("checksum",r),data:n})},i=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,archive:(!!e.archive).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),U.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),["last",t,void 0]}),a=s({type:"resume"},i);D.sendEphemeral({data:q.write(a),onSend:o(r,t),onDrop:n,binaryOpts:{debugString:"query,resume",debugObj:a,metric:K.QUERY_RESUME,ackRequest:!1}})})},resyncReceipts:function(e){return new A["default"](function(t,n){var r=function(e){var n=[],r=q.read(e),i=H.children(r);if(P.logColor("green","bin-recv: response,receipt",r)(),"response"===H.tag(r)&&"receipt"===H.attr("type",r)&&_.isArray(i)){var o,a,s,u=i.length;for(o=0;u>o;o++){a=i[o],s=H.children(a);var c=H.attr("jid",a),l=H.attr("t",a);if("receipt"===H.tag(a)&&c&&l&&_.isArray(s)){var d,f=[],p=s.length;for(d=0;p>d;d++){var h=s[d];if("item"===H.tag(h)){var g=H.attr("index",h),m=parseInt(H.attr("status",h),10)||0;g&&0!==m&&4>=m&&f.push([g,!0,void 0,m])}}f.length>0&&n.push({id:c,t:parseInt(l,10),acks:f})}}}t(n)},i=e.map(function(e){return["last",{jid:e.remote,index:e.id,t:e.t.toString()},void 0]}),a=s({type:"receipt"},i);D.sendEphemeral({data:q.write(a),onSend:o(r,t),onDrop:n,binaryOpts:{debugString:"query,receipt",debugObj:a,metric:K.QUERY_RECEIPT,ackRequest:!1}})})},addParticipant:function(e,t){return new A["default"](function(n,r){var o=D.tag(),s=i(n);s.tag=o;var u=["participant",{jid:t},void 0],c=["group",{id:o,jid:e,type:"add",author:Store.Conn.me},[u]],l=a("set",[c]);D.send({data:q.write(l),onSend:s,onDrop:r,binaryOpts:{debugString:"action,group,add_participant",debugObj:l,metric:K.GROUP,ackRequest:!1}})})},changeSubject:function(e,t){return new A["default"](function(n,r){var o=D.tag(),s=i(n);s.tag=o;var u=["group",{id:o,jid:e,type:"subject",author:Store.Conn.me,subject:t},void 0],c=a("set",[u]);D.send({data:q.write(c),onSend:s,onDrop:r,binaryOpts:{debugString:"action,group,subject",debugObj:c,metric:K.GROUP,ackRequest:!1}})})},createGroup:function(e,t){return new A["default"](function(n,r){var o=D.tag(),s=i(n);s.tag=o;var u=t.map(function(e){return["participant",{jid:e},void 0]});P.log("create group tag",o)();var c=["group",{id:o,type:"create",author:Store.Conn.me,subject:e},u],l=a("set",[c]);D.send({data:q.write(l),onSend:s,onDrop:r,binaryOpts:{debugString:"action,group,create",debugObj:l,metric:K.GROUP,ackRequest:!1}})})},leaveGroup:function(e){return new A["default"](function(t,n){var r=D.tag(),o=i(t);o.tag=r;var s=["group",{id:r,jid:e,type:"leave",author:Store.Conn.me},void 0],u=a("set",[s]);D.send({data:q.write(u),onSend:o,onDrop:n,binaryOpts:{debugString:"action,group,delete",debugObj:u,metric:K.GROUP,ackRequest:!1}})})},removeParticipant:function(e,t){return new A["default"](function(n,r){var o=D.tag(),s=i(n);s.tag=o;var u=["participant",{jid:t},void 0],c=["group",{id:o,jid:e,type:"remove",author:Store.Conn.me},[u]],l=a("set",[c]);D.send({data:q.write(l),onSend:s,onDrop:r,binaryOpts:{debugString:"action,group,rem_participant",debugObj:l,metric:K.GROUP,ackRequest:!1}})})},requestMediaReupload:function(e){return new A["default"](function(t,n){var r=e.id,i=function(e){var n,r=q.read(e);if("response"===H.tag(r)&&"media"===H.attr("type",r)){var i=parseInt(H.attr("code",r))||400,o=H.attr("url",r);i>=500&&502!==i?(P.error("wap:requestMediaReupload:error "+i)(),n={status:i}):200===i&&o?n={status:200,url:o}:200!==i||o?(P.error("wap:requestMediaReupload:error "+i)(),n={status:i}):n={status:400}}else P.error("wap:requestMediaReupload:malformed")(),n={status:400};t(n)},a=r,u=s({type:"media",index:a.id,jid:a.remote,owner:a.fromMe.toString()},void 0);D.sendEphemeral({data:q.write(u),onSend:o(i,t),onDrop:n,binaryOpts:{debugString:"query,media",debugObj:u,metric:K.QUERY_MEDIA,ackRequest:!1}})})},sendConversationSeen:function(e,t,n){return new A["default"](function(r,i){var o=r,s=a("set",[["read",{jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,count:n&&t?n.toString():void 0},void 0]]);D.sendEphemeral({data:q.write(s),onSend:o,onDrop:i,binaryOpts:{debugString:"action,chat,read, "+(0,$["default"])(t)+", "+n,debugObj:s,metric:K.READ,ackRequest:!0}})})},sendConversationDelete:function(e){return new A["default"](function(t,n){var r=t,i=a("set",[["chat",{type:"delete",jid:e},void 0]]);D.send({data:q.write(i),onSend:r,onDrop:n,binaryOpts:{debugString:"action,chat,delete",debugObj:i,metric:K.CHAT,ackRequest:!0}})})},sendConversationArchive:function(e,t){return new A["default"](function(n,r){var i=n,o=t?"archive":"unarchive",s=a("set",[["chat",{type:o,jid:e},void 0]]);D.send({data:q.write(s),onSend:i,onDrop:r,binaryOpts:{debugString:"action,chat, "+o,debugObj:s,metric:K.CHAT,ackRequest:!0}})})},sendConversationMute:function(e,t){return new A["default"](function(n,r){var i=n,o=t?t.toString():void 0,s=a("set",[["chat",{type:"mute",mute:o,jid:e},void 0]]);D.send({data:q.write(s),onSend:i,onDrop:r,binaryOpts:{debugString:"action,chat, "+e+", "+(o?"mute, "+o:"unmute"),debugObj:s,metric:K.CHAT,ackRequest:!0}})})},sendMessagePlayed:function(e){return new A["default"](function(t,n){var r=t,i=e.remote,o=e.id,s=a("set",[["received",{type:"played",index:o,from:i},void 0]]);D.send({data:q.write(s),onSend:r,onDrop:n,binaryOpts:{debugString:"action,played, "+i+"_"+o,debugObj:s,metric:K.RECEIVED,ackRequest:!0}})})},profilePicFindThumbFromPhone:function(e,t){return new A["default"](function(n,r){var i=function(i){var o=q.read(i);("response"!==H.tag(o)||"preview"!==H.attr("type",o))&&r();var a=H.children(o),s=a&&a[0];if(s||r(),"missing"===H.attr("type",s))n({id:e,tag:void 0,raw:void 0});else{var u,c=H.attr("id",s);if(t&&c===t.tag&&t.raw)u=t.raw;else{var l=H.children(s);u=l?l.toBase64():void 0}n({id:e,tag:c,raw:u})}},a={type:"preview",jid:e};t&&t.tag&&(a.id=t.tag);var u=s(a,[]);D.sendEphemeral({data:q.write(u),onSend:o(i,n),onDrop:r,binaryOpts:{debugString:"query,thumb, "+e,debugObj:u,ackRequest:!1}})})},groupMetadataFindFromPhone:function(e,t){return new A["default"](function(t,n){var r=function(n){var r=q.read(n);if("response"!==H.tag(r)||"group"!==H.attr("type",r))return void t({status:"error",info:"bad format: response incorrect"});var i=H.children(r),o=i&&i[0];if(!o)return void t({status:"error",info:"bad format: no group node"});if("missing"===H.attr("type"))return void t({status:"missing"});var a=_.map(H.children(o),function(e){return{id:H.attr("jid",e),isAdmin:"admin"===H.attr("type",e)}});t({status:"ok",data:{id:e,owner:H.attr("creator",o),creation:parseInt(H.attr("create",o),10)||void 0,participants:a,stale:!1}})},i=s({type:"group",jid:e},[]);D.sendEphemeral({data:q.write(i),onSend:o(r,t),onDrop:n,binaryOpts:{debugString:"query,group, "+e,debugObj:i,ackRequest:!1}})})},sendPresenceUpdate:function(e){return["available","unavailable"].indexOf(e)>-1?new A["default"](function(t,n){var r=t,i=a("set",[["presence",{type:e},void 0]]),o={data:q.write(i),onSend:r,onDrop:n,binaryOpts:{debugString:"action,presence, "+e,debugObj:i,metric:K.PRESENCE,available:"available"===e,ackRequest:"available"===e}};"available"===e?D.sendEphemeral(o):D.sendEphemeralIgnore(o)}):void 0},sendChatstateUpdate:function(e,t){return["composing","paused","recording"].indexOf(e)>-1?new A["default"](function(n,r){var i=n,o=a("set",[["presence",{type:e,to:t},void 0]]);D.sendEphemeralIgnore({data:q.write(o),onSend:i,onDrop:r,binaryOpts:{debugString:"action,chatstate, "+e,debugObj:o,metric:K.PRESENCE,skipOffline:!0,ackRequest:!1}},!0)}):void 0},sendSetPicture:function(e,t,n){return new A["default"](function(r,o){var s=B.parseDataURL(t).data,u=B.parseDataURL(n).data,c=M.fromBase64(s,!1),l=M.fromBase64(u,!1),d=D.tag(),f=i(r);f.tag=d;var p=["picture",{id:d,jid:e,type:"set"},[["image",void 0,l],["preview",void 0,c]]],h=a("set",[p]);D.send({data:q.write(h),onSend:f,onDrop:o,binaryOpts:{debugString:"action,set_pic, "+e,debugObj:h,metric:K.PIC,ackRequest:!1}})})},deletePicture:function(e){return new A["default"](function(t,n){var r=D.tag(),o=i(t);o.tag=r;var s=["picture",{id:r,jid:e,type:"delete"},void 0],u=a("set",[s]);D.send({data:q.write(u),onSend:o,onDrop:n,binaryOpts:{debugString:"action,delete_pic, "+e,debugObj:u,metric:K.PIC,ackRequest:!1}})})},sendSetStatus:function(e){return new A["default"](function(t,n){var r=D.tag(),o=i(t);o.tag=r;var s=a("set",[["status",void 0,e]]);D.send({data:q.write(s),onSend:o,onDrop:n,binaryOpts:{debugString:"action,status,set",debugObj:s,metric:K.STATUS,ackRequest:!1}})})},chatFindQuery:function(e){return new A["default"](function(t,n){var r=function(e){var n=[],r=q.read(e),i=H.children(r);if("response"===H.tag(r)&&"chat"===H.attr("type",r))if("true"===H.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=f(i[o]);s&&n.push(s)}}t(n)},i=s({type:"chat",kind:e?"retry":void 0},void 0);D.sendEphemeral({data:q.write(i),onSend:o(r,t),onDrop:n,binaryOpts:{debugString:"query,chat, "+e,debugObj:i,metric:K.QUERY_CHAT,ackRequest:!1}})})},contactFindQuery:function(e){return new A["default"](function(t,n){var r=function(e){var n=[],r=q.read(e),i=H.children(r);if("response"===H.tag(r)&&"contacts"===H.attr("type",r))if("true"===H.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=p(i[o]);s&&n.push(s)}}t({checksum:H.attr("checksum",r),data:n})},i=s({type:"contacts",kind:e?"retry":void 0},void 0);D.send({data:q.write(i),onSend:o(r,t),onDrop:n,binaryOpts:{debugString:"query,contacts, "+e,debugObj:i,metric:K.QUERY_CONTACTS,ackRequest:!1}})})},msgCreateRecord:function(e,t){var n=this;return new A["default"](function(r,o){var s,u,c=e.id;if("chat"===e.type)u=A["default"].cast(["message",{type:"text",to:e.to,id:e.id,t:e.t.toString()},[["body",void 0,e.body]]]);else if("location"===e.type)s=e.body?M.fromBase64(e.body,!1):void 0,u=A["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"location",latitude:e.lat||void 0,longitude:e.lng||void 0,name:e.loc&&e.url?e.loc:void 0,url:e.loc&&e.url?e.url:void 0,encoding:e.body?"raw":void 0},s]]]);else if("vcard"===e.type){var l=["vcard",{name:e.subtype},e.body];u=A["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"vcard"},[l]]]])}else s=e.body?M.fromBase64(e.body,!1):void 0,u=(t?n.sendMedia(e.avparams):A["default"].resolve({status:200})).then(function(t){return 200===t.status?A["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{encoding:e.body?"raw":void 0,origin:"ptt"===e.type?"live":void 0,seconds:"ptt"===e.type&&e.duration?e.duration.toString():void 0,type:t.type,mimetype:e.mimetype||void 0,size:e.size?e.size.toString():void 0,filehash:t.filehash,url:t.url,duration:t.duration?t.duration.toString():void 0,vcodec:t.vcodec||void 0,width:t.width?t.width.toString():void 0,height:t.height?t.height.toString():void 0,fps:t.fps?t.fps.toString():void 0,vbitrate:t.vbitrate?t.vbitrate.toString():void 0,acodec:t.acodec||void 0,asampfreq:t.asampfreq?t.asampfreq.toString():void 0,asampfmt:t.asampfmt||void 0,abitrate:t.abitrate?t.abitrate.toString():void 0,caption:"video"!==e.type&&"image"!==e.type||!e.caption?void 0:e.caption},s]]]):(P.error("wap:msgCreateRecord:sendMedia error "+t.status)(),A["default"].reject())})["catch"](function(){return P.error("wap:msgCreateRecord:sendMedia dropped")(),A["default"].reject()});u.then(function(t){var n=a("relay",[t]),s=i(r);s.tag=c,s.meta={type:"message",key:new Y(e.from,e.to,e.id)},D.send({data:q.write(n),onSend:s,onDrop:o,binaryOpts:{debugString:"action,message, "+e.type,debugObj:n,metric:K.MESSAGE,ackRequest:!1}})})["catch"](function(){P.error("wap:msgCreateRecord mPromise error")(),o()})})},msgFindQuery:function(e,t){return"before"!==e?A["default"].reject("wap:msgFindQuery:unsupported:"+e):new A["default"](function(e,n){var r=function(t){var n=[],r=q.read(t),i=H.children(r);if("response"===H.tag(r)&&"message"===H.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=y(i[o],"response");s&&n.push(s)}}e(n)},i=s({type:"message",jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString()},void 0);D.sendEphemeral({data:q.write(i),onSend:o(r,e),onDrop:n,binaryOpts:{debugString:"query,message, "+t.remote+"_"+t.id+"_"+t.fromMe+"_"+t.count,debugObj:i,metric:K.QUERY_MESSAGES,ackRequest:!1}})})},presenceSubscribe:function(e){return new A["default"](function(t,n){var r=t,i=a("set",[["presence",{type:"subscribe",to:e},void 0]]);D.sendEphemeral({data:q.write(i),onSend:r,onDrop:n,binaryOpts:{debugString:"action,presence,subscribe, "+e,debugObj:i,metric:K.PRESENCE_SUBSCRIBE,ackRequest:!0}})})}};e.exports=Q},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return 0===z&&J++,e||z++,M.log("wap:epochCount: "+z+" epoch: "+J)(),J.toString()}function o(){z>0?z--:M.error("wap:epochRecv: NEGATIVE")(),M.log("wap:epochCount: "+z+" epoch: "+J)()}function a(e){return function(t){return t&&"number"==typeof t.status&&t.status>=500?t:(o(),void e(t))}}function s(e,t){return function(n){if("object"===("undefined"==typeof n?"undefined":(0,D["default"])(n))&&"number"==typeof n.status){if(401===n.status)throw o(),new x.E401;if(n.status>=500)return n;o(),t(n)}else o(),e(n)}}function u(e,t,n){return["action",{type:e,epoch:i(n)},t]}function c(e,t){return e.epoch=i(),["query",e,t]}function l(e,t){return e.reduce(function(e,t){return e||t},!1)?void 0:t}function d(e){var t={};if("action"!==V.tag(e))return t;var n=V.attr("add",e),r=V.attr("missing",e),i=V.attr("checksum",e);switch(n){case"after":case"before":case"last":case"relay":case"update":t.add=n}switch(r){case"remove":t.missing=r}return i&&(t.checksum=i),t}function f(e){var t={};if(!_.isArray(e))return t;var n,r,i=e.length;for(r=0;i>r;r++)switch(n=e[r],V.tag(n)){case"broadcast":switch(V.attr("type",n)){case"create":case"add":case"remove":t.msg||(t.msg=[]),t.msg.push(n);break;case"modify":t.bcUpdate||(t.bcUpdate=[]),t.bcUpdate.push(n)}break;case"message":case"groups_v2":case"notification":t.msg||(t.msg=[]),t.msg.push(n);break;case"read":case"log":t.cmd||(t.cmd=[]),t.cmd.push(n);break;case"received":t.ack||(t.ack=[]),t.ack.push(n);break;case"user":t.contact||(t.contact=[]),t.contact.push(n);break;case"chat":switch(V.attr("type",n)){case"mute":t.mute||(t.mute=[]),t.mute.push(n);break;default:t.chat||(t.chat=[]),t.chat.push(n)}break;case"battery":t.battery||(t.battery=[]),t.battery.push(n);break;default:M.errorVerbose("Wap:groupActionsByType unknown action: "+V.toString(n),n)()}return t}function p(e,t){var n=parseInt(V.attr(t,e),10);return _.isNaN(n)?void 0:n}function h(e){if("chat"===V.tag(e)){var t=V.attr("jid",e),n=parseInt(V.attr("t",e),10)||void 0,r=V.attr("type",e),i=parseInt(V.attr("mute",e),10)||void 0,o=parseInt(V.attr("before",e),10)||void 0,a="true"===V.attr("archive",e),s="true"===V.attr("read_only",e),u=parseInt(V.attr("modify_tag",e),10)||void 0,c=V.attr("name",e)||void 0,d=p(e,"count"),f="true"===V.attr("message",e);"ahead"===r&&(r="clear");var h,g=V.children(e);if(_.isArray(g)){h=[];var m,v,b=g.length;for(m=0;b>m;m++)if(v=g[m],"item"===V.tag(v)){var y=V.attr("index",v);y&&h.push([y,"true"===V.attr("owner",v)])}}var w={id:t,t:n,type:r,keys:h,before:o,archive:a,isReadOnly:s,unreadCount:d,muteExpiration:i,modifyTag:u,name:c,pendingMsgs:f},E=[r&&"delete"!==r&&"clear"!==r&&"archive"!==r&&"unarchive"!==r&&"mute"!==r,!r&&!t,a&&r&&"clear"!==r,"clear"!==r&&o&&o>0,"clear"!==r&&h&&h.length>0];return l(E,w)}}function g(e){if("user"===V.tag(e)){var t=V.attr("jid",e),n=V.attr("name",e),r=V.attr("short",e)||void 0,i=V.attr("type",e)||"in",o={id:t,name:n,type:i,shortName:r},a=[!t,"in"!==i&&"out"!==i&&!!i];return l(a,o)}}function m(e){if("read"===V.tag(e)){var t=V.attr("jid",e),n={type:"read",jid:t},r=[!t];return l(r,n)}}function v(e){if("received"===V.tag(e)){var t,n=V.attr("type",e),r=V.attr("id",e),i=V.attr("to",e);switch(n){case"message":t=2;break;case"read":t=3;break;case"played":t=4;break;case"error":t=-1;break;case"pending":default:t=0}var o={cmd:"ack",id:r,ack:t,from:Store.Conn.me,to:i},a=[!r,!i,"message"!==n&&"read"!==n&&"played"!==n&&"error"!==n&&"pending"!==n];return l(a,o)}}function b(e){if("broadcast"===V.tag(e)&&"modify"===V.attr("type",e)){var t=V.attr("jid",e),n=V.children(e),r=[];if(_.isArray(n)){var i,o,a,s=n.length;for(i=0;s>i;i++)o=n[i],a=V.attr("jid",o),"recipient"===V.tag(o)&&a&&2===a.split("@").length&&"c.us"===a.split("@")[1]&&r.push({
id:a})}var u={id:t,participants:r},c=[!t,"broadcast"!==t.split("@")[1],0===r.length];return l(c,u)}}function y(e){if("battery"===V.tag(e)){var t=Math.min(parseInt(V.attr("value",e),10)||-1,100),n=V.attr("live",e),r={battery:0>t?void 0:t,plugged:n?"true"===n:void 0},i=[0>t&&!n];return l(i,r)}}function w(e){return e.from===Store.Conn.me?e.to:e.from}function E(e,t){switch(V.tag(e)){case"message":return S(e,t);case"groups_v2":return k(e);case"broadcast":return T(e);case"notification":return $(e);default:return}}function S(e,t){if("message"===V.tag(e)){var n;V.attr("from",e)!==Store.Conn.me||V.attr("to",e)?V.attr("to",e)!==Store.Conn.me||V.attr("from",e)||(n="out"):n="in";var r,i=V.attr("id",e),o=parseInt(V.attr("t",e),10)||0,a=V.attr("to",e)||Store.Conn.me,s=V.attr("from",e)||Store.Conn.me,u="broadcast"===s.split("@")[1],c=V.attr("participant",e),d=u?c:s,f=u?void 0:c,p=u?!1:V.child("broadcast",e)&&s===Store.Conn.me,h="invis"===V.attr("web",e),g=V.attr("notify",e)||"",m=parseInt(V.attr("status",e))||0,v=[],b=V.child("broadcast",e);if("broadcast"!==a){switch(t){case"fresh":r=1;break;default:r=m>=-1&&4>=m?m:1}if(_.isArray(b)){var y,w=b.length;for(y=0;w>y;y++){var E=b[y],S=V.attr("jid",E);"to"===V.tag(E)&&S&&v.push(S)}}var k,T=[];switch(V.attr("type",e)){case"text":var $=V.dataStr(V.child("body",e))||"";k={id:i,body:$,type:"chat",t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,broadcast:p,recipients:v},T=[!i,!o,!d,!a];break;case"media":var O,A,R,I,N,j=V.child("media",e),P=V.attr("type",j),L=V.attr("media_key",j);if("retry"===V.attr("reason",j))return;switch(P){case"image":case"video":var D=V.attr("caption",j);O=C(j),A=V.attr("url",j),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,R=V.attr("filehash",j),I=parseInt(V.attr("size",j),10)||0,N=V.attr("seconds",j),k={id:i,body:O,type:P,t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,clientUrl:A,duration:N,broadcast:p,recipients:v,filehash:R,size:I,caption:D,mediaKey:L},T=[!i,!o,!d,!a];break;case"location":var x=V.attr("latitude",j),U=V.attr("longitude",j),B=V.attr("name",j);O=C(j),A=V.attr("url",j),k={id:i,body:O,type:P,t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,clientUrl:A,loc:B,lat:x,lng:U,broadcast:p,recipients:v},T=[!i,!o,!d,!a,!x||!U];break;case"audio":var F="live"===V.attr("origin",j)?"ptt":P;A=V.attr("url",j),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,R=V.attr("filehash",j),I=parseInt(V.attr("size",j),10)||0,N=V.attr("seconds",j),k={id:i,type:F,t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,clientUrl:A,duration:N,broadcast:p,recipients:v,filehash:R,size:I},T=[!i,!o,!d,!a];break;case"vcard":var Y=V.child("vcard",j),W=V.dataStr(Y),G=V.attr("name",Y);k={id:i,body:W,type:P,subtype:G,t:o,notifyName:g,from:d,to:a,self:n,author:f,invis:h,ack:r,broadcast:p,recipients:v},T=[!i,!o,!d,!a,!W,!G];break;default:M.error("wap:parseMsgMessage unknown media type: "+V.toString(e),e)()}break;default:M.error("wap:parseMsgMessage unknown message type: "+V.toString(e),e)()}return l(T,k)}}}function C(e){return"raw"===V.attr("encoding",e)?B.isByteBuffer(V.children(e))?V.children(e).toBase64():"":V.dataStr(e)}function k(e){if("groups_v2"===V.tag(e)){var t,n=parseInt(V.attr("t",e),10)||0,r=V.attr("id",e),i=V.attr("jid",e),o="invis"===V.attr("web",e),a=V.attr("type",e),s=V.attr("author",e),u=V.children(e),c=[];switch(a){case"create":t=V.attr("subject",e);break;case"subject":t=V.attr("subject",e);break;case"picture":t=V.attr("picture",e)}if(_.isArray(u)){var d,f=u.length;for(d=0;f>d;d++){var p=u[d],h=V.attr("jid",p);"participant"===V.tag(p)&&h&&c.push(h)}}var g={t:n,id:r,to:i,from:i,author:s,body:t?t.toString():void 0,type:"gp2",subtype:a,invis:o,recipients:c},m=[!r,!n,"subject"!==a&&"add"!==a&&"remove"!==a&&"leave"!==a&&"picture"!==a&&"modify"!==a&&"create"!==a&&"delete"!==a&&"promote"!==a&&"demote"!==a,"subject"===a&&!t,("add"===a||"remove"===a||"leave"===a||"promote"===a||"demote"===a||"modify"===a)&&0===c.length,!i,"string"==typeof i&&"g.us"!==i.split("@")[1]];return l(m,g)}}function T(e){if("broadcast"===V.tag(e)){var t,n=V.attr("type",e),r=V.attr("id",e),i=parseInt(V.attr("t",e),10)||0,o=V.attr("jid",e);switch(n){case"create":t=parseInt(V.attr("count",e),10)||0;break;case"add":case"remove":t=V.attr("participant",e)}var a={id:r,t:i,type:"broadcast_notification",subtype:n,from:o,to:o,body:t?t.toString():void 0},s=[!r,!i,!o,"string"==typeof o&&"broadcast"!==o.split("@")[1],"create"!==n&&"add"!==n&&"remove"!==n,("add"===n||"remove"===n)&&2!==t.split("@").length];return l(s,a)}}function $(e){if("notification"===V.tag(e)){var t=V.attr("id",e),n=parseInt(V.attr("t",e),10)||0,r=V.attr("jid",e),i="invis"===V.attr("web",e),o=V.dataStr(e),a="true"===V.attr("owner",e)?Store.Conn.me:r,s="true"===V.attr("owner",e)?r:Store.Conn.me,u={id:t,type:"notification",t:n,invis:i,from:a,to:s,body:o},c=[!t,!n,!r,2!==r.split("@").length];return l(c,u)}}function O(e,t,n){return new P["default"](function(r,i){var o=U.tag(),s=a(r),c=["participant",{jid:n},void 0],l=["group",{id:o,jid:t,type:e,author:Store.Conn.me},[c]],d=u("set",[l]);U.send({tag:o,data:K.write(d),clientCacheable:!0,onSend:s,onDrop:a(i),binaryOpts:{debugString:"action,group,participant,"+[e,t,n].join(","),debugObj:d,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})}var A=n(22),R=r(A),I=n(37),N=r(I),j=n(3),P=r(j),L=n(24),D=r(L),M=n(1),x=n(11),U=n(14),B=n(7),F=n(38),Y=n(21),W=n(41),G=n(63),q=n(60),H=new G("04"),K=H,V=H.Node,Q={DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20},z=0,J=0,X=0,Z={"delete":function(){z=0,J=0},error2412:function(){o()},setSubProtocol:function(e){4===e?(K=H,V=H.Node):(M.error("Wap:setSubProtocol unknown "+e)(),K=H,V=H.Node)},handle:function(e,t,n){var r,i,o,a,s,u,c,l,p=K.read(e);switch(V.tag(p)){case"response":if(0===n.indexOf("preempt"))switch(V.attr("type",p)){case"chat":if(M.logColor("green","bin-recv: "+n+",response,chat",p)(),i=V.children(p)||[],_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)c=h(i[o]),c&&r.push(c);Store.Chat.handle([{cmd:"preempt",response:r}],t)}break;case"contacts":if(M.logColor("green","bin-recv: "+n+",response,contact",p)(),i=V.children(p),_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)s=g(i[o]),s&&r.push(s);Store.Contact.handle([{cmd:"preempt",checksum:V.attr("checksum",p),response:r}],t)}break;default:M.error("Wap:handle unknown response type: "+V.toString(p,!0),p)()}else M.error("Wap:handle non-preemptive response: "+V.toString(p,!0),p)();break;case"action":var S=d(p),C=f(V.children(p)),k=(0,N["default"])(C);if(_.isArray(k)){var T,$,O,A,R=k.length;if(0===R&&"last"===S.add)Store.Msg.handle([{recent:!0}],t);else for(o=0;R>o;o++){$=k[o],T=C[$];var I,j=T.length;switch($){case"msg":var P;switch(S.add){case"relay":case"update":P=E(T[0],"relay"),1!==j&&M.error("Wap:handle action msg relay length not 1",p)(),P?(M.logColor("green","bin-recv: "+[n,"action","msg",S.add,P.type,P.from,P.to,P.id].join(","),p)(),A=w(P),Store.Msg.handle([{meta:{add:S.add},chat:A,msg:P}],t)):M.error("Wap:handle action msg relay dropped",T[0])();break;case"last":for(M.logColor("green","bin-recv: "+[n,"action","msg","last",T.length].join(","),p)(),O=[],I=0;j>I;I++)P=E(T[I],"last"),P?O.push(P):M.error("Wap:handle action msg last dropped",T[I])();if(O.length>0){for(var L={recent:!0},D=0;D<O.length;D++)L[w(O[D])]=O[D];Store.Msg.handle([L],t)}else M.error("Wap:handle action msg last dropped to 0")();break;case"before":case"after":if(j>0){for(O=[],I=0;j>I;I++)P=E(T[I],S.add),P?O.push(P):M.error("Wap:handle action msg before/after dropped",T[I])();M.logColor("green","bin-recv: "+[n,"action","msg",S.add,O.length].join(","),p)(),O.length>0?(A=w(O[0]),Store.Msg.handle([{meta:{add:S.add},chat:A,msgs:O}],t)):M.error("Wap:handle action msg before/after droppped to 0")()}else M.error("Wap:handle action msg before/after 0 msgs")();break;default:M.error("Wap:handle action msg no meta.add",p)()}break;case"cmd":for(I=0;j>I;I++){var x=m(T[I]);if(x){var U=_.values(x).join(",");M.logColor("green","bin-recv: "+[n,"action","cmd",U].join(","),p)(),Store.Cmd.handle([x],t)}else M.error("Wap:handle action cmd invalid",p)()}break;case"bcUpdate":var B=[];for(I=0;j>I;I++){var F=b(T[I]);F?B.push(F):M.error("Wap:handle action bc update invalid",T[I])()}M.logColor("green","bin-recv: "+[n,"action","bcUpdate",B.length].join(","),p)(),B.length>0&&Store.GroupMetadata.handle(B,t);break;case"ack":for(I=0;j>I;I++){var Y=v(T[I]);Y?(M.logColor("green","bin-recv: "+[n,"action","ack",Y.to,Y.id,Y.ack].join(","),p)(),Store.Msg.handle([Y],t)):M.error("Wap:handle action ack invalid",p)()}break;case"contact":for(u=[],I=0;j>I;I++)s=g(T[I]),s?u.push(s):M.error("Wap:handle action contact dropped",T[I])();if(M.logColor("green","bin-recv: "+[n,"action","contact",u.length,S.missing].join(","),p)(),u.length>0){var W=[u];(S.missing||S.checksum)&&W.push(S),Store.Contact.handle(W,t)}break;case"chat":for(l=[],I=0;j>I;I++)c=h(T[I]),c?l.push(c):M.error("Wap:handle action chat dropped",T[I])();M.logColor("green","bin-recv: "+[n,"action","chat",l.length].join(","),p)(),l.length>0&&Store.Chat.handle([l],t);break;case"battery":var G=y(T[0]);G?(M.logColor("green","bin-recv: "+[n,"action","battery",G.battery,G.plugged].join(","),p)(),Store.Conn.handle([G],t)):M.error("Wap:handle action battery dropped",T[0])();break;case"mute":for(l=[],I=0;j>I;I++)c=h(T[I]),c?l.push(c):M.error("Wap:handle action mute dropped",T[I])();M.logColor("green","bin-recv: "+[n,"action","mute",l.length].join(","),p)(),l.length>0&&Store.Mute.handle(l,t);break;default:M.error("Wap:handle action unknown "+$,p)()}}}break;default:M.errorVerbose("TODO "+V.toString(p,!0),p)()}return!0},requestDeviceUploadLogs:function(){var e;return new P["default"](function(t,n){if(X)return void t();e=++X;var r=u("debug",[["log",void 0,void 0]]),i=a(t);i.drop=!0,U.send({data:K.write(r),clientCacheable:!0,onSend:i,onDrop:n,binaryOpts:{debugString:"debug,log",debugObj:r,metric:Q.DEBUG_LOG,ackRequest:!0}})})["finally"](function(){e===X&&(X=0)})},resyncMessages:function(e){return new F(function(t,n){var r=function(e){var n=[],r=K.read(e),i=V.children(r);if(M.logColor("green","bin-recv: response,resume",r)(),"response"===V.tag(r)&&"resume"===V.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=h(i[o]);s&&n.push(s)}}t({checksum:V.attr("checksum",r),data:n})},i=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,archive:(!!e.archive).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),Y.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),["last",t,void 0]}),o=c({type:"resume"},i);U.sendEphemeral({data:K.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,resume",debugObj:o,metric:Q.QUERY_RESUME,ackRequest:!1}})})},resyncReceipts:function(e){return new P["default"](function(t,n){var r=function(e){var n=[],r=K.read(e),i=V.children(r);if(M.logColor("green","bin-recv: response,receipt",r)(),"response"===V.tag(r)&&"receipt"===V.attr("type",r)&&_.isArray(i)){var o,a,s,u=i.length;for(o=0;u>o;o++){a=i[o],s=V.children(a);var c=V.attr("jid",a),l=V.attr("t",a);if("receipt"===V.tag(a)&&c&&l&&_.isArray(s)){var d,f=[],p=s.length;for(d=0;p>d;d++){var h=s[d];if("item"===V.tag(h)){var g=V.attr("index",h),m=parseInt(V.attr("status",h),10)||0;g&&0!==m&&4>=m&&f.push([g,!0,void 0,m])}}f.length>0&&n.push({id:c,t:parseInt(l,10),acks:f})}}}t(n)},i=e.map(function(e){return["last",{jid:e.remote,index:e.id,t:e.t.toString()},void 0]}),o=c({type:"receipt"},i);U.sendEphemeral({data:K.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,receipt",debugObj:o,metric:Q.QUERY_RECEIPT,ackRequest:!1}})})},queryReceivedActions:function(e){return new P["default"](function(t,n){var r=function(e){var n=[],r=K.read(e),i=V.children(r);if(M.logColor("green","bin-recv: response,actions",r)(),"response"===V.tag(r)&&"action"===V.attr("type",r))if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=i[o],u=V.attr("id",s),c=parseInt(V.attr("code",s),10)||0;"item"===V.tag(s)&&u&&0!==c&&n.push({id:u,code:c})}}else"true"===V.attr("replaced",r)&&(n="replaced");t(n)},i=e.map(function(e){return["item",{id:e},void 0]}),o=c({type:"action"},i);U.sendEphemeral({data:K.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,actions",debugObj:o,metric:Q.QUERY_ACTIONS,ackRequest:!1}})})},changeSubject:function(e,t){return new P["default"](function(n,r){var i=U.tag(),o=a(n);o.tag=i;var s=["group",{id:i,jid:e,type:"subject",author:Store.Conn.me,subject:t},void 0],c=u("set",[s]);U.send({data:K.write(c),clientCacheable:!0,onSend:o,onDrop:a(r),binaryOpts:{debugString:"action,group,subject",debugObj:c,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},createGroup:function(e,t){return new P["default"](function(n,r){var i=U.tag(),o=a(n);o.tag=i;var s=t.map(function(e){return["participant",{jid:e},void 0]});M.log("create group tag",i)();var c=["group",{id:i,type:"create",author:Store.Conn.me,subject:e},s],l=u("set",[c]);U.send({data:K.write(l),clientCacheable:!0,onSend:o,onDrop:a(r),binaryOpts:{debugString:"action,group,create",debugObj:l,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},leaveGroup:function(e){return new P["default"](function(t,n){var r=U.tag(),i=a(t);i.tag=r;var o=["group",{id:r,jid:e,type:"leave",author:Store.Conn.me},void 0],s=u("set",[o]);U.send({data:K.write(s),clientCacheable:!0,onSend:i,onDrop:a(n),binaryOpts:{debugString:"action,group,delete",debugObj:s,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},addParticipant:function(e,t){return O("add",e,t)},removeParticipant:function(e,t){return O("remove",e,t)},promoteParticipant:function(e,t){return O("promote",e,t)},requestMediaReupload:function(e){return new P["default"](function(t,n){var r=e.id,i=function(e){var n,r=K.read(e);if("response"===V.tag(r)&&"media"===V.attr("type",r)){var i=parseInt(V.attr("code",r))||400,o=V.attr("url",r);i>=500&&502!==i?(M.error("wap:requestMediaReupload:error "+i)(),n={status:i}):200===i&&o?n={status:200,url:o}:200!==i||o?(M.error("wap:requestMediaReupload:error "+i)(),n={status:i}):n={status:400}}else M.error("wap:requestMediaReupload:malformed")(),n={status:400};t(n)},o=r,u=c({type:"media",index:o.id,jid:o.remote,owner:o.fromMe.toString()},void 0);U.sendEphemeral({data:K.write(u),onSend:s(i,t),onDrop:a(n),binaryOpts:{debugString:"query,media",debugObj:u,metric:Q.QUERY_MEDIA,ackRequest:!1}})})},sendConversationSeen:function(e,t,n){return new P["default"](function(r,i){var o=u("set",[["read",{jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,count:n&&t?n.toString():void 0},void 0]]);U.send({data:K.write(o),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,read,"+(0,R["default"])(t)+","+n,debugObj:o,metric:Q.READ,ackRequest:!0}})})},sendConversationDelete:function(e,t){return new P["default"](function(n,r){var i=u("set",[["chat",{type:"delete",jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0},void 0]]);U.send({data:K.write(i),clientCacheable:!0,onSend:a(n),onDrop:a(r),binaryOpts:{debugString:"action,chat,delete",debugObj:i,metric:Q.CHAT,ackRequest:!0}})})},sendConversationArchive:function(e,t,n){return new P["default"](function(r,i){var o=t?"archive":"unarchive",s=u("set",[["chat",{type:o,jid:e,index:n?n.id:void 0,owner:n?n.fromMe.toString():void 0},void 0]]);U.send({data:K.write(s),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,"+o,debugObj:s,metric:Q.CHAT,ackRequest:!0}})})},sendConversationMute:function(e,t,n){return new P["default"](function(r,i){var o=t?t.toString():void 0,s=n?n.toString():void 0,c=u("set",[["chat",{type:"mute",mute:o,previous:s,jid:e},void 0]]);U.send({data:K.write(c),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,"+e+", "+(o?"mute,"+o:"unmute"),debugObj:c,metric:Q.CHAT,ackRequest:!0}})})},sendMessagePlayed:function(e){return new P["default"](function(t,n){var r=a(t),i=e.remote,o=e.id,s=u("set",[["received",{type:"played",index:o,from:i},void 0]]);U.send({data:K.write(s),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,played,"+i+"_"+o,debugObj:s,metric:Q.RECEIVED,ackRequest:!0}})})},profilePicFindThumbFromPhone:function(e,t){return new P["default"](function(n,r){var i=function(i){var o=K.read(i);("response"!==V.tag(o)||"preview"!==V.attr("type",o))&&r();var a=V.children(o),s=a&&a[0];if(s||r(),"missing"===V.attr("type",s))n({id:e,tag:void 0,raw:void 0});else{var u,c=V.attr("id",s);if(t&&c===t.tag&&t.raw)u=t.raw;else{var l=V.children(s);u=l?l.toBase64():void 0}n({id:e,tag:c,raw:u})}},o={type:"preview",jid:e};t&&t.tag&&(o.id=t.tag);var u=c(o,[]);U.sendEphemeral({data:K.write(u),onSend:s(i,n),onDrop:a(r),binaryOpts:{debugString:"query,thumb,"+e,debugObj:u,metric:Q.QUERY_PREVIEW,ackRequest:!1}})})},groupMetadataFindFromPhone:function(e,t){return new P["default"](function(t,n){var r=function(n){var r=K.read(n);if("response"!==V.tag(r)||"group"!==V.attr("type",r))return void t({status:"error",info:"bad format: response incorrect"});var i=V.children(r),o=i&&i[0];if(!o)return void t({status:"error",info:"bad format: no group node"});if("missing"===V.attr("type"))return void t({status:"missing"});var a=_.map(V.children(o),function(e){return{id:V.attr("jid",e),isAdmin:"admin"===V.attr("type",e)}});t({status:"ok",data:{id:e,owner:V.attr("creator",o),creation:parseInt(V.attr("create",o),10)||void 0,participants:a,stale:!1}})},i=c({type:"group",jid:e},[]);U.sendEphemeral({data:K.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,group,"+e,debugObj:i,metric:Q.QUERY_GROUP,ackRequest:!1}})})},sendPresenceUpdate:function(e){return["available","unavailable"].indexOf(e)>-1?new P["default"](function(t,n){var r=a(t),i=u("set",[["presence",{type:e},void 0]]),o={data:K.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,presence,"+e,debugObj:i,metric:Q.PRESENCE,available:"available"===e,ackRequest:"available"===e}};"available"===e?U.sendEphemeral(o):U.sendEphemeralIgnore(o)}):void 0},sendChatstateUpdate:function(e,t){return["composing","paused","recording"].indexOf(e)>-1?new P["default"](function(n,r){var i=n,o=u("set",[["presence",{type:e,to:t},void 0]],!0);U.sendEphemeralIgnore({data:K.write(o),onSend:i,onDrop:r,binaryOpts:{debugString:"action,chatstate,"+e,debugObj:o,metric:Q.PRESENCE,skipOffline:!0,ackRequest:!1}},!0)}):void 0},sendSetPicture:function(e,t,n){return new P["default"](function(r,i){var o=W.parseDataURL(t).data,s=W.parseDataURL(n).data,c=B.fromBase64(o,!1),l=B.fromBase64(s,!1),d=U.tag(),f=a(r);f.tag=d;var p=["picture",{id:d,jid:e,type:"set"},[["image",void 0,l],["preview",void 0,c]]],h=u("set",[p]);U.send({data:K.write(h),clientCacheable:!0,onSend:f,onDrop:a(i),binaryOpts:{debugString:"action,set_pic,"+e,debugObj:h,metric:Q.PIC,ackRequest:!1,expires:moment().unix()}})})},deletePicture:function(e){return new P["default"](function(t,n){var r=U.tag(),i=a(t);i.tag=r;var o=["picture",{id:r,jid:e,type:"delete"},void 0],s=u("set",[o]);U.send({data:K.write(s),clientCacheable:!0,onSend:i,onDrop:a(n),binaryOpts:{debugString:"action,delete_pic,"+e,debugObj:s,metric:Q.PIC,ackRequest:!1,expires:moment().unix()}})})},sendSetStatus:function(e){return new P["default"](function(t,n){var r=a(t),i=u("set",[["status",void 0,e]]);U.send({data:K.write(i),clientCacheable:!0,onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,status,set",debugObj:i,metric:Q.STATUS,ackRequest:!1,expires:moment().unix()}})})},sendSetBlock:function(e,t){return new P["default"](function(n,r){var i=t.map(function(t){return["user",{jid:t.jid,reason:e&&t.spam?"spam":void 0},void 0]}),o=["block",{type:e?"add":"remove"},i],s=u("set",[o]);U.send({data:K.write(s),clientCacheable:!0,onSend:a(n),onDrop:a(r),binaryOpts:{debugString:"action,block,"+e+","+_.pluck(t,"jid").join(","),debugObj:s,metric:Q.BLOCK,ackRequest:!1,expires:moment().unix()}})})},chatFindQuery:function(e){return new P["default"](function(t,n){var r=function(e){var n=[],r=K.read(e),i=V.children(r);if("response"===V.tag(r)&&"chat"===V.attr("type",r))if("true"===V.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=h(i[o]);s&&n.push(s)}}t(n)},i=c({type:"chat",kind:e?"retry":void 0},void 0);U.sendEphemeral({data:K.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,chat,"+e,debugObj:i,metric:Q.QUERY_CHAT,ackRequest:!1}})})},contactFindQuery:function(e){return new P["default"](function(t,n){var r=function(e){var n=[],r=K.read(e),i=V.children(r);if("response"===V.tag(r)&&"contacts"===V.attr("type",r))if("true"===V.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=g(i[o]);s&&n.push(s)}}t({checksum:V.attr("checksum",r),data:n})},i=c({type:"contacts",kind:e?"retry":void 0},void 0);U.send({data:K.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,contacts, "+e,debugObj:i,metric:Q.QUERY_CONTACTS,ackRequest:!1}})})},msgCreateRecord:function(e,t){var n=this;return new P["default"](function(r,i){var o,s,c=e.id;if("chat"===e.type)s=P["default"].cast(["message",{type:"text",to:e.to,id:e.id,t:e.t.toString()},[["body",void 0,e.body]]]);else if("location"===e.type)o=e.body?B.fromBase64(e.body,!1):void 0,s=P["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"location",latitude:e.lat||void 0,longitude:e.lng||void 0,name:e.loc&&e.url?e.loc:void 0,url:e.loc&&e.url?e.url:void 0,encoding:e.body?"raw":void 0},o]]]);else if("vcard"===e.type){var l=["vcard",{name:e.subtype},e.body];s=P["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"vcard"},[l]]]])}else o=e.body?B.fromBase64(e.body,!1):void 0,s=(t?n.sendMedia(e.avparams):P["default"].resolve({status:200})).then(function(t){return 200===t.status?P["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{encoding:e.body?"raw":void 0,origin:"ptt"===e.type?"live":void 0,seconds:"ptt"===e.type&&e.duration?e.duration.toString():void 0,type:t.type,mimetype:e.mimetype||void 0,size:e.size?e.size.toString():void 0,filehash:t.filehash,url:t.url,duration:t.duration?t.duration.toString():void 0,vcodec:t.vcodec||void 0,width:t.width?t.width.toString():void 0,height:t.height?t.height.toString():void 0,fps:t.fps?t.fps.toString():void 0,vbitrate:t.vbitrate?t.vbitrate.toString():void 0,acodec:t.acodec||void 0,asampfreq:t.asampfreq?t.asampfreq.toString():void 0,asampfmt:t.asampfmt||void 0,abitrate:t.abitrate?t.abitrate.toString():void 0,caption:"video"!==e.type&&"image"!==e.type||!e.caption?void 0:e.caption},o]]]):(M.error("wap:msgCreateRecord:sendMedia error "+t.status)(),P["default"].reject())})["catch"](function(){return M.error("wap:msgCreateRecord:sendMedia dropped")(),P["default"].reject()});s.then(function(t){var n=u("relay",[t]),o=a(r);o.tag=c,o.meta={type:"message",key:new q(e.from,e.to,e.id)},U.send({data:K.write(n),onSend:o,onDrop:a(i),binaryOpts:{debugString:"action,message, "+e.type,debugObj:n,metric:Q.MESSAGE,ackRequest:!1}})})["catch"](function(){M.error("wap:msgCreateRecord mPromise error")(),i()})})},msgFindQuery:function(e,t){return"before"!==e?P["default"].reject("wap:msgFindQuery:unsupported:"+e):new P["default"](function(e,n){var r=function(t){var n=[],r=K.read(t),i=V.children(r);if("response"===V.tag(r)&&"message"===V.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=E(i[o],"response");s&&n.push(s)}}e(n)},i=c({type:"message",jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString()},void 0);U.sendEphemeral({data:K.write(i),onSend:s(r,e),onDrop:a(n),binaryOpts:{debugString:"query,message,"+t.remote+"_"+t.id+"_"+t.fromMe+"_"+t.count,debugObj:i,metric:Q.QUERY_MESSAGES,ackRequest:!1}})})},presenceSubscribe:function(e){return new P["default"](function(t,n){var r=a(t),i=u("set",[["presence",{type:"subscribe",to:e},void 0]]);U.sendEphemeral({data:K.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,presence,subscribe,"+e,debugObj:i,metric:Q.PRESENCE_SUBSCRIBE,ackRequest:!0}})})}};e.exports=Z},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return 0===X&&Z++,e||X++,x.log("wap:epochCount: "+X+" epoch: "+Z)(),Z.toString()}function o(){X>0?X--:x.error("wap:epochRecv: NEGATIVE")(),x.log("wap:epochCount: "+X+" epoch: "+Z)()}function a(e){return function(t){return t&&"number"==typeof t.status&&t.status>=500?t:(o(),void e(t))}}function s(e,t){return function(n){if("object"===("undefined"==typeof n?"undefined":(0,M["default"])(n))&&"number"==typeof n.status){if(401===n.status)throw o(),new U.E401;if(n.status>=500)return n;o(),t(n)}else o(),e(n)}}function u(e,t,n){return["action",{type:e,epoch:i(n)},t]}function c(e,t){return e.epoch=i(),["query",e,t]}function l(e,t){return e.reduce(function(e,t){return e||t},!1)?void 0:t}function d(e){var t={};if("action"!==z.tag(e))return t;var n=z.attr("add",e),r=z.attr("missing",e),i=z.attr("checksum",e);switch(n){case"after":case"before":case"last":case"relay":case"update":t.add=n}switch(r){case"remove":t.missing=r}return i&&(t.checksum=i),t}function f(e){var t={};if(!_.isArray(e))return t;var n,r,i=e.length;for(r=0;i>r;r++)switch(n=e[r],z.tag(n)){case"broadcast":switch(z.attr("type",n)){case"create":case"add":case"remove":t.msg||(t.msg=[]),t.msg.push(n);break;case"modify":t.bcUpdate||(t.bcUpdate=[]),t.bcUpdate.push(n)}break;case"message":case"groups_v2":case"notification":t.msg||(t.msg=[]),t.msg.push(n);break;case"read":case"log":t.cmd||(t.cmd=[]),t.cmd.push(n);break;case"received":t.ack||(t.ack=[]),t.ack.push(n);break;case"user":t.contact||(t.contact=[]),t.contact.push(n);break;case"chat":switch(z.attr("type",n)){case"mute":t.mute||(t.mute=[]),t.mute.push(n);break;default:t.chat||(t.chat=[]),t.chat.push(n)}break;case"battery":t.battery||(t.battery=[]),t.battery.push(n);break;default:x.errorVerbose("Wap:groupActionsByType unknown action: "+z.toString(n),n)()}return t}function p(e,t){var n=parseInt(z.attr(t,e),10);return _.isNaN(n)?void 0:n}function h(e){if("chat"===z.tag(e)){var t=z.attr("jid",e),n=parseInt(z.attr("t",e),10)||void 0,r=z.attr("type",e),i=parseInt(z.attr("mute",e),10)||void 0,o=parseInt(z.attr("before",e),10)||void 0,a="true"===z.attr("archive",e),s="true"===z.attr("read_only",e),u=parseInt(z.attr("modify_tag",e),10)||void 0,c=z.attr("name",e)||void 0,d=p(e,"count"),f="true"===z.attr("message",e);"ahead"===r&&(r="clear");var h,g=z.children(e);if(_.isArray(g)){h=[];var m,v,b=g.length;for(m=0;b>m;m++)if(v=g[m],"item"===z.tag(v)){var y=z.attr("index",v);y&&h.push([y,"true"===z.attr("owner",v),z.attr("participant",v)])}}var w={id:t,t:n,type:r,keys:h,before:o,archive:a,isReadOnly:s,unreadCount:d,muteExpiration:i,modifyTag:u,name:c,pendingMsgs:f},E=[r&&"delete"!==r&&"clear"!==r&&"archive"!==r&&"unarchive"!==r&&"mute"!==r,!r&&!t,a&&r&&"clear"!==r,"clear"!==r&&o&&o>0,"clear"!==r&&h&&h.length>0];return l(E,w)}}function g(e){if("user"===z.tag(e)){var t=z.attr("jid",e),n=z.attr("name",e),r=z.attr("short",e)||void 0,i=z.attr("type",e)||"in",o={id:t,name:n,type:i,shortName:r},a=[!t,"in"!==i&&"out"!==i&&!!i];return l(a,o)}}function m(e){if("read"===z.tag(e)){var t=z.attr("jid",e),n="false"===z.attr("type",e),r={type:n?"unread":"read",jid:t},i=[!t];return l(i,r)}}function v(e){if("received"===z.tag(e)){var t,n=z.attr("type",e),r=z.attr("id",e),i=z.attr("to",e);switch(n){case"message":t=2;break;case"read":t=3;break;case"played":t=4;break;case"error":t=-1;break;case"pending":default:t=0}var o={cmd:"ack",id:r,ack:t,from:Store.Conn.me,to:i},a=[!r,!i,"message"!==n&&"read"!==n&&"played"!==n&&"error"!==n&&"pending"!==n];return l(a,o)}}function b(e){if("broadcast"===z.tag(e)&&"modify"===z.attr("type",e)){var t=z.attr("jid",e),n=z.children(e),r=[];if(_.isArray(n)){var i,o,a,s=n.length;for(i=0;s>i;i++)o=n[i],a=z.attr("jid",o),"recipient"===z.tag(o)&&a&&2===a.split("@").length&&"c.us"===a.split("@")[1]&&r.push({id:a})}var u={id:t,participants:r},c=[!t,"broadcast"!==t.split("@")[1],0===r.length];return l(c,u)}}function y(e){if("battery"===z.tag(e)){var t=Math.min(parseInt(z.attr("value",e),10)||-1,100),n=z.attr("live",e),r={battery:0>t?void 0:t,plugged:n?"true"===n:void 0},i=[0>t&&!n];return l(i,r)}}function w(e){return e.from===Store.Conn.me?e.to:e.from}function E(e,t){switch(z.tag(e)){case"message":return S(e,t);case"groups_v2":return k(e);case"broadcast":return T(e);case"notification":return $(e);default:return}}function S(e,t){if("message"===z.tag(e)){var n;z.attr("from",e)!==Store.Conn.me||z.attr("to",e)?z.attr("to",e)!==Store.Conn.me||z.attr("from",e)||(n="out"):n="in";var r,i=z.attr("id",e),o=parseInt(z.attr("t",e),10)||0,a=z.attr("to",e)||Store.Conn.me,s=z.attr("from",e)||Store.Conn.me,u="broadcast"===s.split("@")[1],c=z.attr("participant",e),d=u?c:s,f=u?void 0:c,p=u?!1:z.child("broadcast",e)&&s===Store.Conn.me,h="invis"===z.attr("web",e),g=z.attr("notify",e)||"",m=parseInt(z.attr("status",e))||0,v=[],b=z.child("broadcast",e);if("broadcast"!==a){switch(t){case"fresh":r=1;break;default:r=m>=-1&&4>=m?m:1}if(_.isArray(b)){var y,w=b.length;for(y=0;w>y;y++){var E=b[y],S=z.attr("jid",E);"to"===z.tag(E)&&S&&v.push(S)}}var k,T=[];switch(z.attr("type",e)){case"text":var $=z.dataStr(z.child("body",e))||"";k={id:i,body:$,type:"chat",t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,broadcast:p,recipients:v},T=[!i,!o,!d,!a];break;case"media":var O,A,R,I,N,j=z.child("media",e),P=z.attr("type",j),L=z.attr("media_key",j);if("retry"===z.attr("reason",j))return;switch(P){case"image":case"video":var D=z.attr("caption",j);O=C(j),A=z.attr("url",j),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,R=z.attr("filehash",j),I=parseInt(z.attr("size",j),10)||0,N=z.attr("seconds",j),k={id:i,body:O,type:P,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:A,duration:N,broadcast:p,recipients:v,filehash:R,size:I,caption:D,mediaKey:L},T=[!i,!o,!d,!a];break;case"location":var M=z.attr("latitude",j),U=z.attr("longitude",j),B=z.attr("name",j);O=C(j),A=z.attr("url",j),k={id:i,body:O,type:P,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:A,loc:B,lat:M,lng:U,broadcast:p,recipients:v},T=[!i,!o,!d,!a,!M||!U];break;case"audio":var F="live"===z.attr("origin",j)?"ptt":P;A=z.attr("url",j),A=_.isString(A)&&A.indexOf("/u/")>0?void 0:A,R=z.attr("filehash",j),I=parseInt(z.attr("size",j),10)||0,N=z.attr("seconds",j),k={id:i,type:F,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:A,duration:N,broadcast:p,recipients:v,filehash:R,size:I},T=[!i,!o,!d,!a];break;case"vcard":var Y=z.child("vcard",j),W=z.dataStr(Y),G=z.attr("name",Y);k={id:i,body:W,type:P,subtype:G,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,broadcast:p,recipients:v},T=[!i,!o,!d,!a,!W,!G];break;default:x.error("wap:parseMsgMessage unknown media type: "+z.toString(e),e)()}break;default:x.error("wap:parseMsgMessage unknown message type: "+z.toString(e),e)()}return l(T,k)}}}function C(e){return"raw"===z.attr("encoding",e)?F.isByteBuffer(z.children(e))?z.children(e).toBase64():"":z.dataStr(e)}function k(e){if("groups_v2"===z.tag(e)){var t,n=parseInt(z.attr("t",e),10)||0,r=z.attr("id",e),i=z.attr("jid",e),o="invis"===z.attr("web",e),a="true"===z.attr("owner",e),s=z.attr("type",e),u=z.attr("author",e),c=z.children(e),d=z.attr("participant",e),f=[];switch(s){case"create":t=z.attr("subject",e);break;case"subject":t=z.attr("subject",e);break;case"picture":t=z.attr("picture",e)}if(_.isArray(c)){var p,h=c.length;for(p=0;h>p;p++){var g=c[p],m=z.attr("jid",g);"participant"===z.tag(g)&&m&&f.push(m)}}var v={t:n,id:r,to:a?i:Store.Conn.me,from:a?Store.Conn.me:i,author:u,participant:d,body:t?t.toString():void 0,
type:"gp2",subtype:s,invis:o,recipients:f},b=[!r,!n,"subject"!==s&&"add"!==s&&"remove"!==s&&"leave"!==s&&"picture"!==s&&"modify"!==s&&"create"!==s&&"delete"!==s&&"promote"!==s&&"demote"!==s,"subject"===s&&!t,("add"===s||"remove"===s||"leave"===s||"promote"===s||"demote"===s||"modify"===s)&&0===f.length,!i,"string"==typeof i&&"g.us"!==i.split("@")[1]];return l(b,v)}}function T(e){if("broadcast"===z.tag(e)){var t,n,r=z.attr("type",e),i=z.attr("id",e),o=parseInt(z.attr("t",e),10)||0,a=z.attr("jid",e),s="true"===z.attr("owner",e),u=z.attr("participant",e);switch(r){case"create":t=parseInt(z.attr("count",e),10)||0;break;case"add":case"remove":n=z.child("participant",e),n&&(t=z.attr("jid",n))}var c={id:i,t:o,participant:u,type:"broadcast_notification",subtype:r,from:s?Store.Conn.me:a,to:s?a:Store.Conn.me,body:t?t.toString():void 0},d=[!i,!o,!a,"string"==typeof a&&"broadcast"!==a.split("@")[1],"create"!==r&&"add"!==r&&"remove"!==r,("add"===r||"remove"===r)&&2!==t.split("@").length];return l(d,c)}}function $(e){if("notification"===z.tag(e)){var t=z.attr("id",e),n=parseInt(z.attr("t",e),10)||0,r=z.attr("jid",e),i=z.attr("participant",e),o="invis"===z.attr("web",e),a=z.dataStr(e),s="true"===z.attr("owner",e)?Store.Conn.me:r,u="true"===z.attr("owner",e)?r:Store.Conn.me,c={id:t,type:"notification",t:n,invis:o,from:s,to:u,participant:i,body:a},d=[!t,!n,!r,2!==r.split("@").length];return l(d,c)}}function O(e,t,n){return new L["default"](function(r,i){var o=B.tag(),s=a(r),c=["participant",{jid:n},void 0],l=["group",{id:o,jid:t,type:e,author:Store.Conn.me},[c]],d=u("set",[l]);B.send({tag:o,data:Q.write(d),clientCacheable:!0,onSend:s,onDrop:a(i),binaryOpts:{debugString:"action,group,participant,"+[e,t,n].join(","),debugObj:d,metric:J.GROUP,ackRequest:!1,expires:moment().unix()}})})}function A(e,t,n){return new L["default"](function(r,i){var o=u("set",[["chat",{type:e,jid:t,index:n?n.id:void 0,owner:n?n.fromMe.toString():void 0,participant:n?n.participant:void 0},void 0]]);B.send({data:Q.write(o),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,"+[e,(n||"no_msg_key").toString()].join(),debugObj:o,metric:J.CHAT,ackRequest:!0}})})}var R=n(22),I=r(R),N=n(37),j=r(N),P=n(3),L=r(P),D=n(24),M=r(D),x=n(1),U=n(11),B=n(14),F=n(7),Y=n(38),W=n(21),G=n(41),q=n(63),H=n(60),K=new q("05"),V=new q("06"),Q=K,z=K.Node,J={DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22},X=0,Z=0,ee=0,te={"delete":function(){X=0,Z=0},error2412:function(){o()},setSubProtocol:function(e){5===e?(Q=K,z=K.Node):6===e?(Q=V,z=V.Node):(x.error("Wap:setSubProtocol unknown "+e)(),Q=K,z=K.Node)},handle:function(e,t,n){var r,i,o,a,s,u,c,l,p=Q.read(e);switch(z.tag(p)){case"response":if(0===n.indexOf("preempt"))switch(z.attr("type",p)){case"chat":if(x.logColor("green","bin-recv: "+n+",response,chat",p)(),i=z.children(p)||[],_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)c=h(i[o]),c&&r.push(c);Store.Chat.handle([{cmd:"preempt",response:r}],t)}break;case"contacts":if(x.logColor("green","bin-recv: "+n+",response,contact",p)(),i=z.children(p),_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)s=g(i[o]),s&&r.push(s);Store.Contact.handle([{cmd:"preempt",checksum:z.attr("checksum",p),response:r}],t)}break;default:x.error("Wap:handle unknown response type: "+z.toString(p,!0),p)()}else x.error("Wap:handle non-preemptive response: "+z.toString(p,!0),p)();break;case"action":var S=d(p),C=f(z.children(p)),k=(0,j["default"])(C);if(_.isArray(k)){var T,$,O,A,R=k.length;if(0===R&&"last"===S.add)Store.Msg.handle([{recent:!0}],t);else for(o=0;R>o;o++){$=k[o],T=C[$];var I,N=T.length;switch($){case"msg":var P;switch(S.add){case"relay":case"update":P=E(T[0],"relay"),1!==N&&x.error("Wap:handle action msg relay length not 1",p)(),P?(x.logColor("green","bin-recv: "+[n,"action","msg",S.add,P.type,P.from,P.to,P.id].join(","),p)(),A=w(P),Store.Msg.handle([{meta:{add:S.add},chat:A,msg:P}],t)):x.error("Wap:handle action msg relay dropped",T[0])();break;case"last":for(x.logColor("green","bin-recv: "+[n,"action","msg","last",T.length].join(","),p)(),O=[],I=0;N>I;I++)P=E(T[I],"last"),P?O.push(P):x.error("Wap:handle action msg last dropped",T[I])();if(O.length>0){for(var L={recent:!0},D=0;D<O.length;D++)L[w(O[D])]=O[D];Store.Msg.handle([L],t)}else x.error("Wap:handle action msg last dropped to 0")();break;case"before":case"after":if(N>0){for(O=[],I=0;N>I;I++)P=E(T[I],S.add),P?O.push(P):x.error("Wap:handle action msg before/after dropped",T[I])();x.logColor("green","bin-recv: "+[n,"action","msg",S.add,O.length].join(","),p)(),O.length>0?(A=w(O[0]),Store.Msg.handle([{meta:{add:S.add},chat:A,msgs:O}],t)):x.error("Wap:handle action msg before/after droppped to 0")()}else x.error("Wap:handle action msg before/after 0 msgs")();break;default:x.error("Wap:handle action msg no meta.add",p)()}break;case"cmd":for(I=0;N>I;I++){var M=m(T[I]);if(M){var U=_.values(M).join(",");x.logColor("green","bin-recv: "+[n,"action","cmd",U].join(","),p)(),Store.Cmd.handle([M],t)}else x.error("Wap:handle action cmd invalid",p)()}break;case"bcUpdate":var B=[];for(I=0;N>I;I++){var F=b(T[I]);F?B.push(F):x.error("Wap:handle action bc update invalid",T[I])()}x.logColor("green","bin-recv: "+[n,"action","bcUpdate",B.length].join(","),p)(),B.length>0&&Store.GroupMetadata.handle(B,t);break;case"ack":for(I=0;N>I;I++){var Y=v(T[I]);Y?(x.logColor("green","bin-recv: "+[n,"action","ack",Y.to,Y.id,Y.ack].join(","),p)(),Store.Msg.handle([Y],t)):x.error("Wap:handle action ack invalid",p)()}break;case"contact":for(u=[],I=0;N>I;I++)s=g(T[I]),s?u.push(s):x.error("Wap:handle action contact dropped",T[I])();if(x.logColor("green","bin-recv: "+[n,"action","contact",u.length,S.missing].join(","),p)(),u.length>0){var W=[u];(S.missing||S.checksum)&&W.push(S),Store.Contact.handle(W,t)}break;case"chat":for(l=[],I=0;N>I;I++)c=h(T[I]),c?l.push(c):x.error("Wap:handle action chat dropped",T[I])();x.logColor("green","bin-recv: "+[n,"action","chat",l.length].join(","),p)(),l.length>0&&Store.Chat.handle([l],t);break;case"battery":var G=y(T[0]);G?(x.logColor("green","bin-recv: "+[n,"action","battery",G.battery,G.plugged].join(","),p)(),Store.Conn.handle([G],t)):x.error("Wap:handle action battery dropped",T[0])();break;case"mute":for(l=[],I=0;N>I;I++)c=h(T[I]),c?l.push(c):x.error("Wap:handle action mute dropped",T[I])();x.logColor("green","bin-recv: "+[n,"action","mute",l.length].join(","),p)(),l.length>0&&Store.Mute.handle(l,t);break;default:x.error("Wap:handle action unknown "+$,p)()}}}break;default:x.errorVerbose("TODO "+z.toString(p,!0),p)()}return!0},requestDeviceUploadLogs:function(){var e;return new L["default"](function(t,n){if(ee)return void t();e=++ee;var r=u("debug",[["log",void 0,void 0]]),i=a(t);i.drop=!0,B.send({data:Q.write(r),clientCacheable:!0,onSend:i,onDrop:n,binaryOpts:{debugString:"debug,log",debugObj:r,metric:J.DEBUG_LOG,ackRequest:!0}})})["finally"](function(){e===ee&&(ee=0)})},resyncMessages:function(e){return new Y(function(t,n){var r=function(e){var n=[],r=Q.read(e),i=z.children(r);if(x.logColor("green","bin-recv: response,resume",r)(),"response"===z.tag(r)&&"resume"===z.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=h(i[o]);s&&n.push(s)}}t({checksum:z.attr("checksum",r),data:n})},i=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,participant:e.participant,archive:(!!e.archive).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),W.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),["last",t,void 0]}),o=c({type:"resume"},i);B.sendEphemeral({data:Q.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,resume",debugObj:o,metric:J.QUERY_RESUME,ackRequest:!1}})})},resyncReceipts:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=Q.read(e),i=z.children(r);if(x.logColor("green","bin-recv: response,receipt",r)(),"response"===z.tag(r)&&"receipt"===z.attr("type",r)&&_.isArray(i)){var o,a,s,u=i.length;for(o=0;u>o;o++){a=i[o],s=z.children(a);var c=z.attr("jid",a),l=z.attr("t",a);if("receipt"===z.tag(a)&&c&&l&&_.isArray(s)){var d,f=[],p=s.length;for(d=0;p>d;d++){var h=s[d];if("item"===z.tag(h)){var g=z.attr("index",h),m="true"===z.attr("owner",h),v=parseInt(z.attr("status",h),10)||0,b=z.attr("participant",h);g&&0!==v&&4>=v&&f.push([g,m,b,v])}}f.length>0&&n.push({id:c,t:parseInt(l,10),acks:f})}}}t(n)},i=e.map(function(e){return["last",{jid:e.remote,index:e.id,owner:e.fromMe.toString(),participant:e.participant,t:e.t.toString()},void 0]}),o=c({type:"receipt"},i);B.sendEphemeral({data:Q.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,receipt",debugObj:o,metric:J.QUERY_RECEIPT,ackRequest:!1}})})},queryReceivedActions:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=Q.read(e),i=z.children(r);if(x.logColor("green","bin-recv: response,actions",r)(),"response"===z.tag(r)&&"action"===z.attr("type",r))if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=i[o],u=z.attr("id",s),c=parseInt(z.attr("code",s),10)||0;"item"===z.tag(s)&&u&&0!==c&&n.push({id:u,code:c})}}else"true"===z.attr("replaced",r)&&(n="replaced");t(n)},i=e.map(function(e){return["item",{id:e},void 0]}),o=c({type:"action"},i);B.sendEphemeral({data:Q.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,actions",debugObj:o,metric:J.QUERY_ACTIONS,ackRequest:!1}})})},recentEmojiQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=Q.read(e),i=z.children(r);if(x.logColor("green","bin-recv: response,emoji",r)(),"response"===z.tag(r)&&"emoji"===z.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=i[o],u=z.attr("code",s),c=parseFloat(z.attr("value",s))||0;"item"===z.tag(s)&&u&&c&&!isNaN(c)&&n.push({"char":u,weight:c})}}t(n)},i=_.isArray(e)?e.map(function(e){return["item",{code:e["char"],value:e.weight.toString()},void 0]}):void 0,o=c({type:"emoji"},i);B.sendEphemeral({data:Q.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,emoji",debugObj:o,metric:J.QUERY_EMOJI,ackRequest:!1}})})},queryMsgInfo:function(e){function t(e){var t,n,r=[];if(_.isArray(e)){t=e.length;for(var i=0;t>i;i++)n=e[i],"item"===z.tag(n)&&z.attr("jid",n)&&z.attr("t",n)&&r.push({id:z.attr("jid",n),t:parseInt(z.attr("t",n),10)||0})}return r}return new L["default"](function(n,r){var i=function(e){var r=Q.read(e),i={played:[],playedRemaining:0,read:[],readRemaining:0,delivery:[],deliveryRemaining:0};if(x.logColor("green","bin-recv: response,msg,info",r)(),"response"===z.tag(r)&&"message_info"===z.attr("type",r)){var o=z.child("played",r),a=z.child("read",r),s=z.child("delivery",r),u=z.children(o),c=z.children(a),l=z.children(s),d=parseInt(z.attr("count",r),10)||0;i.played=t(u),i.read=t(c),i.delivery=t(l);var f=d-i.played.length,p=d-i.played.length-i.read.length,h=d-i.played.length-i.read.length-i.delivery.length;i.playedRemaining=0>f?0:f,i.readRemaining=0>p?0:p,i.deliveryRemaining=0>h?0:h}n(i)},o=c({type:"message_info",index:e.id,jid:e.remote},void 0);B.sendEphemeral({data:Q.write(o),onSend:s(i,n),onDrop:a(r),binaryOpts:{debugString:["query,msg,info",e.id,e.remote,e.fromMe].join(),debugObj:o,metric:J.QUERY_MESSAGE_INFO,ackRequest:!1}})})},changeSubject:function(e,t){return new L["default"](function(n,r){var i=B.tag(),o=a(n);o.tag=i;var s=["group",{id:i,jid:e,type:"subject",author:Store.Conn.me,subject:t},void 0],c=u("set",[s]);B.send({data:Q.write(c),clientCacheable:!0,onSend:o,onDrop:a(r),binaryOpts:{debugString:"action,group,subject",debugObj:c,metric:J.GROUP,ackRequest:!1,expires:moment().unix()}})})},createGroup:function(e,t){return new L["default"](function(n,r){var i=B.tag(),o=a(n);o.tag=i;var s=t.map(function(e){return["participant",{jid:e},void 0]});x.log("create group tag",i)();var c=["group",{id:i,type:"create",author:Store.Conn.me,subject:e},s],l=u("set",[c]);B.send({data:Q.write(l),clientCacheable:!0,onSend:o,onDrop:a(r),binaryOpts:{debugString:"action,group,create",debugObj:l,metric:J.GROUP,ackRequest:!1,expires:moment().unix()}})})},leaveGroup:function(e){return new L["default"](function(t,n){var r=B.tag(),i=a(t);i.tag=r;var o=["group",{id:r,jid:e,type:"leave",author:Store.Conn.me},void 0],s=u("set",[o]);B.send({data:Q.write(s),clientCacheable:!0,onSend:i,onDrop:a(n),binaryOpts:{debugString:"action,group,delete",debugObj:s,metric:J.GROUP,ackRequest:!1,expires:moment().unix()}})})},addParticipant:function(e,t){return O("add",e,t)},removeParticipant:function(e,t){return O("remove",e,t)},promoteParticipant:function(e,t){return O("promote",e,t)},requestMediaReupload:function(e){return new L["default"](function(t,n){var r=e.id,i=function(e){var n,r=Q.read(e);if("response"===z.tag(r)&&"media"===z.attr("type",r)){var i=parseInt(z.attr("code",r))||400,o=z.attr("url",r);i>=500&&502!==i?(x.error("wap:requestMediaReupload:error "+i)(),n={status:i}):200===i&&o?n={status:200,url:o}:200!==i||o?(x.error("wap:requestMediaReupload:error "+i)(),n={status:i}):n={status:400}}else x.error("wap:requestMediaReupload:malformed")(),n={status:400};t(n)},o=r,u=c({type:"media",index:o.id,jid:o.remote,owner:o.fromMe.toString(),participant:o.participant},void 0);B.sendEphemeral({data:Q.write(u),onSend:s(i,t),onDrop:a(n),binaryOpts:{debugString:"query,media",debugObj:u,metric:J.QUERY_MEDIA,ackRequest:!1}})})},sendConversationSeen:function(e,t,n){return new L["default"](function(r,i){var o=u("set",[["read",{jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,participant:t?t.participant:void 0,count:n&&t?n.toString():void 0},void 0]]);B.send({data:Q.write(o),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,read,"+(0,I["default"])(t)+","+n,debugObj:o,metric:J.READ,ackRequest:!0}})})},sendConversationUnseen:function(e,t){return this.sendConversationSeen(e,t,-2)},sendConversationClear:function(e,t){return A("clear",e,t)},sendConversationDelete:function(e,t){return A("delete",e,t)},sendConversationArchive:function(e,t,n){return A(t?"archive":"unarchive",e,n)},sendConversationMute:function(e,t,n){return new L["default"](function(r,i){var o=t?t.toString():void 0,s=n?n.toString():void 0,c=u("set",[["chat",{type:"mute",mute:o,previous:s,jid:e},void 0]]);B.send({data:Q.write(c),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,"+e+", "+(o?"mute,"+o:"unmute"),debugObj:c,metric:J.CHAT,ackRequest:!0}})})},sendMessagePlayed:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["received",{type:"played",index:e.id,from:e.remote,participant:e.participant},void 0]]);B.send({data:Q.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,played,"+e.toString(),debugObj:i,metric:J.RECEIVED,ackRequest:!0}})})},sendMessageDelete:function(e,t,n){return new L["default"](function(r,i){var o=t.map(function(e){return["item",{index:e.id,owner:e.fromMe.toString(),participant:e.participant},void 0]}),s=u("set",[["chat",{type:"clear",jid:e,media:n.toString()},o]]);B.send({data:Q.write(s),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,msgs,delete,"+[e,n,t.length].join(),debugObj:s,metric:J.CHAT,ackRequest:!0}})})},profilePicFindThumbFromPhone:function(e,t){return new L["default"](function(n,r){var i=function(i){var o=Q.read(i);("response"!==z.tag(o)||"preview"!==z.attr("type",o))&&r();var a=z.children(o),s=a&&a[0];if(s||r(),"missing"===z.attr("type",s))n({id:e,tag:void 0,raw:void 0});else{var u,c=z.attr("id",s);if(t&&c===t.tag&&t.raw)u=t.raw;else{var l=z.children(s);u=l?l.toBase64():void 0}n({id:e,tag:c,raw:u})}},o={type:"preview",jid:e};t&&t.tag&&(o.id=t.tag);var u=c(o,[]);B.sendEphemeral({data:Q.write(u),onSend:s(i,n),onDrop:a(r),binaryOpts:{debugString:"query,thumb,"+e,debugObj:u,metric:J.QUERY_PREVIEW,ackRequest:!1}})})},groupMetadataFindFromPhone:function(e,t){return new L["default"](function(t,n){var r=function(n){var r=Q.read(n);if("response"!==z.tag(r)||"group"!==z.attr("type",r))return void t({status:"error",info:"bad format: response incorrect"});var i=z.children(r),o=i&&i[0];if(!o)return void t({status:"error",info:"bad format: no group node"});if("missing"===z.attr("type"))return void t({status:"missing"});var a=_.map(z.children(o),function(e){return{id:z.attr("jid",e),isAdmin:"admin"===z.attr("type",e)}});t({status:"ok",data:{id:e,owner:z.attr("creator",o),creation:parseInt(z.attr("create",o),10)||void 0,participants:a,stale:!1}})},i=c({type:"group",jid:e},[]);B.sendEphemeral({data:Q.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,group,"+e,debugObj:i,metric:J.QUERY_GROUP,ackRequest:!1}})})},sendPresenceUpdate:function(e){return["available","unavailable"].indexOf(e)>-1?new L["default"](function(t,n){var r=a(t),i=u("set",[["presence",{type:e},void 0]]),o={data:Q.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,presence,"+e,debugObj:i,metric:J.PRESENCE,available:"available"===e,ackRequest:"available"===e}};"available"===e?B.sendEphemeral(o):B.sendEphemeralIgnore(o)}):void 0},sendChatstateUpdate:function(e,t){return["composing","paused","recording"].indexOf(e)>-1?new L["default"](function(n,r){var i=n,o=u("set",[["presence",{type:e,to:t},void 0]],!0);B.sendEphemeralIgnore({data:Q.write(o),onSend:i,onDrop:r,binaryOpts:{debugString:"action,chatstate,"+e,debugObj:o,metric:J.PRESENCE,skipOffline:!0,ackRequest:!1}},!0)}):void 0},sendSetPicture:function(e,t,n){return new L["default"](function(r,i){var o=G.parseDataURL(t).data,s=G.parseDataURL(n).data,c=F.fromBase64(o,!1),l=F.fromBase64(s,!1),d=B.tag(),f=a(r);f.tag=d;var p=["picture",{id:d,jid:e,type:"set"},[["image",void 0,l],["preview",void 0,c]]],h=u("set",[p]);B.send({data:Q.write(h),clientCacheable:!0,onSend:f,onDrop:a(i),binaryOpts:{debugString:"action,set_pic,"+e,debugObj:h,metric:J.PIC,ackRequest:!1,expires:moment().unix()}})})},deletePicture:function(e){return new L["default"](function(t,n){var r=B.tag(),i=a(t);i.tag=r;var o=["picture",{id:r,jid:e,type:"delete"},void 0],s=u("set",[o]);B.send({data:Q.write(s),clientCacheable:!0,onSend:i,onDrop:a(n),binaryOpts:{debugString:"action,delete_pic,"+e,debugObj:s,metric:J.PIC,ackRequest:!1,expires:moment().unix()}})})},sendSetStatus:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["status",void 0,e]]);B.send({data:Q.write(i),clientCacheable:!0,onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,status,set",debugObj:i,metric:J.STATUS,ackRequest:!1,expires:moment().unix()}})})},sendSetBlock:function(e,t){return new L["default"](function(n,r){var i=t.map(function(t){return["user",{jid:t.jid,reason:e&&t.spam?"spam":void 0},void 0]}),o=["block",{type:e?"add":"remove"},i],s=u("set",[o]);B.send({data:Q.write(s),clientCacheable:!0,onSend:a(n),onDrop:a(r),binaryOpts:{debugString:"action,block,"+e+","+_.pluck(t,"jid").join(","),debugObj:s,metric:J.BLOCK,ackRequest:!1,expires:moment().unix()}})})},chatFindQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=Q.read(e),i=z.children(r);if("response"===z.tag(r)&&"chat"===z.attr("type",r))if("true"===z.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=h(i[o]);s&&n.push(s)}}t(n)},i=c({type:"chat",kind:e?"retry":void 0},void 0);B.sendEphemeral({data:Q.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,chat,"+e,debugObj:i,metric:J.QUERY_CHAT,ackRequest:!1}})})},contactFindQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=Q.read(e),i=z.children(r);if("response"===z.tag(r)&&"contacts"===z.attr("type",r))if("true"===z.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=g(i[o]);s&&n.push(s)}}t({checksum:z.attr("checksum",r),data:n})},i=c({type:"contacts",kind:e?"retry":void 0},void 0);B.send({data:Q.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,contacts, "+e,debugObj:i,metric:J.QUERY_CONTACTS,ackRequest:!1}})})},msgCreateRecord:function(e,t){var n=this;return new L["default"](function(r,i){var o,s,c=e.id;if("chat"===e.type)s=L["default"].cast(["message",{type:"text",to:e.to,id:e.id,t:e.t.toString()},[["body",void 0,e.body]]]);else if("location"===e.type)o=e.body?F.fromBase64(e.body,!1):void 0,s=L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"location",latitude:e.lat||void 0,longitude:e.lng||void 0,name:e.loc&&e.url?e.loc:void 0,url:e.loc&&e.url?e.url:void 0,encoding:e.body?"raw":void 0},o]]]);else if("vcard"===e.type){var l=["vcard",{name:e.subtype},e.body];s=L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"vcard"},[l]]]])}else o=e.body?F.fromBase64(e.body,!1):void 0,s=(t?n.sendMedia(e.avparams):L["default"].resolve({status:200})).then(function(t){return 200===t.status?L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{encoding:e.body?"raw":void 0,origin:"ptt"===e.type?"live":void 0,seconds:"ptt"===e.type&&e.duration?e.duration.toString():void 0,type:t.type,mimetype:e.mimetype||void 0,size:e.size?e.size.toString():void 0,filehash:t.filehash,url:t.url,duration:t.duration?t.duration.toString():void 0,vcodec:t.vcodec||void 0,width:t.width?t.width.toString():void 0,height:t.height?t.height.toString():void 0,fps:t.fps?t.fps.toString():void 0,vbitrate:t.vbitrate?t.vbitrate.toString():void 0,acodec:t.acodec||void 0,asampfreq:t.asampfreq?t.asampfreq.toString():void 0,asampfmt:t.asampfmt||void 0,abitrate:t.abitrate?t.abitrate.toString():void 0,caption:"video"!==e.type&&"image"!==e.type||!e.caption?void 0:e.caption},o]]]):(x.error("wap:msgCreateRecord:sendMedia error "+t.status)(),L["default"].reject())})["catch"](function(){return x.error("wap:msgCreateRecord:sendMedia dropped")(),L["default"].reject()});s.then(function(t){var n=u("relay",[t]),o=a(r);o.tag=c,o.meta={type:"message",key:new H(e.from,e.to,e.id)},B.send({data:Q.write(n),onSend:o,onDrop:a(i),binaryOpts:{debugString:"action,message, "+e.type,debugObj:n,metric:J.MESSAGE,ackRequest:!1}})})["catch"](function(){x.error("wap:msgCreateRecord mPromise error")(),i()})})},msgFindQuery:function(e,t){return"before"!==e?L["default"].reject("wap:msgFindQuery:unsupported:"+e):new L["default"](function(e,n){var r=function(t){var n=[],r=Q.read(t),i=z.children(r);if("response"===z.tag(r)&&"message"===z.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=E(i[o],"response");s&&n.push(s)}}e(n)},i=c({type:"message",jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},void 0);B.sendEphemeral({data:Q.write(i),onSend:s(r,e),onDrop:a(n),binaryOpts:{debugString:"query,message,"+[t.toString(),t.count].join(),debugObj:i,metric:J.QUERY_MESSAGES,ackRequest:!1}})})},presenceSubscribe:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["presence",{type:"subscribe",to:e},void 0]]);B.sendEphemeral({data:Q.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,presence,subscribe,"+e,debugObj:i,metric:J.PRESENCE_SUBSCRIBE,ackRequest:!0}})})}};e.exports=te},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return 0===z&&J++,e||z++,x.log("wap:epochCount: "+z+" epoch: "+J)(),J.toString()}function o(){z>0?z--:x.error("wap:epochRecv: NEGATIVE")(),x.log("wap:epochCount: "+z+" epoch: "+J)()}function a(e){return function(t){return t&&"number"==typeof t.status&&t.status>=500?t:(o(),void e(t))}}function s(e,t){return function(n){if("object"===("undefined"==typeof n?"undefined":(0,M["default"])(n))&&"number"==typeof n.status){if(401===n.status)throw o(),new B.E401;if(n.status>=500)return n;o(),t(n)}else o(),e(n)}}function u(e,t,n){return["action",{type:e,epoch:i(n)},t]}function c(e,t){return e.epoch=i(),["query",e,t]}function l(e,t){return e.reduce(function(e,t){return e||t},!1)?void 0:t}function d(e){var t={};if("action"!==I.tag(e))return t;var n=I.attr("add",e),r=I.attr("missing",e),i=I.attr("checksum",e);switch(n){case"after":case"before":case"last":case"relay":case"update":t.add=n}switch(r){case"remove":t.missing=r}return i&&(t.checksum=i),t}function f(e){var t={};if(!_.isArray(e))return t;var n,r,i=e.length;for(r=0;i>r;r++)switch(n=e[r],I.tag(n)){case"broadcast":switch(I.attr("type",n)){case"create":case"add":case"remove":t.msg||(t.msg=[]),t.msg.push(n);break;case"modify":t.bcUpdate||(t.bcUpdate=[]),t.bcUpdate.push(n)}break;case"message":case"groups_v2":case"notification":t.msg||(t.msg=[]),t.msg.push(n);break;case"read":case"log":t.cmd||(t.cmd=[]),t.cmd.push(n);break;case"received":t.ack||(t.ack=[]),t.ack.push(n);break;case"user":t.contact||(t.contact=[]),t.contact.push(n);break;case"chat":switch(I.attr("type",n)){case"mute":t.mute||(t.mute=[]),t.mute.push(n);break;default:t.chat||(t.chat=[]),t.chat.push(n)}break;case"battery":t.battery||(t.battery=[]),t.battery.push(n);break;default:x.errorVerbose("Wap:groupActionsByType unknown action: "+I.toString(n),n)()}return t}function p(e,t){var n=parseInt(I.attr(t,e),10);return _.isNaN(n)?void 0:n}function h(e){if("chat"===I.tag(e)){var t=I.attr("jid",e),n=parseInt(I.attr("t",e),10)||void 0,r=I.attr("type",e),i=parseInt(I.attr("mute",e),10)||void 0,o=parseInt(I.attr("before",e),10)||void 0,a="true"===I.attr("archive",e),s="true"===I.attr("read_only",e),u=parseInt(I.attr("modify_tag",e),10)||void 0,c=I.attr("name",e)||void 0,d=p(e,"count"),f="true"===I.attr("message",e),h="true"===I.attr("star",e);"ahead"===r&&(r="clear");var g,m=I.children(e);if(_.isArray(m)){g=[];var v,b,y=m.length;for(v=0;y>v;v++)if(b=m[v],"item"===I.tag(b)){var w=I.attr("index",b);w&&g.push([w,"true"===I.attr("owner",b),I.attr("participant",b)])}}var E={id:t,t:n,type:r,keys:g,before:o,archive:a,isReadOnly:s,unreadCount:d,muteExpiration:i,modifyTag:u,name:c,pendingMsgs:f,star:h},S=[r&&"delete"!==r&&"clear"!==r&&"archive"!==r&&"unarchive"!==r&&"mute"!==r&&"star"!==r&&"unstar"!==r,!r&&!t,a&&r&&"clear"!==r,"clear"!==r&&o&&o>0,"clear"!==r&&"star"!==r&&"unstar"!==r&&g&&g.length>0];return l(S,E)}}function g(e){if("user"===I.tag(e)){var t=I.attr("jid",e),n=I.attr("name",e),r=I.attr("short",e)||void 0,i=I.attr("type",e)||"in",o={id:t,name:n,type:i,shortName:r},a=[!t,"in"!==i&&"out"!==i&&!!i];return l(a,o)}}function m(e){if("read"===I.tag(e)){var t=I.attr("jid",e),n="false"===I.attr("type",e),r={type:n?"unread":"read",jid:t},i=[!t];return l(i,r)}}function v(e){if("received"===I.tag(e)){var t,n=I.attr("type",e),r=I.attr("id",e),i=I.attr("to",e);switch(n){case"message":t=2;break;case"read":t=3;break;case"played":t=4;break;case"error":t=-1;break;case"pending":default:t=0}var o={cmd:"ack",id:r,ack:t,from:Store.Conn.me,to:i},a=[!r,!i,"message"!==n&&"read"!==n&&"played"!==n&&"error"!==n&&"pending"!==n];return l(a,o)}}function b(e){if("broadcast"===I.tag(e)&&"modify"===I.attr("type",e)){var t=I.attr("jid",e),n=I.children(e),r=[];if(_.isArray(n)){var i,o,a,s=n.length;for(i=0;s>i;i++)o=n[i],a=I.attr("jid",o),"recipient"===I.tag(o)&&a&&2===a.split("@").length&&"c.us"===a.split("@")[1]&&r.push({id:a})}var u={id:t,participants:r},c=[!t,"broadcast"!==t.split("@")[1],0===r.length];return l(c,u)}}function y(e){if("battery"===I.tag(e)){var t=Math.min(parseInt(I.attr("value",e),10)||-1,100),n=I.attr("live",e),r={battery:0>t?void 0:t,plugged:n?"true"===n:void 0},i=[0>t&&!n];return l(i,r)}}function w(e){return e.from===Store.Conn.me?e.to:e.from}function E(e,t){switch(I.tag(e)){case"message":return S(e,t);case"groups_v2":return k(e);case"broadcast":return T(e);case"notification":return $(e);default:return}}function S(e,t){if("message"===I.tag(e)){var n;I.attr("from",e)!==Store.Conn.me||I.attr("to",e)?I.attr("to",e)!==Store.Conn.me||I.attr("from",e)||(n="out"):n="in";var r,i=I.attr("id",e),o=parseInt(I.attr("t",e),10)||0,a=I.attr("to",e)||Store.Conn.me,s=I.attr("from",e)||Store.Conn.me,u="broadcast"===s.split("@")[1],c=I.attr("participant",e),d=u?c:s,f=u?void 0:c,p=u?!1:I.child("broadcast",e)&&s===Store.Conn.me,h="invis"===I.attr("web",e),g=I.attr("notify",e)||"",m=parseInt(I.attr("status",e))||0,v=[],b=I.child("broadcast",e),y="true"===I.attr("star",e);if("broadcast"!==a){switch(t){case"fresh":r=1;break;default:r=m>=-1&&4>=m?m:1}if(_.isArray(b)){var w,E=b.length;for(w=0;E>w;w++){var S=b[w],k=I.attr("jid",S);"to"===I.tag(S)&&k&&v.push(k)}}var T,$=[];switch(I.attr("type",e)){case"text":var O=I.dataStr(I.child("body",e))||"";T={id:i,body:O,type:"chat",t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,broadcast:p,recipients:v,star:y};var A=I.child("media",e);A&&"url"===I.attr("type",A)&&_.merge(T,{subtype:"url",title:I.attr("title",A),description:I.attr("description",A),canonicalUrl:I.attr("canonical-url",A),matchedText:I.attr("matched-text",A),thumbnail:C(A)}),$=[!i,!o,!d,!a];break;case"media":var R,N,j,P,L,D,M=I.child("media",e),U=I.attr("type",M),B=I.attr("media_key",M);if("retry"===I.attr("reason",M))return;switch(U){case"image":case"video":case"document":var F=parseInt(I.attr("page_count",M),10)||0,Y=I.attr("mimetype",M);D=I.attr("caption",M),R=C(M),N=I.attr("url",M),N=_.isString(N)&&N.indexOf("/u/")>0?void 0:N,j=I.attr("filehash",M),P=parseInt(I.attr("size",M),10)||0,L=I.attr("seconds",M),T={id:i,body:R,type:U,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:N,duration:L,broadcast:p,recipients:v,filehash:j,size:P,caption:D,mediaKey:B,star:y,pageCount:F,mimetype:Y},$=[!i,!o,!d,!a];break;case"location":var W=I.attr("latitude",M),G=I.attr("longitude",M),q=I.attr("name",M);R=C(M),N=I.attr("url",M),T={id:i,body:R,type:U,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:N,loc:q,lat:W,lng:G,broadcast:p,recipients:v,star:y},$=[!i,!o,!d,!a,!W||!G];break;case"audio":var H="live"===I.attr("origin",M)?"ptt":U;N=I.attr("url",M),N=_.isString(N)&&N.indexOf("/u/")>0?void 0:N,j=I.attr("filehash",M),P=parseInt(I.attr("size",M),10)||0,L=I.attr("seconds",M),T={id:i,type:H,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:N,duration:L,broadcast:p,recipients:v,filehash:j,size:P,star:y},$=[!i,!o,!d,!a];break;case"vcard":var K=I.child("vcard",M),V=I.dataStr(K),Q=I.attr("name",K);T={id:i,body:V,type:U,subtype:Q,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,broadcast:p,recipients:v,star:y},$=[!i,!o,!d,!a,!V,!Q];break;default:x.error("wap:parseMsgMessage unknown media type: "+I.toString(e),e)()}break;default:x.error("wap:parseMsgMessage unknown message type: "+I.toString(e),e)()}return l($,T)}}}function C(e){return"raw"===I.attr("encoding",e)?Y.isByteBuffer(I.children(e))?I.children(e).toBase64():"":I.dataStr(e)}function k(e){if("groups_v2"===I.tag(e)){var t,n=parseInt(I.attr("t",e),10)||0,r=I.attr("id",e),i=I.attr("jid",e),o="invis"===I.attr("web",e),a="true"===I.attr("owner",e),s=I.attr("type",e),u=I.attr("author",e),c=I.children(e),d=I.attr("participant",e),f=[];switch(s){case"create":t=I.attr("subject",e);break;case"subject":t=I.attr("subject",e);break;case"picture":t=I.attr("picture",e)}if(_.isArray(c)){var p,h=c.length;for(p=0;h>p;p++){var g=c[p],m=I.attr("jid",g);"participant"===I.tag(g)&&m&&f.push(m)}}var v={t:n,id:r,to:a?i:Store.Conn.me,from:a?Store.Conn.me:i,author:u,participant:d,body:t?t.toString():void 0,type:"gp2",subtype:s,invis:o,recipients:f},b=[!r,!n,"subject"!==s&&"add"!==s&&"remove"!==s&&"leave"!==s&&"picture"!==s&&"modify"!==s&&"create"!==s&&"delete"!==s&&"promote"!==s&&"demote"!==s,"subject"===s&&!t,("add"===s||"remove"===s||"leave"===s||"promote"===s||"demote"===s||"modify"===s)&&0===f.length,!i,"string"==typeof i&&"g.us"!==i.split("@")[1]];return l(b,v)}}function T(e){if("broadcast"===I.tag(e)){var t,n,r=I.attr("type",e),i=I.attr("id",e),o=parseInt(I.attr("t",e),10)||0,a=I.attr("jid",e),s="true"===I.attr("owner",e),u=I.attr("participant",e);
switch(r){case"create":t=parseInt(I.attr("count",e),10)||0;break;case"add":case"remove":n=I.child("participant",e),n&&(t=I.attr("jid",n))}var c={id:i,t:o,participant:u,type:"broadcast_notification",subtype:r,from:s?Store.Conn.me:a,to:s?a:Store.Conn.me,body:t?t.toString():void 0},d=[!i,!o,!a,"string"==typeof a&&"broadcast"!==a.split("@")[1],"create"!==r&&"add"!==r&&"remove"!==r,("add"===r||"remove"===r)&&2!==t.split("@").length];return l(d,c)}}function $(e){if("notification"===I.tag(e)){var t=I.attr("id",e),n=parseInt(I.attr("t",e),10)||0,r=I.attr("jid",e),i=I.attr("participant",e),o="invis"===I.attr("web",e),a=I.dataStr(e),s="true"===I.attr("owner",e)?Store.Conn.me:r,u="true"===I.attr("owner",e)?r:Store.Conn.me,c={id:t,type:"notification",t:n,invis:o,from:s,to:u,participant:i,body:a},d=[!t,!n,!r,2!==r.split("@").length];return l(d,c)}}function O(e,t,n){return new L["default"](function(r,i){var o=F.tag(),s=a(r),c=["participant",{jid:n},void 0],l=["group",{id:o,jid:t,type:e,author:Store.Conn.me},[c]],d=u("set",[l]);F.send({tag:o,data:R.write(d),clientCacheable:!0,onSend:s,onDrop:a(i),binaryOpts:{debugString:"action,group,participant,"+[e,t,n].join(","),debugObj:d,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})}function A(e,t,n,r){return new L["default"](function(i,o){var s;switch(e){case"clear":s=(!!r).toString()}var c=u("set",[["chat",{type:e,jid:t,index:n?n.id:void 0,owner:n?n.fromMe.toString():void 0,participant:n?n.participant:void 0,star:"undefined"!=typeof s?s:void 0},void 0]]);F.send({data:R.write(c),clientCacheable:!0,onSend:a(i),onDrop:a(o),binaryOpts:{debugString:"action,chat,"+[e,n,r].join(),debugObj:c,metric:Q.CHAT,ackRequest:!0}})})}var R,I,N=n(37),j=r(N),P=n(3),L=r(P),D=n(24),M=r(D),x=n(1),U=n(12),B=n(11),F=n(14),Y=n(7),W=n(38),G=n(21),q=n(41),H=n(63),K=n(60),V=n(17),Q={DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22,SPAM:23},z=0,J=0,X=0,Z={"delete":function(){z=0,J=0},error2412:function(){o()},setSubProtocol:function(e){e?(R=new H(e),I=R.Node):(x.error("Wap:setSubProtocol unknown "+e)(),U.upload("07_unknown_version",!0)["finally"](function(){return V.hardRefresh()}))},handle:function(e,t,n){var r,i,o,a,s,u,c,l,p=R.read(e);switch(I.tag(p)){case"response":if(0===n.indexOf("preempt"))switch(I.attr("type",p)){case"chat":if(x.logColor("green","bin-recv: "+n+",response,chat",p)(),i=I.children(p)||[],_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)c=h(i[o]),c&&r.push(c);Store.Chat.handle([{cmd:"preempt",response:r}],t)}break;case"contacts":if(x.logColor("green","bin-recv: "+n+",response,contact",p)(),i=I.children(p),_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)s=g(i[o]),s&&r.push(s);Store.Contact.handle([{cmd:"preempt",checksum:I.attr("checksum",p),response:r}],t)}break;default:x.error("Wap:handle unknown response type: "+I.toString(p,!0),p)()}else x.error("Wap:handle non-preemptive response: "+I.toString(p,!0),p)();break;case"action":var S=d(p),C=f(I.children(p)),k=(0,j["default"])(C);if(_.isArray(k)){var T,$,O,A,N=k.length;if(0===N&&"last"===S.add)Store.Msg.handle([{recent:!0}],t);else for(o=0;N>o;o++){$=k[o],T=C[$];var P,L=T.length;switch($){case"msg":var D;switch(S.add){case"relay":case"update":D=E(T[0],"relay"),1!==L&&x.error("Wap:handle action msg relay length not 1",p)(),D?(x.logColor("green","bin-recv: "+[n,"action","msg",S.add,D.type,D.from,D.to,D.id].join(","),p)(),A=w(D),Store.Msg.handle([{meta:{add:S.add},chat:A,msg:D}],t)):x.error("Wap:handle action msg relay dropped",T[0])();break;case"last":for(x.logColor("green","bin-recv: "+[n,"action","msg","last",T.length].join(","),p)(),O=[],P=0;L>P;P++)D=E(T[P],"last"),D?O.push(D):x.error("Wap:handle action msg last dropped",T[P])();if(O.length>0){for(var M={recent:!0},U=0;U<O.length;U++)M[w(O[U])]=O[U];Store.Msg.handle([M],t)}else x.error("Wap:handle action msg last dropped to 0")();break;case"before":case"after":if(L>0){for(O=[],P=0;L>P;P++)D=E(T[P],S.add),D?O.push(D):x.error("Wap:handle action msg before/after dropped",T[P])();x.logColor("green","bin-recv: "+[n,"action","msg",S.add,O.length].join(","),p)(),O.length>0?(A=w(O[0]),Store.Msg.handle([{meta:{add:S.add},chat:A,msgs:O}],t)):x.error("Wap:handle action msg before/after droppped to 0")()}else x.error("Wap:handle action msg before/after 0 msgs")();break;default:x.error("Wap:handle action msg no meta.add",p)()}break;case"cmd":for(P=0;L>P;P++){var B=m(T[P]);if(B){var F=_.values(B).join(",");x.logColor("green","bin-recv: "+[n,"action","cmd",F].join(","),p)(),Store.Cmd.handle([B],t)}else x.error("Wap:handle action cmd invalid",p)()}break;case"bcUpdate":var Y=[];for(P=0;L>P;P++){var W=b(T[P]);W?Y.push(W):x.error("Wap:handle action bc update invalid",T[P])()}x.logColor("green","bin-recv: "+[n,"action","bcUpdate",Y.length].join(","),p)(),Y.length>0&&Store.GroupMetadata.handle(Y,t);break;case"ack":for(P=0;L>P;P++){var G=v(T[P]);G?(x.logColor("green","bin-recv: "+[n,"action","ack",G.to,G.id,G.ack].join(","),p)(),Store.Msg.handle([G],t)):x.error("Wap:handle action ack invalid",p)()}break;case"contact":for(u=[],P=0;L>P;P++)s=g(T[P]),s?u.push(s):x.error("Wap:handle action contact dropped",T[P])();if(x.logColor("green","bin-recv: "+[n,"action","contact",u.length,S.missing].join(","),p)(),u.length>0){var q=[u];(S.missing||S.checksum)&&q.push(S),Store.Contact.handle(q,t)}break;case"chat":for(l=[],P=0;L>P;P++)c=h(T[P]),c?l.push(c):x.error("Wap:handle action chat dropped",T[P])();x.logColor("green","bin-recv: "+[n,"action","chat",l.length].join(","),p)(),l.length>0&&Store.Chat.handle([l],t);break;case"battery":var H=y(T[0]);H?(x.logColor("green","bin-recv: "+[n,"action","battery",H.battery,H.plugged].join(","),p)(),Store.Conn.handle([H],t)):x.error("Wap:handle action battery dropped",T[0])();break;case"mute":for(l=[],P=0;L>P;P++)c=h(T[P]),c?l.push(c):x.error("Wap:handle action mute dropped",T[P])();x.logColor("green","bin-recv: "+[n,"action","mute",l.length].join(","),p)(),l.length>0&&Store.Mute.handle(l,t);break;default:x.error("Wap:handle action unknown "+$,p)()}}}break;default:x.errorVerbose("TODO "+I.toString(p,!0),p)()}return!0},requestDeviceUploadLogs:function(){var e;return new L["default"](function(t,n){if(X)return void t();e=++X;var r=u("debug",[["log",void 0,void 0]]),i=a(t);i.drop=!0,F.send({data:R.write(r),clientCacheable:!0,onSend:i,onDrop:n,binaryOpts:{debugString:"debug,log",debugObj:r,metric:Q.DEBUG_LOG,ackRequest:!0}})})["finally"](function(){e===X&&(X=0)})},resyncMessages:function(e){return new W(function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,resume",r)(),"response"===I.tag(r)&&"resume"===I.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=h(i[o]);s&&n.push(s)}}t({checksum:I.attr("checksum",r),data:n})},i=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,participant:e.participant,archive:(!!e.archive).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),G.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),["last",t,void 0]}),o=c({type:"resume"},i);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,resume",debugObj:o,metric:Q.QUERY_RESUME,ackRequest:!1}})})},resyncReceipts:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,receipt",r)(),"response"===I.tag(r)&&"receipt"===I.attr("type",r)&&_.isArray(i)){var o,a,s,u=i.length;for(o=0;u>o;o++){a=i[o],s=I.children(a);var c=I.attr("jid",a),l=I.attr("t",a);if("receipt"===I.tag(a)&&c&&l&&_.isArray(s)){var d,f=[],p=s.length;for(d=0;p>d;d++){var h=s[d];if("item"===I.tag(h)){var g=I.attr("index",h),m="true"===I.attr("owner",h),v=parseInt(I.attr("status",h),10)||0,b=I.attr("participant",h);g&&0!==v&&4>=v&&f.push([g,m,b,v])}}f.length>0&&n.push({id:c,t:parseInt(l,10),acks:f})}}}t(n)},i=e.map(function(e){return["last",{jid:e.remote,index:e.id,owner:e.fromMe.toString(),participant:e.participant,t:e.t.toString()},void 0]}),o=c({type:"receipt"},i);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,receipt",debugObj:o,metric:Q.QUERY_RECEIPT,ackRequest:!1}})})},queryReceivedActions:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,actions",r)(),"response"===I.tag(r)&&"action"===I.attr("type",r))if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=i[o],u=I.attr("id",s),c=parseInt(I.attr("code",s),10)||0;"item"===I.tag(s)&&u&&0!==c&&n.push({id:u,code:c})}}else"true"===I.attr("replaced",r)&&(n="replaced");t(n)},i=e.map(function(e){return["item",{id:e},void 0]}),o=c({type:"action"},i);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,actions",debugObj:o,metric:Q.QUERY_ACTIONS,ackRequest:!1}})})},recentEmojiQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,emoji",r)(),"response"===I.tag(r)&&"emoji"===I.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=i[o],u=I.attr("code",s),c=parseFloat(I.attr("value",s))||0;"item"===I.tag(s)&&u&&c&&!isNaN(c)&&n.push({"char":u,weight:c})}}t(n)},i=_.isArray(e)?e.map(function(e){return["item",{code:e["char"],value:e.weight.toString()},void 0]}):void 0,o=c({type:"emoji"},i);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,emoji",debugObj:o,metric:Q.QUERY_EMOJI,ackRequest:!1}})})},queryMsgInfo:function(e){function t(e){var t,n,r=[];if(_.isArray(e)){t=e.length;for(var i=0;t>i;i++)n=e[i],"item"===I.tag(n)&&I.attr("jid",n)&&I.attr("t",n)&&r.push({id:I.attr("jid",n),t:parseInt(I.attr("t",n),10)||0})}return r}return new L["default"](function(n,r){var i=function(e){var r=R.read(e),i={played:[],playedRemaining:0,read:[],readRemaining:0,delivery:[],deliveryRemaining:0};if(x.logColor("green","bin-recv: response,msg,info",r)(),"response"===I.tag(r)&&"message_info"===I.attr("type",r)){var o=I.child("played",r),a=I.child("read",r),s=I.child("delivery",r),u=I.children(o),c=I.children(a),l=I.children(s),d=parseInt(I.attr("count",r),10)||0;i.played=t(u),i.read=t(c),i.delivery=t(l);var f=d-i.played.length,p=d-i.played.length-i.read.length,h=d-i.played.length-i.read.length-i.delivery.length;i.playedRemaining=0>f?0:f,i.readRemaining=0>p?0:p,i.deliveryRemaining=0>h?0:h}n(i)},o=c({type:"message_info",index:e.id,jid:e.remote},void 0);F.sendEphemeral({data:R.write(o),onSend:s(i,n),onDrop:a(r),binaryOpts:{debugString:["query,msg,info",e.id,e.remote,e.fromMe].join(),debugObj:o,metric:Q.QUERY_MESSAGE_INFO,ackRequest:!1}})})},changeSubject:function(e,t){return new L["default"](function(n,r){var i=F.tag(),o=a(n);o.tag=i;var s=["group",{id:i,jid:e,type:"subject",author:Store.Conn.me,subject:t},void 0],c=u("set",[s]);F.send({data:R.write(c),clientCacheable:!0,onSend:o,onDrop:a(r),binaryOpts:{debugString:"action,group,subject",debugObj:c,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},createGroup:function(e,t){return new L["default"](function(n,r){var i=F.tag(),o=a(n);o.tag=i;var s=t.map(function(e){return["participant",{jid:e},void 0]});x.log("create group tag",i)();var c=["group",{id:i,type:"create",author:Store.Conn.me,subject:e},s],l=u("set",[c]);F.send({data:R.write(l),clientCacheable:!0,onSend:o,onDrop:a(r),binaryOpts:{debugString:"action,group,create",debugObj:l,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},leaveGroup:function(e){return new L["default"](function(t,n){var r=F.tag(),i=a(t);i.tag=r;var o=["group",{id:r,jid:e,type:"leave",author:Store.Conn.me},void 0],s=u("set",[o]);F.send({data:R.write(s),clientCacheable:!0,onSend:i,onDrop:a(n),binaryOpts:{debugString:"action,group,delete",debugObj:s,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},addParticipant:function(e,t){return O("add",e,t)},removeParticipant:function(e,t){return O("remove",e,t)},promoteParticipant:function(e,t){return O("promote",e,t)},requestMediaReupload:function(e){return new L["default"](function(t,n){var r=e.id,i=function(e){var n,r=R.read(e);if("response"===I.tag(r)&&"media"===I.attr("type",r)){var i=parseInt(I.attr("code",r))||400,o=I.attr("url",r);i>=500&&502!==i?(x.error("wap:requestMediaReupload:error "+i)(),n={status:i}):200===i&&o?n={status:200,url:o}:200!==i||o?(x.error("wap:requestMediaReupload:error "+i)(),n={status:i}):n={status:400}}else x.error("wap:requestMediaReupload:malformed")(),n={status:400};t(n)},o=r,u=c({type:"media",index:o.id,jid:o.remote,owner:o.fromMe.toString(),participant:o.participant},void 0);F.sendEphemeral({data:R.write(u),onSend:s(i,t),onDrop:a(n),binaryOpts:{debugString:"query,media",debugObj:u,metric:Q.QUERY_MEDIA,ackRequest:!1}})})},sendConversationSeen:function(e,t,n){return new L["default"](function(r,i){var o=u("set",[["read",{jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,participant:t?t.participant:void 0,count:n&&t?n.toString():void 0},void 0]]);F.send({data:R.write(o),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,read,"+[t,n].join(),debugObj:o,metric:Q.READ,ackRequest:!0}})})},sendConversationUnseen:function(e,t){return this.sendConversationSeen(e,t,-2)},sendConversationClear:function(e,t,n){return A("clear",e,t,n)},sendConversationDelete:function(e,t){return A("delete",e,t)},sendConversationArchive:function(e,t,n){return A(t?"archive":"unarchive",e,n)},sendConversationMute:function(e,t,n){return new L["default"](function(r,i){var o=t?t.toString():void 0,s=n?n.toString():void 0,c=u("set",[["chat",{type:"mute",mute:o,previous:s,jid:e},void 0]]);F.send({data:R.write(c),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,"+e+", "+(o?"mute,"+o:"unmute"),debugObj:c,metric:Q.CHAT,ackRequest:!0}})})},sendMessagePlayed:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["received",{type:"played",index:e.id,from:e.remote,participant:e.participant},void 0]]);F.send({data:R.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,played,"+e.toString(),debugObj:i,metric:Q.RECEIVED,ackRequest:!0}})})},sendMessageDelete:function(e,t,n){return new L["default"](function(r,i){var o=t.map(function(e){return["item",{index:e.id,owner:e.fromMe.toString(),participant:e.participant},void 0]}),s=u("set",[["chat",{type:"clear",jid:e,media:n.toString()},o]]);F.send({data:R.write(s),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,msgs,delete,"+[e,n,t.length].join(),debugObj:s,metric:Q.CHAT,ackRequest:!0}})})},sendMessageStarred:function(e,t,n){return new L["default"](function(r,i){var o=t.map(function(e){return["item",{index:e.id,owner:e.fromMe.toString(),participant:e.participant},void 0]}),s=u("set",[["chat",{type:n?"star":"unstar",jid:e},o]]);F.send({data:R.write(s),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,msgs,star,"+[e,n,t.length].join(),debugObj:s,metrics:Q.CHAT,ackRequest:!0}})})},sendUnstarAll:function(){return new L["default"](function(e,t){var n=u("set",[["chat",{type:"unstar"},void 0]]);F.send({data:R.write(n),clientCacheable:!0,onSend:a(e),onDrop:a(t),binaryOpts:{debugString:"action,unstar,all",debugObj:n,metrics:Q.CHAT,ackRequest:!0,expires:moment().unix()}})})},profilePicFindThumbFromPhone:function(e,t){return new L["default"](function(n,r){var i=function(i){var o=R.read(i);("response"!==I.tag(o)||"preview"!==I.attr("type",o))&&r();var a=I.children(o),s=a&&a[0];if(s||r(),"missing"===I.attr("type",s))n({id:e,tag:void 0,raw:void 0});else{var u,c=I.attr("id",s);if(t&&c===t.tag&&t.raw)u=t.raw;else{var l=I.children(s);u=l?l.toBase64():void 0}n({id:e,tag:c,raw:u})}},o={type:"preview",jid:e};t&&t.tag&&(o.id=t.tag);var u=c(o,[]);F.sendEphemeral({data:R.write(u),onSend:s(i,n),onDrop:a(r),binaryOpts:{debugString:"query,thumb,"+e,debugObj:u,metric:Q.QUERY_PREVIEW,ackRequest:!1}})})},groupMetadataFindFromPhone:function(e,t){return new L["default"](function(t,n){var r=function(n){var r=R.read(n);if("response"!==I.tag(r)||"group"!==I.attr("type",r))return void t({status:"error",info:"bad format: response incorrect"});var i=I.children(r),o=i&&i[0];if(!o)return void t({status:"error",info:"bad format: no group node"});if("missing"===I.attr("type"))return void t({status:"missing"});var a=_.map(I.children(o),function(e){return{id:I.attr("jid",e),isAdmin:"admin"===I.attr("type",e)}});t({status:"ok",data:{id:e,owner:I.attr("creator",o),creation:parseInt(I.attr("create",o),10)||void 0,participants:a,stale:!1}})},i=c({type:"group",jid:e},[]);F.sendEphemeral({data:R.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,group,"+e,debugObj:i,metric:Q.QUERY_GROUP,ackRequest:!1}})})},sendPresenceUpdate:function(e){return["available","unavailable"].indexOf(e)>-1?new L["default"](function(t,n){var r=a(t),i=u("set",[["presence",{type:e},void 0]]),o={data:R.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,presence,"+e,debugObj:i,metric:Q.PRESENCE,available:"available"===e,ackRequest:"available"===e}};"available"===e?F.sendEphemeral(o):F.sendEphemeralIgnore(o)}):void 0},sendChatstateUpdate:function(e,t){return["composing","paused","recording"].indexOf(e)>-1?new L["default"](function(n,r){var i=n,o=u("set",[["presence",{type:e,to:t},void 0]],!0);F.sendEphemeralIgnore({data:R.write(o),onSend:i,onDrop:r,binaryOpts:{debugString:"action,chatstate,"+e,debugObj:o,metric:Q.PRESENCE,skipOffline:!0,ackRequest:!1}},!0)}):void 0},sendSetPicture:function(e,t,n){return new L["default"](function(r,i){var o=q.parseDataURL(t).data,s=q.parseDataURL(n).data,c=Y.fromBase64(o,!1),l=Y.fromBase64(s,!1),d=F.tag(),f=a(r);f.tag=d;var p=["picture",{id:d,jid:e,type:"set"},[["image",void 0,l],["preview",void 0,c]]],h=u("set",[p]);F.send({data:R.write(h),clientCacheable:!0,onSend:f,onDrop:a(i),binaryOpts:{debugString:"action,set_pic,"+e,debugObj:h,metric:Q.PIC,ackRequest:!1,expires:moment().unix()}})})},deletePicture:function(e){return new L["default"](function(t,n){var r=F.tag(),i=a(t);i.tag=r;var o=["picture",{id:r,jid:e,type:"delete"},void 0],s=u("set",[o]);F.send({data:R.write(s),clientCacheable:!0,onSend:i,onDrop:a(n),binaryOpts:{debugString:"action,delete_pic,"+e,debugObj:s,metric:Q.PIC,ackRequest:!1,expires:moment().unix()}})})},sendSetStatus:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["status",void 0,e]]);F.send({data:R.write(i),clientCacheable:!0,onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,status,set",debugObj:i,metric:Q.STATUS,ackRequest:!1,expires:moment().unix()}})})},sendSetBlock:function(e,t){return new L["default"](function(n,r){var i=t.map(function(e){return["user",{jid:e.jid},void 0]}),o=["block",{type:e?"add":"remove"},i],s=u("set",[o]);F.send({data:R.write(s),clientCacheable:!0,onSend:a(n),onDrop:a(r),binaryOpts:{debugString:"action,block,"+e+","+_.pluck(t,"jid").join(","),debugObj:s,metric:Q.BLOCK,ackRequest:!1,expires:moment().unix()}})})},sendSpamReport:function(e){return new L["default"](function(t,n){var r=u("set",[["spam",{jid:e},void 0]]);F.send({data:R.write(r),clientCacheable:!0,onSend:a(t),onDrop:a(n),binaryOpts:{debugString:"action,spam,"+e,debugObj:r,metric:Q.SPAM,ackRequest:!1,expires:moment().unix()}})})},chatFindQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if("response"===I.tag(r)&&"chat"===I.attr("type",r))if("true"===I.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=h(i[o]);s&&n.push(s)}}t(n)},i={type:"chat"};"boolean"==typeof e&&e?i.kind="retry":"string"==typeof e&&(i.jid=e);var o=c(i,void 0);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:["query","chat",e].join(),debugObj:o,metric:Q.QUERY_CHAT,ackRequest:!1}})})},contactFindQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if("response"===I.tag(r)&&"contacts"===I.attr("type",r))if("true"===I.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=g(i[o]);s&&n.push(s)}}t({checksum:I.attr("checksum",r),data:n})},i=c({type:"contacts",kind:e?"retry":void 0},void 0);F.send({data:R.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,contacts, "+e,debugObj:i,metric:Q.QUERY_CONTACTS,ackRequest:!1}})})},msgCreateRecord:function(e,t){var n=this;return new L["default"](function(r,i){var o,s,c=e.id;if("chat"===e.type){var l=[["body",void 0,e.body]];"url"===e.subtype&&l.push(["media",{type:"url",title:e.title,description:e.description,"canonical-url":e.canonicalUrl,"matched-text":e.matchedText,encoding:"raw"},e.thumbnail?Y.fromBase64(e.thumbnail,!1):void 0]),s=L["default"].cast(["message",{type:"text",to:e.to,id:e.id,t:e.t.toString()},l])}else if("location"===e.type)o=e.body?Y.fromBase64(e.body,!1):void 0,s=L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"location",latitude:e.lat||void 0,longitude:e.lng||void 0,name:e.loc&&e.url?e.loc:void 0,url:e.loc&&e.url?e.url:void 0,encoding:e.body?"raw":void 0},o]]]);else if("vcard"===e.type){var d=["vcard",{name:e.subtype},e.body];s=L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"vcard"},[d]]]])}else{o=e.body?Y.fromBase64(e.body,!1):void 0;var f="ptt"===e.type?"audio":e.type;s=(t?n.sendMedia(e.avparams):L["default"].resolve({status:200,type:f})).then(function(t){return 200===t.status?L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{encoding:e.body?"raw":void 0,origin:"ptt"===e.type?"live":void 0,seconds:"ptt"===e.type&&e.duration?e.duration.toString():void 0,type:t.type,mimetype:e.mimetype||void 0,size:e.size?e.size.toString():void 0,filehash:t.filehash,url:t.url,duration:t.duration?t.duration.toString():void 0,vcodec:t.vcodec||void 0,width:t.width?t.width.toString():void 0,height:t.height?t.height.toString():void 0,fps:t.fps?t.fps.toString():void 0,vbitrate:t.vbitrate?t.vbitrate.toString():void 0,acodec:t.acodec||void 0,asampfreq:t.asampfreq?t.asampfreq.toString():void 0,asampfmt:t.asampfmt||void 0,abitrate:t.abitrate?t.abitrate.toString():void 0,caption:"video"!==e.type&&"image"!==e.type&&"document"!==e.type||!e.caption?void 0:e.caption,page_count:"number"!=typeof e.pageCount||isNaN(e.pageCount)?void 0:e.pageCount.toString()},o]]]):(x.error("wap:msgCreateRecord:sendMedia error "+t.status)(),L["default"].reject())})["catch"](function(){return x.error("wap:msgCreateRecord:sendMedia dropped")(),L["default"].reject()})}s.then(function(t){var n=u("relay",[t]),o=a(r);o.tag=c,o.meta={type:"message",key:new K(e.from,e.to,e.id)},F.send({data:R.write(n),onSend:o,onDrop:a(i),binaryOpts:{debugString:["action","message",e.type,e.subtype].join(),debugObj:n,metric:Q.MESSAGE,ackRequest:!1}})})["catch"](function(){x.error("wap:msgCreateRecord mPromise error")(),i()})})},msgFindQuery:function(e,t){return"before"!==e?L["default"].reject("wap:msgFindQuery:unsupported:"+e):new L["default"](function(e,n){var r=function(t){var n=[],r=R.read(t),i=I.children(r);if("response"===I.tag(r)&&"message"===I.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=E(i[o],"response");s&&n.push(s)}}e(n)},i=c({type:"message",jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},void 0);F.sendEphemeral({data:R.write(i),onSend:s(r,e),onDrop:a(n),binaryOpts:{debugString:"query,message,"+[t.toString(),t.count].join(),debugObj:i,metric:Q.QUERY_MESSAGES,ackRequest:!1}})})},presenceSubscribe:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["presence",{type:"subscribe",to:e},void 0]]);F.sendEphemeral({data:R.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,presence,subscribe,"+e,debugObj:i,metric:Q.PRESENCE_SUBSCRIBE,ackRequest:!0}})})}};e.exports=Z},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return 0===z&&J++,e||z++,x.log("wap:epochCount: "+z+" epoch: "+J)(),J.toString()}function o(){z>0?z--:x.error("wap:epochRecv: NEGATIVE")(),x.log("wap:epochCount: "+z+" epoch: "+J)()}function a(e){return function(t){return t&&"number"==typeof t.status&&t.status>=500?t:(o(),void e(t))}}function s(e,t){return function(n){if("object"===("undefined"==typeof n?"undefined":(0,M["default"])(n))&&"number"==typeof n.status){if(401===n.status)throw o(),new B.E401;if(n.status>=500)return n;o(),t(n)}else o(),e(n)}}function u(e,t,n){return["action",{type:e,epoch:i(n)},t]}function c(e,t){return e.epoch=i(),["query",e,t]}function l(e,t){return e.reduce(function(e,t){return e||t},!1)?void 0:t}function d(e){var t={};if("action"!==I.tag(e))return t;var n=I.attr("add",e),r=I.attr("missing",e),i=I.attr("checksum",e);switch(n){case"after":case"before":case"last":case"relay":case"update":t.add=n}switch(r){case"remove":t.missing=r}return i&&(t.checksum=i),t}function f(e){var t={};if(!_.isArray(e))return t;var n,r,i=e.length;for(r=0;i>r;r++)switch(n=e[r],I.tag(n)){case"broadcast":switch(I.attr("type",n)){case"create":case"add":case"remove":t.msg||(t.msg=[]),t.msg.push(n);break;case"modify":t.bcUpdate||(t.bcUpdate=[]),t.bcUpdate.push(n)}break;case"message":case"groups_v2":case"notification":t.msg||(t.msg=[]),t.msg.push(n);break;case"read":case"log":t.cmd||(t.cmd=[]),t.cmd.push(n);break;case"received":t.ack||(t.ack=[]),t.ack.push(n);break;case"user":t.contact||(t.contact=[]),t.contact.push(n);break;case"chat":switch(I.attr("type",n)){case"mute":t.mute||(t.mute=[]),t.mute.push(n);break;default:t.chat||(t.chat=[]),t.chat.push(n)}break;case"battery":t.battery||(t.battery=[]),t.battery.push(n);break;default:x.errorVerbose("Wap:groupActionsByType unknown action: "+I.toString(n),n)()}return t}function p(e,t){var n=parseInt(I.attr(t,e),10);return _.isNaN(n)?void 0:n}function h(e){if("chat"===I.tag(e)){var t=I.attr("jid",e),n=parseInt(I.attr("t",e),10)||void 0,r=I.attr("type",e),i=parseInt(I.attr("mute",e),10)||void 0,o=parseInt(I.attr("before",e),10)||void 0,a="true"===I.attr("archive",e),s="true"===I.attr("read_only",e),u=parseInt(I.attr("modify_tag",e),10)||void 0,c=I.attr("name",e)||void 0,d=p(e,"count"),f="true"===I.attr("message",e),h="true"===I.attr("star",e),g="false"===I.attr("spam",e);"ahead"===r&&(r="clear");var m,v=I.children(e);if(_.isArray(v)){m=[];var b,y,w=v.length;for(b=0;w>b;b++)if(y=v[b],"item"===I.tag(y)){var E=I.attr("index",y);E&&m.push([E,"true"===I.attr("owner",y),I.attr("participant",y)])}}var S={id:t,t:n,type:r,keys:m,before:o,archive:a,isReadOnly:s,unreadCount:d,muteExpiration:i,modifyTag:u,name:c,pendingMsgs:f,star:h,notSpam:g},C=[r&&"delete"!==r&&"clear"!==r&&"archive"!==r&&"unarchive"!==r&&"mute"!==r&&"star"!==r&&"unstar"!==r&&"spam"!=r,!r&&!t,a&&r&&"clear"!==r,"clear"!==r&&o&&o>0,"clear"!==r&&"star"!==r&&"unstar"!==r&&m&&m.length>0];return l(C,S)}}function g(e){if("user"===I.tag(e)){var t=I.attr("jid",e),n=I.attr("name",e),r=I.attr("short",e)||void 0,i=I.attr("type",e)||"in",o={id:t,name:n,type:i,shortName:r},a=[!t,"in"!==i&&"out"!==i&&!!i];return l(a,o)}}function m(e){if("read"===I.tag(e)){var t=I.attr("jid",e),n="false"===I.attr("type",e),r={type:n?"unread":"read",jid:t},i=[!t];return l(i,r)}}function v(e){if("received"===I.tag(e)){var t,n=I.attr("type",e),r=I.attr("id",e),i=I.attr("to",e);switch(n){case"message":t=2;break;case"read":t=3;break;case"played":t=4;break;case"error":t=-1;break;case"pending":default:t=0}var o={cmd:"ack",id:r,ack:t,from:Store.Conn.me,to:i},a=[!r,!i,"message"!==n&&"read"!==n&&"played"!==n&&"error"!==n&&"pending"!==n];return l(a,o)}}function b(e){if("broadcast"===I.tag(e)&&"modify"===I.attr("type",e)){var t=I.attr("jid",e),n=I.children(e),r=[];if(_.isArray(n)){var i,o,a,s=n.length;for(i=0;s>i;i++)o=n[i],a=I.attr("jid",o),"recipient"===I.tag(o)&&a&&2===a.split("@").length&&"c.us"===a.split("@")[1]&&r.push({id:a})}var u={id:t,participants:r},c=[!t,"broadcast"!==t.split("@")[1],0===r.length];return l(c,u)}}function y(e){if("battery"===I.tag(e)){var t=Math.min(parseInt(I.attr("value",e),10)||-1,100),n=I.attr("live",e),r={battery:0>t?void 0:t,plugged:n?"true"===n:void 0},i=[0>t&&!n];return l(i,r)}}function w(e){return e.from===Store.Conn.me?e.to:e.from}function E(e,t){switch(I.tag(e)){case"message":return S(e,t);case"groups_v2":return k(e);case"broadcast":return T(e);case"notification":return $(e);default:return}}function S(e,t){if("message"===I.tag(e)){var n;I.attr("from",e)!==Store.Conn.me||I.attr("to",e)?I.attr("to",e)!==Store.Conn.me||I.attr("from",e)||(n="out"):n="in";var r,i=I.attr("id",e),o=parseInt(I.attr("t",e),10)||0,a=I.attr("to",e)||Store.Conn.me,s=I.attr("from",e)||Store.Conn.me,u="broadcast"===s.split("@")[1],c=I.attr("participant",e),d=u?c:s,f=u?void 0:c,p=u?!1:I.child("broadcast",e)&&s===Store.Conn.me,h="invis"===I.attr("web",e),g=I.attr("notify",e)||"",m=parseInt(I.attr("status",e))||0,v=[],b=I.child("broadcast",e),y="true"===I.attr("star",e);if("broadcast"!==a){switch(t){case"fresh":r=1;break;default:r=m>=-1&&4>=m?m:1}if(_.isArray(b)){var w,E=b.length;for(w=0;E>w;w++){var S=b[w],k=I.attr("jid",S);"to"===I.tag(S)&&k&&v.push(k)}}var T,$=[];switch(I.attr("type",e)){case"text":var O=I.dataStr(I.child("body",e))||"";T={id:i,body:O,type:"chat",t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,broadcast:p,recipients:v,star:y};var A=I.child("media",e);A&&"url"===I.attr("type",A)&&_.merge(T,{subtype:"url",title:I.attr("title",A),description:I.attr("description",A),canonicalUrl:I.attr("canonical-url",A),matchedText:I.attr("matched-text",A),thumbnail:C(A)}),$=[!i,!o,!d,!a];break;case"media":var R,N,j,P,L,D,M=I.child("media",e),U=I.attr("type",M),B=I.attr("media_key",M);if("retry"===I.attr("reason",M))return;switch(U){case"image":case"video":case"document":var F=parseInt(I.attr("page_count",M),10)||0,Y=I.attr("mimetype",M);D=I.attr("caption",M),R=C(M),N=I.attr("url",M),N=_.isString(N)&&N.indexOf("/u/")>0?void 0:N,j=I.attr("filehash",M),P=parseInt(I.attr("size",M),10)||0,L=I.attr("seconds",M),T={id:i,body:R,type:U,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:N,duration:L,broadcast:p,recipients:v,filehash:j,size:P,caption:D,mediaKey:B,star:y,pageCount:F,mimetype:Y},$=[!i,!o,!d,!a];break;case"location":var W=I.attr("latitude",M),G=I.attr("longitude",M),q=I.attr("name",M);R=C(M),N=I.attr("url",M),T={id:i,body:R,type:U,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:N,loc:q,lat:W,lng:G,broadcast:p,recipients:v,star:y},$=[!i,!o,!d,!a,!W||!G];break;case"audio":var H="live"===I.attr("origin",M)?"ptt":U;N=I.attr("url",M),N=_.isString(N)&&N.indexOf("/u/")>0?void 0:N,j=I.attr("filehash",M),P=parseInt(I.attr("size",M),10)||0,L=I.attr("seconds",M),T={id:i,type:H,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,clientUrl:N,duration:L,broadcast:p,recipients:v,filehash:j,size:P,star:y},$=[!i,!o,!d,!a];break;case"vcard":var K=I.child("vcard",M),V=I.dataStr(K),Q=I.attr("name",K);T={id:i,body:V,type:U,subtype:Q,t:o,notifyName:g,from:d,to:a,self:n,author:f,participant:c,invis:h,ack:r,broadcast:p,recipients:v,star:y},$=[!i,!o,!d,!a,!V,!Q];break;default:x.error("wap:parseMsgMessage unknown media type: "+I.toString(e),e)()}break;default:x.error("wap:parseMsgMessage unknown message type: "+I.toString(e),e)()}return l($,T)}}}function C(e){return"raw"===I.attr("encoding",e)?Y.isByteBuffer(I.children(e))?I.children(e).toBase64():"":I.dataStr(e)}function k(e){if("groups_v2"===I.tag(e)){var t,n=parseInt(I.attr("t",e),10)||0,r=I.attr("id",e),i=I.attr("jid",e),o="invis"===I.attr("web",e),a="true"===I.attr("owner",e),s=I.attr("type",e),u=I.attr("author",e),c=I.children(e),d=I.attr("participant",e),f=[];
switch(s){case"create":t=I.attr("subject",e);break;case"subject":t=I.attr("subject",e);break;case"picture":t=I.attr("picture",e)}if(_.isArray(c)){var p,h=c.length;for(p=0;h>p;p++){var g=c[p],m=I.attr("jid",g);"participant"===I.tag(g)&&m&&f.push(m)}}var v={t:n,id:r,to:a?i:Store.Conn.me,from:a?Store.Conn.me:i,author:u,participant:d,body:t?t.toString():void 0,type:"gp2",subtype:s,invis:o,recipients:f},b=[!r,!n,"subject"!==s&&"add"!==s&&"remove"!==s&&"leave"!==s&&"picture"!==s&&"modify"!==s&&"create"!==s&&"delete"!==s&&"promote"!==s&&"demote"!==s,"subject"===s&&!t,("add"===s||"remove"===s||"leave"===s||"promote"===s||"demote"===s||"modify"===s)&&0===f.length,!i,"string"==typeof i&&"g.us"!==i.split("@")[1]];return l(b,v)}}function T(e){if("broadcast"===I.tag(e)){var t,n,r=I.attr("type",e),i=I.attr("id",e),o=parseInt(I.attr("t",e),10)||0,a=I.attr("jid",e),s="true"===I.attr("owner",e),u=I.attr("participant",e);switch(r){case"create":t=parseInt(I.attr("count",e),10)||0;break;case"add":case"remove":n=I.child("participant",e),n&&(t=I.attr("jid",n))}var c={id:i,t:o,participant:u,type:"broadcast_notification",subtype:r,from:s?Store.Conn.me:a,to:s?a:Store.Conn.me,body:t?t.toString():void 0},d=[!i,!o,!a,"string"==typeof a&&"broadcast"!==a.split("@")[1],"create"!==r&&"add"!==r&&"remove"!==r,("add"===r||"remove"===r)&&2!==t.split("@").length];return l(d,c)}}function $(e){if("notification"===I.tag(e)){var t=I.attr("id",e),n=parseInt(I.attr("t",e),10)||0,r=I.attr("jid",e),i=I.attr("participant",e),o="invis"===I.attr("web",e),a=I.dataStr(e),s="true"===I.attr("owner",e)?Store.Conn.me:r,u="true"===I.attr("owner",e)?r:Store.Conn.me,c={id:t,type:"notification",t:n,invis:o,from:s,to:u,participant:i,body:a},d=[!t,!n,!r,2!==r.split("@").length];return l(d,c)}}function O(e,t,n){return new L["default"](function(r,i){var o=F.tag(),s=a(r),c=["participant",{jid:n},void 0],l=["group",{id:o,jid:t,type:e,author:Store.Conn.me},[c]],d=u("set",[l]);F.send({tag:o,data:R.write(d),clientCacheable:!0,onSend:s,onDrop:a(i),binaryOpts:{debugString:"action,group,participant,"+[e,t,n].join(","),debugObj:d,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})}function A(e,t,n,r){return new L["default"](function(i,o){var s,c;switch(e){case"clear":s=(!!r).toString();break;case"spam":c=(!!r).toString()}var l=u("set",[["chat",{type:e,jid:t,index:n?n.id:void 0,owner:n?n.fromMe.toString():void 0,participant:n?n.participant:void 0,star:"undefined"!=typeof s?s:void 0,spam:"undefined"!=typeof c?c:void 0},void 0]]);F.send({data:R.write(l),clientCacheable:!0,onSend:a(i),onDrop:a(o),binaryOpts:{debugString:"action,chat,"+[e,n,r].join(),debugObj:l,metric:Q.CHAT,ackRequest:!0}})})}var R,I,N=n(37),j=r(N),P=n(3),L=r(P),D=n(24),M=r(D),x=n(1),U=n(12),B=n(11),F=n(14),Y=n(7),W=n(38),G=n(21),q=n(41),H=n(63),K=n(60),V=n(17),Q={DEBUG_LOG:1,QUERY_RESUME:2,QUERY_RECEIPT:3,QUERY_MEDIA:4,QUERY_CHAT:5,QUERY_CONTACTS:6,QUERY_MESSAGES:7,PRESENCE:8,PRESENCE_SUBSCRIBE:9,GROUP:10,READ:11,CHAT:12,RECEIVED:13,PIC:14,STATUS:15,MESSAGE:16,QUERY_ACTIONS:17,BLOCK:18,QUERY_GROUP:19,QUERY_PREVIEW:20,QUERY_EMOJI:21,QUERY_MESSAGE_INFO:22,SPAM:23,QUERY_SEARCH:24},z=0,J=0,X=0,Z={"delete":function(){z=0,J=0},error2412:function(){o()},setSubProtocol:function(e){e?(R=new H(e),I=R.Node):(x.error("Wap:setSubProtocol unknown "+e)(),U.upload("08_unknown_version",!0)["finally"](function(){return V.hardRefresh()}))},handle:function(e,t,n){var r,i,o,a,s,u,c,l,p=R.read(e);switch(I.tag(p)){case"response":if(0===n.indexOf("preempt"))switch(I.attr("type",p)){case"chat":if(x.logColor("green","bin-recv: "+n+",response,chat",p)(),i=I.children(p)||[],_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)c=h(i[o]),c&&r.push(c);Store.Chat.handle([{cmd:"preempt",response:r}],t)}break;case"contacts":if(x.logColor("green","bin-recv: "+n+",response,contact",p)(),i=I.children(p),_.isArray(i)){for(a=i.length,r=[],o=0;a>o;o++)s=g(i[o]),s&&r.push(s);Store.Contact.handle([{cmd:"preempt",checksum:I.attr("checksum",p),response:r}],t)}break;default:x.error("Wap:handle unknown response type: "+I.toString(p,!0),p)()}else x.error("Wap:handle non-preemptive response: "+I.toString(p,!0),p)();break;case"action":var S=d(p),C=f(I.children(p)),k=(0,j["default"])(C);if(_.isArray(k)){var T,$,O,A,N=k.length;if(0===N&&"last"===S.add)Store.Msg.handle([{recent:!0}],t);else for(o=0;N>o;o++){$=k[o],T=C[$];var P,L=T.length;switch($){case"msg":var D;switch(S.add){case"relay":case"update":D=E(T[0],"relay"),1!==L&&x.error("Wap:handle action msg relay length not 1",p)(),D?(x.logColor("green","bin-recv: "+[n,"action","msg",S.add,D.type,D.from,D.to,D.id].join(","),p)(),A=w(D),Store.Msg.handle([{meta:{add:S.add},chat:A,msg:D}],t)):x.error("Wap:handle action msg relay dropped",T[0])();break;case"last":for(x.logColor("green","bin-recv: "+[n,"action","msg","last",T.length].join(","),p)(),O=[],P=0;L>P;P++)D=E(T[P],"last"),D?O.push(D):x.error("Wap:handle action msg last dropped",T[P])();if(O.length>0){for(var M={recent:!0},U=0;U<O.length;U++)M[w(O[U])]=O[U];Store.Msg.handle([M],t)}else x.error("Wap:handle action msg last dropped to 0")();break;case"before":case"after":if(L>0){for(O=[],P=0;L>P;P++)D=E(T[P],S.add),D?O.push(D):x.error("Wap:handle action msg before/after dropped",T[P])();x.logColor("green","bin-recv: "+[n,"action","msg",S.add,O.length].join(","),p)(),O.length>0?(A=w(O[0]),Store.Msg.handle([{meta:{add:S.add},chat:A,msgs:O}],t)):x.error("Wap:handle action msg before/after droppped to 0")()}else x.error("Wap:handle action msg before/after 0 msgs")();break;default:x.error("Wap:handle action msg no meta.add",p)()}break;case"cmd":for(P=0;L>P;P++){var B=m(T[P]);if(B){var F=_.values(B).join(",");x.logColor("green","bin-recv: "+[n,"action","cmd",F].join(","),p)(),Store.Cmd.handle([B],t)}else x.error("Wap:handle action cmd invalid",p)()}break;case"bcUpdate":var Y=[];for(P=0;L>P;P++){var W=b(T[P]);W?Y.push(W):x.error("Wap:handle action bc update invalid",T[P])()}x.logColor("green","bin-recv: "+[n,"action","bcUpdate",Y.length].join(","),p)(),Y.length>0&&Store.GroupMetadata.handle(Y,t);break;case"ack":for(P=0;L>P;P++){var G=v(T[P]);G?(x.logColor("green","bin-recv: "+[n,"action","ack",G.to,G.id,G.ack].join(","),p)(),Store.Msg.handle([G],t)):x.error("Wap:handle action ack invalid",p)()}break;case"contact":for(u=[],P=0;L>P;P++)s=g(T[P]),s?u.push(s):x.error("Wap:handle action contact dropped",T[P])();if(x.logColor("green","bin-recv: "+[n,"action","contact",u.length,S.missing].join(","),p)(),u.length>0){var q=[u];(S.missing||S.checksum)&&q.push(S),Store.Contact.handle(q,t)}break;case"chat":for(l=[],P=0;L>P;P++)c=h(T[P]),c?l.push(c):x.error("Wap:handle action chat dropped",T[P])();x.logColor("green","bin-recv: "+[n,"action","chat",l.length].join(","),p)(),l.length>0&&Store.Chat.handle([l],t);break;case"battery":var H=y(T[0]);H?(x.logColor("green","bin-recv: "+[n,"action","battery",H.battery,H.plugged].join(","),p)(),Store.Conn.handle([H],t)):x.error("Wap:handle action battery dropped",T[0])();break;case"mute":for(l=[],P=0;L>P;P++)c=h(T[P]),c?l.push(c):x.error("Wap:handle action mute dropped",T[P])();x.logColor("green","bin-recv: "+[n,"action","mute",l.length].join(","),p)(),l.length>0&&Store.Mute.handle(l,t);break;default:x.error("Wap:handle action unknown "+$,p)()}}}break;default:x.errorVerbose("TODO "+I.toString(p,!0),p)()}return!0},requestDeviceUploadLogs:function(){var e;return new L["default"](function(t,n){if(X)return void t();e=++X;var r=u("debug",[["log",void 0,void 0]]),i=a(t);i.drop=!0,F.send({data:R.write(r),clientCacheable:!0,onSend:i,onDrop:n,binaryOpts:{debugString:"debug,log",debugObj:r,metric:Q.DEBUG_LOG,ackRequest:!0}})})["finally"](function(){e===X&&(X=0)})},resyncMessages:function(e){return new W(function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,resume",r)(),"response"===I.tag(r)&&"resume"===I.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=h(i[o]);s&&n.push(s)}}t({checksum:I.attr("checksum",r),data:n})},i=e.map(function(e){var t={jid:e.wid,index:e.id,owner:e.fromMe,participant:e.participant,archive:(!!e.archive).toString(),spam:(!e.notSpam).toString()};return e.mute&&(t.mute=e.mute.toString()),e.active&&(t.active="true"),G.isGroup(e.wid)&&(t.read_only=(!!e.isReadOnly).toString()),e.modifyTag&&(t.modify_tag=e.modifyTag.toString()),e.unreadCount&&(t.count=e.unreadCount.toString()),["last",t,void 0]}),o=c({type:"resume"},i);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,resume",debugObj:o,metric:Q.QUERY_RESUME,ackRequest:!1}})})},resyncReceipts:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,receipt",r)(),"response"===I.tag(r)&&"receipt"===I.attr("type",r)&&_.isArray(i)){var o,a,s,u=i.length;for(o=0;u>o;o++){a=i[o],s=I.children(a);var c=I.attr("jid",a),l=I.attr("t",a);if("receipt"===I.tag(a)&&c&&l&&_.isArray(s)){var d,f=[],p=s.length;for(d=0;p>d;d++){var h=s[d];if("item"===I.tag(h)){var g=I.attr("index",h),m="true"===I.attr("owner",h),v=parseInt(I.attr("status",h),10)||0,b=I.attr("participant",h);g&&0!==v&&4>=v&&f.push([g,m,b,v])}}f.length>0&&n.push({id:c,t:parseInt(l,10),acks:f})}}}t(n)},i=e.map(function(e){return["last",{jid:e.remote,index:e.id,owner:e.fromMe.toString(),participant:e.participant,t:e.t.toString()},void 0]}),o=c({type:"receipt"},i);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,receipt",debugObj:o,metric:Q.QUERY_RECEIPT,ackRequest:!1}})})},queryReceivedActions:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,actions",r)(),"response"===I.tag(r)&&"action"===I.attr("type",r))if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=i[o],u=I.attr("id",s),c=parseInt(I.attr("code",s),10)||0;"item"===I.tag(s)&&u&&0!==c&&n.push({id:u,code:c})}}else"true"===I.attr("replaced",r)&&(n="replaced");t(n)},i=e.map(function(e){return["item",{id:e},void 0]}),o=c({type:"action"},i);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,actions",debugObj:o,metric:Q.QUERY_ACTIONS,ackRequest:!1}})})},recentEmojiQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,emoji",r)(),"response"===I.tag(r)&&"emoji"===I.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=i[o],u=I.attr("code",s),c=parseFloat(I.attr("value",s))||0;"item"===I.tag(s)&&u&&c&&!isNaN(c)&&n.push({"char":u,weight:c})}}t(n)},i=_.isArray(e)?e.map(function(e){return["item",{code:e["char"],value:e.weight.toString()},void 0]}):void 0,o=c({type:"emoji"},i);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,emoji",debugObj:o,metric:Q.QUERY_EMOJI,ackRequest:!1}})})},queryMsgInfo:function(e){function t(e){var t,n,r=[];if(_.isArray(e)){t=e.length;for(var i=0;t>i;i++)n=e[i],"item"===I.tag(n)&&I.attr("jid",n)&&I.attr("t",n)&&r.push({id:I.attr("jid",n),t:parseInt(I.attr("t",n),10)||0})}return r}return new L["default"](function(n,r){var i=function(e){var r=R.read(e),i={played:[],playedRemaining:0,read:[],readRemaining:0,delivery:[],deliveryRemaining:0};if(x.logColor("green","bin-recv: response,msg,info",r)(),"response"===I.tag(r)&&"message_info"===I.attr("type",r)){var o=I.child("played",r),a=I.child("read",r),s=I.child("delivery",r),u=I.children(o),c=I.children(a),l=I.children(s),d=parseInt(I.attr("count",r),10)||0;i.played=t(u),i.read=t(c),i.delivery=t(l);var f=d-i.played.length,p=d-i.played.length-i.read.length,h=d-i.played.length-i.read.length-i.delivery.length;i.playedRemaining=0>f?0:f,i.readRemaining=0>p?0:p,i.deliveryRemaining=0>h?0:h}n(i)},o=c({type:"message_info",index:e.id,jid:e.remote},void 0);F.sendEphemeral({data:R.write(o),onSend:s(i,n),onDrop:a(r),binaryOpts:{debugString:["query,msg,info",e.id,e.remote,e.fromMe].join(),debugObj:o,metric:Q.QUERY_MESSAGE_INFO,ackRequest:!1}})})},changeSubject:function(e,t){return new L["default"](function(n,r){var i=F.tag(),o=a(n);o.tag=i;var s=["group",{id:i,jid:e,type:"subject",author:Store.Conn.me,subject:t},void 0],c=u("set",[s]);F.send({data:R.write(c),clientCacheable:!0,onSend:o,onDrop:a(r),binaryOpts:{debugString:"action,group,subject",debugObj:c,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},createGroup:function(e,t){return new L["default"](function(n,r){var i=F.tag(),o=a(n);o.tag=i;var s=t.map(function(e){return["participant",{jid:e},void 0]});x.log("create group tag",i)();var c=["group",{id:i,type:"create",author:Store.Conn.me,subject:e},s],l=u("set",[c]);F.send({data:R.write(l),clientCacheable:!0,onSend:o,onDrop:a(r),binaryOpts:{debugString:"action,group,create",debugObj:l,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},leaveGroup:function(e){return new L["default"](function(t,n){var r=F.tag(),i=a(t);i.tag=r;var o=["group",{id:r,jid:e,type:"leave",author:Store.Conn.me},void 0],s=u("set",[o]);F.send({data:R.write(s),clientCacheable:!0,onSend:i,onDrop:a(n),binaryOpts:{debugString:"action,group,delete",debugObj:s,metric:Q.GROUP,ackRequest:!1,expires:moment().unix()}})})},addParticipant:function(e,t){return O("add",e,t)},removeParticipant:function(e,t){return O("remove",e,t)},promoteParticipant:function(e,t){return O("promote",e,t)},requestMediaReupload:function(e){return new L["default"](function(t,n){var r=e.id,i=function(e){var n,r=R.read(e);if(x.logColor("green","bin-recv: response,media",r)(),"response"===I.tag(r)&&"media"===I.attr("type",r)){var i=parseInt(I.attr("code",r))||400,o=I.attr("url",r);i>=500&&502!==i?(x.error("wap:requestMediaReupload:error "+i)(),n={status:i}):200===i&&o?n={status:200,url:o,mediaKey:I.attr("media_key",r),refKey:I.attr("ref_key",r)}:200!==i||o?(x.error("wap:requestMediaReupload:error "+i)(),n={status:i}):n={status:400}}else x.error("wap:requestMediaReupload:malformed")(),n={status:400};t(n)},o=r,u=c({type:"media",index:o.id,jid:o.remote,owner:o.fromMe.toString(),participant:o.participant},void 0);F.sendEphemeral({data:R.write(u),onSend:s(i,t),onDrop:a(n),binaryOpts:{debugString:"query,media",debugObj:u,metric:Q.QUERY_MEDIA,ackRequest:!1}})})},sendConversationSeen:function(e,t,n){return new L["default"](function(r,i){var o=u("set",[["read",{jid:e,index:t?t.id:void 0,owner:t?t.fromMe.toString():void 0,participant:t?t.participant:void 0,count:n&&t?n.toString():void 0},void 0]]);F.send({data:R.write(o),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,read,"+[t,n].join(),debugObj:o,metric:Q.READ,ackRequest:!0}})})},sendConversationUnseen:function(e,t){return this.sendConversationSeen(e,t,-2)},sendConversationClear:function(e,t,n){return A("clear",e,t,n)},sendConversationDelete:function(e,t){return A("delete",e,t)},sendConversationArchive:function(e,t,n){return A(t?"archive":"unarchive",e,n)},sendConversationNotSpam:function(e){return A("spam",e,void 0,!1)},sendConversationMute:function(e,t,n){return new L["default"](function(r,i){var o=t?t.toString():void 0,s=n?n.toString():void 0,c=u("set",[["chat",{type:"mute",mute:o,previous:s,jid:e},void 0]]);F.send({data:R.write(c),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,chat,"+e+", "+(o?"mute,"+o:"unmute"),debugObj:c,metric:Q.CHAT,ackRequest:!0}})})},sendMessagePlayed:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["received",{type:"played",index:e.id,from:e.remote,participant:e.participant},void 0]]);F.send({data:R.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,played,"+e.toString(),debugObj:i,metric:Q.RECEIVED,ackRequest:!0}})})},sendMessageDelete:function(e,t,n){return new L["default"](function(r,i){var o=t.map(function(e){return["item",{index:e.id,owner:e.fromMe.toString(),participant:e.participant},void 0]}),s=u("set",[["chat",{type:"clear",jid:e,media:n.toString()},o]]);F.send({data:R.write(s),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,msgs,delete,"+[e,n,t.length].join(),debugObj:s,metric:Q.CHAT,ackRequest:!0}})})},sendMessageStarred:function(e,t,n){return new L["default"](function(r,i){var o=t.map(function(e){return["item",{index:e.id,owner:e.fromMe.toString(),participant:e.participant},void 0]}),s=u("set",[["chat",{type:n?"star":"unstar",jid:e},o]]);F.send({data:R.write(s),clientCacheable:!0,onSend:a(r),onDrop:a(i),binaryOpts:{debugString:"action,msgs,star,"+[e,n,t.length].join(),debugObj:s,metrics:Q.CHAT,ackRequest:!0}})})},sendUnstarAll:function(){return new L["default"](function(e,t){var n=u("set",[["chat",{type:"unstar"},void 0]]);F.send({data:R.write(n),clientCacheable:!0,onSend:a(e),onDrop:a(t),binaryOpts:{debugString:"action,unstar,all",debugObj:n,metrics:Q.CHAT,ackRequest:!0,expires:moment().unix()}})})},profilePicFindThumbFromPhone:function(e,t){return new L["default"](function(n,r){var i=function(i){var o=R.read(i);("response"!==I.tag(o)||"preview"!==I.attr("type",o))&&r();var a=I.children(o),s=a&&a[0];if(s||r(),"missing"===I.attr("type",s))n({id:e,tag:void 0,raw:void 0});else{var u,c=I.attr("id",s);if(t&&c===t.tag&&t.raw)u=t.raw;else{var l=I.children(s);u=l?l.toBase64():void 0}n({id:e,tag:c,raw:u})}},o={type:"preview",jid:e};t&&t.tag&&(o.id=t.tag);var u=c(o,[]);F.sendEphemeral({data:R.write(u),onSend:s(i,n),onDrop:a(r),binaryOpts:{debugString:"query,thumb,"+e,debugObj:u,metric:Q.QUERY_PREVIEW,ackRequest:!1}})})},groupMetadataFindFromPhone:function(e,t){return new L["default"](function(t,n){var r=function(n){var r=R.read(n);if("response"!==I.tag(r)||"group"!==I.attr("type",r))return void t({status:"error",info:"bad format: response incorrect"});var i=I.children(r),o=i&&i[0];if(!o)return void t({status:"error",info:"bad format: no group node"});if("missing"===I.attr("type"))return void t({status:"missing"});var a=_.map(I.children(o),function(e){return{id:I.attr("jid",e),isAdmin:"admin"===I.attr("type",e)}});t({status:"ok",data:{id:e,owner:I.attr("creator",o),creation:parseInt(I.attr("create",o),10)||void 0,participants:a,stale:!1}})},i=c({type:"group",jid:e},[]);F.sendEphemeral({data:R.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,group,"+e,debugObj:i,metric:Q.QUERY_GROUP,ackRequest:!1}})})},sendPresenceUpdate:function(e){return["available","unavailable"].indexOf(e)>-1?new L["default"](function(t,n){var r=a(t),i=u("set",[["presence",{type:e},void 0]]),o={data:R.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,presence,"+e,debugObj:i,metric:Q.PRESENCE,available:"available"===e,ackRequest:"available"===e}};"available"===e?F.sendEphemeral(o):F.sendEphemeralIgnore(o)}):void 0},sendChatstateUpdate:function(e,t){return["composing","paused","recording"].indexOf(e)>-1?new L["default"](function(n,r){var i=n,o=u("set",[["presence",{type:e,to:t},void 0]],!0);F.sendEphemeralIgnore({data:R.write(o),onSend:i,onDrop:r,binaryOpts:{debugString:"action,chatstate,"+e,debugObj:o,metric:Q.PRESENCE,skipOffline:!0,ackRequest:!1}},!0)}):void 0},sendSetPicture:function(e,t,n){return new L["default"](function(r,i){var o=q.parseDataURL(t).data,s=q.parseDataURL(n).data,c=Y.fromBase64(o,!1),l=Y.fromBase64(s,!1),d=F.tag(),f=a(r);f.tag=d;var p=["picture",{id:d,jid:e,type:"set"},[["image",void 0,l],["preview",void 0,c]]],h=u("set",[p]);F.send({data:R.write(h),clientCacheable:!0,onSend:f,onDrop:a(i),binaryOpts:{debugString:"action,set_pic,"+e,debugObj:h,metric:Q.PIC,ackRequest:!1,expires:moment().unix()}})})},deletePicture:function(e){return new L["default"](function(t,n){var r=F.tag(),i=a(t);i.tag=r;var o=["picture",{id:r,jid:e,type:"delete"},void 0],s=u("set",[o]);F.send({data:R.write(s),clientCacheable:!0,onSend:i,onDrop:a(n),binaryOpts:{debugString:"action,delete_pic,"+e,debugObj:s,metric:Q.PIC,ackRequest:!1,expires:moment().unix()}})})},sendSetStatus:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["status",void 0,e]]);F.send({data:R.write(i),clientCacheable:!0,onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,status,set",debugObj:i,metric:Q.STATUS,ackRequest:!1,expires:moment().unix()}})})},sendSetBlock:function(e,t){return new L["default"](function(n,r){var i=t.map(function(e){return["user",{jid:e.jid},void 0]}),o=["block",{type:e?"add":"remove"},i],s=u("set",[o]);F.send({data:R.write(s),clientCacheable:!0,onSend:a(n),onDrop:a(r),binaryOpts:{debugString:"action,block,"+e+","+_.pluck(t,"jid").join(","),debugObj:s,metric:Q.BLOCK,ackRequest:!1,expires:moment().unix()}})})},sendSpamReport:function(e){return new L["default"](function(t,n){var r=u("set",[["spam",{jid:e},void 0]]);F.send({data:R.write(r),clientCacheable:!0,onSend:a(t),onDrop:a(n),binaryOpts:{debugString:"action,spam,"+e,debugObj:r,metric:Q.SPAM,ackRequest:!1,expires:moment().unix()}})})},chatFindQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if("response"===I.tag(r)&&"chat"===I.attr("type",r))if("true"===I.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=h(i[o]);s&&n.push(s)}}t(n)},i={type:"chat"};"boolean"==typeof e&&e?i.kind="retry":"string"==typeof e&&(i.jid=e);var o=c(i,void 0);F.sendEphemeral({data:R.write(o),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:["query","chat",e].join(),debugObj:o,metric:Q.QUERY_CHAT,ackRequest:!1}})})},contactFindQuery:function(e){return new L["default"](function(t,n){var r=function(e){var n=[],r=R.read(e),i=I.children(r);if("response"===I.tag(r)&&"contacts"===I.attr("type",r))if("true"===I.attr("duplicate",r))n="preempted";else if(_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=g(i[o]);s&&n.push(s)}}t({checksum:I.attr("checksum",r),data:n})},i=c({type:"contacts",kind:e?"retry":void 0},void 0);F.send({data:R.write(i),onSend:s(r,t),onDrop:a(n),binaryOpts:{debugString:"query,contacts, "+e,debugObj:i,metric:Q.QUERY_CONTACTS,ackRequest:!1}})})},msgCreateRecord:function(e,t){var n=this;return new L["default"](function(r,i){var o,s,c=e.id;if("chat"===e.type){var l=[["body",void 0,e.body]];"url"===e.subtype&&l.push(["media",{type:"url",title:e.title,description:e.description,"canonical-url":e.canonicalUrl,"matched-text":e.matchedText,encoding:"raw"},e.thumbnail?Y.fromBase64(e.thumbnail,!1):void 0]),s=L["default"].cast(["message",{type:"text",to:e.to,id:e.id,t:e.t.toString()},l])}else if("location"===e.type)o=e.body?Y.fromBase64(e.body,!1):void 0,s=L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"location",latitude:e.lat||void 0,longitude:e.lng||void 0,name:e.loc&&e.url?e.loc:void 0,url:e.loc&&e.url?e.url:void 0,encoding:e.body?"raw":void 0},o]]]);else if("vcard"===e.type){var d=["vcard",{name:e.subtype},e.body];s=L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{type:"vcard"},[d]]]])}else{o=e.body?Y.fromBase64(e.body,!1):void 0;var f="ptt"===e.type?"audio":e.type;s=(t?n.sendMedia(e.avparams):L["default"].resolve({status:200,type:f})).then(function(t){return 200===t.status?L["default"].cast(["message",{type:"media",to:e.to,id:e.id,t:e.t.toString()},[["media",{encoding:e.body?"raw":void 0,origin:"ptt"===e.type?"live":void 0,seconds:"ptt"===e.type&&e.duration?e.duration.toString():void 0,type:t.type,mimetype:e.mimetype||void 0,size:e.size?e.size.toString():void 0,filehash:t.filehash,url:t.url,duration:t.duration?t.duration.toString():void 0,vcodec:t.vcodec||void 0,width:t.width?t.width.toString():void 0,height:t.height?t.height.toString():void 0,fps:t.fps?t.fps.toString():void 0,vbitrate:t.vbitrate?t.vbitrate.toString():void 0,acodec:t.acodec||void 0,asampfreq:t.asampfreq?t.asampfreq.toString():void 0,asampfmt:t.asampfmt||void 0,abitrate:t.abitrate?t.abitrate.toString():void 0,caption:"video"!==e.type&&"image"!==e.type&&"document"!==e.type||!e.caption?void 0:e.caption,page_count:"number"!=typeof e.pageCount||isNaN(e.pageCount)?void 0:e.pageCount.toString()},o]]]):(x.error("wap:msgCreateRecord:sendMedia error "+t.status)(),L["default"].reject())})["catch"](function(){return x.error("wap:msgCreateRecord:sendMedia dropped")(),L["default"].reject()})}s.then(function(t){var n=u("relay",[t]),o=a(r);o.tag=c,o.meta={type:"message",key:new K(e.from,e.to,e.id)},F.send({data:R.write(n),onSend:o,onDrop:a(i),binaryOpts:{debugString:["action","message",e.type,e.subtype].join(),debugObj:n,metric:Q.MESSAGE,ackRequest:!1}})})["catch"](function(){x.error("wap:msgCreateRecord mPromise error")(),i()})})},msgFindQuery:function(e,t){return new L["default"](function(n,r){var i,o=function(e){var t=[],r=R.read(e),i=I.children(r);if(x.logColor("green","bin-recv: response,msg",r)(),"response"===I.tag(r)&&"message"===I.attr("type",r)&&_.isArray(i)){var o,a=i.length;for(o=0;a>o;o++){var s=E(i[o],"response");s&&t.push(s)}}n(t)},u="";switch(e){case"after":t.id||(e="before");case"before":i={type:"message",kind:e,jid:t.remote,count:t.count.toString(),index:t.id,owner:"undefined"==typeof t.fromMe?void 0:t.fromMe.toString(),participant:t.participant},u=[t.toString(),t.count].join();break;case"search":i={type:"search",search:t},u="search,"+t;break;case"star":i={type:"star"},u="starred"}var l=c(i,void 0);F.sendEphemeral({data:R.write(l),onSend:s(o,n),onDrop:a(r),binaryOpts:{debugString:"query,message,"+u,debugObj:l,metric:Q.QUERY_SEARCH,ackRequest:!1}})})},presenceSubscribe:function(e){return new L["default"](function(t,n){var r=a(t),i=u("set",[["presence",{type:"subscribe",to:e},void 0]]);F.sendEphemeral({data:R.write(i),onSend:r,onDrop:a(n),binaryOpts:{debugString:"action,presence,subscribe,"+e,debugObj:i,metric:Q.PRESENCE_SUBSCRIBE,ackRequest:!0}})})}};e.exports=Z},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,n){function r(){for(var e in l)this[e]=l[e]}function i(e){this.all=new r,e&&this.set(e),this._validate(),"function"==typeof n&&n.apply(this,arguments)}function u(){}if("string"!=typeof e)throw new TypeError("TypeHash.define given bad name "+this.name);var l={},f=[],p={$className:{value:e},$requiredProps:{value:f},$defaultValues:{value:l}};for(var h in t){var g=t[h];if(("string"==typeof g||"function"==typeof g)&&(g={type:g}),!g||"object"!==("undefined"==typeof g?"undefined":(0,d["default"])(g)))throw new Error(e+" specified with non-object "+g);l[h]=g["default"],g.required&&f.push(h),p[h]={enumerable:!0,get:a(h,g),set:s(h,g)}}if(n)if("object"===("undefined"==typeof n?"undefined":(0,d["default"])(n)))u.prototype=(0,c["default"])(o.prototype,n),i.prototype=(0,c["default"])(u.prototype,p);else if(n.prototype instanceof o)i.prototype=(0,c["default"])(n.prototype,p);else{var m=o.prototype;for(var _ in m)p[_]=m[_];i.prototype=(0,c["default"])(n.prototype,p)}else i.prototype=(0,c["default"])(o.prototype,p);return i}function o(){}function a(e,t){return t.get||function(){return this.all[e]}}function s(e,t){var n=t.type||"any",r=!!t.required,i=!!t.allowNull,o=t.set,a=!!t.get;return function(t){if(a||t!==this.all[e]){if(void 0===t){if(r)throw new TypeError(this.$className+"."+e+" may not be undefined")}else if(null===t){if(!i)throw new TypeError(this.$className+"."+e+" may not be null")}else if("function"==typeof n){if(!n(t))throw new TypeError(this.$className+"."+e+" type-validator fails "+t)}else if("any"!==n&&("undefined"==typeof t?"undefined":(0,d["default"])(t))!==n)throw new TypeError(this.$className+"."+e+" requires type "+n+", got "+t);o&&o.call(this,t),a||(this.all[e]=t)}}}var u=n(113),c=r(u),l=n(24),d=r(l);o.prototype={set:function(e){for(var t in e)this[t]=e[t]},_validate:function(){for(var e=this.$requiredProps,t=this.all,n=0;n<e.length;n++){var r=e[n];if(void 0===t[r])throw new TypeError(this.$className+"."+r+" is undefined")}}},o.define=i,e.exports=o},function(e,t,n){e.exports={"default":n(398),__esModule:!0}},function(e,t,n){e.exports={"default":n(403),__esModule:!0}},,function(e,t,n){n(431),e.exports=n(29).Object.assign},function(e,t,n){var r=n(16);e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){n(432),e.exports=n(29).Object.getPrototypeOf},function(e,t,n){n(433),e.exports=n(29).Object.keys},function(e,t,n){n(434),n(436),n(438),n(435),e.exports=n(29).Promise},function(e,t,n){n(437),e.exports=n(29).Symbol},function(e,t,n){var r=n(16),i=n(121),o=n(176);e.exports=n(85)(function(){var e=Object.assign,t={},n={},r=Symbol(),i="abcdefghijklmnopqrst";return t[r]=7,i.split("").forEach(function(e){n[e]=e}),7!=e({},t)[r]||Object.keys(e({},n)).join("")!=i})?function(e,t){for(var n=i(e),a=arguments,s=a.length,u=1,c=r.getKeys,l=r.getSymbols,d=r.isEnum;s>u;)for(var f,p=o(a[u++]),h=l?c(p).concat(l(p)):c(p),g=h.length,m=0;g>m;)d.call(p,f=h[m++])&&(n[f]=p[f]);return n}:Object.assign},function(e,t,n){var r=n(86),i=n(31).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(16);e.exports=function(e){var t=r.getKeys(e),n=r.getSymbols;if(n)for(var i,o=n(e),a=r.isEnum,s=0;o.length>s;)a.call(e,i=o[s++])&&t.push(i);return t}},function(e,t,n){var r=n(84),i=n(413),o=n(411),a=n(54),s=n(427),u=n(429);e.exports=function(e,t,n,c){var l,d,f,p=u(e),h=r(n,c,t?2:1),g=0;if("function"!=typeof p)throw TypeError(e+" is not iterable!");if(o(p))for(l=s(e.length);l>g;g++)t?h(a(d=e[g])[0],d[1]):h(e[g]);else for(f=p.call(e);!(d=f.next()).done;)i(f,h,d.value,t)}},function(e,t,n){var r={}.toString,i=n(89),o=n(16).getNames,a="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(e){try{return o(e)}catch(t){return a.slice()}};e.exports.get=function(e){return a&&"[object Window]"==r.call(e)?s(e):o(i(e))}},function(e,t,n){e.exports=n(31).document&&document.documentElement},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(65),i=n(25)("iterator");e.exports=function(e){return(r.Array||Array.prototype[i])===e}},function(e,t,n){var r=n(64);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(54);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(o){var a=e["return"];throw void 0!==a&&r(a.call(e)),o}}},function(e,t,n){"use strict";var r=n(16),i={};n(117)(i,n(25)("iterator"),function(){return this}),e.exports=function(e,t,o){e.prototype=r.create(i,{next:n(119)(1,o)}),n(88)(e,t+" Iterator")}},function(e,t,n){var r=n(25)("iterator"),i=!1;try{var o=[7][r]();o["return"]=function(){i=!0},Array.from(o,function(){throw 2})}catch(a){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){n=!0},o[r]=function(){return a},e(o)}catch(s){}return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(16),i=n(89);e.exports=function(e,t){for(var n,o=i(e),a=r.getKeys(o),s=a.length,u=0;s>u;)if(o[n=a[u++]]===t)return n}},function(e,t,n){var r,i,o,a=n(31),s=n(426).set,u=a.MutationObserver||a.WebKitMutationObserver,c=a.process,l="process"==n(64)(c),d=function(){var e,t;for(l&&(e=c.domain)&&(c.domain=null,e.exit());r;)t=r.domain,t&&t.enter(),r.fn.call(),t&&t.exit(),r=r.next;i=void 0,e&&e.enter()};if(l)o=function(){c.nextTick(d)};else if(u){var f=1,p=document.createTextNode("");new u(d).observe(p,{characterData:!0}),o=function(){p.data=f=-f}}else o=function(){s.call(a,d)};e.exports=function(e){var t={fn:e,next:void 0,domain:l&&c.domain};i&&(i.next=t),r||(r=t,o()),i=t}},function(e,t,n){var r=n(120);e.exports=function(e,t){for(var n in t)r(e,n,t[n]);return e}},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},function(e,t,n){var r=n(16).getDesc,i=n(86),o=n(54),a=function(e,t){if(o(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){
try{i=n(84)(Function.call,r(Object.prototype,"__proto__").set,2),i(e,[]),t=!(e instanceof Array)}catch(o){t=!0}return function(e,n){return a(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:a}},function(e,t,n){var r=n(54),i=n(114),o=n(25)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||void 0==(n=r(a)[o])?t:i(n)}},function(e,t,n){"use strict";var r=n(16),i=n(25)("species");e.exports=function(e){!n(87)||i in e||r.setDesc(e,i,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError(n+": use the 'new' operator!");return e}},function(e,t,n){var r=n(180),i=n(115);e.exports=function(e){return function(t,n){var o,a,s=String(i(t)),u=r(n),c=s.length;return 0>u||u>=c?e?"":void 0:(o=s.charCodeAt(u),55296>o||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?e?s.charAt(u):o:e?s.slice(u,u+2):(o-55296<<10)+(a-56320)+65536)}}},function(e,t,n){"use strict";var r,i,o,a=n(84),s=n(410),u=n(409),c=n(405),l=n(31),d=l.process,f=l.setImmediate,p=l.clearImmediate,h=l.MessageChannel,g=0,m={},_="onreadystatechange",v=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},b=function(e){v.call(e.data)};f&&p||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++g]=function(){s("function"==typeof e?e:Function(e),t)},r(g),g},p=function(e){delete m[e]},"process"==n(64)(d)?r=function(e){d.nextTick(a(v,e,1))}:h?(i=new h,o=i.port2,i.port1.onmessage=b,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):r=_ in c("script")?function(e){u.appendChild(c("script"))[_]=function(){u.removeChild(this),v.call(e)}}:function(e){setTimeout(a(v,e,1),0)}),e.exports={set:f,clear:p}},function(e,t,n){var r=n(180),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(175),i=n(25)("iterator"),o=n(65);e.exports=n(29).getIteratorMethod=function(e){return void 0!=e?e[i]||e["@@iterator"]||o[r(e)]:void 0}},function(e,t,n){"use strict";var r=n(428),i=n(416),o=n(65),a=n(89);n(177)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var r=n(61);r(r.S+r.F,"Object",{assign:n(404)})},function(e,t,n){var r=n(121);n(178)("getPrototypeOf",function(e){return function(t){return e(r(t))}})},function(e,t,n){var r=n(121);n(178)("keys",function(e){return function(t){return e(r(t))}})},function(e,t){},function(e,t,n){"use strict";var r,i=n(16),o=n(118),a=n(31),s=n(84),u=n(175),c=n(61),l=n(86),d=n(54),f=n(114),p=n(424),h=n(407),g=n(421).set,m=n(420),_=n(423),v=n(25)("species"),b=n(422),y=n(122)("record"),w=n(418),E="Promise",S=a.process,C="process"==u(S),k=a[E],T=function(e){var t=new k(function(){});return e&&(t.constructor=Object),k.resolve(t)===t},$=function(){function e(t){var n=new k(t);return g(n,e.prototype),n}var t=!1;try{if(t=k&&k.resolve&&T(),g(e,k),e.prototype=i.create(k.prototype,{constructor:{value:e}}),e.resolve(5).then(function(){})instanceof e||(t=!1),t&&n(87)){var r=!1;k.resolve(i.setDesc({},"then",{get:function(){r=!0}})),t=r}}catch(o){t=!1}return t}(),O=function(e){return l(e)&&($?"Promise"==u(e):y in e)},A=function(e,t){return o&&e===k&&t===r?!0:m(e,t)},R=function(e){var t=d(e)[v];return void 0!=t?t:e},I=function(e){var t;return l(e)&&"function"==typeof(t=e.then)?t:!1},N=function(e,t){if(!e.n){e.n=!0;var n=e.c;w(function(){for(var r=e.v,i=1==e.s,o=0,s=function(t){var n,o,a=i?t.ok:t.fail;try{a?(i||(e.h=!0),n=a===!0?r:a(r),n===t.P?t.rej(TypeError("Promise-chain cycle")):(o=I(n))?o.call(n,t.res,t.rej):t.res(n)):t.rej(r)}catch(s){t.rej(s)}};n.length>o;)s(n[o++]);n.length=0,e.n=!1,t&&setTimeout(function(){var t,n,i=e.p;j(i)&&(C?S.emit("unhandledRejection",r,i):(t=a.onunhandledrejection)?t({promise:i,reason:r}):(n=a.console)&&n.error&&n.error("Unhandled promise rejection",r)),e.a=void 0},1)})}},j=function(e){var t,n=e[y],r=n.a||n.c,i=0;if(n.h)return!1;for(;r.length>i;)if(t=r[i++],t.fail||!j(t.P))return!1;return!0},P=function(e){var t=this;t.d||(t.d=!0,t=t.r||t,t.v=e,t.s=2,t.a=t.c.slice(),N(t,!0))},L=function(e){var t,n=this;if(!n.d){n.d=!0,n=n.r||n;try{(t=I(e))?w(function(){var r={r:n,d:!1};try{t.call(e,s(L,r,1),s(P,r,1))}catch(i){P.call(r,i)}}):(n.v=e,n.s=1,N(n,!1))}catch(r){P.call({r:n,d:!1},r)}}};$||(k=function(e){f(e);var t={p:p(this,k,E),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};this[y]=t;try{e(s(L,t,1),s(P,t,1))}catch(n){P.call(t,n)}},n(419)(k.prototype,{then:function(e,t){var n={ok:"function"==typeof e?e:!0,fail:"function"==typeof t?t:!1},r=n.P=new(b(this,k))(function(e,t){n.res=e,n.rej=t});f(n.res),f(n.rej);var i=this[y];return i.c.push(n),i.a&&i.a.push(n),i.s&&N(i,!1),r},"catch":function(e){return this.then(void 0,e)}})),c(c.G+c.W+c.F*!$,{Promise:k}),n(88)(k,E),_(k),_(r=n(29)[E]),c(c.S+c.F*!$,E,{reject:function(e){return new this(function(t,n){n(e)})}}),c(c.S+c.F*(!$||T(!0)),E,{resolve:function(e){return O(e)&&A(e.constructor,this)?e:new this(function(t){t(e)})}}),c(c.S+c.F*!($&&n(415)(function(e){k.all(e)["catch"](function(){})})),E,{all:function(e){var t=R(this),n=[];return new t(function(r,o){h(e,!1,n.push,n);var a=n.length,s=Array(a);a?i.each.call(n,function(e,n){t.resolve(e).then(function(e){s[n]=e,--a||r(s)},o)}):r(s)})},race:function(e){var t=R(this);return new t(function(n,r){h(e,!1,function(e){t.resolve(e).then(n,r)})})}})},function(e,t,n){"use strict";var r=n(425)(!0);n(177)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var r=n(16),i=n(31),o=n(116),a=n(87),s=n(61),u=n(120),c=n(85),l=n(179),d=n(88),f=n(122),p=n(25),h=n(417),g=n(408),m=n(406),_=n(412),v=n(54),b=n(89),y=n(119),w=r.getDesc,E=r.setDesc,S=r.create,C=g.get,k=i.Symbol,T=i.JSON,$=T&&T.stringify,O=!1,A=p("_hidden"),R=r.isEnum,I=l("symbol-registry"),N=l("symbols"),j="function"==typeof k,P=Object.prototype,L=a&&c(function(){return 7!=S(E({},"a",{get:function(){return E(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=w(P,t);r&&delete P[t],E(e,t,n),r&&e!==P&&E(P,t,r)}:E,D=function(e){var t=N[e]=S(k.prototype);return t._k=e,a&&O&&L(P,e,{configurable:!0,set:function(t){o(this,A)&&o(this[A],e)&&(this[A][e]=!1),L(this,e,y(1,t))}}),t},M=function(e){return"symbol"==typeof e},x=function(e,t,n){return n&&o(N,t)?(n.enumerable?(o(e,A)&&e[A][t]&&(e[A][t]=!1),n=S(n,{enumerable:y(0,!1)})):(o(e,A)||E(e,A,y(1,{})),e[A][t]=!0),L(e,t,n)):E(e,t,n)},U=function(e,t){v(e);for(var n,r=m(t=b(t)),i=0,o=r.length;o>i;)x(e,n=r[i++],t[n]);return e},B=function(e,t){return void 0===t?S(e):U(S(e),t)},F=function(e){var t=R.call(this,e);return t||!o(this,e)||!o(N,e)||o(this,A)&&this[A][e]?t:!0},Y=function(e,t){var n=w(e=b(e),t);return!n||!o(N,t)||o(e,A)&&e[A][t]||(n.enumerable=!0),n},W=function(e){for(var t,n=C(b(e)),r=[],i=0;n.length>i;)o(N,t=n[i++])||t==A||r.push(t);return r},G=function(e){for(var t,n=C(b(e)),r=[],i=0;n.length>i;)o(N,t=n[i++])&&r.push(N[t]);return r},q=function(e){for(var t,n,r=[e],i=1,o=arguments;o.length>i;)r.push(o[i++]);return t=r[1],"function"==typeof t&&(n=t),(n||!_(t))&&(t=function(e,t){return n&&(t=n.call(this,e,t)),M(t)?void 0:t}),r[1]=t,$.apply(T,r)},H=c(function(){var e=k();return"[null]"!=$([e])||"{}"!=$({a:e})||"{}"!=$(Object(e))});j||(k=function(){if(M(this))throw TypeError("Symbol is not a constructor");return D(f(arguments.length>0?arguments[0]:void 0))},u(k.prototype,"toString",function(){return this._k}),M=function(e){return e instanceof k},r.create=B,r.isEnum=F,r.getDesc=Y,r.setDesc=x,r.setDescs=U,r.getNames=g.get=W,r.getSymbols=G,a&&!n(118)&&u(P,"propertyIsEnumerable",F,!0));var K={"for":function(e){return o(I,e+="")?I[e]:I[e]=k(e)},keyFor:function(e){return h(I,e)},useSetter:function(){O=!0},useSimple:function(){O=!1}};r.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(e){var t=p(e);K[e]=j?t:D(t)}),O=!0,s(s.G+s.W,{Symbol:k}),s(s.S,"Symbol",K),s(s.S+s.F*!j,"Object",{create:B,defineProperty:x,defineProperties:U,getOwnPropertyDescriptor:Y,getOwnPropertyNames:W,getOwnPropertySymbols:G}),T&&s(s.S+s.F*(!j||H),"JSON",{stringify:q}),d(k,"Symbol"),d(Math,"Math",!0),d(i.JSON,"JSON",!0)},function(e,t,n){n(430);var r=n(65);r.NodeList=r.HTMLCollection=r.Array},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n.p+"img/4caf7eaae50b9501fcb650e8f8e130e4.png"},function(e,t,n){e.exports=n.p+"img/b9f46c1cdda2922d18d9a3329f9e63f2.webp"},function(e,t,n){e.exports=n.p+"img/f734574f894b0185142f8cdf6b1c9718.jpg"},function(e,t,n){e.exports=n.p+"img/7e74568d78f1448fcd64393bb481dd62.png"},function(e,t,n){e.exports=n.p+"img/835e0489cae714e1315b7440f2dd0aee.webp"},function(e,t,n){e.exports=n.p+"img/a87049f3f29c9548629aa327b18bfdaf.jpg"},function(e,t,n){e.exports=n.p+"img/c7b6991aaa56b04b67f0ab451e26df68.webp"},function(e,t,n){e.exports=n.p+"img/92b8a80d57227e2f342bd57ccf6382d8.png"},function(e,t,n){e.exports=n.p+"img/bfb4ec026499f5b2d80e673a1a3a5bd7.png"},function(e,t,n){e.exports=n.p+"img/9466a20e6d2921a21ac7ab82419be157.jpg"},function(e,t,n){e.exports=n.p+"img/c98cc75f2aa905314d74375a975d2cf2.jpg"},,,,,function(e,t){e.exports={1:[[10],[["(...)(....)","$1-$2",[]],["(...)(...)(....)","($1) $2-$3",[]]]],7:[[10],[["(...)(..)(..)","$1-$2-$3",["[1-79]"]],["([3489]..)(...)(..)(..)","$1 $2-$3-$4",["[34689]"]],["(7..)(...)(....)","$1 $2 $3",["7"]]]],20:[[9,10],[["(.)(.{7,8})","$1 $2",["[23]"]],["(...)(...)(....)","$1 $2 $3",["1[012]|[89]00"]],["(..)(.{6,7})","$1 $2",["1[35]|[4-6]|[89][2-9]"]]]],27:[[9],[["(860)(...)(...)","$1 $2 $3",["860"]],["(..)(...)(....)","$1 $2 $3",["[1-79]|8(?:[0-47]|6[1-9])"]],["(..)(.{3,4})","$1 $2",["8[1-4]"]],["(..)(...)(.{2,3})","$1 $2 $3",["8[1-4]"]]]],30:[[10],[["([27].)(....)(....)","$1 $2 $3",["21|7"]],["(...)(...)(....)","$1 $2 $3",["2[2-9]1|[689]"]],["(2...)(.{6})","$1 $2",["2[2-9][02-9]"]]]],31:[[9],[["([1-578].)(...)(....)","$1 $2 $3",["1[035]|2[0346]|3[03568]|4[0356]|5[0358]|7|8[4578]"]],["([1-5]..)(...)(...)","$1 $2 $3",["1[16-8]|2[259]|3[124]|4[17-9]|5[124679]"]],["(6)(.{8})","$1 $2",["6[0-57-9]"]],["(66)(.{7})","$1 $2",["66"]],["(14)(.{3,4})","$1 $2",["14"]],["([89]0.)(.{4,7})","$1 $2",["80|9"]]]],32:[[9],[["(...)(..)(..)(..)","$1 $2 $3 $4",["4[6-9]"]],["(.)(...)(..)(..)","$1 $2 $3 $4",["[23]|4[23]|9[2-4]"]],["(..)(..)(..)(..)","$1 $2 $3 $4",["[156]|7[018]|8(?:0[1-9]|[1-79])"]],["(...)(..)(...)","$1 $2 $3",["(?:80|9)0"]]]],33:[[9],[["([1-79])(..)(..)(..)(..)","$1 $2 $3 $4 $5",["[1-79]"]],["(1..)(...)","$1 $2",["11"]],["(8..)(..)(..)(..)","$1 $2 $3 $4",["8"]]]],34:[[9],[["([89]00)(...)(...)","$1 $2 $3",["[89]00"]],["([5-9]..)(..)(..)(..)","$1 $2 $3 $4",["[568]|[79][0-8]"]]]],36:[[9],[["(1)(...)(....)","$1 $2 $3",["1"]],["(..)(...)(.{3,4})","$1 $2 $3",["[2-9]"]]]],39:[[9,10],[["(..)(.{3,4})(....)","$1 $2 $3",["0[26]|55"]],["(0[26])(....)(.....)","$1 $2 $3",["0[26]"]],["(0[26])(.{4,6})","$1 $2",["0[26]"]],["(0..)(.{3,4})(....)","$1 $2 $3",["0[13-57-9][0159]"]],["(...)(.{3,6})","$1 $2",["0[13-57-9][0159]|8(?:03|4[17]|9[245])","0[13-57-9][0159]|8(?:03|4[17]|9(?:2|[45][0-4]))"]],["(0...)(...)(....)","$1 $2 $3",["0[13-57-9][2-46-8]"]],["(0...)(.{2,6})","$1 $2",["0[13-57-9][2-46-8]"]],["(...)(...)(.{3,4})","$1 $2 $3",["[13]|8(?:00|4[08]|9[59])","[13]|8(?:00|4[08]|9(?:5[5-9]|9))"]],["(....)(....)","$1 $2",["894","894[5-9]"]],["(...)(....)(....)","$1 $2 $3",["3"]]]],40:[[9],[["(..)(...)(....)","$1 $2 $3",["[23]1"]],["(21)(....)","$1 $2",["21"]],["(...)(...)(...)","$1 $2 $3",["[23][3-7]|[7-9]"]],["(2..)(...)","$1 $2",["2[3-6]"]]]],41:[[9],[["([2-9].)(...)(..)(..)","$1 $2 $3 $4",["[2-7]|[89]1"]],["([89]..)(...)(...)","$1 $2 $3",["8[047]|90"]],["(...)(..)(...)(..)(..)","$1 $2 $3 $4 $5",["860"]]]],43:[[10,11,12,13],[["(116...)","$1",["116"]],["(1)(.{3,12})","$1 $2",["1"]],["(5.)(.{3,5})","$1 $2",["5[079]"]],["(5.)(...)(.{3,4})","$1 $2 $3",["5[079]"]],["(5.)(....)(.{4,7})","$1 $2 $3",["5[079]"]],["(...)(.{3,10})","$1 $2",["316|46|51|732|6(?:5[0-3579]|[6-9])|7(?:[28]0)|[89]"]],["(....)(.{3,9})","$1 $2",["2|3(?:1[1-578]|[3-8])|4[2378]|5[2-6]|6(?:[12]|4[1-9]|5[468])|7(?:2[1-8]|35|4[1-8]|[5-79])"]]]],44:[[10],[["(..)(....)(....)","$1 $2 $3",["2|5[56]|7(?:0|6[013-9])","2|5[56]|7(?:0|6(?:[013-9]|2[0-35-9]))"]],["(...)(...)(....)","$1 $2 $3",["1(?:1|.1)|3|9[018]"]],["(.....)(.{4,5})","$1 $2",["1(?:38|5[23]|69|76|94)","1(?:387|5(?:24|39)|697|768|946)","1(?:3873|5(?:242|39[456])|697[347]|768[347]|9467)"]],["(1...)(.{5,6})","$1 $2",["1"]],["(7...)(.{6})","$1 $2",["7(?:[1-5789]|62)","7(?:[1-5789]|624)"]],["(800)(....)","$1 $2",["800","8001","80011","800111","8001111"]],["(845)(46)(4.)","$1 $2 $3",["845","8454","84546","845464"]],["(8..)(...)(....)","$1 $2 $3",["8(?:4[2-5]|7[0-3])"]],["(80.)(...)(....)","$1 $2 $3",["80"]],["([58]00)(.{6})","$1 $2",["[58]00"]]]],45:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],46:[[9],[["(8)(.{2,3})(.{2,3})(..)","$1 $2 $3 $4",["8"]],["([1-69].)(.{2,3})(..)(..)","$1 $2 $3 $4",["1[013689]|2[0136]|3[1356]|4[0246]|54|6[03]|90"]],["([1-69].)(...)(..)","$1 $2 $3",["1[13689]|2[136]|3[1356]|4[0246]|54|6[03]|90"]],["(...)(..)(..)(..)","$1 $2 $3 $4",["1[2457]|2[2457-9]|3[0247-9]|4[1357-9]|5[0-35-9]|6[124-9]|9(?:[125-8]|3[0-5]|4[0-3])"]],["(...)(.{2,3})(..)","$1 $2 $3",["1[2457]|2[2457-9]|3[0247-9]|4[1357-9]|5[0-35-9]|6[124-9]|9(?:[125-8]|3[0-5]|4[0-3])"]],["(7.)(...)(..)(..)","$1 $2 $3 $4",["7"]],["(77)(..)(..)","$1 $2 $3",["7"]],["(20)(.{2,3})(..)","$1 $2 $3",["20"]],["(9[034].)(..)(..)(...)","$1 $2 $3 $4",["9[034]"]],["(9[034].)(....)","$1 $2",["9[034]"]]]],47:[[8],[["([489]..)(..)(...)","$1 $2 $3",["[489]"]],["([235-7].)(..)(..)(..)","$1 $2 $3 $4",["[235-7]"]]]],48:[[9],[["(..)(...)(..)(..)","$1 $2 $3 $4",["[14]|2[0-57-9]|3[2-4]|5[24-689]|6[1-3578]|7[14-7]|8[1-79]|9[145]"]],["(..)(.)(....)","$1 $2 $3",["[12]2"]],["(...)(...)(...)","$1 $2 $3",["26|39|5[0137]|6[0469]|7[02389]|8[08]"]],["(...)(..)(.{2,3})","$1 $2 $3",["64"]],["(...)(...)","$1 $2",["64"]]]],49:[[7,8,9,10,11,12],[["(1..)(.{7,8})","$1 $2",["1[67]"]],["(15...)(.{6})","$1 $2",["15[0568]"]],["(1...)(.{7})","$1 $2",["15"]],["(..)(.{3,11})","$1 $2",["3[02]|40|[68]9"]],["(...)(.{3,11})","$1 $2",["2(?:.1|0[2389]|1[24]|28|34)|3(?:[3-9][15]|40)|[4-8][1-9]1|9(?:06|[1-9]1)"]],["(....)(.{2,11})","$1 $2",["[24-6]|[7-9](?:.[1-9]|[1-9].)|3(?:[3569][02-46-9]|4[2-4679]|7[2-467]|8[2-46-8])","[24-6]|[7-9](?:.[1-9]|[1-9].)|3(?:3(?:0[1-467]|2[127-9]|3[124578]|[46][1246]|7[1257-9]|8[1256]|9[145])|4(?:2[135]|3[1357]|4[13578]|6[1246]|7[1356]|9[1346])|5(?:0[14]|2[1-3589]|3[1357]|4[1246]|6[1-4]|7[1346]|8[13568]|9[1246])|6(?:0[356]|2[1-489]|3[124-6]|4[1347]|6[13]|7[12579]|8[1-356]|9[135])|7(?:2[1-7]|3[1357]|4[145]|6[1-5]|7[1-4])|8(?:21|3[1468]|4[1347]|6[0135-9]|7[1467]|8[136])|9(?:0[12479]|2[1358]|3[1357]|4[134679]|6[1-9]|7[136]|8[147]|9[1468]))"]],["(3....)(.{1,10})","$1 $2",["3"]],["(800)(.{7,12})","$1 $2",["800"]],["(177)(99)(.{7,8})","$1 $2 $3",["177","1779","17799"]],["(...)(.)(.{4,10})","$1 $2 $3",["(?:18|90)0|137","1(?:37|80)|900[1359]"]],["(1..)(.{5,11})","$1 $2",["181"]],["(18...)(.{6})","$1 $2",["185","1850","18500"]],["(18..)(.{7})","$1 $2",["18[68]"]],["(18.)(.{8})","$1 $2",["18[2-579]"]],["(700)(....)(....)","$1 $2 $3",["700"]],["(138)(....)","$1 $2",["138"]]]],51:[[9],[["(1)(.{7})","$1 $2",["1"]],["([4-8].)(.{6})","$1 $2",["[4-7]|8[2-4]"]],["(...)(.....)","$1 $2",["80"]],["(9..)(...)(...)","$1 $2 $3",["9"]]]],52:[[10,11],[["([358].)(....)(....)","$1 $2 $3",["33|55|81"]],["(...)(...)(....)","$1 $2 $3",["[2467]|3[0-2457-9]|5[089]|8[02-9]|9[0-35-9]"]],["(1)([358].)(....)(....)","$1 $2 $3 $4",["1(?:33|55|81)"]],["(1)(...)(...)(....)","$1 $2 $3 $4",["1(?:[2467]|3[0-2457-9]|5[089]|8[2-9]|9[1-35-9])"]]]],53:[[8],[["(.)(.{6,7})","$1 $2",["7"]],["(..)(.{4,6})","$1 $2",["[2-4]"]],["(.)(.{7})","$1 $2",["5"]]]],54:[[10,11],[["([68]..)(...)(....)","$1-$2-$3",["[68]"]],["(..)(....)","$1-$2",["[2-9]"]],["(...)(....)","$1-$2",["[2-9]"]],["(....)(....)","$1-$2",["[2-9]"]],["(9)(11)(....)(....)","$1 $2 $3-$4",["911"]],["(9)(...)(...)(....)","$1 $2 $3-$4",["9(?:2[234689]|3[3-8])","9(?:2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578]))","9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))","9(?:2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45])))"]],["(9)(....)(..)(....)","$1 $2 $3-$4",["9[23]"]],["(11)(....)(....)","$1 $2-$3",["1"]],["(...)(...)(....)","$1 $2-$3",["2(?:2[013]|3[067]|49|6[01346]|80|9[147-9])|3(?:36|4[1-358]|5[138]|6[24]|7[069]|8[013578])","2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3[456]|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))","2(?:2(?:0[013-9]|[13])|3(?:0[013-9]|[67])|49|6(?:[0136]|4[0-59])|8|9(?:[19]|44|7[013-9]|8[14]))|3(?:36|4(?:[12]|3(?:4|5[014]|6[1239])|[58]4)|5(?:1|3[0-24-689]|8[46])|6|7[069]|8(?:[01]|34|[578][45]))"]],["(....)(..)(....)","$1 $2-$3",["[23]"]],["(...)","$1",["1[012]|911"]]]],55:[[10,11],[["(....)(....)","$1-$2",["[2-9](?:[1-9]|0[1-9])"]],["(.....)(....)","$1-$2",["9(?:[1-9]|0[1-9])"]],["(.{3,5})","$1",["1[125689]"]],["(..)(.....)(....)","$1 $2-$3",["(?:[189][1-9]|2[12478]|3[1-578]|7[13-579])9"]],["(..)(....)(....)","$1 $2-$3",["[1-9][1-9]"]],["(....)(....)","$1-$2",["(?:300|40(?:0|20))"]],["([3589]00)(.{2,3})(....)","$1 $2 $3",["[3589]00"]]]],56:[[9],[["(.)(....)(....)","$1 $2 $3",["2[23]"]],["(..)(...)(....)","$1 $2 $3",["[357]|4[1-35]|6[13-57]"]],["(9)(....)(....)","$1 $2 $3",["9"]],["(44)(...)(....)","$1 $2 $3",["44"]],["([68]00)(...)(.{3,4})","$1 $2 $3",["60|8"]],["(600)(...)(..)(...)","$1 $2 $3 $4",["60"]],["(1230)(...)(....)","$1 $2 $3",["1"]],["(.....)(....)","$1 $2",["219"]],["(.{4,5})","$1",["[1-9]"]]]],57:[[10],[["(.)(.{7})","$1 $2",["1(?:8[2-9]|9[0-3]|[2-7])|[24-8]","1(?:8[2-9]|9(?:09|[1-3])|[2-7])|[24-8]"]],["(...)(.{7})","$1 $2",["3"]],["(1)(...)(.{7})","$1 $2 $3",["1(?:80|9[04])","1(?:800|9(?:0[01]|4[78]))"]]]],58:[[10],[["(...)(.{7})","$1-$2",[]]]],60:[[9,10],[["([4-79])(...)(....)","$1-$2 $3",["[4-79]"]],["(3)(....)(....)","$1-$2 $3",["3"]],["([18].)(...)(.{3,4})","$1-$2 $3",["1[02-46-9][1-9]|8"]],["(1)([36-8]00)(..)(....)","$1-$2-$3-$4",["1[36-8]0"]],["(11)(....)(....)","$1-$2 $3",["11"]],["(15[49])(...)(....)","$1-$2 $3",["15"]]]],61:[[9],[["([2378])(....)(....)","$1 $2 $3",["[2378]"]],["(...)(...)(...)","$1 $2 $3",["[45]|14"]],["(16)(...)(.{2,4})","$1 $2 $3",["16"]],["(1[389]..)(...)(...)","$1 $2 $3",["1(?:[38]0|90)","1(?:[38]00|90)"]],["(180)(2...)","$1 $2",["180","1802"]],["(19.)(...)","$1 $2",["19[13]"]],["(19..)(....)","$1 $2",["19[67]"]],["(13)(..)(..)","$1 $2 $3",["13[1-9]"]]]],62:[[9,10,11,12],[["(..)(.{5,8})","$1 $2",["2[124]|[36]1"]],["(...)(.{5,8})","$1 $2",["[4579]|2[035-9]|[36][02-9]"]],["(8..)(.{3,4})(.{3,5})","$1-$2-$3",["8[1-35-9]"]],["(1)(500)(...)","$1 $2 $3",["15"]],["(177)(.{6,8})","$1 $2",["17"]],["(800)(.{5,7})","$1 $2",["800"]],["(804)(...)(....)","$1 $2 $3",["804"]],["(80.)(.)(...)(...)","$1 $2 $3 $4",["80[79]"]]]],63:[[10],[["(2)(...)(....)","$1 $2 $3",["2"]],["(2)(.....)","$1 $2",["2"]],["(....)(.{4,6})","$1 $2",["3(?:23|39|46)|4(?:2[3-6]|[35]9|4[26]|76)|5(?:22|44)|642|8(?:62|8[245])","3(?:230|397|461)|4(?:2(?:35|[46]4|51)|396|4(?:22|63)|59[347]|76[15])|5(?:221|446)|642[23]|8(?:622|8(?:[24]2|5[13]))"]],["(.....)(....)","$1 $2",["346|4(?:27|9[35])|883","3469|4(?:279|9(?:30|56))|8834"]],["([3-8].)(...)(....)","$1 $2 $3",["[3-8]"]],["(...)(...)(....)","$1 $2 $3",["81|9"]],["(1800)(...)(....)","$1 $2 $3",["1"]],["(1800)(.{1,2})(...)(....)","$1 $2 $3 $4",["1"]]]],64:[[8,9,10],[["([34679])(...)(....)","$1-$2 $3",["[346]|7[2-57-9]|9[1-9]"]],["(24099)(...)","$1 $2",["240","2409","24099"]],["(..)(...)(...)","$1 $2 $3",["21"]],["(..)(...)(.{3,5})","$1 $2 $3",["2(?:1[1-9]|[69]|7[0-35-9])|70|86"]],["(2.)(.{3,4})(....)","$1 $2 $3",["2[028]"]],["(...)(...)(.{3,4})","$1 $2 $3",["2(?:10|74)|5|[89]0"]]]],65:[[8],[["([3689]...)(....)","$1 $2",["[369]|8[1-9]"]],["(1[89]00)(...)(....)","$1 $2 $3",["1[89]"]],["(7000)(....)(...)","$1 $2 $3",["70"]],["(800)(...)(....)","$1 $2 $3",["80"]]]],66:[[9],[["(2)(...)(....)","$1 $2 $3",["2"]],["([13-9].)(...)(.{3,4})","$1 $2 $3",["14|[3-9]"]],["(1[89]00)(...)(...)","$1 $2 $3",["1"]]]],81:[[10],[["(...)(...)(...)","$1-$2-$3",["(?:12|57|99)0"]],["(...)(...)(....)","$1-$2-$3",["800"]],["(....)(....)","$1-$2",["0077"]],["(....)(..)(.{3,4})","$1-$2-$3",["0077"]],["(....)(..)(....)","$1-$2-$3",["0088"]],["(....)(...)(.{3,4})","$1-$2-$3",["00(?:37|66)"]],["(....)(....)(.{4,5})","$1-$2-$3",["00(?:37|66)"]],["(....)(.....)(.{5,6})","$1-$2-$3",["00(?:37|66)"]],["(....)(.{6})(.{6,7})","$1-$2-$3",["00(?:37|66)"]],["(..)(....)(....)","$1-$2-$3",["[2579]0|80[1-9]"]],["(....)(.)(....)","$1-$2-$3",["1(?:26|3[79]|4[56]|5[4-68]|6[3-5])|5(?:76|97)|499|746|8(?:3[89]|63|47|51)|9(?:49|80|9[16])","1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:76|97)9|499[2468]|7468|8(?:3(?:8[78]|96)|636|477|51[24])|9(?:496|802|9(?:1[23]|69))","1(?:267|3(?:7[247]|9[278])|4(?:5[67]|66)|5(?:47|58|64|8[67])|6(?:3[245]|48|5[4-68]))|5(?:769|979[2-69])|499[2468]|7468|8(?:3(?:8[78]|96[2457-9])|636[2-57-9]|477|51[24])|9(?:496|802|9(?:1[23]|69))"]],["(...)(..)(....)","$1-$2-$3",["1(?:2[3-6]|3[3-9]|4[2-6]|5[2-8]|[68][2-7]|7[2-689]|9[1-578])|2(?:2[03-689]|3[3-58]|4[0-468]|5[04-8]|6[013-8]|7[06-9]|8[02-57-9]|9[13])|4(?:2[28]|3[689]|6[035-7]|7[05689]|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9[4-9])|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9[014-9])|8(?:2[49]|3[3-8]|4[5-8]|5[2-9]|6[35-9]|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9[3-7])","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9[2-8])|3(?:7[2-6]|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5[4-7]|6[2-9]|8[2-8]|9[236-9])|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3[34]|[4-7]))","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6[56]))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))","1(?:2[3-6]|3[3-9]|4[2-6]|5(?:[236-8]|[45][2-69])|[68][2-7]|7[2-689]|9[1-578])|2(?:2(?:[04-689]|3[23])|3[3-58]|4[0-468]|5(?:5[78]|7[2-4]|[0468][2-9])|6(?:[0135-8]|4[2-5])|7(?:[0679]|8[2-7])|8(?:[024578]|3[25-9]|9[6-9])|9(?:11|3[2-4]))|4(?:2(?:2[2-9]|8[237-9])|3[689]|6[035-7]|7(?:[059][2-8]|[68])|80|9[3-5])|5(?:3[1-36-9]|4[4578]|5[013-8]|6[1-9]|7[2-8]|8[14-7]|9(?:[89][2-8]|[4-7]))|7(?:2[15]|3[5-9]|4[02-9]|6[135-8]|7[0-4689]|9(?:[017-9]|4[6-8]|5[2-478]|6[2-589]))|8(?:2(?:4[4-8]|9(?:[3578]|20|4[04-9]|6(?:5[25]|60)))|3(?:7(?:[2-5]|6[0-59])|[3-6][2-9]|8[2-5])|4[5-8]|5[2-9]|6(?:[37]|5(?:[467]|5[014-9])|6(?:[2-8]|9[02-69])|8[2-8]|9(?:[236-8]|9[23]))|7[579]|8[03-579]|9[2-8])|9(?:[23]0|4[02-46-9]|5[024-79]|6[4-9]|7[2-47-9]|8[02-7]|9(?:3(?:3[02-9]|4[0-24689])|4[2-69]|[5-7]))"]],["(..)(...)(....)","$1-$2-$3",["1|2(?:2[37]|5[5-9]|64|78|8[39]|91)|4(?:2[2689]|64|7[347])|5(?:[2-589]|39)|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93)","1|2(?:2[37]|5(?:[57]|[68]0|9[19])|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93[34])","1|2(?:2[37]|5(?:[57]|[68]0|9(?:17|99))|64|78|8[39]|917)|4(?:2(?:[68]|20|9[178])|64|7[347])|5(?:[2-589]|39[67])|60|8(?:[46-9]|3[279]|2[124589])|9(?:[235-8]|93(?:31|4))"]],["(...)(..)(....)","$1-$2-$3",["2(?:9[14-79]|74|[34]7|[56]9)|82|993"]],["(.)(....)(....)","$1-$2-$3",["3|4(?:2[09]|7[01])|6[1-9]"]],["(..)(...)(....)","$1-$2-$3",["[2479][1-9]"]]]],82:[[9,10],[["(..)(....)(....)","$1-$2-$3",["1(?:0|1[19]|[69]9|5[458])|[57]0","1(?:0|1[19]|[69]9|5(?:44|59|8))|[57]0"]],["(..)(.{3,4})(....)","$1-$2-$3",["1(?:[169][2-8]|[78]|5[1-4])|[68]0|[3-6][1-9][1-9]","1(?:[169][2-8]|[78]|5(?:[1-3]|4[56]))|[68]0|[3-6][1-9][1-9]"]],["(...)(.)(....)","$1-$2-$3",["131","1312"]],["(...)(..)(....)","$1-$2-$3",["131","131[13-9]"]],["(...)(...)(....)","$1-$2-$3",["13[2-9]"]],["(..)(..)(...)(....)","$1-$2-$3-$4",["30"]],["(.)(.{3,4})(....)","$1-$2-$3",["2[1-9]"]],["(.)(.{3,4})","$1-$2",["21[0-46-9]"]],["(..)(.{3,4})","$1-$2",["[3-6][1-9]1","[3-6][1-9]1(?:[0-46-9])"]],["(....)(....)","$1-$2",["1(?:5[46-9]|6[04678]|8[0579])","1(?:5(?:44|66|77|88|99)|6(?:00|44|6[16]|70|88)|8(?:00|55|77|99))"]]]],84:[[9,10],[["([17]99)(....)","$1 $2",["[17]99"]],["([48])(....)(....)","$1 $2 $3",["[48]"]],["([235-7].)(....)(...)","$1 $2 $3",["2[025-79]|3[0136-9]|5[2-9]|6[0-46-8]|7[02-79]"]],["(80)(.....)","$1 $2",["80"]],["(69.)(.{4,5})","$1 $2",["69"]],["([235-7]..)(....)(...)","$1 $2 $3",["2[1348]|3[25]|5[01]|65|7[18]"]],["(9.)(...)(..)(..)","$1 $2 $3 $4",["9"]],["(1[2689].)(...)(....)","$1 $2 $3",["1(?:[26]|8[68]|99)"]],["(1[89]00)(.{4,6})","$1 $2",["1[89]0"]]]],86:[[11],[["(80..)(....)","$1 $2",["80[2678]"]],["([48]00)(...)(....)","$1 $2 $3",["[48]00"]],["(.{5,6})","$1",["100|95"]],["(..)(.{5,6})","$1 $2",["(?:10|2.)[19]","(?:10|2.)(?:10|9[56])","(?:10|2.)(?:100|9[56])"]],["(...)(.{5,6})","$1 $2",["[3-9]","[3-9]..[19]","[3-9]..(?:10|9[56])"]],["(.{3,4})(....)","$1 $2",["[2-9]"]],["(21)(....)(.{4,6})","$1 $2 $3",["21"]],["([12].)(....)(....)","$1 $2 $3",["10[1-9]|2[02-9]","10[1-9]|2[02-9]","10(?:[1-79]|8(?:[1-9]|0[1-9]))|2[02-9]"]],["(...)(....)(....)","$1 $2 $3",["3(?:11|7[179])|4(?:[15]1|3[12])|5(?:1|2[37]|3[12]|51|7[13-79]|9[15])|7(?:31|5[457]|6[09]|91)|8(?:[57]1|98)"]],["(...)(...)(....)","$1 $2 $3",["3(?:1[02-9]|35|49|5|7[02-68]|9[1-68])|4(?:1[02-9]|2[179]|[35][2-9]|6[4789]|7.|8[23])|5(?:3[03-9]|4[36]|5[02-9]|6[1-46]|7[028]|80|9[2-46-9])|6(?:3[1-5]|6[0238]|9[12])|7(?:01|[1579]|2[248]|3[04-9]|4[3-6]|6[2368])|8(?:1[236-8]|2[5-7]|3|5[4-9]|7[02-9]|8[3678]|9[1-7])|9(?:0[1-3689]|1[1-79]|[379]|4[13]|5[1-5])"]],["(...)(....)(....)","$1 $2 $3",["1[3-578]"]],["(10800)(...)(....)","$1 $2 $3",["108","1080","10800"]],["(...)(.{7,8})","$1 $2",["950"]]]],90:[[10],[["(...)(...)(....)","$1 $2 $3",["[23]|4(?:[0-35-9]|4[0-35-9])"]],["(...)(...)(....)","$1 $2 $3",["[589]"]],["(444)(.)(...)","$1 $2 $3",["444"]]]],91:[[10],[["(.....)(.....)","$1 $2",["7(?:[0257]|3[0157-9]|4[0-389]|6[0-35-9]|8[0-79])|8(?:0[015689]|1[0-57-9]|2[2356-9]|3[0-57-9]|[45]|6[02457-9]|7[01-69]|8[0-24-9]|9[02-9])|9","7(?:0|2(?:[0235679]|[14][017-9]|8[0-59]|9[389])|3(?:[058]|10|7[3679]|9[689])|4(?:0[1-9]|1[015-9]|[29][89]|39|8[389])|5(?:[034678]|2[03-9]|5[017-9]|9[7-9])|6(?:0[0-47]|1[0-257-9]|2[0-4]|3[19]|5[4589]|[6-9])|7(?:0[2-9]|[1-79]|8[1-9])|8[0-79])|8(?:0(?:[01589]|6[67])|1(?:[02-57-9]|1[0135-9])|2(?:[236-9]|5[1-9])|3(?:[0357-9]|4[1-9])|[45]|6[02457-9]|7(?:07|[1-69])|8(?:[0-26-9]|44|5[2-9])|9(?:[035-9]|2[2-9]|4[0-8]))|9"]],["(..)(....)(....)","$1 $2 $3",["11|2[02]|33|4[04]|79|80[2-46]"]],["(...)(...)(....)","$1 $2 $3",["1(?:2[0-249]|3[0-25]|4[145]|[569][14]|7[1257]|8[1346]|[68][1-9])|2(?:1[257]|3[013]|4[01]|5[0137]|6[0158]|78|8[1568]|9[14])|3(?:26|4[1-3]|5[34]|6[01489]|7[02-46]|8[159])|4(?:1[36]|2[1-47]|3[15]|5[12]|6[0-26-9]|7[0-24-9]|8[013-57]|9[014-7])|5(?:1[025]|[36][25]|22|4[28]|5[12]|[78]1|9[15])|6(?:12|[2345]1|57|6[13]|7[14]|80)"]],["(...)(...)(....)","$1 $2 $3",["7(?:12|2[14]|3[134]|4[47]|5[15]|[67]1|88)","7(?:12|2[14]|3[134]|4[47]|5(?:1|5[2-6])|[67]1|88)"]],["(...)(...)(....)","$1 $2 $3",["8(?:16|2[014]|3[126]|6[136]|7[078]|8[34]|91)"]],["(....)(...)(...)","$1 $2 $3",["1(?:[23579]|[468][1-9])|[2-8]"]],["(1600)(..)(....)","$1 $2 $3",["160","1600"]],["(1800)(.{4,5})","$1 $2",["180","1800"]],["(18[06]0)(.{2,4})(....)","$1 $2 $3",["18[06]","18[06]0"]],["(140)(...)(....)","$1 $2 $3",["140"]],["(....)(...)(...)(...)","$1 $2 $3 $4",["18[06]","18(?:0[03]|6[12])"]]]],92:[[10],[["(..)(111)(...)(...)","$1 $2 $3 $4",["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)1","(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)11","(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)111"]],["(...)(111)(...)(...)","$1 $2 $3 $4",["2[349]|45|54|60|72|8[2-5]|9[2-9]","(?:2[349]|45|54|60|72|8[2-5]|9[2-9]).1","(?:2[349]|45|54|60|72|8[2-5]|9[2-9]).11","(?:2[349]|45|54|60|72|8[2-5]|9[2-9]).111"]],["(..)(.{7,8})","$1 $2",["(?:2[125]|4[0-246-9]|5[1-35-7]|6[1-8]|7[14]|8[16]|91)[2-9]"]],["(...)(.{6,7})","$1 $2",["2[349]|45|54|60|72|8[2-5]|9[2-9]","(?:2[349]|45|54|60|72|8[2-5]|9[2-9]).[2-9]"]],["(3..)(.{7})","$1 $2",["3"]],["([15]...)(.{5,6})","$1 $2",["58[12]|1"]],["(586..)(.....)","$1 $2",["586"]],["([89]00)(...)(..)","$1 $2 $3",["[89]00"]]]],93:[[9],[["([2-7].)(...)(....)","$1 $2 $3",["[2-7]"]]]],94:[[9],[["(..)(.)(.{6})","$1 $2 $3",["[1-689]"]],["(..)(...)(....)","$1 $2 $3",["7"]]]],95:[[8,9,10],[["(.)(...)(.{3,4})","$1 $2 $3",["1|2[245]"]],["(2)(....)(....)","$1 $2 $3",["251"]],["(.)(..)(...)","$1 $2 $3",["16|2"]],["(..)(...)(.{3,4})","$1 $2 $3",["67|81"]],["(..)(..)(.{3,4})","$1 $2 $3",["[4-8]"]],["(9)(...)(.{4,6})","$1 $2 $3",["9(?:2[0-4]|[35-9]|4[137-9])"]],["(9)([34]....)(....)","$1 $2 $3",["9(?:3[0-36]|4[0-57-9])"]],["(9)(...)(...)(...)","$1 $2 $3 $4",["92[56]"]],["(9)(...)(...)(..)","$1 $2 $3 $4",["93"]]]],98:[[10],[["(21)(.{3,5})","$1 $2",["21"]],["(..)(....)(....)","$1 $2 $3",["[1-8]"]],["(...)(...)(.{3,4})","$1 $2 $3",["9"]],["(...)(..)(.{2,3})","$1 $2 $3",["9"]],["(...)(...)","$1 $2",["9"]]]],211:[[9],[["(...)(...)(...)","$1 $2 $3",[]]]],212:[[9],[["([56]..)(.{6})","$1-$2",["5(?:2[015-7]|3[0-4])|6"]],["([58]...)(.....)","$1-$2",["5(?:2[2-489]|3[5-9])|892","5(?:2(?:[2-48]|90)|3(?:[5-79]|80))|892"]],["(5....)(....)","$1-$2",["5(?:29|38)","5(?:29|38)[89]"]],["(8[09])(.{7})","$1-$2",["8(?:0|9[013-9])"]]]],213:[[9],[["([1-4].)(..)(..)(..)","$1 $2 $3 $4",["[1-4]"]],["([5-8]..)(..)(..)(..)","$1 $2 $3 $4",["[5-8]"]],["(9.)(...)(..)(..)","$1 $2 $3 $4",["9"]]]],216:[[8],[["(..)(...)(...)","$1 $2 $3",[]]]],218:[[9],[["([25679].)(.{7})","$1-$2",[]]]],220:[[7],[["(...)(....)","$1 $2",[]]]],221:[[9],[["(..)(...)(..)(..)","$1 $2 $3 $4",["[379]"]],["(...)(..)(..)(..)","$1 $2 $3 $4",["8"]]]],222:[[8],[["([2-48].)(..)(..)(..)","$1 $2 $3 $4",[]]]],223:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",["[246-9]"]],["(....)","$1",["67|74"]]]],224:[[8,9],[["(..)(..)(..)(..)","$1 $2 $3 $4",["3"]],["(...)(..)(..)(..)","$1 $2 $3 $4",["[67]"]]]],225:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],226:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],227:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",["[289]|09"]],["(08)(...)(...)","$1 $2 $3",["08"]]]],228:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],229:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],230:[[7,8],[["([2-46-9]..)(....)","$1 $2",["[2-46-9]"]],["(5...)(....)","$1 $2",["5"]]]],
231:[[7,8,9],[["(2.)(...)(...)","$1 $2 $3",["2"]],["(...)(...)(...)","$1 $2 $3",["[2579]"]],["([4-6])(...)(...)","$1 $2 $3",["[4-6]"]],["(..)(...)(....)","$1 $2 $3",["[38]"]]]],232:[[8],[["(..)(.{6})","$1 $2",[]]]],233:[[9],[["(..)(...)(....)","$1 $2 $3",["[235]"]],["(...)(.....)","$1 $2",["8"]]]],234:[[10],[["([129])(...)(.{3,4})","$1 $2 $3",["[129]"]],["(..)(...)(.{2,3})","$1 $2 $3",["[3-6]|7(?:[1-79]|0[1-9])|8[2-9]"]],["(...)(...)(.{3,4})","$1 $2 $3",["70|8[01]|90[2359]"]],["([78]00)(....)(.{4,5})","$1 $2 $3",["[78]00"]],["([78]00)(.....)(.{5,6})","$1 $2 $3",["[78]00"]],["(78)(..)(...)","$1 $2 $3",["78"]]]],235:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],236:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],237:[[8,9],[["([26])(..)(..)(..)(..)","$1 $2 $3 $4 $5",["[26]"]],["(..)(..)(..)(..)","$1 $2 $3 $4",["[23]|88"]],["(800)(..)(...)","$1 $2 $3",["80"]]]],238:[[7],[["(...)(..)(..)","$1 $2 $3",[]]]],239:[[7],[["(...)(....)","$1 $2",[]]]],240:[[9],[["(...)(...)(...)","$1 $2 $3",["[235]"]],["(...)(.{6})","$1 $2",["[89]"]]]],241:[[8],[["(.)(..)(..)(..)","$1 $2 $3 $4",["[2-7]"]],["(..)(..)(..)(..)","$1 $2 $3 $4",["0"]]]],242:[[9],[["(..)(...)(....)","$1 $2 $3",["[02]"]],["(.)(....)(....)","$1 $2 $3",["8"]]]],243:[[9],[["(..)(...)(....)","$1 $2 $3",["12"]],["([89]..)(...)(...)","$1 $2 $3",["8[0-2459]|9"]],["(..)(..)(...)","$1 $2 $3",["88"]],["(..)(.....)","$1 $2",["[1-6]"]]]],244:[[9],[["(...)(...)(...)","$1 $2 $3",[]]]],245:[[7,9],[["(...)(...)(...)","$1 $2 $3",["44|9[567]"]]]],246:[[7],[["(...)(....)","$1 $2",[]]]],247:[[4],[]],248:[[7],[["(...)(...)","$1 $2",["8"]],["(.)(...)(...)","$1 $2 $3",["[246]"]]]],249:[[9],[["(..)(...)(....)","$1 $2 $3",[]]]],250:[[9],[["(2..)(...)(...)","$1 $2 $3",["2"]],["([7-9]..)(...)(...)","$1 $2 $3",["[7-9]"]],["(0.)(..)(..)(..)","$1 $2 $3 $4",["0"]]]],251:[[9],[["([1-59].)(...)(....)","$1 $2 $3",[]]]],252:[[8,9],[["(.)(.{6})","$1 $2",["2[0-79]|[13-5]"]],["(.)(.{7})","$1 $2",["24|[67]"]],["(..)(.{5,7})","$1 $2",["15|28|6[1-35-9]|799|9[2-9]"]],["(90.)(...)(...)","$1 $2 $3",["90"]]]],253:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],254:[[9],[["(..)(.{5,7})","$1 $2",["[24-6]"]],["(...)(.{6})","$1 $2",["7"]],["(...)(...)(.{3,4})","$1 $2 $3",["[89]"]]]],255:[[9],[["([24].)(...)(....)","$1 $2 $3",["[24]"]],["([67]..)(...)(...)","$1 $2 $3",["[67]"]],["([89]..)(..)(....)","$1 $2 $3",["[89]"]]]],256:[[9],[["(...)(.{6})","$1 $2",["[7-9]|20(?:[013-8]|2[5-9])|4(?:6[45]|[7-9])"]],["(..)(.{7})","$1 $2",["3|4(?:[1-5]|6[0-36-9])"]],["(2024)(.....)","$1 $2",["2024"]]]],257:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",[]]]],258:[[9],[["([28].)(...)(.{3,4})","$1 $2 $3",["2|8[2-7]"]],["(80.)(...)(...)","$1 $2 $3",["80"]]]],260:[[9],[["([29].)(.{7})","$1 $2",["[29]"]],["(800)(...)(...)","$1 $2 $3",["8"]]]],261:[[9],[["([23].)(..)(...)(..)","$1 $2 $3 $4",[]]]],262:[[9],[["([268]..)(..)(..)(..)","$1 $2 $3 $4",[]]]],263:[[9,10],[["([49])(...)(.{2,4})","$1 $2 $3",["4|9[2-9]"]],["(7.)(...)(.{3,4})","$1 $2 $3",["7"]],["(86..)(...)(...)","$1 $2 $3",["86[24]"]],["([2356]..)(.{3,5})","$1 $2",["2(?:0[45]|2[278]|[49]8|[78])|3(?:08|17|3[78]|7[1569]|8[37]|98)|5[15][78]|6(?:[29]8|[38]7|6[78]|75|[89]8)"]],["(...)(...)(.{3,4})","$1 $2 $3",["2(?:1[39]|2[0157]|6[14]|7[35]|84)|329"]],["([1-356].)(.{3,5})","$1 $2",["1[3-9]|2[0569]|3[0-69]|5[05689]|6[0-46-9]"]],["([235].)(...)(.{3,4})","$1 $2 $3",["[23]9|54"]],["([25]...)(.{3,5})","$1 $2",["(?:25|54)8","258[23]|5483"]],["(8...)(.{6})","$1 $2",["86"]],["(80.)(...)(....)","$1 $2 $3",["80"]]]],264:[[9],[["(8.)(...)(....)","$1 $2 $3",["8[1235]"]],["(6.)(...)(.{3,4})","$1 $2 $3",["6"]],["(88)(...)(...)","$1 $2 $3",["88"]],["(870)(...)(...)","$1 $2 $3",["870"]]]],265:[[9],[["(.)(...)(...)","$1 $2 $3",["1"]],["(2..)(...)(...)","$1 $2 $3",["2"]],["(...)(..)(..)(..)","$1 $2 $3 $4",["[1789]"]]]],266:[[8],[["(....)(....)","$1 $2",[]]]],267:[[8],[["(...)(....)","$1 $2",["[2-6]"]],["(7.)(...)(...)","$1 $2 $3",["7"]],["(90)(.....)","$1 $2",["9"]]]],268:[[8],[["(....)(....)","$1 $2",["[027]"]]]],269:[[7],[["(...)(..)(..)","$1 $2 $3",[]]]],290:[[4,5],[]],291:[[7],[["(.)(...)(...)","$1 $2 $3",[]]]],297:[[7],[["(...)(....)","$1 $2",[]]]],298:[[6],[["(.{6})","$1",[]]]],299:[[6],[["(..)(..)(..)","$1 $2 $3",[]]]],350:[[8],[["(...)(.....)","$1 $2",["2"]]]],351:[[9],[["(2.)(...)(....)","$1 $2 $3",["2[12]"]],["([2-46-9]..)(...)(...)","$1 $2 $3",["2[3-9]|[346-9]"]]]],352:[[9],[["(..)(...)","$1 $2",["[2-5]|7[1-9]|[89](?:[1-9]|0[2-9])"]],["(..)(..)(..)","$1 $2 $3",["[2-5]|7[1-9]|[89](?:[1-9]|0[2-9])"]],["(..)(..)(...)","$1 $2 $3",["20"]],["(..)(..)(..)(.{1,2})","$1 $2 $3 $4",["2(?:[0367]|4[3-8])"]],["(..)(..)(..)(...)","$1 $2 $3 $4",["20"]],["(..)(..)(..)(..)(.{1,2})","$1 $2 $3 $4 $5",["2(?:[0367]|4[3-8])"]],["(..)(..)(..)(.{1,4})","$1 $2 $3 $4",["2(?:[12589]|4[12])|[3-5]|7[1-9]|8(?:[1-9]|0[2-9])|9(?:[1-9]|0[2-46-9])"]],["(...)(..)(...)","$1 $2 $3",["70|80[01]|90[015]"]],["(...)(...)(...)","$1 $2 $3",["6"]]]],353:[[9],[["(1)(.{3,4})(....)","$1 $2 $3",["1"]],["(..)(.....)","$1 $2",["2[24-9]|47|58|6[237-9]|9[35-9]"]],["(...)(.....)","$1 $2",["40[24]|50[45]"]],["(48)(....)(....)","$1 $2 $3",["48"]],["(818)(...)(...)","$1 $2 $3",["81"]],["(..)(...)(.{3,4})","$1 $2 $3",["[24-69]|7[14]"]],["([78].)(.{3,4})(....)","$1 $2 $3",["76|8[35-9]"]],["(700)(...)(...)","$1 $2 $3",["70"]],["(....)(...)(...)","$1 $2 $3",["1(?:8[059]|5)","1(?:8[059]0|5)"]]]],354:[[7,8,9],[["(...)(....)","$1 $2",["[4-9]"]],["(3..)(...)(...)","$1 $2 $3",["3"]]]],355:[[9],[["(4)(...)(....)","$1 $2 $3",["4[0-6]"]],["(6[6-9])(...)(....)","$1 $2 $3",["6"]],["(..)(...)(...)","$1 $2 $3",["[2358][2-5]|4[7-9]"]],["(...)(.{3,5})","$1 $2",["[235][16-9]|8[016-9]|[79]"]]]],356:[[8],[["(....)(....)","$1 $2",[]]]],357:[[8],[["(..)(.{6})","$1 $2",[]]]],358:[[6,7,8,9,10,11],[["(...)(.{3,7})","$1 $2",["(?:[1-3]00|[6-8]0)"]],["(116...)","$1",["116"]],["(..)(.{4,10})","$1 $2",["[14]|2[09]|50|7[135]"]],["(.)(.{4,11})","$1 $2",["[25689][1-8]|3"]]]],359:[[9],[["(2)(.....)","$1 $2",["29"]],["(2)(...)(.{3,4})","$1 $2 $3",["2"]],["(...)(....)","$1 $2",["43[124-7]|70[1-9]"]],["(...)(...)(..)","$1 $2 $3",["43[124-7]|70[1-9]"]],["(...)(..)(...)","$1 $2 $3",["[78]00"]],["(...)(...)(...)","$1 $2 $3",["999"]],["(..)(...)(.{2,3})","$1 $2 $3",["[356]|4[124-7]|7[1-9]|8[1-6]|9[1-7]"]],["(..)(...)(.{3,4})","$1 $2 $3",["48|8[7-9]|9[08]"]]]],370:[[8],[["([34].)(.{6})","$1 $2",["37|4(?:1|5[45]|6[2-4])"]],["([3-6]..)(.....)","$1 $2",["3[148]|4(?:[24]|6[09])|528|6"]],["([7-9]..)(..)(...)","$1 $2 $3",["[7-9]"]],["(5)(2..)(....)","$1 $2 $3",["52[0-79]"]]]],371:[[8],[["([2689].)(...)(...)","$1 $2 $3",[]]]],372:[[7,8],[["([3-79]..)(....)","$1 $2",["[369]|4[3-8]|5(?:[0-2]|5[0-478]|6[45])|7[1-9]","[369]|4[3-8]|5(?:[02]|1(?:[0-8]|95)|5[0-478]|6(?:4[0-4]|5[1-589]))|7[1-9]"]],["(70)(..)(....)","$1 $2 $3",["70"]],["(8000)(...)(...)","$1 $2 $3",["800","8000"]],["([458]...)(.{3,4})","$1 $2",["40|5|8(?:00|[1-5])","40|5|8(?:00[1-9]|[1-5])"]]]],373:[[8],[["(..)(...)(...)","$1 $2 $3",["22|3"]],["([25-7]..)(..)(...)","$1 $2 $3",["2[13-79]|[5-7]"]],["([89]..)(.....)","$1 $2",["[89]"]]]],374:[[8],[["(..)(.{6})","$1 $2",["1|47"]],["(..)(.{6})","$1 $2",["4[139]|[5-7]|9[1-9]"]],["(...)(.....)","$1 $2",["[23]"]],["(...)(..)(...)","$1 $2 $3",["8|90"]]]],375:[[9],[["(..)(...)(..)(..)","$1 $2-$3-$4",["17[0-3589]|2[4-9]|[34]","17(?:[02358]|1[0-2]|9[0189])|2[4-9]|[34]"]],["(...)(..)(..)(..)","$1 $2-$3-$4",["1(?:5[24]|6[235]|7[467])|2(?:1[246]|2[25]|3[26])","1(?:5[24]|6(?:2|3[04-9]|5[0346-9])|7(?:[46]|7[37-9]))|2(?:1[246]|2[25]|3[26])"]],["(....)(..)(...)","$1 $2-$3",["1(?:5[169]|6[3-5]|7[179])|2(?:1[35]|2[34]|3[3-5])","1(?:5[169]|6(?:3[1-3]|4|5[125])|7(?:1[3-9]|7[0-24-6]|9[2-7]))|2(?:1[35]|2[34]|3[3-5])"]],["([89]..)(...)(....)","$1 $2 $3",["8[01]|9"]],["(82.)(....)(....)","$1 $2 $3",["82"]],["(800)(...)","$1 $2",["800"]],["(800)(..)(.{2,4})","$1 $2 $3",["800"]]]],376:[[6],[["(...)(...)","$1 $2",["[346-9]"]],["(180[02])(....)","$1 $2",["1"]]]],377:[[8,9],[["(..)(..)(..)(..)","$1 $2 $3 $4",["9"]],["(..)(...)(...)","$1 $2 $3",["4"]],["(6)(..)(..)(..)(..)","$1 $2 $3 $4 $5",["6"]],["(...)(...)(..)","$1 $2 $3",["8"]]]],378:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",["[5-7]"]],["(0549)(.{6})","($1) $2",["0"]],["(.{6})","(0549) $1",["[89]"]]]],379:[[10],[]],380:[[9],[["([3-9].)(...)(....)","$1 $2 $3",["[38]9|4(?:[45][0-5]|87)|5(?:0|6[37]|7[37])|6[36-8]|73|9[1-9]","[38]9|4(?:[45][0-5]|87)|5(?:0|6(?:3[14-7]|7)|7[37])|6[36-8]|73|9[1-9]"]],["([3-689]..)(...)(...)","$1 $2 $3",["3[1-8]2|4[13678]2|5(?:[12457]2|6[24])|6(?:[49]2|[12][29]|5[24])|8[0-8]|90","3(?:[1-46-8]2[013-9]|52)|4(?:[1378]2|62[013-9])|5(?:[12457]2|6[24])|6(?:[49]2|[12][29]|5[24])|8[0-8]|90"]],["([3-6]...)(.....)","$1 $2",["3(?:5[013-9]|[1-46-8])|4(?:[137][013-9]|6|[45][6-9]|8[4-6])|5(?:[1245][013-9]|6[0135-9]|3|7[4-6])|6(?:[49][013-9]|5[0135-9]|[12][13-8])","3(?:5[013-9]|[1-46-8](?:22|[013-9]))|4(?:[137][013-9]|6(?:[013-9]|22)|[45][6-9]|8[4-6])|5(?:[1245][013-9]|6(?:3[02389]|[015689])|3|7[4-6])|6(?:[49][013-9]|5[0135-9]|[12][13-8])"]]]],381:[[8,9],[["([23]..)(.{4,9})","$1 $2",["(?:2[389]|39)0"]],["([1-3].)(.{5,10})","$1 $2",["1|2(?:[0-24-7]|[389][1-9])|3(?:[0-8]|9[1-9])"]],["(6.)(.{6,8})","$1 $2",["6"]],["([89]..)(.{3,9})","$1 $2",["[89]"]],["(7[26])(.{4,9})","$1 $2",["7[26]"]],["(7[08].)(.{4,9})","$1 $2",["7[08]"]]]],382:[[8,9],[["(..)(...)(...)","$1 $2 $3",["[2-57-9]|6[036-9]","[2-57-9]|6(?:[03689]|7(?:[0-8]|9[3-9]))"]],["(67)(9)(...)(...)","$1 $2 $3 $4",["679","679[0-2]"]]]],385:[[8,9],[["(1)(....)(...)","$1 $2 $3",["1"]],["(6[09])(....)(...)","$1 $2 $3",["6[09]"]],["([67]2)(...)(.{3,4})","$1 $2 $3",["[67]2"]],["([2-5].)(...)(.{3,4})","$1 $2 $3",["[2-5]"]],["(9.)(...)(.{3,4})","$1 $2 $3",["9"]],["(9.)(....)(....)","$1 $2 $3",["9"]],["(9.)(.{3,4})(...)(...)","$1 $2 $3 $4",["9"]],["(..)(..)(.{2,3})","$1 $2 $3",["6[0145]|7"]],["(..)(.{3,4})(...)","$1 $2 $3",["6[0145]|7"]],["(80[01])(..)(.{2,3})","$1 $2 $3",["8"]],["(80[01])(.{3,4})(...)","$1 $2 $3",["8"]]]],386:[[8],[["(.)(...)(..)(..)","$1 $2 $3 $4",["[12]|3[4-8]|4[24-8]|5[2-8]|7[3-8]"]],["([3-7].)(...)(...)","$1 $2 $3",["[37][01]|4[0139]|51|6"]],["([89][09])(.{3,6})","$1 $2",["[89][09]"]],["([58]..)(.....)","$1 $2",["59|8[1-3]"]]]],387:[[8,9],[["(..)(...)(...)","$1 $2-$3",["[3-5]"]],["(..)(...)(...)","$1 $2 $3",["6[1-356]|[7-9]"]],["(..)(..)(..)(...)","$1 $2 $3 $4",["6[047]"]]]],389:[[8],[["(2)(...)(....)","$1 $2 $3",["2"]],["([347].)(...)(...)","$1 $2 $3",["[347]"]],["([58]..)(.)(..)(..)","$1 $2 $3 $4",["[58]"]]]],420:[[9],[["([2-9]..)(...)(...)","$1 $2 $3",["[2-8]|9[015-7]"]],["(96.)(...)(...)(...)","$1 $2 $3 $4",["96"]],["(9.)(...)(...)(...)","$1 $2 $3 $4",["9[36]"]]]],421:[[9],[["(2)(...)(...)(..)","$1/$2 $3 $4",["2"]],["([3-5].)(...)(..)(..)","$1/$2 $3 $4",["[3-5]"]],["([689]..)(...)(...)","$1 $2 $3",["[689]"]],["(9090)(...)","$1 $2",["9090"]]]],423:[[7],[["(...)(..)(..)","$1 $2 $3",["[23789]"]],["(...)(...)(...)","$1 $2 $3",["6[56]"]],["(69)(7..)(....)","$1 $2 $3",["697"]]]],500:[[5],[]],501:[[7],[["(...)(....)","$1-$2",["[2-8]"]],["(0)(800)(....)(...)","$1-$2-$3-$4",["0"]]]],502:[[8],[["(....)(....)","$1 $2",["[2-7]"]],["(....)(...)(....)","$1 $2 $3",["1"]]]],503:[[8],[["(....)(....)","$1 $2",["[267]"]],["(...)(....)","$1 $2",["[89]"]],["(...)(....)(....)","$1 $2 $3",["[89]"]]]],504:[[8],[["(....)(....)","$1-$2",[]]]],505:[[8],[["(....)(....)","$1 $2",[]]]],506:[[8],[["(....)(....)","$1 $2",["[24-7]|8[3-9]"]],["(...)(...)(....)","$1-$2-$3",["[89]0"]]]],507:[[8],[["(...)(....)","$1-$2",["[1-57-9]"]],["(....)(....)","$1-$2",["6"]]]],508:[[6],[["([45].)(..)(..)","$1 $2 $3",[]]]],509:[[8],[["(..)(..)(....)","$1 $2 $3",[]]]],590:[[9],[["([56]90)(..)(....)","$1 $2-$3",[]]]],591:[[8],[["([234])(.{7})","$1 $2",["[234]"]],["([67].{7})","$1",["[67]"]]]],592:[[7],[["(...)(....)","$1 $2",[]]]],593:[[8,9],[["(.)(...)(....)","$1-$2-$3",["[247]|[356][2-8]"]],["(..)(...)(....)","$1 $2 $3",["9"]],["(1800)(...)(.{3,4})","$1 $2 $3",["1"]]]],594:[[9],[["(...)(..)(..)(..)","$1 $2 $3 $4",[]]]],595:[[9],[["(..)(.{5,7})","$1 $2",["(?:[26]1|3[289]|4[124678]|7[123]|8[1236])"]],["(...)(.{3,6})","$1 $2",["[2-9]0"]],["(...)(.{6})","$1 $2",["9[1-9]"]],["(..)(...)(....)","$1 $2 $3",["8700"]],["(...)(.{4,6})","$1 $2",["[2-8][1-9]"]]]],596:[[9],[["(...)(..)(..)(..)","$1 $2 $3 $4",[]]]],597:[[7],[["(...)(...)","$1-$2",["[2-4]|5[2-58]"]],["(..)(..)(..)","$1-$2-$3",["56"]],["(...)(....)","$1-$2",["59|[6-8]"]]]],598:[[8],[["(....)(....)","$1 $2",["[24]"]],["(..)(...)(...)","$1 $2 $3",["9[1-9]"]],["(...)(....)","$1 $2",["[89]0"]]]],599:[[7,8],[["(...)(....)","$1 $2",["[13-7]"]],["(9)(...)(....)","$1 $2 $3",["9"]]]],670:[[8],[["(...)(....)","$1 $2",["[2-489]"]],["(....)(....)","$1 $2",["7"]]]],672:[[5,6],[["(..)(....)","$1 $2",["1"]],["(.)(.....)","$1 $2",["3"]]]],673:[[7],[["([2-578]..)(....)","$1 $2",[]]]],674:[[7],[["(...)(....)","$1 $2",[]]]],675:[[7,8],[["(...)(....)","$1 $2",["[13-689]|27"]],["(....)(....)","$1 $2",["20|7"]]]],676:[[7],[["(..)(...)","$1-$2",["[1-6]|7[0-4]|8[05]"]],["(...)(....)","$1 $2",["7[5-9]|8[47-9]"]],["(....)(...)","$1 $2",["0"]]]],677:[[7],[["(..)(.....)","$1 $2",["[7-9]"]]]],678:[[7],[["(...)(....)","$1 $2",["[579]"]]]],679:[[7],[["(...)(....)","$1 $2",["[36-9]"]],["(....)(...)(....)","$1 $2 $3",["0"]]]],680:[[7],[["(...)(....)","$1 $2",[]]]],681:[[6],[["(..)(..)(..)","$1 $2 $3",[]]]],682:[[5],[["(..)(...)","$1 $2",[]]]],683:[[4],[]],685:[[6,7],[["(8..)(.{3,4})","$1 $2",["8"]],["(7.)(.....)","$1 $2",["7"]],["(.....)","$1",["[2-6]"]]]],686:[[8],[]],687:[[6],[["(..)(..)(..)","$1.$2.$3",["[2-46-9]|5[0-4]"]]]],688:[[6],[]],689:[[6,8],[["(..)(..)(..)(..)","$1 $2 $3 $4",["4[09]|8[79]"]],["(..)(..)(..)","$1 $2 $3",["44"]]]],690:[[4],[]],691:[[7],[["(...)(....)","$1 $2",[]]]],692:[[7],[["(...)(....)","$1-$2",[]]]],850:[[10],[["(...)(...)(....)","$1 $2 $3",["1"]],["(.)(...)(....)","$1 $2 $3",["2"]],["(..)(...)(...)","$1 $2 $3",["8"]]]],852:[[8],[["(....)(....)","$1 $2",["[235-7]|[89](?:0[1-9]|[1-9])"]],["(800)(...)(...)","$1 $2 $3",["800"]],["(900)(..)(...)(...)","$1 $2 $3 $4",["900"]],["(900)(.{2,5})","$1 $2",["900"]]]],853:[[8],[["([268]...)(....)","$1 $2",[]]]],855:[[8,9],[["(..)(...)(.{3,4})","$1 $2 $3",["1.[1-9]|[2-9]"]],["(1[89]00)(...)(...)","$1 $2 $3",["1[89]0"]]]],856:[[10],[["(20)(..)(...)(...)","$1 $2 $3 $4",["20"]],["([2-8].)(...)(...)","$1 $2 $3",["2[13]|3[14]|[4-8]"]],["(30)(..)(..)(...)","$1 $2 $3 $4",["30"]]]],880:[[10],[["(2)(.{7,8})","$1-$2",["2"]],["(..)(.{4,6})","$1-$2",["[3-79]1"]],["(....)(.{3,6})","$1-$2",["1|3(?:0|[2-58]2)|4(?:0|[25]2|3[23]|[4689][25])|5(?:[02-578]2|6[25])|6(?:[0347-9]2|[26][25])|7[02-9]2|8(?:[023][23]|[4-7]2)|9(?:[02][23]|[458]2|6[016])"]],["(...)(.{3,7})","$1-$2",["[3-79][2-9]|8"]]]],886:[[9],[["([2-8])(.{3,4})(....)","$1 $2 $3",["[2-6]|[78][1-9]"]],["([89]..)(...)(...)","$1 $2 $3",["80|9"]],["(70)(....)(....)","$1 $2 $3",["70"]]]],960:[[7],[["(...)(....)","$1-$2",["[3467]|9(?:[1-9]|0[1-9])"]],["(...)(...)(....)","$1 $2 $3",["900"]]]],961:[[7,8],[["(.)(...)(...)","$1 $2 $3",["[13-6]|7(?:[2-57]|62|8[0-7]|9[04-9])|8[02-9]|9"]],["([7-9].)(...)(...)","$1 $2 $3",["[89][01]|7(?:[01]|6[013-9]|8[89]|9[1-3])"]]]],962:[[9],[["(.)(...)(....)","$1 $2 $3",["[2356]|87"]],["(7)(....)(....)","$1 $2 $3",["7[457-9]"]],["(...)(.{5,6})","$1 $2",["70|8[0158]|9"]]]],963:[[9],[["(..)(...)(.{3,4})","$1 $2 $3",["[1-5]"]],["(9..)(...)(...)","$1 $2 $3",["9"]]]],964:[[10],[["(1)(...)(....)","$1 $2 $3",["1"]],["([2-6].)(...)(.{3,4})","$1 $2 $3",["[2-6]"]],["(7..)(...)(....)","$1 $2 $3",["7"]]]],965:[[8],[["(....)(.{3,4})","$1 $2",["[126]|9[04-9]|52[25]"]],["(...)(.....)","$1 $2",["5[015]|92"]]]],966:[[9],[["([1-467])(...)(....)","$1 $2 $3",["[1-467]"]],["(1.)(...)(....)","$1 $2 $3",["1[1-467]"]],["(5.)(...)(....)","$1 $2 $3",["5"]],["(92..)(.....)","$1 $2",["92"]],["(800)(...)(....)","$1 $2 $3",["80"]],["(811)(...)(.{3,4})","$1 $2 $3",["81"]]]],967:[[9],[["([1-7])(...)(.{3,4})","$1 $2 $3",["[1-6]|7[24-68]"]],["(7..)(...)(...)","$1 $2 $3",["7[0137]"]]]],968:[[8],[["(2.)(.{6})","$1 $2",["2"]],["(9...)(....)","$1 $2",["9"]],["([58]00)(.{4,6})","$1 $2",["[58]"]]]],970:[[9],[["([2489])(2..)(....)","$1 $2 $3",["[2489]"]],["(5[69].)(...)(...)","$1 $2 $3",["5"]],["(1[78]00)(...)(...)","$1 $2 $3",["1[78]"]]]],971:[[9],[["([2-4679])(...)(....)","$1 $2 $3",["[2-4679][2-8]"]],["(5[0256])(...)(....)","$1 $2 $3",["5"]],["([479]00)(.)(.....)","$1 $2 $3",["[479]0"]],["([68]00)(.{2,9})","$1 $2",["60|8"]]]],972:[[9],[["([2-489])(...)(....)","$1-$2-$3",["[2-489]"]],["([57].)(...)(....)","$1-$2-$3",["[57]"]],["(1)([7-9]..)(...)(...)","$1-$2-$3-$4",["1[7-9]"]],["(1255)(...)","$1-$2",["125"]],["(1200)(...)(...)","$1-$2-$3",["120"]],["(1212)(..)(..)","$1-$2-$3",["121"]],["(1599)(.{6})","$1-$2",["15"]],["(....)","*$1",["[2-689]"]]]],973:[[8],[["(....)(....)","$1 $2",[]]]],974:[[8],[["([28]..)(....)","$1 $2",["[28]"]],["([3-7]...)(....)","$1 $2",["[3-7]"]]]],975:[[8],[["(..)(..)(..)(..)","$1 $2 $3 $4",["1|77"]],["([2-8])(...)(...)","$1 $2 $3",["[2-68]|7[246]"]]]],976:[[8],[["([12].)(..)(....)","$1 $2 $3",["[12]1"]],["([12]2.)(.{5,6})","$1 $2",["[12]2[1-3]"]],["([12]...)(.....)","$1 $2",["[12](?:27|[3-5])","[12](?:27|[3-5].)2"]],["(....)(....)","$1 $2",["[57-9]"]],["([12]....)(.{4,5})","$1 $2",["[12](?:27|[3-5])","[12](?:27|[3-5].)[4-9]"]]]],977:[[10],[["(1)(.{7})","$1-$2",["1[2-6]"]],["(..)(.{6})","$1-$2",["1[01]|[2-8]|9(?:[1-69]|7[15-9])"]],["(9..)(.{7})","$1-$2",["9(?:6[013]|7[245]|8)"]]]],992:[[9],[["([349]..)(..)(....)","$1 $2 $3",["[34]7|91[78]"]],["([459].)(...)(....)","$1 $2 $3",["4[48]|5|9(?:1[59]|[0235-9])"]],["(331700)(.)(..)","$1 $2 $3",["331","3317","33170","331700"]],["(....)(.)(....)","$1 $2 $3",["3[1-5]","3(?:[1245]|3(?:[02-9]|1[0-589]))"]]]],993:[[8],[["(..)(..)(..)(..)","$1 $2-$3-$4",["12"]],["(..)(.{6})","$1 $2",["6"]],["(...)(.)(..)(..)","$1 $2-$3-$4",["13|[2-5]"]]]],994:[[9],[["(..)(...)(..)(..)","$1 $2 $3 $4",["(?:1[28]|2(?:[45]2|[0-36])|365)"]],["(..)(...)(..)(..)","$1 $2 $3 $4",["[4-8]"]],["(...)(..)(..)(..)","$1 $2 $3 $4",["9"]]]],995:[[9],[["(...)(..)(..)(..)","$1 $2 $3 $4",["[348]"]],["(...)(...)(...)","$1 $2 $3",["7"]],["(...)(..)(..)(..)","$1 $2 $3 $4",["5"]]]],996:[[9],[["(...)(...)(...)","$1 $2 $3",["[25-7]|31[25]"]],["(....)(.....)","$1 $2",["3(?:1[36]|[2-9])"]],["(...)(...)(.)(...)","$1 $2 $3 $4",["8"]]]],998:[[7,8,9],[["([679].)(...)(..)(..)","$1 $2 $3 $4",[]]]]}},function(e,t){e.exports={ar:"ar",az:"az",bg:"bg",bn:"bn",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",fa:"fa",fi:"fi",fil:"fil",fr:"fr",gu:"gu",he:"he",hi:"hi",hr:"hr",hu:"hu",id:"id",it:"it",ja:"ja",kk:"kk",lt:"lt",lv:"lv",mk:"mk",ms:"ms",nb:"nb",nl:"nl",pl:"pl",pt:"pt",pt_br:"pt-BR",pt_zz:"pt-BR",ro:"ro",ru:"ru",sl:"sl",sq:"sq",sr:"sr",sv:"sv",sw:"sw",ta:"ta",th:"th",tr:"tr",uk:"uk",uz:"uz",vi:"vi",zh_cn:"zh-CN",zh_hk:"zh-TW",zh_sg:"zh-CN",zh_tw:"zh-TW"}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function r(e){return n(i(e))}function i(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./af":213,"./af.js":213,"./ar":216,"./ar-ma":214,"./ar-ma.js":214,"./ar-sa":215,"./ar-sa.js":215,"./ar.js":216,"./az":217,"./az.js":217,"./be":218,"./be.js":218,"./bg":219,"./bg.js":219,"./bn":220,"./bn.js":220,"./bo":221,"./bo.js":221,"./br":222,"./br.js":222,"./bs":223,"./bs.js":223,"./ca":224,"./ca.js":224,"./cs":225,"./cs.js":225,"./cv":226,"./cv.js":226,"./cy":227,"./cy.js":227,"./da":228,"./da.js":228,"./de":230,"./de-at":229,"./de-at.js":229,"./de.js":230,"./el":231,"./el.js":231,"./en-au":232,"./en-au.js":232,"./en-ca":233,"./en-ca.js":233,"./en-gb":234,"./en-gb.js":234,"./eo":235,"./eo.js":235,"./es":236,"./es.js":236,"./et":237,"./et.js":237,"./eu":238,"./eu.js":238,"./fa":239,"./fa.js":239,"./fi":240,"./fi.js":240,"./fo":241,"./fo.js":241,"./fr":243,"./fr-ca":242,"./fr-ca.js":242,"./fr.js":243,"./gl":244,"./gl.js":244,"./he":245,"./he.js":245,"./hi":246,"./hi.js":246,"./hr":247,"./hr.js":247,"./hu":248,"./hu.js":248,"./hy-am":249,"./hy-am.js":249,"./id":250,"./id.js":250,"./is":251,"./is.js":251,"./it":252,"./it.js":252,"./ja":253,"./ja.js":253,"./ka":254,"./ka.js":254,"./km":255,"./km.js":255,"./ko":256,"./ko.js":256,"./lb":257,"./lb.js":257,"./lt":258,"./lt.js":258,"./lv":259,"./lv.js":259,"./mk":260,"./mk.js":260,"./ml":261,"./ml.js":261,"./mr":262,"./mr.js":262,"./ms-my":263,"./ms-my.js":263,"./my":264,"./my.js":264,"./nb":265,"./nb.js":265,"./ne":266,"./ne.js":266,"./nl":267,"./nl.js":267,"./nn":268,"./nn.js":268,"./pl":269,"./pl.js":269,"./pt":271,"./pt-br":270,"./pt-br.js":270,"./pt.js":271,"./ro":272,"./ro.js":272,"./ru":273,"./ru.js":273,"./sk":274,"./sk.js":274,"./sl":275,"./sl.js":275,"./sq":276,"./sq.js":276,"./sr":278,"./sr-cyrl":277,"./sr-cyrl.js":277,"./sr.js":278,"./sv":279,"./sv.js":279,"./ta":280,"./ta.js":280,"./th":281,"./th.js":281,"./tl-ph":282,"./tl-ph.js":282,"./tr":283,"./tr.js":283,"./tzm":285,"./tzm-latn":284,"./tzm-latn.js":284,"./tzm.js":285,"./uk":286,"./uk.js":286,"./uz":287,"./uz.js":287,"./vi":288,"./vi.js":288,"./zh-cn":289,"./zh-cn.js":289,"./zh-tw":290,"./zh-tw.js":290};r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=542},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(78).then(function(t){e(n(696))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(77).then(function(t){e(n(697))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(76).then(function(t){e(n(698))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(75).then(function(t){e(n(699))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(74).then(function(t){e(n(700))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(73).then(function(t){e(n(701))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(72).then(function(t){e(n(702))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(71).then(function(t){e(n(703))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(70).then(function(t){e(n(704))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(69).then(function(t){e(n(705))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(68).then(function(t){e(n(706))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(67).then(function(t){e(n(707))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){Promise.resolve().then(function(t){e(n(190))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(66).then(function(t){e(n(708))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(65).then(function(t){e(n(709))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(64).then(function(t){e(n(710))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(63).then(function(t){e(n(711))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(62).then(function(t){e(n(712))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(61).then(function(t){e(n(713))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(60).then(function(t){e(n(714))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(59).then(function(t){e(n(715))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(58).then(function(t){e(n(716))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(57).then(function(t){e(n(717))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(56).then(function(t){e(n(718))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(55).then(function(t){e(n(719))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(54).then(function(t){e(n(720))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(53).then(function(t){e(n(721))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(52).then(function(t){e(n(722))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(51).then(function(t){e(n(723))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(50).then(function(t){e(n(724))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(49).then(function(t){e(n(725))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(48).then(function(t){e(n(726))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(47).then(function(t){e(n(727))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(46).then(function(t){e(n(728))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(45).then(function(t){e(n(729))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(44).then(function(t){e(n(730))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(43).then(function(t){e(n(731))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(42).then(function(t){e(n(732))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(41).then(function(t){e(n(733))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(40).then(function(t){e(n(734))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(39).then(function(t){e(n(735))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(38).then(function(t){e(n(736))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(37).then(function(t){e(n(737))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(36).then(function(t){e(n(738))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(35).then(function(t){e(n(739))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(34).then(function(t){e(n(740))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(33).then(function(t){e(n(741))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(32).then(function(t){e(n(742))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(31).then(function(t){e(n(743))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(30).then(function(t){e(n(744))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(29).then(function(t){e(n(745))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(28).then(function(t){e(n(746))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(27).then(function(t){e(n(747))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(26).then(function(t){e(n(748))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(25).then(function(t){e(n(749))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(24).then(function(t){e(n(750))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(23).then(function(t){e(n(751))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(22).then(function(t){e(n(752))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(21).then(function(t){e(n(753))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(20).then(function(t){e(n(754))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){
return new Promise(function(e,t){n.e(19).then(function(t){e(n(755))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(18).then(function(t){e(n(756))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(17).then(function(t){e(n(757))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(16).then(function(t){e(n(758))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(15).then(function(t){e(n(759))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(14).then(function(t){e(n(760))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(13).then(function(t){e(n(761))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(12).then(function(t){e(n(762))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(11).then(function(t){e(n(763))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(10).then(function(t){e(n(764))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(9).then(function(t){e(n(765))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(8).then(function(t){e(n(766))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(7).then(function(t){e(n(767))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}},function(e,t,n){e.exports=function(){return new Promise(function(e,t){n.e(6).then(function(t){e(n(768))}.bind(null,n))["catch"](function(e){n.oe(e)})["catch"](function(){t()})})}}],[376]);